{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.130542490463103, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12973414608778092, "policy_loss": -0.0022925489612164035, "vf_loss": 0.13118855538602758, "vf_explained_var": -0.1922052534036739, "kl": 0.004190694707289055, "entropy": 2.8411015559268256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 0.9796424363497638, "episode_reward_min": -1.0, "episode_reward_mean": -0.9354402825039825, "episode_len_mean": 49.8875, "episode_media": {}, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6834529654932713, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9796424363497638, -1.0, -1.0, -1.0, 0.5016819978383611, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [16, 80, 61, 80, 42, 28, 16, 61, 80, 60, 29, 80, 23, 80, 80, 53, 75, 26, 55, 17, 36, 28, 39, 80, 42, 65, 17, 33, 80, 80, 49, 66, 80, 29, 12, 65, 16, 34, 32, 80, 80, 69, 47, 80, 35, 60, 54, 25, 20, 19, 80, 58, 12, 41, 48, 80, 51, 23, 77, 34, 20, 59, 42, 37, 69, 33, 80, 57, 51, 65, 30, 75, 22, 32, 52, 68, 16, 59, 46, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09258590141435587, "mean_inference_ms": 0.24270808747398115, "mean_action_processing_ms": 0.04373964921321549, "mean_env_wait_ms": 0.04653601728657191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014412403106689453, "StateBufferConnector_ms": 0.001207888126373291, "ViewRequirementAgentConnector_ms": 0.028457045555114746}}, "episode_reward_max": 0.9796424363497638, "episode_reward_min": -1.0, "episode_reward_mean": -0.9354402825039825, "episode_len_mean": 49.8875, "episodes_this_iter": 80, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6834529654932713, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9796424363497638, -1.0, -1.0, -1.0, 0.5016819978383611, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [16, 80, 61, 80, 42, 28, 16, 61, 80, 60, 29, 80, 23, 80, 80, 53, 75, 26, 55, 17, 36, 28, 39, 80, 42, 65, 17, 33, 80, 80, 49, 66, 80, 29, 12, 65, 16, 34, 32, 80, 80, 69, 47, 80, 35, 60, 54, 25, 20, 19, 80, 58, 12, 41, 48, 80, 51, 23, 77, 34, 20, 59, 42, 37, 69, 33, 80, 57, 51, 65, 30, 75, 22, 32, 52, 68, 16, 59, 46, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09258590141435587, "mean_inference_ms": 0.24270808747398115, "mean_action_processing_ms": 0.04373964921321549, "mean_env_wait_ms": 0.04653601728657191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014412403106689453, "StateBufferConnector_ms": 0.001207888126373291, "ViewRequirementAgentConnector_ms": 0.028457045555114746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1091.8381059934222, "num_env_steps_trained_throughput_per_sec": 1091.8381059934222, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 3663.532, "sample_time_ms": 1719.589, "load_time_ms": 0.135, "load_throughput": 29641724.382, "learn_time_ms": 1942.714, "learn_throughput": 2058.975, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 80, "training_iteration": 1, "trial_id": "default", "date": "2024-05-22_22-15-03", "timestamp": 1716408903, "time_this_iter_s": 3.6661500930786133, "time_total_s": 3.6661500930786133, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3.6661500930786133, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.316666666666668, "ram_util_percent": 61.449999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.220953197152384, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05400301218934117, "policy_loss": -0.005758305755193515, "vf_loss": 0.058777162353558246, "vf_explained_var": -0.16444820960362752, "kl": 0.009841551053770225, "entropy": 2.796448213567016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 0.9796424363497638, "episode_reward_min": -1.0, "episode_reward_mean": -0.9467758972407099, "episode_len_mean": 55.56, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9796424363497638, -1.0, -1.0, -1.0, 0.5016819978383611, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8410858417408899, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [25, 20, 19, 80, 58, 12, 41, 48, 80, 51, 23, 77, 34, 20, 59, 42, 37, 69, 33, 80, 57, 51, 65, 30, 75, 22, 32, 52, 68, 16, 59, 46, 80, 79, 12, 69, 80, 26, 52, 55, 80, 59, 80, 47, 37, 75, 80, 19, 54, 30, 80, 38, 80, 28, 62, 65, 58, 29, 52, 22, 37, 74, 59, 76, 29, 80, 80, 72, 56, 80, 80, 60, 60, 80, 80, 80, 49, 80, 67, 80, 27, 56, 80, 80, 37, 80, 45, 59, 80, 51, 55, 34, 23, 60, 80, 59, 80, 80, 42, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09219415365651393, "mean_inference_ms": 0.2422010346661746, "mean_action_processing_ms": 0.04369565535189835, "mean_env_wait_ms": 0.046453944640965424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015482902526855469, "StateBufferConnector_ms": 0.0012378692626953125, "ViewRequirementAgentConnector_ms": 0.028426647186279297}}, "episode_reward_max": 0.9796424363497638, "episode_reward_min": -1.0, "episode_reward_mean": -0.9467758972407099, "episode_len_mean": 55.56, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9796424363497638, -1.0, -1.0, -1.0, 0.5016819978383611, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8410858417408899, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [25, 20, 19, 80, 58, 12, 41, 48, 80, 51, 23, 77, 34, 20, 59, 42, 37, 69, 33, 80, 57, 51, 65, 30, 75, 22, 32, 52, 68, 16, 59, 46, 80, 79, 12, 69, 80, 26, 52, 55, 80, 59, 80, 47, 37, 75, 80, 19, 54, 30, 80, 38, 80, 28, 62, 65, 58, 29, 52, 22, 37, 74, 59, 76, 29, 80, 80, 72, 56, 80, 80, 60, 60, 80, 80, 80, 49, 80, 67, 80, 27, 56, 80, 80, 37, 80, 45, 59, 80, 51, 55, 34, 23, 60, 80, 59, 80, 80, 42, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09219415365651393, "mean_inference_ms": 0.2422010346661746, "mean_action_processing_ms": 0.04369565535189835, "mean_env_wait_ms": 0.046453944640965424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015482902526855469, "StateBufferConnector_ms": 0.0012378692626953125, "ViewRequirementAgentConnector_ms": 0.028426647186279297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1124.2602892079974, "num_env_steps_trained_throughput_per_sec": 1124.2602892079974, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 3610.707, "sample_time_ms": 1712.811, "load_time_ms": 0.146, "load_throughput": 27413751.634, "learn_time_ms": 1896.769, "learn_throughput": 2108.85, "synch_weights_time_ms": 0.61}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 147, "training_iteration": 2, "trial_id": "default", "date": "2024-05-22_22-15-07", "timestamp": 1716408907, "time_this_iter_s": 3.5601091384887695, "time_total_s": 7.226259231567383, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7.226259231567383, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.5, "ram_util_percent": 61.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.113329535081822, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11310409910736545, "policy_loss": -0.0024695093573261335, "vf_loss": 0.1151605949076193, "vf_explained_var": -0.12722673685319963, "kl": 0.004130127305423291, "entropy": 2.810293161484503, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 0.8410858417408899, "episode_reward_min": -1.0, "episode_reward_mean": -0.888138660876113, "episode_len_mean": 62.47, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8410858417408899, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7762965567190909, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5560030291500101, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5127484847787026, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 72, 56, 80, 80, 60, 60, 80, 80, 80, 49, 80, 67, 80, 27, 56, 80, 80, 37, 80, 45, 59, 80, 51, 55, 34, 23, 60, 80, 59, 80, 80, 42, 80, 53, 80, 79, 18, 80, 80, 59, 80, 70, 80, 80, 32, 80, 35, 27, 53, 59, 80, 80, 43, 80, 80, 24, 75, 21, 80, 53, 68, 80, 80, 25, 77, 19, 55, 13, 80, 80, 67, 60, 69, 80, 70, 80, 50, 80, 16, 80, 80, 80, 67, 80, 41, 56, 80, 58, 80, 22, 49, 80, 80, 20, 33, 19, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09176428285288356, "mean_inference_ms": 0.24181447503084683, "mean_action_processing_ms": 0.04363617787278859, "mean_env_wait_ms": 0.04637318410666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001592397689819336, "StateBufferConnector_ms": 0.0013060569763183594, "ViewRequirementAgentConnector_ms": 0.028325796127319336}}, "episode_reward_max": 0.8410858417408899, "episode_reward_min": -1.0, "episode_reward_mean": -0.888138660876113, "episode_len_mean": 62.47, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8410858417408899, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7762965567190909, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5560030291500101, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5127484847787026, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 72, 56, 80, 80, 60, 60, 80, 80, 80, 49, 80, 67, 80, 27, 56, 80, 80, 37, 80, 45, 59, 80, 51, 55, 34, 23, 60, 80, 59, 80, 80, 42, 80, 53, 80, 79, 18, 80, 80, 59, 80, 70, 80, 80, 32, 80, 35, 27, 53, 59, 80, 80, 43, 80, 80, 24, 75, 21, 80, 53, 68, 80, 80, 25, 77, 19, 55, 13, 80, 80, 67, 60, 69, 80, 70, 80, 50, 80, 16, 80, 80, 80, 67, 80, 41, 56, 80, 58, 80, 22, 49, 80, 80, 20, 33, 19, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09176428285288356, "mean_inference_ms": 0.24181447503084683, "mean_action_processing_ms": 0.04363617787278859, "mean_env_wait_ms": 0.04637318410666026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001592397689819336, "StateBufferConnector_ms": 0.0013060569763183594, "ViewRequirementAgentConnector_ms": 0.028325796127319336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1133.66093777831, "num_env_steps_trained_throughput_per_sec": 1133.66093777831, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 3583.264, "sample_time_ms": 1709.854, "load_time_ms": 0.153, "load_throughput": 26132735.202, "learn_time_ms": 1872.297, "learn_throughput": 2136.414, "synch_weights_time_ms": 0.61}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 212, "training_iteration": 3, "trial_id": "default", "date": "2024-05-22_22-15-10", "timestamp": 1716408910, "time_this_iter_s": 3.5306456089019775, "time_total_s": 10.75690484046936, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.75690484046936, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.059999999999995, "ram_util_percent": 61.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.519294027295164, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1276646198793715, "policy_loss": -0.003867107403454601, "vf_loss": 0.13099169018227727, "vf_explained_var": -0.22329367059533314, "kl": 0.010800776894914134, "entropy": 2.7756411137119414, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 0.9702216864374535, "episode_reward_min": -1.0, "episode_reward_mean": -0.8362546646847183, "episode_len_mean": 63.64, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5560030291500101, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5127484847787026, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.9702216864374535, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9498495234756339, 0.8857108076863728, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [53, 68, 80, 80, 25, 77, 19, 55, 13, 80, 80, 67, 60, 69, 80, 70, 80, 50, 80, 16, 80, 80, 80, 67, 80, 41, 56, 80, 58, 80, 22, 49, 80, 80, 20, 33, 19, 80, 80, 80, 36, 42, 80, 80, 80, 60, 80, 80, 60, 46, 35, 57, 76, 57, 43, 80, 80, 80, 64, 74, 80, 75, 80, 27, 80, 80, 54, 62, 21, 80, 47, 80, 80, 80, 80, 27, 65, 69, 80, 53, 62, 80, 80, 43, 60, 80, 80, 80, 63, 60, 80, 48, 60, 73, 36, 64, 80, 41, 80, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09148638609791043, "mean_inference_ms": 0.24157879313270406, "mean_action_processing_ms": 0.043594077844087024, "mean_env_wait_ms": 0.0463105220498878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015223026275634766, "StateBufferConnector_ms": 0.001276254653930664, "ViewRequirementAgentConnector_ms": 0.028480052947998047}}, "episode_reward_max": 0.9702216864374535, "episode_reward_min": -1.0, "episode_reward_mean": -0.8362546646847183, "episode_len_mean": 63.64, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5560030291500101, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5127484847787026, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.9702216864374535, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9498495234756339, 0.8857108076863728, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [53, 68, 80, 80, 25, 77, 19, 55, 13, 80, 80, 67, 60, 69, 80, 70, 80, 50, 80, 16, 80, 80, 80, 67, 80, 41, 56, 80, 58, 80, 22, 49, 80, 80, 20, 33, 19, 80, 80, 80, 36, 42, 80, 80, 80, 60, 80, 80, 60, 46, 35, 57, 76, 57, 43, 80, 80, 80, 64, 74, 80, 75, 80, 27, 80, 80, 54, 62, 21, 80, 47, 80, 80, 80, 80, 27, 65, 69, 80, 53, 62, 80, 80, 43, 60, 80, 80, 80, 63, 60, 80, 48, 60, 73, 36, 64, 80, 41, 80, 77]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09148638609791043, "mean_inference_ms": 0.24157879313270406, "mean_action_processing_ms": 0.043594077844087024, "mean_env_wait_ms": 0.0463105220498878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015223026275634766, "StateBufferConnector_ms": 0.001276254653930664, "ViewRequirementAgentConnector_ms": 0.028480052947998047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1133.4203018586988, "num_env_steps_trained_throughput_per_sec": 1133.4203018586988, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 3569.73, "sample_time_ms": 1707.289, "load_time_ms": 0.165, "load_throughput": 24297199.131, "learn_time_ms": 1861.324, "learn_throughput": 2149.007, "synch_weights_time_ms": 0.613}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 273, "training_iteration": 4, "trial_id": "default", "date": "2024-05-22_22-15-14", "timestamp": 1716408914, "time_this_iter_s": 3.53141188621521, "time_total_s": 14.28831672668457, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14.28831672668457, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 14.52, "ram_util_percent": 61.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0873795106846798, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1039690177697408, "policy_loss": -0.0024725751876230203, "vf_loss": 0.10599320451178218, "vf_explained_var": -0.05936769490600914, "kl": 0.008967777942658482, "entropy": 2.8170161260071622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 0.988351293450523, "episode_reward_min": -1.0, "episode_reward_mean": -0.8925544097903191, "episode_len_mean": 63.61, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9498495234756339, 0.8857108076863728, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.988351293450523, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8487879172741271, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5718594790814379, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 54, 62, 21, 80, 47, 80, 80, 80, 80, 27, 65, 69, 80, 53, 62, 80, 80, 43, 60, 80, 80, 80, 63, 60, 80, 48, 60, 73, 36, 64, 80, 41, 80, 77, 80, 80, 73, 80, 80, 26, 80, 80, 78, 25, 60, 80, 42, 80, 22, 26, 80, 80, 27, 80, 80, 28, 80, 60, 80, 80, 29, 80, 80, 80, 29, 61, 16, 80, 80, 60, 80, 67, 63, 80, 53, 80, 43, 80, 20, 56, 21, 19, 80, 79, 43, 80, 17, 80, 80, 66, 46, 51, 70, 60, 80, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09134801685777956, "mean_inference_ms": 0.2414823622193554, "mean_action_processing_ms": 0.04359616760556266, "mean_env_wait_ms": 0.046292238289407005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016214847564697266, "StateBufferConnector_ms": 0.0012438297271728516, "ViewRequirementAgentConnector_ms": 0.0283963680267334}}, "episode_reward_max": 0.988351293450523, "episode_reward_min": -1.0, "episode_reward_mean": -0.8925544097903191, "episode_len_mean": 63.61, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9498495234756339, 0.8857108076863728, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.988351293450523, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8487879172741271, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5718594790814379, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 54, 62, 21, 80, 47, 80, 80, 80, 80, 27, 65, 69, 80, 53, 62, 80, 80, 43, 60, 80, 80, 80, 63, 60, 80, 48, 60, 73, 36, 64, 80, 41, 80, 77, 80, 80, 73, 80, 80, 26, 80, 80, 78, 25, 60, 80, 42, 80, 22, 26, 80, 80, 27, 80, 80, 28, 80, 60, 80, 80, 29, 80, 80, 80, 29, 61, 16, 80, 80, 60, 80, 67, 63, 80, 53, 80, 43, 80, 20, 56, 21, 19, 80, 79, 43, 80, 17, 80, 80, 66, 46, 51, 70, 60, 80, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09134801685777956, "mean_inference_ms": 0.2414823622193554, "mean_action_processing_ms": 0.04359616760556266, "mean_env_wait_ms": 0.046292238289407005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016214847564697266, "StateBufferConnector_ms": 0.0012438297271728516, "ViewRequirementAgentConnector_ms": 0.0283963680267334}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1131.7566475933802, "num_env_steps_trained_throughput_per_sec": 1131.7566475933802, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 3562.647, "sample_time_ms": 1707.145, "load_time_ms": 0.175, "load_throughput": 22838573.373, "learn_time_ms": 1854.379, "learn_throughput": 2157.056, "synch_weights_time_ms": 0.613}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 337, "training_iteration": 5, "trial_id": "default", "date": "2024-05-22_22-15-17", "timestamp": 1716408917, "time_this_iter_s": 3.5366599559783936, "time_total_s": 17.824976682662964, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 17.824976682662964, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 10.8, "ram_util_percent": 61.44}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4833318323858322, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05848575453931135, "policy_loss": -0.006187260675153905, "vf_loss": 0.06409209794114513, "vf_explained_var": -0.11513823501525387, "kl": 0.011618360272881972, "entropy": 2.7454073259907386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 0.8487879172741271, "episode_reward_min": -1.0, "episode_reward_mean": -0.9356366434019633, "episode_len_mean": 64.05, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8487879172741271, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5718594790814379, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5156882634481075, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 29, 80, 80, 80, 29, 61, 16, 80, 80, 60, 80, 67, 63, 80, 53, 80, 43, 80, 20, 56, 21, 19, 80, 79, 43, 80, 17, 80, 80, 66, 46, 51, 70, 60, 80, 80, 80, 80, 80, 55, 52, 80, 16, 80, 80, 62, 75, 80, 41, 80, 70, 71, 53, 80, 80, 47, 80, 80, 54, 80, 80, 52, 28, 46, 68, 23, 80, 19, 80, 80, 80, 80, 80, 80, 80, 21, 80, 80, 30, 61, 80, 67, 80, 58, 80, 59, 80, 80, 80, 78, 80, 17, 14, 80, 80, 80, 80, 80, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0912332818968323, "mean_inference_ms": 0.24139022970541382, "mean_action_processing_ms": 0.04357889248131846, "mean_env_wait_ms": 0.046272201062236305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016188621520996094, "StateBufferConnector_ms": 0.0012176036834716797, "ViewRequirementAgentConnector_ms": 0.02832508087158203}}, "episode_reward_max": 0.8487879172741271, "episode_reward_min": -1.0, "episode_reward_mean": -0.9356366434019633, "episode_len_mean": 64.05, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8487879172741271, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5718594790814379, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5156882634481075, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 29, 80, 80, 80, 29, 61, 16, 80, 80, 60, 80, 67, 63, 80, 53, 80, 43, 80, 20, 56, 21, 19, 80, 79, 43, 80, 17, 80, 80, 66, 46, 51, 70, 60, 80, 80, 80, 80, 80, 55, 52, 80, 16, 80, 80, 62, 75, 80, 41, 80, 70, 71, 53, 80, 80, 47, 80, 80, 54, 80, 80, 52, 28, 46, 68, 23, 80, 19, 80, 80, 80, 80, 80, 80, 80, 21, 80, 80, 30, 61, 80, 67, 80, 58, 80, 59, 80, 80, 80, 78, 80, 17, 14, 80, 80, 80, 80, 80, 39]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0912332818968323, "mean_inference_ms": 0.24139022970541382, "mean_action_processing_ms": 0.04357889248131846, "mean_env_wait_ms": 0.046272201062236305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016188621520996094, "StateBufferConnector_ms": 0.0012176036834716797, "ViewRequirementAgentConnector_ms": 0.02832508087158203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1132.4178845610104, "num_env_steps_trained_throughput_per_sec": 1132.4178845610104, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 3557.582, "sample_time_ms": 1705.524, "load_time_ms": 0.176, "load_throughput": 22728222.172, "learn_time_ms": 1850.943, "learn_throughput": 2161.061, "synch_weights_time_ms": 0.608}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 398, "training_iteration": 6, "trial_id": "default", "date": "2024-05-22_22-15-21", "timestamp": 1716408921, "time_this_iter_s": 3.5345637798309326, "time_total_s": 21.359540462493896, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 21.359540462493896, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.52, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3336623919907438, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05446545152965012, "policy_loss": -0.002513329949109785, "vf_loss": 0.056478375470846574, "vf_explained_var": -0.12631607760665237, "kl": 0.010008129983608198, "entropy": 2.7272772640310308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.0, "episode_reward_mean": -0.97, "episode_len_mean": 68.39, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [47, 80, 80, 54, 80, 80, 52, 28, 46, 68, 23, 80, 19, 80, 80, 80, 80, 80, 80, 80, 21, 80, 80, 30, 61, 80, 67, 80, 58, 80, 59, 80, 80, 80, 78, 80, 17, 14, 80, 80, 80, 80, 80, 39, 80, 80, 80, 45, 80, 80, 79, 80, 80, 80, 80, 60, 80, 80, 80, 30, 20, 80, 80, 39, 56, 80, 70, 40, 56, 80, 80, 80, 80, 80, 70, 50, 80, 80, 80, 80, 80, 80, 80, 75, 80, 10, 80, 80, 56, 80, 80, 80, 80, 74, 80, 51, 80, 80, 78, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09105176310344937, "mean_inference_ms": 0.2428778251135493, "mean_action_processing_ms": 0.04354551001358657, "mean_env_wait_ms": 0.04623767390798696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014917850494384766, "StateBufferConnector_ms": 0.0012052059173583984, "ViewRequirementAgentConnector_ms": 0.028291702270507812}}, "episode_reward_max": 0.5, "episode_reward_min": -1.0, "episode_reward_mean": -0.97, "episode_len_mean": 68.39, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [47, 80, 80, 54, 80, 80, 52, 28, 46, 68, 23, 80, 19, 80, 80, 80, 80, 80, 80, 80, 21, 80, 80, 30, 61, 80, 67, 80, 58, 80, 59, 80, 80, 80, 78, 80, 17, 14, 80, 80, 80, 80, 80, 39, 80, 80, 80, 45, 80, 80, 79, 80, 80, 80, 80, 60, 80, 80, 80, 30, 20, 80, 80, 39, 56, 80, 70, 40, 56, 80, 80, 80, 80, 80, 70, 50, 80, 80, 80, 80, 80, 80, 80, 75, 80, 10, 80, 80, 56, 80, 80, 80, 80, 74, 80, 51, 80, 80, 78, 59]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09105176310344937, "mean_inference_ms": 0.2428778251135493, "mean_action_processing_ms": 0.04354551001358657, "mean_env_wait_ms": 0.04623767390798696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014917850494384766, "StateBufferConnector_ms": 0.0012052059173583984, "ViewRequirementAgentConnector_ms": 0.028291702270507812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1114.1599088760818, "num_env_steps_trained_throughput_per_sec": 1114.1599088760818, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 3562.232, "sample_time_ms": 1715.422, "load_time_ms": 0.196, "load_throughput": 20435098.66, "learn_time_ms": 1845.666, "learn_throughput": 2167.24, "synch_weights_time_ms": 0.619}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 454, "training_iteration": 7, "trial_id": "default", "date": "2024-05-22_22-15-24", "timestamp": 1716408924, "time_this_iter_s": 3.5923421382904053, "time_total_s": 24.9518826007843, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 24.9518826007843, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.259999999999998, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.379921826960579, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12019373945721615, "policy_loss": -0.004234088913747861, "vf_loss": 0.12373772120223411, "vf_explained_var": -0.1242309296002952, "kl": 0.013802100965042117, "entropy": 2.657464780858768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.9831626895128832, "episode_reward_min": -1.0, "episode_reward_mean": -0.930778394343114, "episode_len_mean": 67.81, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9389978761757194, 0.9831626895128832, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 39, 56, 80, 70, 40, 56, 80, 80, 80, 80, 80, 70, 50, 80, 80, 80, 80, 80, 80, 80, 75, 80, 10, 80, 80, 56, 80, 80, 80, 80, 74, 80, 51, 80, 80, 78, 59, 80, 80, 80, 37, 80, 80, 80, 79, 69, 37, 80, 80, 80, 80, 80, 14, 80, 80, 80, 80, 24, 31, 40, 40, 66, 28, 77, 80, 80, 41, 80, 80, 80, 76, 38, 53, 80, 63, 19, 43, 80, 80, 73, 80, 79, 80, 80, 18, 61, 80, 80, 80, 55, 49, 53, 80, 80, 73, 80, 80, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0909260591942209, "mean_inference_ms": 0.24388015688752193, "mean_action_processing_ms": 0.04353379620258114, "mean_env_wait_ms": 0.046222988416904906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0013899803161621094, "StateBufferConnector_ms": 0.0012176036834716797, "ViewRequirementAgentConnector_ms": 0.028510332107543945}}, "episode_reward_max": 0.9831626895128832, "episode_reward_min": -1.0, "episode_reward_mean": -0.930778394343114, "episode_len_mean": 67.81, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9389978761757194, 0.9831626895128832, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 39, 56, 80, 70, 40, 56, 80, 80, 80, 80, 80, 70, 50, 80, 80, 80, 80, 80, 80, 80, 75, 80, 10, 80, 80, 56, 80, 80, 80, 80, 74, 80, 51, 80, 80, 78, 59, 80, 80, 80, 37, 80, 80, 80, 79, 69, 37, 80, 80, 80, 80, 80, 14, 80, 80, 80, 80, 24, 31, 40, 40, 66, 28, 77, 80, 80, 41, 80, 80, 80, 76, 38, 53, 80, 63, 19, 43, 80, 80, 73, 80, 79, 80, 80, 18, 61, 80, 80, 80, 55, 49, 53, 80, 80, 73, 80, 80, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0909260591942209, "mean_inference_ms": 0.24388015688752193, "mean_action_processing_ms": 0.04353379620258114, "mean_env_wait_ms": 0.046222988416904906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0013899803161621094, "StateBufferConnector_ms": 0.0012176036834716797, "ViewRequirementAgentConnector_ms": 0.028510332107543945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1108.7159401521824, "num_env_steps_trained_throughput_per_sec": 1108.7159401521824, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 3567.923, "sample_time_ms": 1713.81, "load_time_ms": 0.194, "load_throughput": 20613996.007, "learn_time_ms": 1852.95, "learn_throughput": 2158.72, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 515, "training_iteration": 8, "trial_id": "default", "date": "2024-05-22_22-15-28", "timestamp": 1716408928, "time_this_iter_s": 3.6100921630859375, "time_total_s": 28.56197476387024, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 28.56197476387024, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.7, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4749382178629598, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05628037957013935, "policy_loss": -0.008201635289957286, "vf_loss": 0.06406910193342996, "vf_explained_var": -0.1415100480279615, "kl": 0.008258262835937872, "entropy": 2.6955307358054705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 0.6833108225543841, "episode_reward_min": -1.0, "episode_reward_mean": -0.9681668917744563, "episode_len_mean": 68.72, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6833108225543841, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 24, 31, 40, 40, 66, 28, 77, 80, 80, 41, 80, 80, 80, 76, 38, 53, 80, 63, 19, 43, 80, 80, 73, 80, 79, 80, 80, 18, 61, 80, 80, 80, 55, 49, 53, 80, 80, 73, 80, 80, 21, 80, 80, 80, 80, 80, 64, 80, 53, 80, 75, 80, 80, 80, 80, 80, 45, 80, 80, 80, 80, 80, 80, 80, 80, 40, 80, 80, 80, 80, 80, 80, 80, 80, 54, 80, 80, 80, 80, 15, 80, 80, 50, 80, 80, 63, 43, 72, 34, 79, 80, 57, 80, 49, 80, 80, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09084423048953591, "mean_inference_ms": 0.24360430350741907, "mean_action_processing_ms": 0.04353874847220007, "mean_env_wait_ms": 0.046208787151494984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014896392822265625, "StateBufferConnector_ms": 0.0012102127075195312, "ViewRequirementAgentConnector_ms": 0.028305768966674805}}, "episode_reward_max": 0.6833108225543841, "episode_reward_min": -1.0, "episode_reward_mean": -0.9681668917744563, "episode_len_mean": 68.72, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6833108225543841, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 24, 31, 40, 40, 66, 28, 77, 80, 80, 41, 80, 80, 80, 76, 38, 53, 80, 63, 19, 43, 80, 80, 73, 80, 79, 80, 80, 18, 61, 80, 80, 80, 55, 49, 53, 80, 80, 73, 80, 80, 21, 80, 80, 80, 80, 80, 64, 80, 53, 80, 75, 80, 80, 80, 80, 80, 45, 80, 80, 80, 80, 80, 80, 80, 80, 40, 80, 80, 80, 80, 80, 80, 80, 80, 54, 80, 80, 80, 80, 15, 80, 80, 50, 80, 80, 63, 43, 72, 34, 79, 80, 57, 80, 49, 80, 80, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09084423048953591, "mean_inference_ms": 0.24360430350741907, "mean_action_processing_ms": 0.04353874847220007, "mean_env_wait_ms": 0.046208787151494984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014896392822265625, "StateBufferConnector_ms": 0.0012102127075195312, "ViewRequirementAgentConnector_ms": 0.028305768966674805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1138.5210098769176, "num_env_steps_trained_throughput_per_sec": 1138.5210098769176, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3561.856, "sample_time_ms": 1712.298, "load_time_ms": 0.194, "load_throughput": 20661596.059, "learn_time_ms": 1848.402, "learn_throughput": 2164.032, "synch_weights_time_ms": 0.631}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 571, "training_iteration": 9, "trial_id": "default", "date": "2024-05-22_22-15-32", "timestamp": 1716408932, "time_this_iter_s": 3.5156118869781494, "time_total_s": 32.07758665084839, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.07758665084839, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.720000000000002, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3917372070012555, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04430782757760514, "policy_loss": -0.0062209701320777334, "vf_loss": 0.05021162356340116, "vf_explained_var": -0.15401599855833156, "kl": 0.006343478653447766, "entropy": 2.7370706999173726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 0.7828310351674657, "episode_reward_min": -1.0, "episode_reward_mean": -0.9653385814227815, "episode_len_mean": 71.42, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6833108225543841, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7828310351674657, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 45, 80, 80, 80, 80, 80, 80, 80, 80, 40, 80, 80, 80, 80, 80, 80, 80, 80, 54, 80, 80, 80, 80, 15, 80, 80, 50, 80, 80, 63, 43, 72, 34, 79, 80, 57, 80, 49, 80, 80, 78, 74, 65, 80, 80, 16, 59, 80, 80, 80, 33, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 25, 80, 80, 80, 10, 43, 80, 80, 80, 80, 80, 80, 80, 80, 76, 68, 80, 80, 69, 80, 80, 51, 76, 80, 47, 80, 80, 16, 80, 80, 80, 80, 59, 80, 80, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0907465715349673, "mean_inference_ms": 0.24336313633114628, "mean_action_processing_ms": 0.043538148014742734, "mean_env_wait_ms": 0.04619418600570376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015926361083984375, "StateBufferConnector_ms": 0.0012149810791015625, "ViewRequirementAgentConnector_ms": 0.028238296508789062}}, "episode_reward_max": 0.7828310351674657, "episode_reward_min": -1.0, "episode_reward_mean": -0.9653385814227815, "episode_len_mean": 71.42, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6833108225543841, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7828310351674657, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 45, 80, 80, 80, 80, 80, 80, 80, 80, 40, 80, 80, 80, 80, 80, 80, 80, 80, 54, 80, 80, 80, 80, 15, 80, 80, 50, 80, 80, 63, 43, 72, 34, 79, 80, 57, 80, 49, 80, 80, 78, 74, 65, 80, 80, 16, 59, 80, 80, 80, 33, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 25, 80, 80, 80, 10, 43, 80, 80, 80, 80, 80, 80, 80, 80, 76, 68, 80, 80, 69, 80, 80, 51, 76, 80, 47, 80, 80, 16, 80, 80, 80, 80, 59, 80, 80, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0907465715349673, "mean_inference_ms": 0.24336313633114628, "mean_action_processing_ms": 0.043538148014742734, "mean_env_wait_ms": 0.04619418600570376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015926361083984375, "StateBufferConnector_ms": 0.0012149810791015625, "ViewRequirementAgentConnector_ms": 0.028238296508789062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1134.0056800266095, "num_env_steps_trained_throughput_per_sec": 1134.0056800266095, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 3558.401, "sample_time_ms": 1710.93, "load_time_ms": 0.194, "load_throughput": 20572919.681, "learn_time_ms": 1846.318, "learn_throughput": 2166.474, "synch_weights_time_ms": 0.629}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 627, "training_iteration": 10, "trial_id": "default", "date": "2024-05-22_22-15-35", "timestamp": 1716408935, "time_this_iter_s": 3.529597043991089, "time_total_s": 35.60718369483948, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 35.60718369483948, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3522009001944655, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04025636694452103, "policy_loss": -0.003681230925584352, "vf_loss": 0.043516666553313696, "vf_explained_var": -0.0565839111164052, "kl": 0.00841863038069513, "entropy": 2.7559864328753565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.0, "episode_reward_mean": -0.985, "episode_len_mean": 69.81, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 80, 80, 25, 80, 80, 80, 10, 43, 80, 80, 80, 80, 80, 80, 80, 80, 76, 68, 80, 80, 69, 80, 80, 51, 76, 80, 47, 80, 80, 16, 80, 80, 80, 80, 59, 80, 80, 76, 80, 80, 63, 80, 80, 80, 38, 80, 80, 25, 80, 80, 80, 80, 80, 47, 77, 80, 80, 80, 80, 58, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 36, 57, 35, 80, 73, 37, 20, 80, 80, 80, 56, 63, 80, 55, 63, 80, 44, 80, 63, 38, 66, 19, 80, 78, 77, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0907241099863476, "mean_inference_ms": 0.2432182521602816, "mean_action_processing_ms": 0.04355332195186563, "mean_env_wait_ms": 0.0462072417500026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015437602996826172, "StateBufferConnector_ms": 0.0012238025665283203, "ViewRequirementAgentConnector_ms": 0.0284271240234375}}, "episode_reward_max": 0.5, "episode_reward_min": -1.0, "episode_reward_mean": -0.985, "episode_len_mean": 69.81, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 80, 80, 25, 80, 80, 80, 10, 43, 80, 80, 80, 80, 80, 80, 80, 80, 76, 68, 80, 80, 69, 80, 80, 51, 76, 80, 47, 80, 80, 16, 80, 80, 80, 80, 59, 80, 80, 76, 80, 80, 63, 80, 80, 80, 38, 80, 80, 25, 80, 80, 80, 80, 80, 47, 77, 80, 80, 80, 80, 58, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 36, 57, 35, 80, 73, 37, 20, 80, 80, 80, 56, 63, 80, 55, 63, 80, 44, 80, 63, 38, 66, 19, 80, 78, 77, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0907241099863476, "mean_inference_ms": 0.2432182521602816, "mean_action_processing_ms": 0.04355332195186563, "mean_env_wait_ms": 0.0462072417500026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015437602996826172, "StateBufferConnector_ms": 0.0012238025665283203, "ViewRequirementAgentConnector_ms": 0.0284271240234375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1127.8356361893912, "num_env_steps_trained_throughput_per_sec": 1127.8356361893912, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 3546.708, "sample_time_ms": 1710.138, "load_time_ms": 0.202, "load_throughput": 19807811.098, "learn_time_ms": 1835.427, "learn_throughput": 2179.329, "synch_weights_time_ms": 0.624}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 685, "training_iteration": 11, "trial_id": "default", "date": "2024-05-22_22-15-39", "timestamp": 1716408939, "time_this_iter_s": 3.5489001274108887, "time_total_s": 39.156083822250366, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 39.156083822250366, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 21.020000000000003, "ram_util_percent": 61.379999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6210641755371966, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.062894151353788, "policy_loss": -0.005776709900988686, "vf_loss": 0.06817766954165994, "vf_explained_var": 0.20467394423741167, "kl": 0.009863821355719017, "entropy": 2.8012618128971387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 0.985427216019653, "episode_reward_min": -1.0, "episode_reward_mean": -0.9501457278398034, "episode_len_mean": 67.62, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.985427216019653, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 58, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 36, 57, 35, 80, 73, 37, 20, 80, 80, 80, 56, 63, 80, 55, 63, 80, 44, 80, 63, 38, 66, 19, 80, 78, 77, 57, 80, 23, 80, 80, 34, 72, 80, 80, 46, 80, 45, 80, 80, 22, 80, 75, 80, 80, 80, 80, 80, 80, 80, 43, 68, 26, 60, 80, 26, 80, 80, 44, 57, 80, 80, 80, 80, 43, 24, 80, 80, 31, 80, 53, 80, 80, 80, 80, 80, 78, 76, 80, 80, 80, 44, 80, 75, 62, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0907164309787728, "mean_inference_ms": 0.24307620779425068, "mean_action_processing_ms": 0.043554542651381076, "mean_env_wait_ms": 0.046209965883057105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015277862548828125, "StateBufferConnector_ms": 0.0012090206146240234, "ViewRequirementAgentConnector_ms": 0.028409719467163086}}, "episode_reward_max": 0.985427216019653, "episode_reward_min": -1.0, "episode_reward_mean": -0.9501457278398034, "episode_len_mean": 67.62, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.985427216019653, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 58, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 36, 57, 35, 80, 73, 37, 20, 80, 80, 80, 56, 63, 80, 55, 63, 80, 44, 80, 63, 38, 66, 19, 80, 78, 77, 57, 80, 23, 80, 80, 34, 72, 80, 80, 46, 80, 45, 80, 80, 22, 80, 75, 80, 80, 80, 80, 80, 80, 80, 43, 68, 26, 60, 80, 26, 80, 80, 44, 57, 80, 80, 80, 80, 43, 24, 80, 80, 31, 80, 53, 80, 80, 80, 80, 80, 78, 76, 80, 80, 80, 44, 80, 75, 62, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0907164309787728, "mean_inference_ms": 0.24307620779425068, "mean_action_processing_ms": 0.043554542651381076, "mean_env_wait_ms": 0.046209965883057105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015277862548828125, "StateBufferConnector_ms": 0.0012090206146240234, "ViewRequirementAgentConnector_ms": 0.028409719467163086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1132.5426405893818, "num_env_steps_trained_throughput_per_sec": 1132.5426405893818, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 3544.106, "sample_time_ms": 1709.397, "load_time_ms": 0.205, "load_throughput": 19487996.283, "learn_time_ms": 1833.555, "learn_throughput": 2181.554, "synch_weights_time_ms": 0.63}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 744, "training_iteration": 12, "trial_id": "default", "date": "2024-05-22_22-15-42", "timestamp": 1716408942, "time_this_iter_s": 3.534041166305542, "time_total_s": 42.69012498855591, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 42.69012498855591, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.44, "ram_util_percent": 61.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5060254776029176, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06660490908049127, "policy_loss": -0.0020014566018856984, "vf_loss": 0.06836115094903175, "vf_explained_var": 0.15422483932587408, "kl": 0.004904283488556726, "entropy": 2.725188918011163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 0.985427216019653, "episode_reward_min": -1.0, "episode_reward_mean": -0.93091785740251, "episode_len_mean": 71.68, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.985427216019653, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8553871571155255, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5673998866138243, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [22, 80, 75, 80, 80, 80, 80, 80, 80, 80, 43, 68, 26, 60, 80, 26, 80, 80, 44, 57, 80, 80, 80, 80, 43, 24, 80, 80, 31, 80, 53, 80, 80, 80, 80, 80, 78, 76, 80, 80, 80, 44, 80, 75, 62, 80, 80, 52, 80, 80, 80, 80, 68, 72, 80, 80, 67, 80, 80, 80, 80, 80, 65, 80, 74, 80, 80, 50, 80, 80, 65, 80, 80, 80, 80, 80, 80, 80, 80, 45, 80, 80, 69, 80, 80, 72, 80, 80, 80, 58, 80, 56, 80, 79, 61, 80, 80, 80, 28, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09067012815962233, "mean_inference_ms": 0.2429252695178502, "mean_action_processing_ms": 0.043548207859844326, "mean_env_wait_ms": 0.046202125490437604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014781951904296875, "StateBufferConnector_ms": 0.0012235641479492188, "ViewRequirementAgentConnector_ms": 0.028321266174316406}}, "episode_reward_max": 0.985427216019653, "episode_reward_min": -1.0, "episode_reward_mean": -0.93091785740251, "episode_len_mean": 71.68, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.985427216019653, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8553871571155255, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5673998866138243, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [22, 80, 75, 80, 80, 80, 80, 80, 80, 80, 43, 68, 26, 60, 80, 26, 80, 80, 44, 57, 80, 80, 80, 80, 43, 24, 80, 80, 31, 80, 53, 80, 80, 80, 80, 80, 78, 76, 80, 80, 80, 44, 80, 75, 62, 80, 80, 52, 80, 80, 80, 80, 68, 72, 80, 80, 67, 80, 80, 80, 80, 80, 65, 80, 74, 80, 80, 50, 80, 80, 65, 80, 80, 80, 80, 80, 80, 80, 80, 45, 80, 80, 69, 80, 80, 72, 80, 80, 80, 58, 80, 56, 80, 79, 61, 80, 80, 80, 28, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09067012815962233, "mean_inference_ms": 0.2429252695178502, "mean_action_processing_ms": 0.043548207859844326, "mean_env_wait_ms": 0.046202125490437604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014781951904296875, "StateBufferConnector_ms": 0.0012235641479492188, "ViewRequirementAgentConnector_ms": 0.028321266174316406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1133.7425259744793, "num_env_steps_trained_throughput_per_sec": 1133.7425259744793, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 3544.08, "sample_time_ms": 1709.001, "load_time_ms": 0.208, "load_throughput": 19275294.118, "learn_time_ms": 1833.921, "learn_throughput": 2181.119, "synch_weights_time_ms": 0.631}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 798, "training_iteration": 13, "trial_id": "default", "date": "2024-05-22_22-15-46", "timestamp": 1716408946, "time_this_iter_s": 3.530298948287964, "time_total_s": 46.22042393684387, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 46.22042393684387, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.7, "ram_util_percent": 61.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.679470845608301, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06604582377539206, "policy_loss": -0.004467944731505248, "vf_loss": 0.0701549665606831, "vf_explained_var": 0.14255764920224426, "kl": 0.014352048504143351, "entropy": 2.7148924471229634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 0.8168964184499833, "episode_reward_min": -1.0, "episode_reward_mean": -0.9511570369493618, "episode_len_mean": 71.61, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5673998866138243, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8168964184499833, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 80, 65, 80, 74, 80, 80, 50, 80, 80, 65, 80, 80, 80, 80, 80, 80, 80, 80, 45, 80, 80, 69, 80, 80, 72, 80, 80, 80, 58, 80, 56, 80, 79, 61, 80, 80, 80, 28, 80, 80, 26, 80, 79, 80, 43, 72, 20, 67, 80, 80, 80, 56, 34, 41, 80, 64, 80, 80, 80, 80, 72, 80, 80, 80, 80, 80, 76, 80, 78, 80, 80, 80, 80, 49, 80, 80, 80, 74, 80, 80, 80, 70, 80, 78, 36, 17, 80, 21, 80, 80, 80, 18, 73, 75, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09062139333124286, "mean_inference_ms": 0.24278642412493562, "mean_action_processing_ms": 0.043553157222210974, "mean_env_wait_ms": 0.046197444860514754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014815330505371094, "StateBufferConnector_ms": 0.0012273788452148438, "ViewRequirementAgentConnector_ms": 0.028375864028930664}}, "episode_reward_max": 0.8168964184499833, "episode_reward_min": -1.0, "episode_reward_mean": -0.9511570369493618, "episode_len_mean": 71.61, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5673998866138243, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8168964184499833, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 80, 65, 80, 74, 80, 80, 50, 80, 80, 65, 80, 80, 80, 80, 80, 80, 80, 80, 45, 80, 80, 69, 80, 80, 72, 80, 80, 80, 58, 80, 56, 80, 79, 61, 80, 80, 80, 28, 80, 80, 26, 80, 79, 80, 43, 72, 20, 67, 80, 80, 80, 56, 34, 41, 80, 64, 80, 80, 80, 80, 72, 80, 80, 80, 80, 80, 76, 80, 78, 80, 80, 80, 80, 49, 80, 80, 80, 74, 80, 80, 80, 70, 80, 78, 36, 17, 80, 21, 80, 80, 80, 18, 73, 75, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09062139333124286, "mean_inference_ms": 0.24278642412493562, "mean_action_processing_ms": 0.043553157222210974, "mean_env_wait_ms": 0.046197444860514754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014815330505371094, "StateBufferConnector_ms": 0.0012273788452148438, "ViewRequirementAgentConnector_ms": 0.028375864028930664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1126.4794462280345, "num_env_steps_trained_throughput_per_sec": 1126.4794462280345, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 3546.255, "sample_time_ms": 1709.013, "load_time_ms": 0.206, "load_throughput": 19388900.959, "learn_time_ms": 1836.083, "learn_throughput": 2178.551, "synch_weights_time_ms": 0.631}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 855, "training_iteration": 14, "trial_id": "default", "date": "2024-05-22_22-15-49", "timestamp": 1716408949, "time_this_iter_s": 3.553114175796509, "time_total_s": 49.77353811264038, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 49.77353811264038, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 21.08, "ram_util_percent": 61.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3369494470216894, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0604769084767829, "policy_loss": -0.0023706535057675454, "vf_loss": 0.0625094387134517, "vf_explained_var": 0.20641706662793313, "kl": 0.013524856674013552, "entropy": 2.738734007650806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 0.9529981491063242, "episode_reward_min": -1.0, "episode_reward_mean": -0.9482235857178783, "episode_len_mean": 71.8, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9529981491063242, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7246432791058496, -1.0, -1.0, -1.0], "episode_lengths": [56, 34, 41, 80, 64, 80, 80, 80, 80, 72, 80, 80, 80, 80, 80, 76, 80, 78, 80, 80, 80, 80, 49, 80, 80, 80, 74, 80, 80, 80, 70, 80, 78, 36, 17, 80, 21, 80, 80, 80, 18, 73, 75, 80, 80, 80, 80, 80, 80, 80, 54, 80, 80, 80, 77, 80, 78, 80, 80, 80, 80, 80, 80, 80, 80, 73, 80, 80, 39, 80, 69, 80, 80, 80, 80, 45, 80, 80, 59, 80, 59, 80, 22, 80, 56, 80, 54, 80, 80, 31, 80, 80, 80, 80, 80, 43, 51, 80, 80, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09059840642984557, "mean_inference_ms": 0.24268176336517533, "mean_action_processing_ms": 0.04356126533033013, "mean_env_wait_ms": 0.04620132814017637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015761852264404297, "StateBufferConnector_ms": 0.0012383460998535156, "ViewRequirementAgentConnector_ms": 0.028470277786254883}}, "episode_reward_max": 0.9529981491063242, "episode_reward_min": -1.0, "episode_reward_mean": -0.9482235857178783, "episode_len_mean": 71.8, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9529981491063242, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7246432791058496, -1.0, -1.0, -1.0], "episode_lengths": [56, 34, 41, 80, 64, 80, 80, 80, 80, 72, 80, 80, 80, 80, 80, 76, 80, 78, 80, 80, 80, 80, 49, 80, 80, 80, 74, 80, 80, 80, 70, 80, 78, 36, 17, 80, 21, 80, 80, 80, 18, 73, 75, 80, 80, 80, 80, 80, 80, 80, 54, 80, 80, 80, 77, 80, 78, 80, 80, 80, 80, 80, 80, 80, 80, 73, 80, 80, 39, 80, 69, 80, 80, 80, 80, 45, 80, 80, 59, 80, 59, 80, 22, 80, 56, 80, 54, 80, 80, 31, 80, 80, 80, 80, 80, 43, 51, 80, 80, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09059840642984557, "mean_inference_ms": 0.24268176336517533, "mean_action_processing_ms": 0.04356126533033013, "mean_env_wait_ms": 0.04620132814017637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015761852264404297, "StateBufferConnector_ms": 0.0012383460998535156, "ViewRequirementAgentConnector_ms": 0.028470277786254883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1110.0611786227346, "num_env_steps_trained_throughput_per_sec": 1110.0611786227346, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 3553.162, "sample_time_ms": 1708.757, "load_time_ms": 0.204, "load_throughput": 19627065.98, "learn_time_ms": 1843.24, "learn_throughput": 2170.091, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 910, "training_iteration": 15, "trial_id": "default", "date": "2024-05-22_22-15-53", "timestamp": 1716408953, "time_this_iter_s": 3.6056337356567383, "time_total_s": 53.37917184829712, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 53.37917184829712, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.433333333333334, "ram_util_percent": 61.150000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3202033436747007, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03937855184864333, "policy_loss": -0.009392688435412222, "vf_loss": 0.0485859212044987, "vf_explained_var": 0.11138060374926495, "kl": 0.007412770588195601, "entropy": 2.7596464851851104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.9529981491063242, "episode_reward_min": -1.0, "episode_reward_mean": -0.9455501044202812, "episode_len_mean": 71.35, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9529981491063242, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7246432791058496, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7673481297597053, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 80, 80, 80, 80, 73, 80, 80, 39, 80, 69, 80, 80, 80, 80, 45, 80, 80, 59, 80, 59, 80, 22, 80, 56, 80, 54, 80, 80, 31, 80, 80, 80, 80, 80, 43, 51, 80, 80, 78, 80, 80, 80, 35, 80, 80, 22, 80, 78, 80, 80, 80, 44, 80, 80, 80, 66, 80, 80, 80, 20, 80, 51, 72, 80, 80, 80, 80, 80, 62, 48, 80, 61, 64, 80, 80, 80, 80, 80, 72, 23, 80, 80, 80, 80, 46, 80, 55, 80, 37, 80, 80, 80, 80, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09056762604170579, "mean_inference_ms": 0.24256970112871276, "mean_action_processing_ms": 0.043558577847473134, "mean_env_wait_ms": 0.046202534373163316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015697479248046875, "StateBufferConnector_ms": 0.0012373924255371094, "ViewRequirementAgentConnector_ms": 0.02835988998413086}}, "episode_reward_max": 0.9529981491063242, "episode_reward_min": -1.0, "episode_reward_mean": -0.9455501044202812, "episode_len_mean": 71.35, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9529981491063242, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7246432791058496, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7673481297597053, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 80, 80, 80, 80, 80, 80, 73, 80, 80, 39, 80, 69, 80, 80, 80, 80, 45, 80, 80, 59, 80, 59, 80, 22, 80, 56, 80, 54, 80, 80, 31, 80, 80, 80, 80, 80, 43, 51, 80, 80, 78, 80, 80, 80, 35, 80, 80, 22, 80, 78, 80, 80, 80, 44, 80, 80, 80, 66, 80, 80, 80, 20, 80, 51, 72, 80, 80, 80, 80, 80, 62, 48, 80, 61, 64, 80, 80, 80, 80, 80, 72, 23, 80, 80, 80, 80, 46, 80, 55, 80, 37, 80, 80, 80, 80, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09056762604170579, "mean_inference_ms": 0.24256970112871276, "mean_action_processing_ms": 0.043558577847473134, "mean_env_wait_ms": 0.046202534373163316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015697479248046875, "StateBufferConnector_ms": 0.0012373924255371094, "ViewRequirementAgentConnector_ms": 0.02835988998413086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1133.2834101522567, "num_env_steps_trained_throughput_per_sec": 1133.2834101522567, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 3552.892, "sample_time_ms": 1708.581, "load_time_ms": 0.209, "load_throughput": 19169579.525, "learn_time_ms": 1843.132, "learn_throughput": 2170.219, "synch_weights_time_ms": 0.643}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 967, "training_iteration": 16, "trial_id": "default", "date": "2024-05-22_22-15-56", "timestamp": 1716408956, "time_this_iter_s": 3.531775951385498, "time_total_s": 56.91094779968262, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 56.91094779968262, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 14.3, "ram_util_percent": 61.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6026713676991, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12791551609914148, "policy_loss": -0.007289671048682223, "vf_loss": 0.1349617188245619, "vf_explained_var": 0.1216790428725622, "kl": 0.00973874453813005, "entropy": 2.776542320815466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 0.9504617381465628, "episode_reward_min": -1.0, "episode_reward_mean": -0.8926902938305926, "episode_len_mean": 68.97, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7673481297597053, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7752547670400562, -1.0, -1.0, -1.0, 0.9504617381465628, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9061864628743986, -1.0, -1.0, -1.0, -1.0, 0.8317195191200144, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [66, 80, 80, 80, 20, 80, 51, 72, 80, 80, 80, 80, 80, 62, 48, 80, 61, 64, 80, 80, 80, 80, 80, 72, 23, 80, 80, 80, 80, 46, 80, 55, 80, 37, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 15, 16, 80, 78, 67, 80, 80, 61, 62, 30, 80, 80, 80, 80, 28, 76, 59, 80, 80, 80, 80, 31, 59, 26, 80, 80, 80, 80, 29, 80, 80, 66, 33, 80, 52, 80, 73, 80, 80, 74, 20, 80, 80, 80, 80, 80, 80, 80, 51, 80, 79, 15, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09053566503179061, "mean_inference_ms": 0.24246104770543436, "mean_action_processing_ms": 0.043554466192024695, "mean_env_wait_ms": 0.0462008738022592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015964508056640625, "StateBufferConnector_ms": 0.0012366771697998047, "ViewRequirementAgentConnector_ms": 0.02834916114807129}}, "episode_reward_max": 0.9504617381465628, "episode_reward_min": -1.0, "episode_reward_mean": -0.8926902938305926, "episode_len_mean": 68.97, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7673481297597053, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7752547670400562, -1.0, -1.0, -1.0, 0.9504617381465628, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9061864628743986, -1.0, -1.0, -1.0, -1.0, 0.8317195191200144, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [66, 80, 80, 80, 20, 80, 51, 72, 80, 80, 80, 80, 80, 62, 48, 80, 61, 64, 80, 80, 80, 80, 80, 72, 23, 80, 80, 80, 80, 46, 80, 55, 80, 37, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 80, 15, 16, 80, 78, 67, 80, 80, 61, 62, 30, 80, 80, 80, 80, 28, 76, 59, 80, 80, 80, 80, 31, 59, 26, 80, 80, 80, 80, 29, 80, 80, 66, 33, 80, 52, 80, 73, 80, 80, 74, 20, 80, 80, 80, 80, 80, 80, 80, 51, 80, 79, 15, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09053566503179061, "mean_inference_ms": 0.24246104770543436, "mean_action_processing_ms": 0.043554466192024695, "mean_env_wait_ms": 0.0462008738022592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015964508056640625, "StateBufferConnector_ms": 0.0012366771697998047, "ViewRequirementAgentConnector_ms": 0.02834916114807129}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1130.5853394276469, "num_env_steps_trained_throughput_per_sec": 1130.5853394276469, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 3547.677, "sample_time_ms": 1701.083, "load_time_ms": 0.197, "load_throughput": 20331090.645, "learn_time_ms": 1845.432, "learn_throughput": 2167.514, "synch_weights_time_ms": 0.638}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 1026, "training_iteration": 17, "trial_id": "default", "date": "2024-05-22_22-16-00", "timestamp": 1716408960, "time_this_iter_s": 3.540203094482422, "time_total_s": 60.45115089416504, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 60.45115089416504, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.639999999999997, "ram_util_percent": 61.31999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.355390377086337, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07289492521154624, "policy_loss": 0.0006705121948353706, "vf_loss": 0.0720557244389408, "vf_explained_var": 0.10904046976438132, "kl": 0.0067475858288455716, "entropy": 2.772335072230267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 0.9447525525778009, "episode_reward_min": -1.0, "episode_reward_mean": -0.8959230623262276, "episode_len_mean": 65.93, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.9061864628743986, -1.0, -1.0, -1.0, -1.0, 0.8317195191200144, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7250352328050261, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9447525525778009, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [28, 76, 59, 80, 80, 80, 80, 31, 59, 26, 80, 80, 80, 80, 29, 80, 80, 66, 33, 80, 52, 80, 73, 80, 80, 74, 20, 80, 80, 80, 80, 80, 80, 80, 51, 80, 79, 15, 80, 32, 73, 61, 80, 77, 39, 80, 80, 80, 80, 80, 33, 80, 44, 80, 80, 80, 66, 57, 80, 80, 80, 80, 80, 80, 80, 80, 20, 65, 63, 65, 25, 54, 19, 80, 28, 54, 20, 58, 80, 80, 80, 64, 80, 80, 80, 80, 60, 80, 57, 80, 80, 80, 80, 46, 17, 26, 70, 80, 72, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09051541886549624, "mean_inference_ms": 0.24235775836769316, "mean_action_processing_ms": 0.043554735291304866, "mean_env_wait_ms": 0.046200940778579745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001607656478881836, "StateBufferConnector_ms": 0.0012416839599609375, "ViewRequirementAgentConnector_ms": 0.028519630432128906}}, "episode_reward_max": 0.9447525525778009, "episode_reward_min": -1.0, "episode_reward_mean": -0.8959230623262276, "episode_len_mean": 65.93, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.9061864628743986, -1.0, -1.0, -1.0, -1.0, 0.8317195191200144, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7250352328050261, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9447525525778009, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [28, 76, 59, 80, 80, 80, 80, 31, 59, 26, 80, 80, 80, 80, 29, 80, 80, 66, 33, 80, 52, 80, 73, 80, 80, 74, 20, 80, 80, 80, 80, 80, 80, 80, 51, 80, 79, 15, 80, 32, 73, 61, 80, 77, 39, 80, 80, 80, 80, 80, 33, 80, 44, 80, 80, 80, 66, 57, 80, 80, 80, 80, 80, 80, 80, 80, 20, 65, 63, 65, 25, 54, 19, 80, 28, 54, 20, 58, 80, 80, 80, 64, 80, 80, 80, 80, 60, 80, 57, 80, 80, 80, 80, 46, 17, 26, 70, 80, 72, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09051541886549624, "mean_inference_ms": 0.24235775836769316, "mean_action_processing_ms": 0.043554735291304866, "mean_env_wait_ms": 0.046200940778579745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001607656478881836, "StateBufferConnector_ms": 0.0012416839599609375, "ViewRequirementAgentConnector_ms": 0.028519630432128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1136.1677137216575, "num_env_steps_trained_throughput_per_sec": 1136.1677137216575, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3538.96, "sample_time_ms": 1700.56, "load_time_ms": 0.206, "load_throughput": 19451844.638, "learn_time_ms": 1837.244, "learn_throughput": 2177.174, "synch_weights_time_ms": 0.625}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 1087, "training_iteration": 18, "trial_id": "default", "date": "2024-05-22_22-16-04", "timestamp": 1716408964, "time_this_iter_s": 3.5229029655456543, "time_total_s": 63.97405385971069, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 63.97405385971069, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.580000000000002, "ram_util_percent": 61.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7921255615930403, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11502853580700453, "policy_loss": 0.015554993433417172, "vf_loss": 0.09918039576100406, "vf_explained_var": 0.1431980481070857, "kl": 0.011725857336132236, "entropy": 2.7869362395296813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 0.9447525525778009, "episode_reward_min": -1.0, "episode_reward_mean": -0.8573668701379604, "episode_len_mean": 61.69, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.7250352328050261, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9447525525778009, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9239793254548914, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6568544088606262, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9346738142339428, -1.0, 0.7342408416221224, -1.0, -1.0, 0.8437768106495436], "episode_lengths": [80, 20, 65, 63, 65, 25, 54, 19, 80, 28, 54, 20, 58, 80, 80, 80, 64, 80, 80, 80, 80, 60, 80, 57, 80, 80, 80, 80, 46, 17, 26, 70, 80, 72, 57, 62, 27, 33, 79, 68, 31, 80, 80, 80, 80, 66, 80, 80, 80, 21, 80, 80, 17, 50, 77, 60, 80, 23, 80, 24, 78, 20, 80, 77, 80, 80, 16, 59, 45, 80, 78, 54, 34, 80, 80, 80, 80, 80, 16, 80, 80, 80, 80, 80, 80, 24, 12, 37, 80, 80, 28, 80, 80, 70, 29, 80, 38, 80, 43, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09051588330398486, "mean_inference_ms": 0.24225425558058702, "mean_action_processing_ms": 0.043548480567150535, "mean_env_wait_ms": 0.04619831835339091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015153884887695312, "StateBufferConnector_ms": 0.0012164115905761719, "ViewRequirementAgentConnector_ms": 0.028189420700073242}}, "episode_reward_max": 0.9447525525778009, "episode_reward_min": -1.0, "episode_reward_mean": -0.8573668701379604, "episode_len_mean": 61.69, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.7250352328050261, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9447525525778009, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9239793254548914, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6568544088606262, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9346738142339428, -1.0, 0.7342408416221224, -1.0, -1.0, 0.8437768106495436], "episode_lengths": [80, 20, 65, 63, 65, 25, 54, 19, 80, 28, 54, 20, 58, 80, 80, 80, 64, 80, 80, 80, 80, 60, 80, 57, 80, 80, 80, 80, 46, 17, 26, 70, 80, 72, 57, 62, 27, 33, 79, 68, 31, 80, 80, 80, 80, 66, 80, 80, 80, 21, 80, 80, 17, 50, 77, 60, 80, 23, 80, 24, 78, 20, 80, 77, 80, 80, 16, 59, 45, 80, 78, 54, 34, 80, 80, 80, 80, 80, 16, 80, 80, 80, 80, 80, 80, 24, 12, 37, 80, 80, 28, 80, 80, 70, 29, 80, 38, 80, 43, 73]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09051588330398486, "mean_inference_ms": 0.24225425558058702, "mean_action_processing_ms": 0.043548480567150535, "mean_env_wait_ms": 0.04619831835339091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015153884887695312, "StateBufferConnector_ms": 0.0012164115905761719, "ViewRequirementAgentConnector_ms": 0.028189420700073242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1131.8372746988412, "num_env_steps_trained_throughput_per_sec": 1131.8372746988412, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 3541.035, "sample_time_ms": 1700.447, "load_time_ms": 0.212, "load_throughput": 18880504.164, "learn_time_ms": 1839.423, "learn_throughput": 2174.595, "synch_weights_time_ms": 0.63}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1152, "training_iteration": 19, "trial_id": "default", "date": "2024-05-22_22-16-07", "timestamp": 1716408967, "time_this_iter_s": 3.536353826522827, "time_total_s": 67.51040768623352, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 67.51040768623352, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.62, "ram_util_percent": 61.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.73743242238478, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0896253432281771, "policy_loss": -0.006659262240814265, "vf_loss": 0.09600422580936743, "vf_explained_var": -0.024947939380522696, "kl": 0.011215190575043023, "entropy": 2.792083612308707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 0.9346738142339428, "episode_reward_min": -1.0, "episode_reward_mean": -0.8492948384915825, "episode_len_mean": 58.14, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6568544088606262, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9346738142339428, -1.0, 0.7342408416221224, -1.0, -1.0, 0.8437768106495436, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5059070054244247, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5442492092008134, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7893007521318126, -1.0, -1.0, 0.5615133087184713, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [54, 34, 80, 80, 80, 80, 80, 16, 80, 80, 80, 80, 80, 80, 24, 12, 37, 80, 80, 28, 80, 80, 70, 29, 80, 38, 80, 43, 73, 42, 30, 55, 25, 22, 80, 80, 69, 52, 73, 80, 80, 17, 80, 35, 75, 36, 80, 65, 50, 80, 80, 59, 25, 80, 50, 32, 23, 80, 25, 80, 13, 80, 80, 80, 52, 80, 80, 80, 80, 80, 80, 17, 23, 80, 80, 15, 14, 77, 32, 14, 31, 18, 80, 33, 61, 18, 46, 80, 60, 80, 30, 80, 80, 19, 80, 80, 80, 68, 15, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09054316990787964, "mean_inference_ms": 0.24217799613660992, "mean_action_processing_ms": 0.04354741523655285, "mean_env_wait_ms": 0.0461985895446232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015256404876708984, "StateBufferConnector_ms": 0.0012121200561523438, "ViewRequirementAgentConnector_ms": 0.028275489807128906}}, "episode_reward_max": 0.9346738142339428, "episode_reward_min": -1.0, "episode_reward_mean": -0.8492948384915825, "episode_len_mean": 58.14, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6568544088606262, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9346738142339428, -1.0, 0.7342408416221224, -1.0, -1.0, 0.8437768106495436, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5059070054244247, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5442492092008134, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7893007521318126, -1.0, -1.0, 0.5615133087184713, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [54, 34, 80, 80, 80, 80, 80, 16, 80, 80, 80, 80, 80, 80, 24, 12, 37, 80, 80, 28, 80, 80, 70, 29, 80, 38, 80, 43, 73, 42, 30, 55, 25, 22, 80, 80, 69, 52, 73, 80, 80, 17, 80, 35, 75, 36, 80, 65, 50, 80, 80, 59, 25, 80, 50, 32, 23, 80, 25, 80, 13, 80, 80, 80, 52, 80, 80, 80, 80, 80, 80, 17, 23, 80, 80, 15, 14, 77, 32, 14, 31, 18, 80, 33, 61, 18, 46, 80, 60, 80, 30, 80, 80, 19, 80, 80, 80, 68, 15, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09054316990787964, "mean_inference_ms": 0.24217799613660992, "mean_action_processing_ms": 0.04354741523655285, "mean_env_wait_ms": 0.0461985895446232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015256404876708984, "StateBufferConnector_ms": 0.0012121200561523438, "ViewRequirementAgentConnector_ms": 0.028275489807128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1134.6664020926773, "num_env_steps_trained_throughput_per_sec": 1134.6664020926773, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 3540.829, "sample_time_ms": 1701.017, "load_time_ms": 0.211, "load_throughput": 18978751.131, "learn_time_ms": 1838.651, "learn_throughput": 2175.508, "synch_weights_time_ms": 0.626}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 1223, "training_iteration": 20, "trial_id": "default", "date": "2024-05-22_22-16-11", "timestamp": 1716408971, "time_this_iter_s": 3.527524709701538, "time_total_s": 71.03793239593506, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 71.03793239593506, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 61.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2091336938642687, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.10230445802932786, "policy_loss": -0.007539662502966421, "vf_loss": 0.10950299695444604, "vf_explained_var": -0.012707458196147796, "kl": 0.013644934726538053, "entropy": 2.769000566390253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 0.9932879774172548, "episode_reward_min": -1.0, "episode_reward_mean": -0.8787519120582046, "episode_len_mean": 60.39, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5442492092008134, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7893007521318126, -1.0, -1.0, 0.5615133087184713, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9932879774172548, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7481671558519196, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9882903908592752, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 52, 80, 80, 80, 80, 80, 80, 17, 23, 80, 80, 15, 14, 77, 32, 14, 31, 18, 80, 33, 61, 18, 46, 80, 60, 80, 30, 80, 80, 19, 80, 80, 80, 68, 15, 80, 60, 54, 80, 80, 80, 80, 80, 80, 78, 65, 80, 26, 43, 13, 80, 68, 80, 58, 76, 44, 47, 55, 61, 80, 23, 80, 57, 72, 56, 80, 23, 59, 80, 80, 22, 72, 72, 80, 80, 80, 80, 80, 80, 38, 80, 80, 42, 80, 72, 23, 23, 44, 80, 40, 80, 72, 80, 63, 23, 80, 23, 80, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09054670117073899, "mean_inference_ms": 0.24211756309157956, "mean_action_processing_ms": 0.043549715367510185, "mean_env_wait_ms": 0.046197004462744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015370845794677734, "StateBufferConnector_ms": 0.001219034194946289, "ViewRequirementAgentConnector_ms": 0.02834773063659668}}, "episode_reward_max": 0.9932879774172548, "episode_reward_min": -1.0, "episode_reward_mean": -0.8787519120582046, "episode_len_mean": 60.39, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5442492092008134, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7893007521318126, -1.0, -1.0, 0.5615133087184713, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9932879774172548, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7481671558519196, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9882903908592752, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 52, 80, 80, 80, 80, 80, 80, 17, 23, 80, 80, 15, 14, 77, 32, 14, 31, 18, 80, 33, 61, 18, 46, 80, 60, 80, 30, 80, 80, 19, 80, 80, 80, 68, 15, 80, 60, 54, 80, 80, 80, 80, 80, 80, 78, 65, 80, 26, 43, 13, 80, 68, 80, 58, 76, 44, 47, 55, 61, 80, 23, 80, 57, 72, 56, 80, 23, 59, 80, 80, 22, 72, 72, 80, 80, 80, 80, 80, 80, 38, 80, 80, 42, 80, 72, 23, 23, 44, 80, 40, 80, 72, 80, 63, 23, 80, 23, 80, 49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09054670117073899, "mean_inference_ms": 0.24211756309157956, "mean_action_processing_ms": 0.043549715367510185, "mean_env_wait_ms": 0.046197004462744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015370845794677734, "StateBufferConnector_ms": 0.001219034194946289, "ViewRequirementAgentConnector_ms": 0.02834773063659668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1132.4303436396194, "num_env_steps_trained_throughput_per_sec": 1132.4303436396194, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 3539.39, "sample_time_ms": 1699.783, "load_time_ms": 0.209, "load_throughput": 19106270.356, "learn_time_ms": 1838.446, "learn_throughput": 2175.751, "synch_weights_time_ms": 0.626}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 1286, "training_iteration": 21, "trial_id": "default", "date": "2024-05-22_22-16-14", "timestamp": 1716408974, "time_this_iter_s": 3.5345001220703125, "time_total_s": 74.57243251800537, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 74.57243251800537, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 13.88, "ram_util_percent": 61.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3664444144374581, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03306863744372642, "policy_loss": -0.009012591271531038, "vf_loss": 0.041769064319700566, "vf_explained_var": 0.18727244721945896, "kl": 0.012486549093198749, "entropy": 2.8070572068614346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 0.9882903908592752, "episode_reward_min": -1.0, "episode_reward_mean": -0.9319511731198391, "episode_len_mean": 65.89, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7481671558519196, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9882903908592752, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5684251413048971, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [61, 80, 23, 80, 57, 72, 56, 80, 23, 59, 80, 80, 22, 72, 72, 80, 80, 80, 80, 80, 80, 38, 80, 80, 42, 80, 72, 23, 23, 44, 80, 40, 80, 72, 80, 63, 23, 80, 23, 80, 49, 80, 70, 32, 80, 46, 26, 80, 77, 80, 80, 80, 80, 80, 80, 68, 75, 29, 16, 80, 80, 80, 80, 61, 71, 80, 80, 80, 80, 48, 80, 80, 64, 80, 80, 58, 80, 80, 80, 61, 80, 80, 80, 76, 80, 80, 80, 80, 24, 43, 27, 69, 72, 78, 52, 23, 54, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09052421521681761, "mean_inference_ms": 0.24204370099744538, "mean_action_processing_ms": 0.04354547048232514, "mean_env_wait_ms": 0.04619122536641124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015382766723632812, "StateBufferConnector_ms": 0.00124359130859375, "ViewRequirementAgentConnector_ms": 0.028409957885742188}}, "episode_reward_max": 0.9882903908592752, "episode_reward_min": -1.0, "episode_reward_mean": -0.9319511731198391, "episode_len_mean": 65.89, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7481671558519196, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9882903908592752, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5684251413048971, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [61, 80, 23, 80, 57, 72, 56, 80, 23, 59, 80, 80, 22, 72, 72, 80, 80, 80, 80, 80, 80, 38, 80, 80, 42, 80, 72, 23, 23, 44, 80, 40, 80, 72, 80, 63, 23, 80, 23, 80, 49, 80, 70, 32, 80, 46, 26, 80, 77, 80, 80, 80, 80, 80, 80, 68, 75, 29, 16, 80, 80, 80, 80, 61, 71, 80, 80, 80, 80, 48, 80, 80, 64, 80, 80, 58, 80, 80, 80, 61, 80, 80, 80, 76, 80, 80, 80, 80, 24, 43, 27, 69, 72, 78, 52, 23, 54, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09052421521681761, "mean_inference_ms": 0.24204370099744538, "mean_action_processing_ms": 0.04354547048232514, "mean_env_wait_ms": 0.04619122536641124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015382766723632812, "StateBufferConnector_ms": 0.00124359130859375, "ViewRequirementAgentConnector_ms": 0.028409957885742188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1111.150289668919, "num_env_steps_trained_throughput_per_sec": 1111.150289668919, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 3546.19, "sample_time_ms": 1699.315, "load_time_ms": 0.209, "load_throughput": 19097570.859, "learn_time_ms": 1845.705, "learn_throughput": 2167.194, "synch_weights_time_ms": 0.632}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 1345, "training_iteration": 22, "trial_id": "default", "date": "2024-05-22_22-16-18", "timestamp": 1716408978, "time_this_iter_s": 3.6021008491516113, "time_total_s": 78.17453336715698, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 78.17453336715698, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 61.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2775493637688697, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05752995810812585, "policy_loss": -0.0073355787507538755, "vf_loss": 0.06453213633153267, "vf_explained_var": 0.3305164906286424, "kl": 0.013336082177537515, "entropy": 2.7896543572025916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 0.9844223135447029, "episode_reward_min": -1.0, "episode_reward_mean": -0.9113670561163779, "episode_len_mean": 61.2, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5684251413048971, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8689315673668362, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9844223135447029, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9415153661457799, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [48, 80, 80, 64, 80, 80, 58, 80, 80, 80, 61, 80, 80, 80, 76, 80, 80, 80, 80, 24, 43, 27, 69, 72, 78, 52, 23, 54, 80, 80, 80, 23, 80, 16, 42, 46, 19, 80, 80, 21, 67, 80, 80, 77, 80, 80, 80, 80, 63, 80, 12, 21, 80, 43, 53, 40, 50, 48, 80, 26, 15, 43, 41, 80, 58, 80, 80, 15, 80, 50, 56, 67, 80, 48, 21, 80, 80, 80, 30, 80, 54, 40, 44, 80, 80, 80, 39, 80, 63, 15, 80, 11, 80, 57, 80, 80, 17, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09051734944038721, "mean_inference_ms": 0.24197143051609168, "mean_action_processing_ms": 0.04353756914964401, "mean_env_wait_ms": 0.046184027902681724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015134811401367188, "StateBufferConnector_ms": 0.001224517822265625, "ViewRequirementAgentConnector_ms": 0.028313159942626953}}, "episode_reward_max": 0.9844223135447029, "episode_reward_min": -1.0, "episode_reward_mean": -0.9113670561163779, "episode_len_mean": 61.2, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5684251413048971, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8689315673668362, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9844223135447029, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9415153661457799, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [48, 80, 80, 64, 80, 80, 58, 80, 80, 80, 61, 80, 80, 80, 76, 80, 80, 80, 80, 24, 43, 27, 69, 72, 78, 52, 23, 54, 80, 80, 80, 23, 80, 16, 42, 46, 19, 80, 80, 21, 67, 80, 80, 77, 80, 80, 80, 80, 63, 80, 12, 21, 80, 43, 53, 40, 50, 48, 80, 26, 15, 43, 41, 80, 58, 80, 80, 15, 80, 50, 56, 67, 80, 48, 21, 80, 80, 80, 30, 80, 54, 40, 44, 80, 80, 80, 39, 80, 63, 15, 80, 11, 80, 57, 80, 80, 17, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09051734944038721, "mean_inference_ms": 0.24197143051609168, "mean_action_processing_ms": 0.04353756914964401, "mean_env_wait_ms": 0.046184027902681724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015134811401367188, "StateBufferConnector_ms": 0.001224517822265625, "ViewRequirementAgentConnector_ms": 0.028313159942626953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1133.4356927593126, "num_env_steps_trained_throughput_per_sec": 1133.4356927593126, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 3546.285, "sample_time_ms": 1699.3, "load_time_ms": 0.211, "load_throughput": 18925229.554, "learn_time_ms": 1845.816, "learn_throughput": 2167.064, "synch_weights_time_ms": 0.63}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 1414, "training_iteration": 23, "trial_id": "default", "date": "2024-05-22_22-16-21", "timestamp": 1716408981, "time_this_iter_s": 3.53133487701416, "time_total_s": 81.70586824417114, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 81.70586824417114, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.68, "ram_util_percent": 61.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.033887412855702, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12785847469606007, "policy_loss": -0.007101437371344336, "vf_loss": 0.13458621539250618, "vf_explained_var": 0.12891954427124352, "kl": 0.014947932672532119, "entropy": 2.6166514850431875, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 0.9497394148630804, "episode_reward_min": -1.0, "episode_reward_mean": -0.8276418562851526, "episode_len_mean": 60.98, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, 0.9415153661457799, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.513325410555564, 0.7119901082478564, -1.0, -1.0, 0.6290771421163441, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9497394148630804, -1.0, -1.0, -1.0, -1.0, 0.7255958983912569, -1.0, -1.0, -1.0, 0.8311885486036147, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9333824825612359, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 15, 80, 50, 56, 67, 80, 48, 21, 80, 80, 80, 30, 80, 54, 40, 44, 80, 80, 80, 39, 80, 63, 15, 80, 11, 80, 57, 80, 80, 17, 80, 80, 80, 77, 18, 80, 80, 80, 60, 80, 34, 24, 80, 80, 16, 80, 80, 23, 14, 80, 80, 32, 80, 65, 80, 80, 14, 77, 80, 80, 80, 80, 23, 80, 80, 36, 46, 27, 80, 17, 80, 64, 25, 80, 51, 20, 80, 80, 80, 73, 80, 65, 80, 24, 80, 24, 80, 80, 34, 50, 80, 34, 80, 15, 69, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09052068924516625, "mean_inference_ms": 0.24192368936984024, "mean_action_processing_ms": 0.04353417948439402, "mean_env_wait_ms": 0.04617881337916633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016160011291503906, "StateBufferConnector_ms": 0.0012493133544921875, "ViewRequirementAgentConnector_ms": 0.028399944305419922}}, "episode_reward_max": 0.9497394148630804, "episode_reward_min": -1.0, "episode_reward_mean": -0.8276418562851526, "episode_len_mean": 60.98, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, 0.9415153661457799, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.513325410555564, 0.7119901082478564, -1.0, -1.0, 0.6290771421163441, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9497394148630804, -1.0, -1.0, -1.0, -1.0, 0.7255958983912569, -1.0, -1.0, -1.0, 0.8311885486036147, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9333824825612359, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 15, 80, 50, 56, 67, 80, 48, 21, 80, 80, 80, 30, 80, 54, 40, 44, 80, 80, 80, 39, 80, 63, 15, 80, 11, 80, 57, 80, 80, 17, 80, 80, 80, 77, 18, 80, 80, 80, 60, 80, 34, 24, 80, 80, 16, 80, 80, 23, 14, 80, 80, 32, 80, 65, 80, 80, 14, 77, 80, 80, 80, 80, 23, 80, 80, 36, 46, 27, 80, 17, 80, 64, 25, 80, 51, 20, 80, 80, 80, 73, 80, 65, 80, 24, 80, 24, 80, 80, 34, 50, 80, 34, 80, 15, 69, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09052068924516625, "mean_inference_ms": 0.24192368936984024, "mean_action_processing_ms": 0.04353417948439402, "mean_env_wait_ms": 0.04617881337916633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016160011291503906, "StateBufferConnector_ms": 0.0012493133544921875, "ViewRequirementAgentConnector_ms": 0.028399944305419922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1137.321248069436, "num_env_steps_trained_throughput_per_sec": 1137.321248069436, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 3542.9, "sample_time_ms": 1699.328, "load_time_ms": 0.221, "load_throughput": 18063324.72, "learn_time_ms": 1842.387, "learn_throughput": 2171.097, "synch_weights_time_ms": 0.636}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 1479, "training_iteration": 24, "trial_id": "default", "date": "2024-05-22_22-16-25", "timestamp": 1716408985, "time_this_iter_s": 3.5192630290985107, "time_total_s": 85.22513127326965, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 85.22513127326965, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.32, "ram_util_percent": 61.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.447980985109524, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19351606110150935, "policy_loss": -0.012854271630446116, "vf_loss": 0.20602287962752325, "vf_explained_var": 0.006125892426377983, "kl": 0.013898210832404926, "entropy": 2.6030877585052163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 0.9379945989204688, "episode_reward_min": -1.0, "episode_reward_mean": -0.7061841265771011, "episode_len_mean": 54.03, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9333824825612359, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8669209005205881, -1.0, 0.6028369064972678, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7708664333001933, -1.0, -1.0, 0.5, 0.5063695933192748, 0.8531440021153598, 0.5575627296910455, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9379945989204688, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.567885946738965, -1.0, 0.553727105800302, 0.730896642825183, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 73, 80, 65, 80, 24, 80, 24, 80, 80, 34, 50, 80, 34, 80, 15, 69, 80, 80, 80, 80, 80, 24, 68, 25, 34, 46, 34, 80, 80, 80, 16, 54, 80, 79, 80, 62, 29, 38, 27, 80, 22, 21, 58, 12, 13, 80, 54, 80, 12, 12, 30, 80, 80, 21, 69, 27, 30, 66, 32, 24, 80, 30, 68, 80, 80, 69, 80, 80, 15, 20, 21, 34, 13, 80, 80, 22, 41, 63, 77, 57, 34, 80, 27, 51, 80, 19, 68, 80, 56, 80, 19, 24, 80, 80, 61, 27, 20, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09056624798891574, "mean_inference_ms": 0.24187546873442797, "mean_action_processing_ms": 0.04353640405512636, "mean_env_wait_ms": 0.04618274731532421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016205310821533203, "StateBufferConnector_ms": 0.0012574195861816406, "ViewRequirementAgentConnector_ms": 0.028529882431030273}}, "episode_reward_max": 0.9379945989204688, "episode_reward_min": -1.0, "episode_reward_mean": -0.7061841265771011, "episode_len_mean": 54.03, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9333824825612359, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8669209005205881, -1.0, 0.6028369064972678, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7708664333001933, -1.0, -1.0, 0.5, 0.5063695933192748, 0.8531440021153598, 0.5575627296910455, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9379945989204688, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.567885946738965, -1.0, 0.553727105800302, 0.730896642825183, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 73, 80, 65, 80, 24, 80, 24, 80, 80, 34, 50, 80, 34, 80, 15, 69, 80, 80, 80, 80, 80, 24, 68, 25, 34, 46, 34, 80, 80, 80, 16, 54, 80, 79, 80, 62, 29, 38, 27, 80, 22, 21, 58, 12, 13, 80, 54, 80, 12, 12, 30, 80, 80, 21, 69, 27, 30, 66, 32, 24, 80, 30, 68, 80, 80, 69, 80, 80, 15, 20, 21, 34, 13, 80, 80, 22, 41, 63, 77, 57, 34, 80, 27, 51, 80, 19, 68, 80, 56, 80, 19, 24, 80, 80, 61, 27, 20, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09056624798891574, "mean_inference_ms": 0.24187546873442797, "mean_action_processing_ms": 0.04353640405512636, "mean_env_wait_ms": 0.04618274731532421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016205310821533203, "StateBufferConnector_ms": 0.0012574195861816406, "ViewRequirementAgentConnector_ms": 0.028529882431030273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1130.9393436847859, "num_env_steps_trained_throughput_per_sec": 1130.9393436847859, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 3536.248, "sample_time_ms": 1699.684, "load_time_ms": 0.221, "load_throughput": 18080844.919, "learn_time_ms": 1835.386, "learn_throughput": 2179.378, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 1558, "training_iteration": 25, "trial_id": "default", "date": "2024-05-22_22-16-28", "timestamp": 1716408988, "time_this_iter_s": 3.5393199920654297, "time_total_s": 88.76445126533508, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 88.76445126533508, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 14.219999999999999, "ram_util_percent": 61.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.516524684284964, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1896206595824771, "policy_loss": -0.009550069098521064, "vf_loss": 0.1989311062099953, "vf_explained_var": -0.19532695995864047, "kl": 0.009584907946920945, "entropy": 2.4877406979119905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 0.9797442632325788, "episode_reward_min": -1.0, "episode_reward_mean": -0.7515530288823189, "episode_len_mean": 45.25, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9345417171689091, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5119464987850386, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8909448020558687, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6670934467002794, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8566509263059844, -1.0, -1.0, -1.0, -1.0, 0.9041557279620249, -1.0, 0.8170910728636704, -1.0, -1.0, -1.0, 0.916212651180451, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9031027382371083, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9615919408113457, -1.0, -1.0, -1.0, -1.0, 0.5016213264648625, -1.0, -1.0, -1.0, 0.9797442632325788, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [56, 80, 19, 24, 80, 80, 61, 27, 20, 80, 73, 80, 38, 55, 80, 42, 80, 30, 30, 80, 44, 66, 38, 80, 29, 49, 27, 63, 80, 19, 24, 59, 17, 18, 16, 28, 31, 25, 16, 23, 71, 29, 19, 34, 40, 22, 27, 17, 80, 12, 80, 12, 80, 22, 80, 80, 80, 36, 54, 73, 38, 23, 80, 15, 32, 80, 24, 22, 11, 19, 26, 24, 21, 80, 44, 52, 42, 22, 12, 80, 80, 19, 80, 80, 80, 80, 36, 13, 74, 13, 26, 22, 80, 19, 25, 24, 80, 50, 36, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09065432575241282, "mean_inference_ms": 0.2418521776029442, "mean_action_processing_ms": 0.04354030347855721, "mean_env_wait_ms": 0.04619492110292277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014650821685791016, "StateBufferConnector_ms": 0.001245737075805664, "ViewRequirementAgentConnector_ms": 0.028398990631103516}}, "episode_reward_max": 0.9797442632325788, "episode_reward_min": -1.0, "episode_reward_mean": -0.7515530288823189, "episode_len_mean": 45.25, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9345417171689091, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5119464987850386, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8909448020558687, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6670934467002794, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8566509263059844, -1.0, -1.0, -1.0, -1.0, 0.9041557279620249, -1.0, 0.8170910728636704, -1.0, -1.0, -1.0, 0.916212651180451, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9031027382371083, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9615919408113457, -1.0, -1.0, -1.0, -1.0, 0.5016213264648625, -1.0, -1.0, -1.0, 0.9797442632325788, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [56, 80, 19, 24, 80, 80, 61, 27, 20, 80, 73, 80, 38, 55, 80, 42, 80, 30, 30, 80, 44, 66, 38, 80, 29, 49, 27, 63, 80, 19, 24, 59, 17, 18, 16, 28, 31, 25, 16, 23, 71, 29, 19, 34, 40, 22, 27, 17, 80, 12, 80, 12, 80, 22, 80, 80, 80, 36, 54, 73, 38, 23, 80, 15, 32, 80, 24, 22, 11, 19, 26, 24, 21, 80, 44, 52, 42, 22, 12, 80, 80, 19, 80, 80, 80, 80, 36, 13, 74, 13, 26, 22, 80, 19, 25, 24, 80, 50, 36, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09065432575241282, "mean_inference_ms": 0.2418521776029442, "mean_action_processing_ms": 0.04354030347855721, "mean_env_wait_ms": 0.04619492110292277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014650821685791016, "StateBufferConnector_ms": 0.001245737075805664, "ViewRequirementAgentConnector_ms": 0.028398990631103516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1129.5969786952148, "num_env_steps_trained_throughput_per_sec": 1129.5969786952148, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 3537.4, "sample_time_ms": 1701.479, "load_time_ms": 0.217, "load_throughput": 18396070.175, "learn_time_ms": 1834.754, "learn_throughput": 2180.129, "synch_weights_time_ms": 0.628}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 1648, "training_iteration": 26, "trial_id": "default", "date": "2024-05-22_22-16-32", "timestamp": 1716408992, "time_this_iter_s": 3.5435640811920166, "time_total_s": 92.3080153465271, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 92.3080153465271, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.54, "ram_util_percent": 61.21999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2192479034905794, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24204766280327608, "policy_loss": -0.0057754456466164, "vf_loss": 0.24751285727296066, "vf_explained_var": -0.11473121258520311, "kl": 0.012410064310340904, "entropy": 2.39448406029773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 0.9942538931128689, "episode_reward_min": -1.0, "episode_reward_mean": -0.6331053073918305, "episode_len_mean": 44.42, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.9797442632325788, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.836241188784276, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6136915640907799, -1.0, -1.0, -1.0, 0.8856737462317966, 0.9882989609616244, 0.8964579244966846, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6737703459199138, 0.9942538931128689, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9824762766218186, 0.9651779627381831, 0.616170323076258, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.9431322622283479, -1.0, -1.0, 0.5, -1.0, 0.8922812635569197, -1.0, -1.0, -1.0, 0.6367517198405732, 0.6489876309642951, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5232360156589463, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.613123919301093, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [74, 13, 26, 22, 80, 19, 25, 24, 80, 50, 36, 46, 53, 15, 62, 15, 67, 41, 33, 80, 22, 80, 23, 21, 31, 80, 40, 80, 80, 80, 24, 50, 80, 20, 26, 54, 69, 44, 28, 12, 53, 33, 25, 28, 13, 80, 24, 25, 53, 80, 12, 48, 50, 80, 35, 48, 26, 80, 36, 80, 71, 23, 33, 16, 53, 26, 80, 80, 26, 28, 18, 33, 18, 26, 25, 31, 14, 56, 80, 80, 31, 80, 17, 29, 80, 19, 80, 17, 80, 80, 21, 32, 16, 78, 27, 22, 13, 29, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09073336281344765, "mean_inference_ms": 0.24186175431517717, "mean_action_processing_ms": 0.04354613263863429, "mean_env_wait_ms": 0.04620620930242733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015501976013183594, "StateBufferConnector_ms": 0.0012023448944091797, "ViewRequirementAgentConnector_ms": 0.028396129608154297}}, "episode_reward_max": 0.9942538931128689, "episode_reward_min": -1.0, "episode_reward_mean": -0.6331053073918305, "episode_len_mean": 44.42, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.9797442632325788, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.836241188784276, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6136915640907799, -1.0, -1.0, -1.0, 0.8856737462317966, 0.9882989609616244, 0.8964579244966846, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6737703459199138, 0.9942538931128689, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9824762766218186, 0.9651779627381831, 0.616170323076258, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, 0.9431322622283479, -1.0, -1.0, 0.5, -1.0, 0.8922812635569197, -1.0, -1.0, -1.0, 0.6367517198405732, 0.6489876309642951, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5232360156589463, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.613123919301093, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [74, 13, 26, 22, 80, 19, 25, 24, 80, 50, 36, 46, 53, 15, 62, 15, 67, 41, 33, 80, 22, 80, 23, 21, 31, 80, 40, 80, 80, 80, 24, 50, 80, 20, 26, 54, 69, 44, 28, 12, 53, 33, 25, 28, 13, 80, 24, 25, 53, 80, 12, 48, 50, 80, 35, 48, 26, 80, 36, 80, 71, 23, 33, 16, 53, 26, 80, 80, 26, 28, 18, 33, 18, 26, 25, 31, 14, 56, 80, 80, 31, 80, 17, 29, 80, 19, 80, 17, 80, 80, 21, 32, 16, 78, 27, 22, 13, 29, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09073336281344765, "mean_inference_ms": 0.24186175431517717, "mean_action_processing_ms": 0.04354613263863429, "mean_env_wait_ms": 0.04620620930242733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015501976013183594, "StateBufferConnector_ms": 0.0012023448944091797, "ViewRequirementAgentConnector_ms": 0.028396129608154297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1128.639878974659, "num_env_steps_trained_throughput_per_sec": 1128.639878974659, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3538.01, "sample_time_ms": 1703.213, "load_time_ms": 0.221, "load_throughput": 18129690.944, "learn_time_ms": 1833.628, "learn_throughput": 2181.468, "synch_weights_time_ms": 0.627}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 1736, "training_iteration": 27, "trial_id": "default", "date": "2024-05-22_22-16-35", "timestamp": 1716408995, "time_this_iter_s": 3.5465340614318848, "time_total_s": 95.85454940795898, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 95.85454940795898, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.34, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7180436442616167, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16967197981492807, "policy_loss": 0.00452499975680664, "vf_loss": 0.1649096764363749, "vf_explained_var": 0.056950693233038786, "kl": 0.009492160632997798, "entropy": 2.362866114929158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 0.9819788523795882, "episode_reward_min": -1.0, "episode_reward_mean": -0.727280827059582, "episode_len_mean": 52.41, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6367517198405732, 0.6489876309642951, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5232360156589463, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.613123919301093, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.62028124992846, 0.9601899480645408, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8134572244903907, 0.9819788523795882, -1.0, -1.0, -1.0, -1.0, 0.6143151216324114, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5992579077232036, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5135058804654735, -1.0, 0.8896033414406244, -1.0, -1.0, -1.0, 0.9603323853131035, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6419819639470355, -1.0, -1.0, -1.0, -1.0, 0.5797446989515074, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6751694339405586], "episode_lengths": [25, 31, 14, 56, 80, 80, 31, 80, 17, 29, 80, 19, 80, 17, 80, 80, 21, 32, 16, 78, 27, 22, 13, 29, 80, 80, 80, 46, 60, 80, 39, 80, 56, 80, 45, 33, 14, 61, 80, 80, 80, 80, 27, 30, 23, 63, 39, 17, 80, 25, 25, 43, 33, 30, 80, 23, 70, 80, 18, 77, 54, 37, 18, 80, 80, 24, 46, 80, 54, 45, 34, 80, 80, 80, 57, 80, 80, 13, 23, 39, 16, 79, 62, 80, 35, 29, 19, 80, 80, 80, 80, 36, 53, 80, 80, 13, 80, 80, 80, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09076384368885143, "mean_inference_ms": 0.2418487981438151, "mean_action_processing_ms": 0.04354538178175333, "mean_env_wait_ms": 0.04621114792903232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015680789947509766, "StateBufferConnector_ms": 0.0012288093566894531, "ViewRequirementAgentConnector_ms": 0.028449058532714844}}, "episode_reward_max": 0.9819788523795882, "episode_reward_min": -1.0, "episode_reward_mean": -0.727280827059582, "episode_len_mean": 52.41, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6367517198405732, 0.6489876309642951, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5232360156589463, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.613123919301093, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.62028124992846, 0.9601899480645408, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8134572244903907, 0.9819788523795882, -1.0, -1.0, -1.0, -1.0, 0.6143151216324114, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5992579077232036, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5135058804654735, -1.0, 0.8896033414406244, -1.0, -1.0, -1.0, 0.9603323853131035, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6419819639470355, -1.0, -1.0, -1.0, -1.0, 0.5797446989515074, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6751694339405586], "episode_lengths": [25, 31, 14, 56, 80, 80, 31, 80, 17, 29, 80, 19, 80, 17, 80, 80, 21, 32, 16, 78, 27, 22, 13, 29, 80, 80, 80, 46, 60, 80, 39, 80, 56, 80, 45, 33, 14, 61, 80, 80, 80, 80, 27, 30, 23, 63, 39, 17, 80, 25, 25, 43, 33, 30, 80, 23, 70, 80, 18, 77, 54, 37, 18, 80, 80, 24, 46, 80, 54, 45, 34, 80, 80, 80, 57, 80, 80, 13, 23, 39, 16, 79, 62, 80, 35, 29, 19, 80, 80, 80, 80, 36, 53, 80, 80, 13, 80, 80, 80, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09076384368885143, "mean_inference_ms": 0.2418487981438151, "mean_action_processing_ms": 0.04354538178175333, "mean_env_wait_ms": 0.04621114792903232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015680789947509766, "StateBufferConnector_ms": 0.0012288093566894531, "ViewRequirementAgentConnector_ms": 0.028449058532714844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1127.850269233223, "num_env_steps_trained_throughput_per_sec": 1127.850269233223, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 3540.606, "sample_time_ms": 1704.191, "load_time_ms": 0.213, "load_throughput": 18785372.299, "learn_time_ms": 1835.255, "learn_throughput": 2179.534, "synch_weights_time_ms": 0.626}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 1810, "training_iteration": 28, "trial_id": "default", "date": "2024-05-22_22-16-39", "timestamp": 1716408999, "time_this_iter_s": 3.548945903778076, "time_total_s": 99.40349531173706, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 99.40349531173706, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 61.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9543355075902835, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2377008436395416, "policy_loss": 0.00574941619109082, "vf_loss": 0.23168366280915115, "vf_explained_var": 0.08080660867434676, "kl": 0.010710598060299066, "entropy": 2.249194259284645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 0.974743289621767, "episode_reward_min": -1.0, "episode_reward_mean": -0.5477552104047266, "episode_len_mean": 47.05, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5797446989515074, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6751694339405586, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7840127079663769, -1.0, -1.0, -1.0, 0.9086182759138529, 0.5642069707166102, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6149864984683566, 0.9070681739171745, 0.5, -1.0, 0.8030093635296873, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6930363722198092, -1.0, -1.0, -1.0, 0.5894287133167646, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9694743978617363, -1.0, 0.6750539456875146, -1.0, -1.0, 0.5324653270913273, -1.0, 0.974743289621767, -1.0, -1.0, 0.9516846416369603, -1.0, 0.8589646203311198, -1.0, 0.7621649830531168, 0.9568308428461078, -1.0, 0.805158900697095, 0.964801514164999, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6865453075071402, -1.0, -1.0, 0.967309980087741], "episode_lengths": [80, 80, 36, 53, 80, 80, 13, 80, 80, 80, 41, 80, 80, 80, 68, 80, 80, 59, 22, 45, 80, 30, 32, 80, 80, 16, 80, 80, 72, 68, 23, 16, 16, 20, 26, 55, 18, 80, 33, 25, 80, 33, 28, 40, 31, 12, 28, 80, 80, 80, 13, 33, 69, 80, 20, 33, 50, 64, 37, 80, 50, 29, 16, 39, 78, 17, 80, 27, 65, 33, 62, 25, 31, 18, 44, 23, 22, 50, 22, 29, 78, 24, 37, 68, 39, 35, 39, 80, 38, 15, 33, 79, 18, 14, 23, 42, 23, 25, 18, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09083552982929465, "mean_inference_ms": 0.24183595928805635, "mean_action_processing_ms": 0.04354631777890978, "mean_env_wait_ms": 0.04622043036458964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015766620635986328, "StateBufferConnector_ms": 0.001210927963256836, "ViewRequirementAgentConnector_ms": 0.028471708297729492}}, "episode_reward_max": 0.974743289621767, "episode_reward_min": -1.0, "episode_reward_mean": -0.5477552104047266, "episode_len_mean": 47.05, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5797446989515074, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6751694339405586, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7840127079663769, -1.0, -1.0, -1.0, 0.9086182759138529, 0.5642069707166102, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6149864984683566, 0.9070681739171745, 0.5, -1.0, 0.8030093635296873, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6930363722198092, -1.0, -1.0, -1.0, 0.5894287133167646, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9694743978617363, -1.0, 0.6750539456875146, -1.0, -1.0, 0.5324653270913273, -1.0, 0.974743289621767, -1.0, -1.0, 0.9516846416369603, -1.0, 0.8589646203311198, -1.0, 0.7621649830531168, 0.9568308428461078, -1.0, 0.805158900697095, 0.964801514164999, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6865453075071402, -1.0, -1.0, 0.967309980087741], "episode_lengths": [80, 80, 36, 53, 80, 80, 13, 80, 80, 80, 41, 80, 80, 80, 68, 80, 80, 59, 22, 45, 80, 30, 32, 80, 80, 16, 80, 80, 72, 68, 23, 16, 16, 20, 26, 55, 18, 80, 33, 25, 80, 33, 28, 40, 31, 12, 28, 80, 80, 80, 13, 33, 69, 80, 20, 33, 50, 64, 37, 80, 50, 29, 16, 39, 78, 17, 80, 27, 65, 33, 62, 25, 31, 18, 44, 23, 22, 50, 22, 29, 78, 24, 37, 68, 39, 35, 39, 80, 38, 15, 33, 79, 18, 14, 23, 42, 23, 25, 18, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09083552982929465, "mean_inference_ms": 0.24183595928805635, "mean_action_processing_ms": 0.04354631777890978, "mean_env_wait_ms": 0.04622043036458964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015766620635986328, "StateBufferConnector_ms": 0.001210927963256836, "ViewRequirementAgentConnector_ms": 0.028471708297729492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1104.072043244689, "num_env_steps_trained_throughput_per_sec": 1104.072043244689, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 3549.493, "sample_time_ms": 1705.721, "load_time_ms": 0.207, "load_throughput": 19277508.905, "learn_time_ms": 1842.607, "learn_throughput": 2170.837, "synch_weights_time_ms": 0.631}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 1899, "training_iteration": 29, "trial_id": "default", "date": "2024-05-22_22-16-43", "timestamp": 1716409003, "time_this_iter_s": 3.6256799697875977, "time_total_s": 103.02917528152466, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 103.02917528152466, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.160000000000004, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5781305630360882, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3058297095865841, "policy_loss": -0.005455000223892351, "vf_loss": 0.3110427826042137, "vf_explained_var": 0.1484926417950661, "kl": 0.0096769935486388, "entropy": 2.2527437128046506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 0.9996020080258062, "episode_reward_min": -1.0, "episode_reward_mean": -0.2811556581677529, "episode_len_mean": 38.96078431372549, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8078299157200777, -1.0, -1.0, -1.0, 0.8191519698577021, 0.7268335983114458, 0.8042477151073125, -1.0, 0.7282418968641492, -1.0, 0.98997328053068, 0.5489007841705054, -1.0, -1.0, 0.5845388521283688, -1.0, 0.8138549758232596, -1.0, 0.664339773046138, -1.0, 0.5667095454530037, -1.0, -1.0, -1.0, -1.0, 0.6755026813157208, 0.9996020080258062, -1.0, -1.0, -1.0, -1.0, 0.5442604260106749, -1.0, -1.0, 0.5688169066640996, -1.0, 0.8020277698647826, -1.0, -1.0, -1.0, 0.9437241907832103, -1.0, 0.8765467547276786, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7956397609326046, -1.0, 0.5, -1.0, 0.5, -1.0, 0.8435487841007451, 0.9181399959382702, 0.8433666244091619, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9056213920861746, 0.9679106934103131, 0.8652747030029513, -1.0, 0.7310868113718514, 0.79400250788496, -1.0, -1.0, -1.0, 0.5076429270978273, -1.0, -1.0, 0.8279560137209234, -1.0, 0.924020884308635, 0.6279393729361299, 0.7342170903917119, -1.0, -1.0, -1.0, -1.0, 0.5337340109137279, 0.8257481011136266, 0.9175100157554129, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5933441433396367, -1.0, -1.0, 0.7977341115337169, 0.9025818782362081, -1.0], "episode_lengths": [28, 80, 80, 73, 31, 28, 19, 15, 44, 23, 21, 21, 20, 48, 33, 23, 33, 19, 23, 26, 18, 47, 43, 33, 29, 78, 21, 24, 24, 47, 16, 54, 51, 80, 22, 58, 30, 19, 27, 77, 43, 80, 49, 21, 22, 36, 80, 80, 25, 26, 26, 23, 34, 31, 32, 22, 43, 67, 80, 22, 33, 80, 15, 47, 10, 80, 36, 33, 21, 11, 21, 64, 14, 80, 19, 26, 19, 17, 29, 80, 20, 28, 35, 45, 80, 36, 51, 31, 56, 22, 20, 17, 25, 80, 36, 80, 49, 27, 55, 19, 30, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09095934130523789, "mean_inference_ms": 0.24185721591574322, "mean_action_processing_ms": 0.04355797430796249, "mean_env_wait_ms": 0.04624027024557103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015396697848450904, "StateBufferConnector_ms": 0.00122832316978305, "ViewRequirementAgentConnector_ms": 0.028579375323127296}}, "episode_reward_max": 0.9996020080258062, "episode_reward_min": -1.0, "episode_reward_mean": -0.2811556581677529, "episode_len_mean": 38.96078431372549, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8078299157200777, -1.0, -1.0, -1.0, 0.8191519698577021, 0.7268335983114458, 0.8042477151073125, -1.0, 0.7282418968641492, -1.0, 0.98997328053068, 0.5489007841705054, -1.0, -1.0, 0.5845388521283688, -1.0, 0.8138549758232596, -1.0, 0.664339773046138, -1.0, 0.5667095454530037, -1.0, -1.0, -1.0, -1.0, 0.6755026813157208, 0.9996020080258062, -1.0, -1.0, -1.0, -1.0, 0.5442604260106749, -1.0, -1.0, 0.5688169066640996, -1.0, 0.8020277698647826, -1.0, -1.0, -1.0, 0.9437241907832103, -1.0, 0.8765467547276786, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7956397609326046, -1.0, 0.5, -1.0, 0.5, -1.0, 0.8435487841007451, 0.9181399959382702, 0.8433666244091619, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9056213920861746, 0.9679106934103131, 0.8652747030029513, -1.0, 0.7310868113718514, 0.79400250788496, -1.0, -1.0, -1.0, 0.5076429270978273, -1.0, -1.0, 0.8279560137209234, -1.0, 0.924020884308635, 0.6279393729361299, 0.7342170903917119, -1.0, -1.0, -1.0, -1.0, 0.5337340109137279, 0.8257481011136266, 0.9175100157554129, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5933441433396367, -1.0, -1.0, 0.7977341115337169, 0.9025818782362081, -1.0], "episode_lengths": [28, 80, 80, 73, 31, 28, 19, 15, 44, 23, 21, 21, 20, 48, 33, 23, 33, 19, 23, 26, 18, 47, 43, 33, 29, 78, 21, 24, 24, 47, 16, 54, 51, 80, 22, 58, 30, 19, 27, 77, 43, 80, 49, 21, 22, 36, 80, 80, 25, 26, 26, 23, 34, 31, 32, 22, 43, 67, 80, 22, 33, 80, 15, 47, 10, 80, 36, 33, 21, 11, 21, 64, 14, 80, 19, 26, 19, 17, 29, 80, 20, 28, 35, 45, 80, 36, 51, 31, 56, 22, 20, 17, 25, 80, 36, 80, 49, 27, 55, 19, 30, 69]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09095934130523789, "mean_inference_ms": 0.24185721591574322, "mean_action_processing_ms": 0.04355797430796249, "mean_env_wait_ms": 0.04624027024557103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015396697848450904, "StateBufferConnector_ms": 0.00122832316978305, "ViewRequirementAgentConnector_ms": 0.028579375323127296}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1124.9956917182687, "num_env_steps_trained_throughput_per_sec": 1124.9956917182687, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 3552.524, "sample_time_ms": 1707.93, "load_time_ms": 0.208, "load_throughput": 19259804.844, "learn_time_ms": 1843.423, "learn_throughput": 2169.876, "synch_weights_time_ms": 0.638}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 2001, "training_iteration": 30, "trial_id": "default", "date": "2024-05-22_22-16-46", "timestamp": 1716409006, "time_this_iter_s": 3.558283805847168, "time_total_s": 106.58745908737183, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.58745908737183, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.779999999999998, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1524531299068084, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3013017169960965, "policy_loss": -0.003643463613084888, "vf_loss": 0.30466136119218284, "vf_explained_var": 0.044685338774035056, "kl": 0.011352738123005893, "entropy": 2.1731807428021583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 0.9973391214332483, "episode_reward_min": -1.0, "episode_reward_mean": -0.46308041153457785, "episode_len_mean": 33.65546218487395, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8850797603552951, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7671505085916932, -1.0, -1.0, -1.0, 0.7275528673752869, 0.5, -1.0, 0.5, 0.61651307661329, 0.6468901221596688, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8089808184319094, -1.0, 0.7546944047458971, -1.0, -1.0, -1.0, 0.6535468258951602, 0.9939089540645941, -1.0, -1.0, 0.9731470895643289, 0.6274632772806743, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7344822703490894, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9973391214332483, -1.0, 0.6364838209517709, -1.0, -1.0, -1.0, 0.716768741237304, -1.0, -1.0, -1.0, 0.5, 0.5744462677271244, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.9337872424190788, -1.0, 0.8406806794101582, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5085390507471323, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.988652372335969, -1.0, -1.0, 0.6932447163344038, -1.0, 0.7988306596426901, 0.5028997894307927, -1.0, -1.0, 0.9922268774394248, -1.0, 0.5484961140873225, 0.8652052262839907, 0.5304387462423603, 0.5759816262355744, 0.5, -1.0], "episode_lengths": [78, 34, 68, 19, 43, 12, 21, 80, 22, 20, 15, 16, 28, 34, 24, 29, 31, 42, 12, 20, 25, 41, 30, 17, 43, 27, 13, 30, 80, 30, 26, 21, 37, 73, 59, 21, 24, 31, 44, 25, 20, 22, 80, 14, 17, 22, 11, 13, 80, 18, 20, 19, 39, 27, 26, 23, 52, 61, 18, 35, 76, 18, 37, 21, 22, 28, 30, 71, 25, 25, 36, 61, 27, 42, 16, 39, 39, 78, 37, 17, 19, 18, 30, 33, 22, 80, 27, 54, 16, 36, 17, 40, 24, 13, 21, 80, 12, 13, 14, 38, 21, 15, 26, 48, 64, 18, 80, 39, 52, 56, 30, 27, 35, 18, 29, 42, 32, 17, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09111588776547579, "mean_inference_ms": 0.2418861878606479, "mean_action_processing_ms": 0.04356863664022005, "mean_env_wait_ms": 0.04626600578197914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00148600890856831, "StateBufferConnector_ms": 0.00124819138470818, "ViewRequirementAgentConnector_ms": 0.028622050245269006}}, "episode_reward_max": 0.9973391214332483, "episode_reward_min": -1.0, "episode_reward_mean": -0.46308041153457785, "episode_len_mean": 33.65546218487395, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8850797603552951, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7671505085916932, -1.0, -1.0, -1.0, 0.7275528673752869, 0.5, -1.0, 0.5, 0.61651307661329, 0.6468901221596688, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8089808184319094, -1.0, 0.7546944047458971, -1.0, -1.0, -1.0, 0.6535468258951602, 0.9939089540645941, -1.0, -1.0, 0.9731470895643289, 0.6274632772806743, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7344822703490894, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9973391214332483, -1.0, 0.6364838209517709, -1.0, -1.0, -1.0, 0.716768741237304, -1.0, -1.0, -1.0, 0.5, 0.5744462677271244, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.9337872424190788, -1.0, 0.8406806794101582, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5085390507471323, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.988652372335969, -1.0, -1.0, 0.6932447163344038, -1.0, 0.7988306596426901, 0.5028997894307927, -1.0, -1.0, 0.9922268774394248, -1.0, 0.5484961140873225, 0.8652052262839907, 0.5304387462423603, 0.5759816262355744, 0.5, -1.0], "episode_lengths": [78, 34, 68, 19, 43, 12, 21, 80, 22, 20, 15, 16, 28, 34, 24, 29, 31, 42, 12, 20, 25, 41, 30, 17, 43, 27, 13, 30, 80, 30, 26, 21, 37, 73, 59, 21, 24, 31, 44, 25, 20, 22, 80, 14, 17, 22, 11, 13, 80, 18, 20, 19, 39, 27, 26, 23, 52, 61, 18, 35, 76, 18, 37, 21, 22, 28, 30, 71, 25, 25, 36, 61, 27, 42, 16, 39, 39, 78, 37, 17, 19, 18, 30, 33, 22, 80, 27, 54, 16, 36, 17, 40, 24, 13, 21, 80, 12, 13, 14, 38, 21, 15, 26, 48, 64, 18, 80, 39, 52, 56, 30, 27, 35, 18, 29, 42, 32, 17, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09111588776547579, "mean_inference_ms": 0.2418861878606479, "mean_action_processing_ms": 0.04356863664022005, "mean_env_wait_ms": 0.04626600578197914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00148600890856831, "StateBufferConnector_ms": 0.00124819138470818, "ViewRequirementAgentConnector_ms": 0.028622050245269006}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1122.3905024387277, "num_env_steps_trained_throughput_per_sec": 1122.3905024387277, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 3555.683, "sample_time_ms": 1711.432, "load_time_ms": 0.207, "load_throughput": 19306347.526, "learn_time_ms": 1843.082, "learn_throughput": 2170.278, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 2120, "training_iteration": 31, "trial_id": "default", "date": "2024-05-22_22-16-50", "timestamp": 1716409010, "time_this_iter_s": 3.566664934158325, "time_total_s": 110.15412402153015, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 110.15412402153015, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.72, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1696012994294525, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3019372147680085, "policy_loss": -0.006255253613676115, "vf_loss": 0.3079058211016399, "vf_explained_var": 0.22882277446408425, "kl": 0.011465867255498785, "entropy": 2.2230949599255796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 0.996249739212989, "episode_reward_min": -1.0, "episode_reward_mean": -0.34175429907022076, "episode_len_mean": 35.669642857142854, "episode_media": {}, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8284811410286308, 0.5, 0.9200160976658027, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5623626654916734, -1.0, 0.8031878984090297, 0.5, -1.0, -1.0, -1.0, 0.9160378213427974, -1.0, -1.0, 0.7213977888504413, 0.9207194149333744, -1.0, -1.0, 0.5, 0.5, -1.0, 0.8202669284276077, 0.6238239353054602, -1.0, 0.919590675822747, -1.0, -1.0, -1.0, 0.806950488294216, -1.0, -1.0, 0.607096561255773, -1.0, 0.9781057483418765, -1.0, -1.0, -1.0, -1.0, 0.6538289508242874, -1.0, -1.0, 0.6117099203578586, 0.9830846071655931, 0.8749434418581222, -1.0, 0.6999421037926822, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7630895880071521, -1.0, -1.0, 0.5, -1.0, 0.5, 0.9198954808933903, -1.0, -1.0, 0.9781934400826531, 0.7085645283368899, 0.7731386582007405, 0.8481656336003157, 0.996249739212989, -1.0, 0.6600202669463759, -1.0, 0.7620774308184148, 0.7963490881758121, 0.7733899487191542, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6931867929566217, -1.0, -1.0, -1.0, -1.0, 0.6038103896877147, -1.0, -1.0, 0.6432017146885189, -1.0, -1.0, 0.5526396146405581, -1.0, -1.0, -1.0], "episode_lengths": [40, 21, 14, 56, 80, 22, 19, 24, 19, 24, 19, 26, 19, 80, 35, 16, 33, 34, 43, 19, 33, 25, 59, 27, 23, 37, 80, 27, 66, 23, 13, 21, 34, 68, 19, 45, 41, 80, 22, 30, 26, 17, 16, 39, 26, 33, 20, 12, 42, 43, 80, 39, 19, 41, 79, 32, 20, 14, 37, 16, 80, 41, 11, 80, 33, 29, 80, 28, 18, 19, 11, 20, 80, 30, 27, 72, 32, 43, 24, 80, 21, 20, 34, 21, 34, 80, 37, 28, 43, 16, 20, 51, 16, 29, 80, 19, 41, 55, 19, 29, 56, 62, 38, 21, 80, 18, 13, 17, 30, 17, 32, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09123654724319456, "mean_inference_ms": 0.2418951418590525, "mean_action_processing_ms": 0.04357340976572245, "mean_env_wait_ms": 0.0462768560290293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015073588916233607, "StateBufferConnector_ms": 0.0011929443904331752, "ViewRequirementAgentConnector_ms": 0.028433970042637417}}, "episode_reward_max": 0.996249739212989, "episode_reward_min": -1.0, "episode_reward_mean": -0.34175429907022076, "episode_len_mean": 35.669642857142854, "episodes_this_iter": 112, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8284811410286308, 0.5, 0.9200160976658027, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5623626654916734, -1.0, 0.8031878984090297, 0.5, -1.0, -1.0, -1.0, 0.9160378213427974, -1.0, -1.0, 0.7213977888504413, 0.9207194149333744, -1.0, -1.0, 0.5, 0.5, -1.0, 0.8202669284276077, 0.6238239353054602, -1.0, 0.919590675822747, -1.0, -1.0, -1.0, 0.806950488294216, -1.0, -1.0, 0.607096561255773, -1.0, 0.9781057483418765, -1.0, -1.0, -1.0, -1.0, 0.6538289508242874, -1.0, -1.0, 0.6117099203578586, 0.9830846071655931, 0.8749434418581222, -1.0, 0.6999421037926822, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7630895880071521, -1.0, -1.0, 0.5, -1.0, 0.5, 0.9198954808933903, -1.0, -1.0, 0.9781934400826531, 0.7085645283368899, 0.7731386582007405, 0.8481656336003157, 0.996249739212989, -1.0, 0.6600202669463759, -1.0, 0.7620774308184148, 0.7963490881758121, 0.7733899487191542, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6931867929566217, -1.0, -1.0, -1.0, -1.0, 0.6038103896877147, -1.0, -1.0, 0.6432017146885189, -1.0, -1.0, 0.5526396146405581, -1.0, -1.0, -1.0], "episode_lengths": [40, 21, 14, 56, 80, 22, 19, 24, 19, 24, 19, 26, 19, 80, 35, 16, 33, 34, 43, 19, 33, 25, 59, 27, 23, 37, 80, 27, 66, 23, 13, 21, 34, 68, 19, 45, 41, 80, 22, 30, 26, 17, 16, 39, 26, 33, 20, 12, 42, 43, 80, 39, 19, 41, 79, 32, 20, 14, 37, 16, 80, 41, 11, 80, 33, 29, 80, 28, 18, 19, 11, 20, 80, 30, 27, 72, 32, 43, 24, 80, 21, 20, 34, 21, 34, 80, 37, 28, 43, 16, 20, 51, 16, 29, 80, 19, 41, 55, 19, 29, 56, 62, 38, 21, 80, 18, 13, 17, 30, 17, 32, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09123654724319456, "mean_inference_ms": 0.2418951418590525, "mean_action_processing_ms": 0.04357340976572245, "mean_env_wait_ms": 0.0462768560290293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015073588916233607, "StateBufferConnector_ms": 0.0011929443904331752, "ViewRequirementAgentConnector_ms": 0.028433970042637417}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1119.445954449672, "num_env_steps_trained_throughput_per_sec": 1119.445954449672, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 3553.016, "sample_time_ms": 1714.682, "load_time_ms": 0.207, "load_throughput": 19277508.905, "learn_time_ms": 1837.163, "learn_throughput": 2177.27, "synch_weights_time_ms": 0.642}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 2232, "training_iteration": 32, "trial_id": "default", "date": "2024-05-22_22-16-53", "timestamp": 1716409013, "time_this_iter_s": 3.5760300159454346, "time_total_s": 113.73015403747559, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 113.73015403747559, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 18.650000000000002, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5401471813519794, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26311430827969867, "policy_loss": -0.0057001222445759725, "vf_loss": 0.26859666766418566, "vf_explained_var": 0.06214630494835556, "kl": 0.008710525536869683, "entropy": 2.189608415736947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 0.997018566983434, "episode_reward_min": -1.0, "episode_reward_mean": -0.3722431809389626, "episode_len_mean": 34.560344827586206, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.8348369708618912, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7116406366681982, 0.627389374833502, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.971427555244427, 0.5670398145518449, -1.0, 0.6174597793169145, 0.6354042703107798, -1.0, -1.0, -1.0, 0.9373265502787048, -1.0, -1.0, 0.962599837439251, -1.0, 0.7063517931711982, 0.589422429286599, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.673344318215032, 0.5654592757679812, -1.0, -1.0, -1.0, 0.774683455944649, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7540140159029933, 0.9525049896301125, -1.0, -1.0, -1.0, 0.8241399828375866, -1.0, 0.665448026615703, -1.0, -1.0, 0.7157876340442262, -1.0, 0.5766121465714285, 0.6191278871085741, -1.0, 0.5194756728521575, 0.5, -1.0, 0.5, 0.8479472685018945, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9122271779836052, -1.0, -1.0, 0.6051033047487462, 0.9267192284772934, 0.957189061828521, -1.0, 0.5, -1.0, 0.997018566983434, -1.0, -1.0, 0.7862776327351948, 0.5, -1.0, -1.0, 0.9851555129231522, 0.7226254032246019, -1.0, -1.0, -1.0, -1.0, 0.5616579815766444, -1.0, 0.6230799104070803, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5932935442364144, -1.0], "episode_lengths": [52, 80, 19, 19, 12, 32, 33, 24, 26, 36, 24, 80, 20, 20, 16, 29, 37, 51, 19, 55, 23, 16, 80, 14, 31, 25, 15, 25, 16, 17, 80, 21, 80, 68, 22, 12, 30, 21, 23, 16, 37, 80, 11, 19, 80, 32, 40, 42, 24, 54, 38, 31, 80, 41, 22, 43, 19, 25, 26, 21, 80, 26, 21, 19, 25, 39, 35, 23, 25, 21, 38, 80, 35, 21, 27, 25, 27, 21, 80, 18, 19, 25, 80, 17, 30, 29, 41, 19, 24, 33, 40, 26, 27, 21, 27, 28, 22, 21, 26, 80, 23, 19, 32, 80, 80, 13, 22, 26, 33, 19, 80, 33, 24, 12, 28, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09136475178049579, "mean_inference_ms": 0.24191351432001806, "mean_action_processing_ms": 0.04358342415973943, "mean_env_wait_ms": 0.04629656007462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014812781892973802, "StateBufferConnector_ms": 0.0012424485436801252, "ViewRequirementAgentConnector_ms": 0.028645786745794887}}, "episode_reward_max": 0.997018566983434, "episode_reward_min": -1.0, "episode_reward_mean": -0.3722431809389626, "episode_len_mean": 34.560344827586206, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.8348369708618912, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7116406366681982, 0.627389374833502, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.971427555244427, 0.5670398145518449, -1.0, 0.6174597793169145, 0.6354042703107798, -1.0, -1.0, -1.0, 0.9373265502787048, -1.0, -1.0, 0.962599837439251, -1.0, 0.7063517931711982, 0.589422429286599, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.673344318215032, 0.5654592757679812, -1.0, -1.0, -1.0, 0.774683455944649, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7540140159029933, 0.9525049896301125, -1.0, -1.0, -1.0, 0.8241399828375866, -1.0, 0.665448026615703, -1.0, -1.0, 0.7157876340442262, -1.0, 0.5766121465714285, 0.6191278871085741, -1.0, 0.5194756728521575, 0.5, -1.0, 0.5, 0.8479472685018945, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9122271779836052, -1.0, -1.0, 0.6051033047487462, 0.9267192284772934, 0.957189061828521, -1.0, 0.5, -1.0, 0.997018566983434, -1.0, -1.0, 0.7862776327351948, 0.5, -1.0, -1.0, 0.9851555129231522, 0.7226254032246019, -1.0, -1.0, -1.0, -1.0, 0.5616579815766444, -1.0, 0.6230799104070803, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5932935442364144, -1.0], "episode_lengths": [52, 80, 19, 19, 12, 32, 33, 24, 26, 36, 24, 80, 20, 20, 16, 29, 37, 51, 19, 55, 23, 16, 80, 14, 31, 25, 15, 25, 16, 17, 80, 21, 80, 68, 22, 12, 30, 21, 23, 16, 37, 80, 11, 19, 80, 32, 40, 42, 24, 54, 38, 31, 80, 41, 22, 43, 19, 25, 26, 21, 80, 26, 21, 19, 25, 39, 35, 23, 25, 21, 38, 80, 35, 21, 27, 25, 27, 21, 80, 18, 19, 25, 80, 17, 30, 29, 41, 19, 24, 33, 40, 26, 27, 21, 27, 28, 22, 21, 26, 80, 23, 19, 32, 80, 80, 13, 22, 26, 33, 19, 80, 33, 24, 12, 28, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09136475178049579, "mean_inference_ms": 0.24191351432001806, "mean_action_processing_ms": 0.04358342415973943, "mean_env_wait_ms": 0.04629656007462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014812781892973802, "StateBufferConnector_ms": 0.0012424485436801252, "ViewRequirementAgentConnector_ms": 0.028645786745794887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1116.6899704001428, "num_env_steps_trained_throughput_per_sec": 1116.6899704001428, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 3558.308, "sample_time_ms": 1717.876, "load_time_ms": 0.206, "load_throughput": 19373228.637, "learn_time_ms": 1839.26, "learn_throughput": 2174.788, "synch_weights_time_ms": 0.642}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 2348, "training_iteration": 33, "trial_id": "default", "date": "2024-05-22_22-16-57", "timestamp": 1716409017, "time_this_iter_s": 3.584744930267334, "time_total_s": 117.31489896774292, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.31489896774292, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 10.5, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8829143323244586, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.265265129390423, "policy_loss": -0.0005369852587420453, "vf_loss": 0.2655181248952705, "vf_explained_var": 0.13707629397351254, "kl": 0.011359599685625504, "entropy": 2.136875476888431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 0.9924509186296276, "episode_reward_min": -1.0, "episode_reward_mean": -0.18338545111502114, "episode_len_mean": 36.825688073394495, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8542903826974276, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.9303692047546628, 0.9230622919490857, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9473183169551619, 0.96253812533069, -1.0, -1.0, -1.0, -1.0, 0.5, 0.96785033222805, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5499326122542008, 0.5182686442306674, 0.893865844904426, -1.0, 0.5, 0.8024040972042847, -1.0, 0.6003525412883614, 0.8191020182823675, 0.5, 0.5783035724174264, -1.0, -1.0, 0.9924509186296276, -1.0, -1.0, -1.0, 0.7116609294641643, 0.8595036932946957, 0.5, 0.6261422700284207, 0.6538891611534623, 0.6852710378438764, 0.6159872469856171, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8675189789069865, 0.5937731966464947, 0.5800664744337539, 0.7704637619002022, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6418857294453673, 0.5, -1.0, 0.886069811664785, -1.0, -1.0, 0.54852579836361, 0.5, 0.793578360284926, 0.5, -1.0, -1.0, 0.8799017658078159, 0.5, 0.6177312412206619, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.838907467891421], "episode_lengths": [32, 17, 23, 35, 80, 16, 23, 40, 27, 29, 16, 80, 19, 31, 21, 80, 26, 24, 44, 80, 47, 80, 43, 23, 32, 31, 24, 80, 25, 34, 22, 18, 40, 21, 22, 53, 26, 21, 14, 26, 31, 17, 45, 34, 24, 16, 20, 25, 28, 24, 26, 24, 28, 44, 36, 39, 41, 80, 17, 17, 60, 18, 26, 22, 22, 18, 18, 80, 80, 20, 28, 80, 80, 80, 67, 59, 80, 25, 23, 35, 23, 31, 80, 80, 80, 42, 26, 17, 33, 12, 18, 76, 80, 46, 24, 18, 50, 16, 19, 25, 18, 17, 24, 29, 23, 16, 80, 22, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09146261807395283, "mean_inference_ms": 0.24191871692040023, "mean_action_processing_ms": 0.043587590281394875, "mean_env_wait_ms": 0.046305668318885496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015289411632292862, "StateBufferConnector_ms": 0.00123299589944542, "ViewRequirementAgentConnector_ms": 0.028528642216953663}}, "episode_reward_max": 0.9924509186296276, "episode_reward_min": -1.0, "episode_reward_mean": -0.18338545111502114, "episode_len_mean": 36.825688073394495, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8542903826974276, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.9303692047546628, 0.9230622919490857, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9473183169551619, 0.96253812533069, -1.0, -1.0, -1.0, -1.0, 0.5, 0.96785033222805, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5499326122542008, 0.5182686442306674, 0.893865844904426, -1.0, 0.5, 0.8024040972042847, -1.0, 0.6003525412883614, 0.8191020182823675, 0.5, 0.5783035724174264, -1.0, -1.0, 0.9924509186296276, -1.0, -1.0, -1.0, 0.7116609294641643, 0.8595036932946957, 0.5, 0.6261422700284207, 0.6538891611534623, 0.6852710378438764, 0.6159872469856171, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8675189789069865, 0.5937731966464947, 0.5800664744337539, 0.7704637619002022, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6418857294453673, 0.5, -1.0, 0.886069811664785, -1.0, -1.0, 0.54852579836361, 0.5, 0.793578360284926, 0.5, -1.0, -1.0, 0.8799017658078159, 0.5, 0.6177312412206619, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.838907467891421], "episode_lengths": [32, 17, 23, 35, 80, 16, 23, 40, 27, 29, 16, 80, 19, 31, 21, 80, 26, 24, 44, 80, 47, 80, 43, 23, 32, 31, 24, 80, 25, 34, 22, 18, 40, 21, 22, 53, 26, 21, 14, 26, 31, 17, 45, 34, 24, 16, 20, 25, 28, 24, 26, 24, 28, 44, 36, 39, 41, 80, 17, 17, 60, 18, 26, 22, 22, 18, 18, 80, 80, 20, 28, 80, 80, 80, 67, 59, 80, 25, 23, 35, 23, 31, 80, 80, 80, 42, 26, 17, 33, 12, 18, 76, 80, 46, 24, 18, 50, 16, 19, 25, 18, 17, 24, 29, 23, 16, 80, 22, 27]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09146261807395283, "mean_inference_ms": 0.24191871692040023, "mean_action_processing_ms": 0.043587590281394875, "mean_env_wait_ms": 0.046305668318885496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015289411632292862, "StateBufferConnector_ms": 0.00123299589944542, "ViewRequirementAgentConnector_ms": 0.028528642216953663}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1116.6212966763424, "num_env_steps_trained_throughput_per_sec": 1116.6212966763424, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 3564.828, "sample_time_ms": 1720.344, "load_time_ms": 0.198, "load_throughput": 20203776.493, "learn_time_ms": 1843.326, "learn_throughput": 2169.991, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 2457, "training_iteration": 34, "trial_id": "default", "date": "2024-05-22_22-17-01", "timestamp": 1716409021, "time_this_iter_s": 3.5848917961120605, "time_total_s": 120.89979076385498, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 120.89979076385498, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.64, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.109566987906733, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.25860224861015757, "policy_loss": -0.010823259694922356, "vf_loss": 0.2689755749197737, "vf_explained_var": 0.23200056982296768, "kl": 0.017997357516872935, "entropy": 2.163282532204864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 0.996238837107238, "episode_reward_min": -1.0, "episode_reward_mean": -0.1354099134511913, "episode_len_mean": 32.81147540983606, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.8530877816788448, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.815934709052242, -1.0, 0.5, 0.9493167348143376, -1.0, -1.0, 0.5228107023983299, 0.9366178875334243, 0.5522313402154021, 0.8962189889531983, -1.0, 0.5, -1.0, 0.5, 0.8666736615701572, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.9721370735083588, 0.9213664762509902, 0.8628483956940542, 0.5, -1.0, -1.0, 0.7139452630987999, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5322877776121655, -1.0, 0.5220444072443711, 0.6945685911838384, 0.7342850311581786, 0.6515106751172518, 0.7999730897706562, -1.0, 0.8304827464451292, 0.5, 0.5, -1.0, 0.528021734602509, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9034482489322444, 0.585953887381597, 0.509224610767192, -1.0, -1.0, 0.7550215569358525, 0.8008612794223294, 0.5, 0.9119295908835687, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.593590449675055, 0.906386475259221, 0.5, 0.6362767180337658, 0.9582514112056562, 0.9794433396299311, 0.7104769441711346, -1.0, -1.0, -1.0, 0.996238837107238, 0.5, -1.0, -1.0, -1.0, 0.6072974496361547, -1.0, 0.99522990917335, -1.0, -1.0, 0.5, -1.0, 0.8217253408665577, 0.5, -1.0, -1.0, 0.5029111799803967, -1.0, -1.0, -1.0, 0.9302063380619764, 0.8163669014066597, 0.9027870225225396, -1.0, -1.0], "episode_lengths": [56, 23, 19, 33, 80, 19, 15, 12, 18, 18, 77, 49, 20, 11, 60, 36, 17, 17, 22, 47, 19, 29, 49, 22, 28, 16, 28, 26, 20, 21, 50, 20, 50, 21, 80, 27, 21, 28, 20, 13, 47, 16, 21, 18, 24, 27, 18, 18, 25, 56, 24, 34, 42, 31, 24, 40, 25, 29, 66, 31, 78, 39, 53, 19, 25, 29, 33, 27, 25, 22, 41, 23, 20, 35, 22, 20, 31, 19, 80, 16, 71, 36, 40, 36, 29, 55, 24, 38, 34, 26, 43, 21, 22, 19, 29, 21, 36, 24, 22, 80, 41, 25, 29, 17, 23, 56, 80, 26, 23, 18, 45, 26, 36, 26, 31, 77, 23, 25, 25, 22, 33, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09159600874099419, "mean_inference_ms": 0.24194042380931155, "mean_action_processing_ms": 0.04359610445956619, "mean_env_wait_ms": 0.04632688708126921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015774711233670594, "StateBufferConnector_ms": 0.001240949161717149, "ViewRequirementAgentConnector_ms": 0.028687226967733414}}, "episode_reward_max": 0.996238837107238, "episode_reward_min": -1.0, "episode_reward_mean": -0.1354099134511913, "episode_len_mean": 32.81147540983606, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.8530877816788448, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.815934709052242, -1.0, 0.5, 0.9493167348143376, -1.0, -1.0, 0.5228107023983299, 0.9366178875334243, 0.5522313402154021, 0.8962189889531983, -1.0, 0.5, -1.0, 0.5, 0.8666736615701572, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.9721370735083588, 0.9213664762509902, 0.8628483956940542, 0.5, -1.0, -1.0, 0.7139452630987999, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5322877776121655, -1.0, 0.5220444072443711, 0.6945685911838384, 0.7342850311581786, 0.6515106751172518, 0.7999730897706562, -1.0, 0.8304827464451292, 0.5, 0.5, -1.0, 0.528021734602509, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9034482489322444, 0.585953887381597, 0.509224610767192, -1.0, -1.0, 0.7550215569358525, 0.8008612794223294, 0.5, 0.9119295908835687, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.593590449675055, 0.906386475259221, 0.5, 0.6362767180337658, 0.9582514112056562, 0.9794433396299311, 0.7104769441711346, -1.0, -1.0, -1.0, 0.996238837107238, 0.5, -1.0, -1.0, -1.0, 0.6072974496361547, -1.0, 0.99522990917335, -1.0, -1.0, 0.5, -1.0, 0.8217253408665577, 0.5, -1.0, -1.0, 0.5029111799803967, -1.0, -1.0, -1.0, 0.9302063380619764, 0.8163669014066597, 0.9027870225225396, -1.0, -1.0], "episode_lengths": [56, 23, 19, 33, 80, 19, 15, 12, 18, 18, 77, 49, 20, 11, 60, 36, 17, 17, 22, 47, 19, 29, 49, 22, 28, 16, 28, 26, 20, 21, 50, 20, 50, 21, 80, 27, 21, 28, 20, 13, 47, 16, 21, 18, 24, 27, 18, 18, 25, 56, 24, 34, 42, 31, 24, 40, 25, 29, 66, 31, 78, 39, 53, 19, 25, 29, 33, 27, 25, 22, 41, 23, 20, 35, 22, 20, 31, 19, 80, 16, 71, 36, 40, 36, 29, 55, 24, 38, 34, 26, 43, 21, 22, 19, 29, 21, 36, 24, 22, 80, 41, 25, 29, 17, 23, 56, 80, 26, 23, 18, 45, 26, 36, 26, 31, 77, 23, 25, 25, 22, 33, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09159600874099419, "mean_inference_ms": 0.24194042380931155, "mean_action_processing_ms": 0.04359610445956619, "mean_env_wait_ms": 0.04632688708126921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015774711233670594, "StateBufferConnector_ms": 0.001240949161717149, "ViewRequirementAgentConnector_ms": 0.028687226967733414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1120.086823136315, "num_env_steps_trained_throughput_per_sec": 1120.086823136315, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 3568.255, "sample_time_ms": 1723.156, "load_time_ms": 0.199, "load_throughput": 20102104.002, "learn_time_ms": 1843.937, "learn_throughput": 2169.271, "synch_weights_time_ms": 0.642}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 2579, "training_iteration": 35, "trial_id": "default", "date": "2024-05-22_22-17-04", "timestamp": 1716409024, "time_this_iter_s": 3.5741090774536133, "time_total_s": 124.4738998413086, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 124.4738998413086, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 18.14, "ram_util_percent": 61.279999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1777204124837795, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21375743622581164, "policy_loss": -0.01365914144953813, "vf_loss": 0.2271407191070818, "vf_explained_var": 0.5139935483855586, "kl": 0.011034326796856196, "entropy": 2.1585979259142314, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 0.9790306240703943, "episode_reward_min": -1.0, "episode_reward_mean": -0.020436009747984527, "episode_len_mean": 35.972972972972975, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.8633465510062738, -1.0, -1.0, 0.5, 0.9518815271700305, -1.0, -1.0, -1.0, 0.8870527319713373, -1.0, 0.9733233217273017, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7563059675158381, 0.966198132780548, 0.9210128834034004, 0.814218613320874, -1.0, 0.924094770116048, -1.0, 0.5, -1.0, 0.6924284798337161, 0.5, 0.6214934753486572, 0.5, -1.0, 0.9778676783987644, 0.9442725944879036, -1.0, -1.0, 0.5, 0.6402216882678489, -1.0, 0.5, 0.6492267635905129, -1.0, 0.5, -1.0, 0.7507330195261046, -1.0, 0.5025434390701158, 0.7616830664639809, 0.9117910945514478, 0.8166851385217057, 0.9574417367367334, -1.0, -1.0, 0.5, 0.5, 0.6411076092111958, -1.0, 0.8097954385767323, 0.6180290658545866, -1.0, -1.0, -1.0, 0.5880890681552027, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9007795996904961, -1.0, 0.9624312968320611, -1.0, 0.8293703956808549, 0.727439247309368, -1.0, 0.5231722021982503, -1.0, 0.9281205899113903, 0.5, -1.0, 0.6346842922645521, -1.0, 0.9789487431131412, 0.9238505950027978, 0.7163841516436463, 0.5, 0.6873126470576392, 0.5, 0.5, -1.0, 0.6132466159436749, -1.0, 0.852644559252202, -1.0, 0.6788154429258071, -1.0, 0.9790306240703943, 0.5, -1.0, 0.7720321006035789, -1.0, 0.962119567178234, 0.6203763916887679, 0.5, -1.0], "episode_lengths": [19, 50, 36, 27, 11, 41, 80, 30, 13, 41, 38, 24, 57, 22, 17, 21, 80, 21, 67, 80, 80, 15, 19, 19, 18, 21, 23, 14, 19, 74, 43, 28, 17, 29, 37, 30, 52, 27, 31, 23, 80, 20, 27, 80, 21, 25, 44, 20, 80, 53, 80, 23, 19, 30, 21, 19, 20, 55, 19, 37, 24, 80, 25, 16, 13, 24, 44, 24, 80, 22, 16, 13, 42, 12, 37, 23, 45, 23, 36, 29, 13, 73, 31, 26, 21, 80, 51, 76, 17, 30, 21, 21, 22, 35, 19, 80, 19, 80, 39, 44, 27, 18, 17, 31, 80, 21, 80, 24, 32, 35, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09169477456847867, "mean_inference_ms": 0.2419659795382357, "mean_action_processing_ms": 0.04360768214882139, "mean_env_wait_ms": 0.046344049471894744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001508480793720967, "StateBufferConnector_ms": 0.00121077975711307, "ViewRequirementAgentConnector_ms": 0.028519587473826366}}, "episode_reward_max": 0.9790306240703943, "episode_reward_min": -1.0, "episode_reward_mean": -0.020436009747984527, "episode_len_mean": 35.972972972972975, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.8633465510062738, -1.0, -1.0, 0.5, 0.9518815271700305, -1.0, -1.0, -1.0, 0.8870527319713373, -1.0, 0.9733233217273017, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7563059675158381, 0.966198132780548, 0.9210128834034004, 0.814218613320874, -1.0, 0.924094770116048, -1.0, 0.5, -1.0, 0.6924284798337161, 0.5, 0.6214934753486572, 0.5, -1.0, 0.9778676783987644, 0.9442725944879036, -1.0, -1.0, 0.5, 0.6402216882678489, -1.0, 0.5, 0.6492267635905129, -1.0, 0.5, -1.0, 0.7507330195261046, -1.0, 0.5025434390701158, 0.7616830664639809, 0.9117910945514478, 0.8166851385217057, 0.9574417367367334, -1.0, -1.0, 0.5, 0.5, 0.6411076092111958, -1.0, 0.8097954385767323, 0.6180290658545866, -1.0, -1.0, -1.0, 0.5880890681552027, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9007795996904961, -1.0, 0.9624312968320611, -1.0, 0.8293703956808549, 0.727439247309368, -1.0, 0.5231722021982503, -1.0, 0.9281205899113903, 0.5, -1.0, 0.6346842922645521, -1.0, 0.9789487431131412, 0.9238505950027978, 0.7163841516436463, 0.5, 0.6873126470576392, 0.5, 0.5, -1.0, 0.6132466159436749, -1.0, 0.852644559252202, -1.0, 0.6788154429258071, -1.0, 0.9790306240703943, 0.5, -1.0, 0.7720321006035789, -1.0, 0.962119567178234, 0.6203763916887679, 0.5, -1.0], "episode_lengths": [19, 50, 36, 27, 11, 41, 80, 30, 13, 41, 38, 24, 57, 22, 17, 21, 80, 21, 67, 80, 80, 15, 19, 19, 18, 21, 23, 14, 19, 74, 43, 28, 17, 29, 37, 30, 52, 27, 31, 23, 80, 20, 27, 80, 21, 25, 44, 20, 80, 53, 80, 23, 19, 30, 21, 19, 20, 55, 19, 37, 24, 80, 25, 16, 13, 24, 44, 24, 80, 22, 16, 13, 42, 12, 37, 23, 45, 23, 36, 29, 13, 73, 31, 26, 21, 80, 51, 76, 17, 30, 21, 21, 22, 35, 19, 80, 19, 80, 39, 44, 27, 18, 17, 31, 80, 21, 80, 24, 32, 35, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09169477456847867, "mean_inference_ms": 0.2419659795382357, "mean_action_processing_ms": 0.04360768214882139, "mean_env_wait_ms": 0.046344049471894744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001508480793720967, "StateBufferConnector_ms": 0.00121077975711307, "ViewRequirementAgentConnector_ms": 0.028519587473826366}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1089.0567852355998, "num_env_steps_trained_throughput_per_sec": 1089.0567852355998, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3581.437, "sample_time_ms": 1725.028, "load_time_ms": 0.199, "load_throughput": 20140715.486, "learn_time_ms": 1855.231, "learn_throughput": 2156.066, "synch_weights_time_ms": 0.652}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 2690, "training_iteration": 36, "trial_id": "default", "date": "2024-05-22_22-17-08", "timestamp": 1716409028, "time_this_iter_s": 3.6757771968841553, "time_total_s": 128.14967703819275, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.14967703819275, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.24, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0933712380547678, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20562570693124066, "policy_loss": -0.019865017789115588, "vf_loss": 0.2251200411588915, "vf_explained_var": 0.26698398519587774, "kl": 0.014827315120414747, "entropy": 2.1012735832122065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 0.9992138944709112, "episode_reward_min": -1.0, "episode_reward_mean": -0.061993956700444, "episode_len_mean": 37.91509433962264, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7611752024303541, 0.6236738189884855, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8651405785897878, 0.5, 0.5801422952937156, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6912857741858485, -1.0, 0.7641295008644621, 0.9857905234441, 0.7727066105078401, -1.0, 0.7081840446260105, -1.0, 0.7196889597729421, 0.5, 0.9787518618562454, 0.5, 0.6425863987757646, 0.5, 0.9545539102850035, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.791191900171579, 0.5, 0.843895381184399, 0.5, -1.0, 0.9229807907510128, -1.0, 0.5, -1.0, -1.0, 0.6626894335195683, -1.0, -1.0, -1.0, 0.9877491122881487, 0.5510005242912042, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.797426910346266, -1.0, 0.928821433738568, 0.5, 0.9425998726033711, 0.5, 0.5, -1.0, 0.9533294409070798, 0.9992138944709112, -1.0, -1.0, -1.0, -1.0, 0.6282271588214484, 0.5, 0.9100726645961166, 0.7732353253898918, 0.9873305318350324, 0.8043547419297044, 0.6387934365481662, 0.9195007710630235, -1.0, -1.0, 0.9770363854854314, 0.8417471578517703, 0.5, -1.0, 0.530521602166507, 0.9891126401731763, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [63, 43, 33, 80, 25, 20, 18, 15, 24, 19, 66, 80, 80, 21, 23, 21, 34, 19, 42, 37, 27, 75, 18, 20, 28, 35, 72, 42, 26, 33, 80, 37, 44, 17, 20, 23, 22, 27, 72, 29, 80, 51, 31, 23, 19, 36, 17, 22, 45, 23, 24, 80, 27, 23, 25, 18, 80, 21, 25, 13, 33, 21, 24, 80, 50, 30, 80, 42, 19, 58, 30, 19, 53, 52, 39, 32, 27, 24, 37, 27, 27, 22, 77, 80, 63, 28, 33, 25, 26, 26, 19, 18, 19, 80, 80, 35, 24, 25, 58, 21, 24, 20, 18, 78, 80, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09177239211618685, "mean_inference_ms": 0.2419709951492374, "mean_action_processing_ms": 0.043616918385648636, "mean_env_wait_ms": 0.04635349573210678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015440976844643647, "StateBufferConnector_ms": 0.00123910184176463, "ViewRequirementAgentConnector_ms": 0.028632721810970665}}, "episode_reward_max": 0.9992138944709112, "episode_reward_min": -1.0, "episode_reward_mean": -0.061993956700444, "episode_len_mean": 37.91509433962264, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7611752024303541, 0.6236738189884855, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8651405785897878, 0.5, 0.5801422952937156, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6912857741858485, -1.0, 0.7641295008644621, 0.9857905234441, 0.7727066105078401, -1.0, 0.7081840446260105, -1.0, 0.7196889597729421, 0.5, 0.9787518618562454, 0.5, 0.6425863987757646, 0.5, 0.9545539102850035, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.791191900171579, 0.5, 0.843895381184399, 0.5, -1.0, 0.9229807907510128, -1.0, 0.5, -1.0, -1.0, 0.6626894335195683, -1.0, -1.0, -1.0, 0.9877491122881487, 0.5510005242912042, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.797426910346266, -1.0, 0.928821433738568, 0.5, 0.9425998726033711, 0.5, 0.5, -1.0, 0.9533294409070798, 0.9992138944709112, -1.0, -1.0, -1.0, -1.0, 0.6282271588214484, 0.5, 0.9100726645961166, 0.7732353253898918, 0.9873305318350324, 0.8043547419297044, 0.6387934365481662, 0.9195007710630235, -1.0, -1.0, 0.9770363854854314, 0.8417471578517703, 0.5, -1.0, 0.530521602166507, 0.9891126401731763, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [63, 43, 33, 80, 25, 20, 18, 15, 24, 19, 66, 80, 80, 21, 23, 21, 34, 19, 42, 37, 27, 75, 18, 20, 28, 35, 72, 42, 26, 33, 80, 37, 44, 17, 20, 23, 22, 27, 72, 29, 80, 51, 31, 23, 19, 36, 17, 22, 45, 23, 24, 80, 27, 23, 25, 18, 80, 21, 25, 13, 33, 21, 24, 80, 50, 30, 80, 42, 19, 58, 30, 19, 53, 52, 39, 32, 27, 24, 37, 27, 27, 22, 77, 80, 63, 28, 33, 25, 26, 26, 19, 18, 19, 80, 80, 35, 24, 25, 58, 21, 24, 20, 18, 78, 80, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09177239211618685, "mean_inference_ms": 0.2419709951492374, "mean_action_processing_ms": 0.043616918385648636, "mean_env_wait_ms": 0.04635349573210678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015440976844643647, "StateBufferConnector_ms": 0.00123910184176463, "ViewRequirementAgentConnector_ms": 0.028632721810970665}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1116.5061162145653, "num_env_steps_trained_throughput_per_sec": 1116.5061162145653, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 3585.288, "sample_time_ms": 1725.914, "load_time_ms": 0.197, "load_throughput": 20304025.172, "learn_time_ms": 1858.198, "learn_throughput": 2152.623, "synch_weights_time_ms": 0.652}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 2796, "training_iteration": 37, "trial_id": "default", "date": "2024-05-22_22-17-11", "timestamp": 1716409031, "time_this_iter_s": 3.5853610038757324, "time_total_s": 131.73503804206848, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 131.73503804206848, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.619999999999997, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9248333986728423, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22870734454563227, "policy_loss": -0.006310097224539727, "vf_loss": 0.23473721495078456, "vf_explained_var": 0.22095393814066405, "kl": 0.011209058190769736, "entropy": 2.0990658262724518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 0.9916308749869114, "episode_reward_min": -1.0, "episode_reward_mean": -0.1624256257318424, "episode_len_mean": 36.336363636363636, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5433507408837883, -1.0, -1.0, -1.0, 0.5, 0.9072823448887134, -1.0, 0.5, 0.6323205220477846, -1.0, -1.0, -1.0, 0.7671978929450265, -1.0, 0.7430310499331381, 0.5, -1.0, -1.0, 0.9916308749869114, 0.9004663968181142, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.9302727729313626, 0.8470653438144754, -1.0, 0.5, 0.6444662944811596, -1.0, -1.0, 0.5, 0.8570048686657901, 0.5241962870624344, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.8154182768679489, -1.0, 0.5724966736310227, 0.5, 0.7797054899556528, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9576326026309161, 0.9231188171828686, 0.8504095839967537, -1.0, 0.5, 0.682620613993089, 0.9259584097865727, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9440705380604649, 0.5380806872916023, -1.0, 0.9443854806867057, -1.0, 0.690330277294988, -1.0, -1.0, 0.6928754926238548, 0.5, 0.6944941044502566, -1.0, 0.5433973550767484, -1.0, 0.5, -1.0, 0.6021148215532228, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7956166069636965, -1.0, 0.8723088240485717, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5198611239436979], "episode_lengths": [23, 12, 20, 31, 27, 17, 35, 44, 31, 80, 80, 19, 20, 21, 29, 64, 80, 24, 28, 29, 24, 80, 28, 16, 30, 13, 31, 25, 26, 13, 21, 26, 33, 21, 20, 20, 31, 13, 78, 20, 36, 80, 80, 18, 79, 23, 68, 55, 20, 45, 39, 54, 28, 35, 25, 80, 33, 50, 80, 20, 22, 22, 39, 28, 41, 21, 69, 42, 17, 45, 80, 17, 25, 80, 15, 14, 24, 13, 72, 19, 19, 29, 80, 36, 23, 20, 16, 14, 35, 54, 21, 19, 37, 36, 66, 79, 39, 14, 80, 16, 37, 29, 19, 22, 23, 36, 23, 18, 80, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0918582626369777, "mean_inference_ms": 0.24199458329481732, "mean_action_processing_ms": 0.043621977749881344, "mean_env_wait_ms": 0.0463659034391857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015109235590154474, "StateBufferConnector_ms": 0.0012291561473499644, "ViewRequirementAgentConnector_ms": 0.02857208251953125}}, "episode_reward_max": 0.9916308749869114, "episode_reward_min": -1.0, "episode_reward_mean": -0.1624256257318424, "episode_len_mean": 36.336363636363636, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5433507408837883, -1.0, -1.0, -1.0, 0.5, 0.9072823448887134, -1.0, 0.5, 0.6323205220477846, -1.0, -1.0, -1.0, 0.7671978929450265, -1.0, 0.7430310499331381, 0.5, -1.0, -1.0, 0.9916308749869114, 0.9004663968181142, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.9302727729313626, 0.8470653438144754, -1.0, 0.5, 0.6444662944811596, -1.0, -1.0, 0.5, 0.8570048686657901, 0.5241962870624344, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.8154182768679489, -1.0, 0.5724966736310227, 0.5, 0.7797054899556528, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9576326026309161, 0.9231188171828686, 0.8504095839967537, -1.0, 0.5, 0.682620613993089, 0.9259584097865727, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9440705380604649, 0.5380806872916023, -1.0, 0.9443854806867057, -1.0, 0.690330277294988, -1.0, -1.0, 0.6928754926238548, 0.5, 0.6944941044502566, -1.0, 0.5433973550767484, -1.0, 0.5, -1.0, 0.6021148215532228, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7956166069636965, -1.0, 0.8723088240485717, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5198611239436979], "episode_lengths": [23, 12, 20, 31, 27, 17, 35, 44, 31, 80, 80, 19, 20, 21, 29, 64, 80, 24, 28, 29, 24, 80, 28, 16, 30, 13, 31, 25, 26, 13, 21, 26, 33, 21, 20, 20, 31, 13, 78, 20, 36, 80, 80, 18, 79, 23, 68, 55, 20, 45, 39, 54, 28, 35, 25, 80, 33, 50, 80, 20, 22, 22, 39, 28, 41, 21, 69, 42, 17, 45, 80, 17, 25, 80, 15, 14, 24, 13, 72, 19, 19, 29, 80, 36, 23, 20, 16, 14, 35, 54, 21, 19, 37, 36, 66, 79, 39, 14, 80, 16, 37, 29, 19, 22, 23, 36, 23, 18, 80, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0918582626369777, "mean_inference_ms": 0.24199458329481732, "mean_action_processing_ms": 0.043621977749881344, "mean_env_wait_ms": 0.0463659034391857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015109235590154474, "StateBufferConnector_ms": 0.0012291561473499644, "ViewRequirementAgentConnector_ms": 0.02857208251953125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1120.3333511405524, "num_env_steps_trained_throughput_per_sec": 1120.3333511405524, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 3587.668, "sample_time_ms": 1728.265, "load_time_ms": 0.197, "load_throughput": 20254999.396, "learn_time_ms": 1858.23, "learn_throughput": 2152.586, "synch_weights_time_ms": 0.65}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 2906, "training_iteration": 38, "trial_id": "default", "date": "2024-05-22_22-17-15", "timestamp": 1716409035, "time_this_iter_s": 3.5730462074279785, "time_total_s": 135.30808424949646, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.30808424949646, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 14.5, "ram_util_percent": 61.18000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5953434215758437, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16956598606281062, "policy_loss": -0.010324493391058778, "vf_loss": 0.17954635582363573, "vf_explained_var": 0.5041107134793394, "kl": 0.013764986773357413, "entropy": 2.005161968995166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 0.9833469066536101, "episode_reward_min": -1.0, "episode_reward_mean": -0.04622082349805306, "episode_len_mean": 38.84466019417476, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.9757484239187371, 0.743454649900591, 0.9703057434268427, -1.0, 0.7597529207077092, -1.0, -1.0, -1.0, 0.5983916760482656, 0.8548086048866516, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5642204841110581, 0.8690090930685391, 0.5, 0.7464599059304212, 0.5581286876762215, -1.0, 0.5, -1.0, 0.9833469066536101, 0.8691630654978144, -1.0, -1.0, 0.5771913265102289, 0.7072441312406841, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5851948398722617, 0.5, 0.9752160157389556, 0.5, -1.0, 0.7465811540256457, 0.9581619023019666, 0.8383159736165513, -1.0, 0.759848971154825, 0.5, -1.0, 0.5587163013651371, 0.5, -1.0, 0.7103319574248681, -1.0, 0.8856135488658848, 0.6335074827129532, -1.0, -1.0, -1.0, 0.8197624439894177, -1.0, 0.5, 0.9481690089742838, 0.7309074173531738, 0.9683109257653768, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5982527517153386, -1.0, 0.6512583763037644, -1.0, -1.0, -1.0, -1.0, 0.5151118471813412, 0.828645722421331, 0.822167295675611, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.792761537846576, 0.6334800156034218, 0.5585005634176452, -1.0, 0.5, -1.0, 0.6471797282200838, -1.0, -1.0, 0.5, 0.5, 0.5, 0.796033778576746, -1.0], "episode_lengths": [28, 80, 17, 27, 16, 24, 80, 20, 58, 42, 80, 29, 25, 44, 80, 27, 26, 80, 32, 20, 43, 25, 21, 27, 80, 16, 80, 27, 22, 23, 25, 22, 28, 80, 80, 17, 51, 35, 37, 22, 33, 31, 33, 26, 19, 24, 80, 28, 19, 80, 26, 20, 55, 45, 40, 26, 21, 80, 43, 32, 60, 27, 35, 33, 23, 30, 41, 24, 64, 27, 80, 20, 22, 21, 35, 21, 16, 75, 26, 80, 31, 22, 24, 26, 36, 32, 80, 15, 37, 28, 18, 35, 36, 19, 21, 23, 80, 80, 21, 46, 66, 28, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09191915692902897, "mean_inference_ms": 0.24201018372517114, "mean_action_processing_ms": 0.043630190387319225, "mean_env_wait_ms": 0.046374234621895036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015749514681621664, "StateBufferConnector_ms": 0.001201814818150789, "ViewRequirementAgentConnector_ms": 0.028491714625682646}}, "episode_reward_max": 0.9833469066536101, "episode_reward_min": -1.0, "episode_reward_mean": -0.04622082349805306, "episode_len_mean": 38.84466019417476, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.9757484239187371, 0.743454649900591, 0.9703057434268427, -1.0, 0.7597529207077092, -1.0, -1.0, -1.0, 0.5983916760482656, 0.8548086048866516, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5642204841110581, 0.8690090930685391, 0.5, 0.7464599059304212, 0.5581286876762215, -1.0, 0.5, -1.0, 0.9833469066536101, 0.8691630654978144, -1.0, -1.0, 0.5771913265102289, 0.7072441312406841, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5851948398722617, 0.5, 0.9752160157389556, 0.5, -1.0, 0.7465811540256457, 0.9581619023019666, 0.8383159736165513, -1.0, 0.759848971154825, 0.5, -1.0, 0.5587163013651371, 0.5, -1.0, 0.7103319574248681, -1.0, 0.8856135488658848, 0.6335074827129532, -1.0, -1.0, -1.0, 0.8197624439894177, -1.0, 0.5, 0.9481690089742838, 0.7309074173531738, 0.9683109257653768, 0.5, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5982527517153386, -1.0, 0.6512583763037644, -1.0, -1.0, -1.0, -1.0, 0.5151118471813412, 0.828645722421331, 0.822167295675611, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.792761537846576, 0.6334800156034218, 0.5585005634176452, -1.0, 0.5, -1.0, 0.6471797282200838, -1.0, -1.0, 0.5, 0.5, 0.5, 0.796033778576746, -1.0], "episode_lengths": [28, 80, 17, 27, 16, 24, 80, 20, 58, 42, 80, 29, 25, 44, 80, 27, 26, 80, 32, 20, 43, 25, 21, 27, 80, 16, 80, 27, 22, 23, 25, 22, 28, 80, 80, 17, 51, 35, 37, 22, 33, 31, 33, 26, 19, 24, 80, 28, 19, 80, 26, 20, 55, 45, 40, 26, 21, 80, 43, 32, 60, 27, 35, 33, 23, 30, 41, 24, 64, 27, 80, 20, 22, 21, 35, 21, 16, 75, 26, 80, 31, 22, 24, 26, 36, 32, 80, 15, 37, 28, 18, 35, 36, 19, 21, 23, 80, 80, 21, 46, 66, 28, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09191915692902897, "mean_inference_ms": 0.24201018372517114, "mean_action_processing_ms": 0.043630190387319225, "mean_env_wait_ms": 0.046374234621895036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015749514681621664, "StateBufferConnector_ms": 0.001201814818150789, "ViewRequirementAgentConnector_ms": 0.028491714625682646}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1123.6999788484304, "num_env_steps_trained_throughput_per_sec": 1123.6999788484304, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 3581.34, "sample_time_ms": 1729.474, "load_time_ms": 0.197, "load_throughput": 20333554.721, "learn_time_ms": 1850.701, "learn_throughput": 2161.343, "synch_weights_time_ms": 0.644}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 3009, "training_iteration": 39, "trial_id": "default", "date": "2024-05-22_22-17-19", "timestamp": 1716409039, "time_this_iter_s": 3.5622551441192627, "time_total_s": 138.87033939361572, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 138.87033939361572, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.36, "ram_util_percent": 61.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.806678895796499, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21012099616884214, "policy_loss": -0.008250359590015103, "vf_loss": 0.21799545095212036, "vf_explained_var": 0.26699334543238407, "kl": 0.015036170160866235, "entropy": 1.9230493422477477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 0.9718721662038914, "episode_reward_min": -1.0, "episode_reward_mean": -0.01825260720359199, "episode_len_mean": 38.40384615384615, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.7309708166022681, 0.8601841240310071, -1.0, -1.0, 0.5, -1.0, 0.6145847865577975, -1.0, -1.0, 0.5047850217614764, -1.0, 0.6645996859986533, -1.0, -1.0, 0.824142228534626, 0.916610304013845, 0.5, 0.5087234755308012, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.872510655033137, 0.517694075585263, -1.0, 0.9009702747751682, -1.0, 0.6514438009421193, 0.5, 0.5, -1.0, -1.0, 0.9101815703701606, 0.5, 0.9718721662038914, 0.7474916305606373, 0.5968487318137625, 0.9696379087964203, 0.5337231437270131, -1.0, -1.0, 0.5, 0.5695606562541722, 0.7341790816993059, -1.0, -1.0, -1.0, 0.731991923097677, 0.5, 0.7829705317881203, 0.5, -1.0, -1.0, 0.7627884023932605, -1.0, 0.5, -1.0, -1.0, 0.8251370158093873, 0.9157318578313544, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.6280763434621253, 0.9270443790944904, 0.5, 0.5, 0.5, 0.8405554279311083, 0.7580950242122712, 0.6373421843984921, 0.5, 0.6804504205973567, 0.5, 0.6716488169816208, 0.5, 0.7670694387144211, 0.6184433882985867, 0.5, 0.5, -1.0, 0.5521871634413826, -1.0, -1.0, 0.6488266251038066, 0.802760132508979, 0.949895636370468, -1.0, -1.0, 0.5, -1.0, 0.5], "episode_lengths": [23, 51, 21, 21, 20, 26, 17, 20, 29, 21, 23, 26, 27, 26, 42, 80, 22, 16, 70, 27, 35, 23, 19, 12, 23, 19, 21, 19, 35, 80, 35, 80, 23, 70, 23, 32, 80, 22, 69, 18, 62, 31, 16, 20, 28, 25, 40, 25, 22, 80, 80, 80, 24, 22, 46, 56, 80, 61, 18, 80, 27, 73, 80, 17, 30, 33, 27, 38, 45, 80, 21, 80, 17, 80, 62, 33, 28, 37, 27, 35, 31, 26, 29, 27, 21, 18, 16, 17, 63, 15, 28, 43, 80, 26, 55, 80, 24, 26, 15, 20, 66, 33, 80, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09197997779847863, "mean_inference_ms": 0.24201437669714063, "mean_action_processing_ms": 0.04363691206801708, "mean_env_wait_ms": 0.04638468093953608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001611617895273062, "StateBufferConnector_ms": 0.0012179979911217322, "ViewRequirementAgentConnector_ms": 0.028586387634277344}}, "episode_reward_max": 0.9718721662038914, "episode_reward_min": -1.0, "episode_reward_mean": -0.01825260720359199, "episode_len_mean": 38.40384615384615, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.7309708166022681, 0.8601841240310071, -1.0, -1.0, 0.5, -1.0, 0.6145847865577975, -1.0, -1.0, 0.5047850217614764, -1.0, 0.6645996859986533, -1.0, -1.0, 0.824142228534626, 0.916610304013845, 0.5, 0.5087234755308012, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.872510655033137, 0.517694075585263, -1.0, 0.9009702747751682, -1.0, 0.6514438009421193, 0.5, 0.5, -1.0, -1.0, 0.9101815703701606, 0.5, 0.9718721662038914, 0.7474916305606373, 0.5968487318137625, 0.9696379087964203, 0.5337231437270131, -1.0, -1.0, 0.5, 0.5695606562541722, 0.7341790816993059, -1.0, -1.0, -1.0, 0.731991923097677, 0.5, 0.7829705317881203, 0.5, -1.0, -1.0, 0.7627884023932605, -1.0, 0.5, -1.0, -1.0, 0.8251370158093873, 0.9157318578313544, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.6280763434621253, 0.9270443790944904, 0.5, 0.5, 0.5, 0.8405554279311083, 0.7580950242122712, 0.6373421843984921, 0.5, 0.6804504205973567, 0.5, 0.6716488169816208, 0.5, 0.7670694387144211, 0.6184433882985867, 0.5, 0.5, -1.0, 0.5521871634413826, -1.0, -1.0, 0.6488266251038066, 0.802760132508979, 0.949895636370468, -1.0, -1.0, 0.5, -1.0, 0.5], "episode_lengths": [23, 51, 21, 21, 20, 26, 17, 20, 29, 21, 23, 26, 27, 26, 42, 80, 22, 16, 70, 27, 35, 23, 19, 12, 23, 19, 21, 19, 35, 80, 35, 80, 23, 70, 23, 32, 80, 22, 69, 18, 62, 31, 16, 20, 28, 25, 40, 25, 22, 80, 80, 80, 24, 22, 46, 56, 80, 61, 18, 80, 27, 73, 80, 17, 30, 33, 27, 38, 45, 80, 21, 80, 17, 80, 62, 33, 28, 37, 27, 35, 31, 26, 29, 27, 21, 18, 16, 17, 63, 15, 28, 43, 80, 26, 55, 80, 24, 26, 15, 20, 66, 33, 80, 43]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09197997779847863, "mean_inference_ms": 0.24201437669714063, "mean_action_processing_ms": 0.04363691206801708, "mean_env_wait_ms": 0.04638468093953608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001611617895273062, "StateBufferConnector_ms": 0.0012179979911217322, "ViewRequirementAgentConnector_ms": 0.028586387634277344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1124.7354204101218, "num_env_steps_trained_throughput_per_sec": 1124.7354204101218, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 3581.422, "sample_time_ms": 1729.359, "load_time_ms": 0.197, "load_throughput": 20353288.851, "learn_time_ms": 1850.897, "learn_throughput": 2161.114, "synch_weights_time_ms": 0.646}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 3113, "training_iteration": 40, "trial_id": "default", "date": "2024-05-22_22-17-22", "timestamp": 1716409042, "time_this_iter_s": 3.559030055999756, "time_total_s": 142.42936944961548, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.42936944961548, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.96, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.970177927581213, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17872866720001224, "policy_loss": 6.439193422275204e-05, "vf_loss": 0.1783121651429082, "vf_explained_var": 0.35812113759338216, "kl": 0.014084487731974859, "entropy": 2.058766959559533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 0.9997045840864872, "episode_reward_min": -1.0, "episode_reward_mean": -0.07568209179086727, "episode_len_mean": 37.44859813084112, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.9488291916691977, 0.9571221851553029, -1.0, 0.9430728141329852, 0.5, 0.5, 0.8064761192948106, 0.5047635986352738, -1.0, -1.0, -1.0, 0.8650816957597908, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.6103741417157631, -1.0, 0.6651303438546605, 0.5592312055158317, 0.9098434449431643, 0.5, -1.0, 0.7937681677734012, -1.0, 0.5, -1.0, -1.0, 0.7981533877319094, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5556597723240646, 0.5, 0.6805895971813858, -1.0, -1.0, 0.7223351707971402, -1.0, -1.0, 0.5, 0.8493412150920748, 0.9325018316584969, -1.0, 0.7887211195202508, 0.6856443886670562, -1.0, 0.6348867671368132, -1.0, -1.0, 0.5622323996907539, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9166691751165971, 0.5, 0.974749050617963, -1.0, 0.8707413771659205, -1.0, -1.0, -1.0, 0.7279980412159469, 0.7332928686170429, 0.9997045840864872, 0.7977777278800069, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5427852400509814, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.9262358914097265, 0.6627340635225916, 0.5, 0.9755696004438127], "episode_lengths": [22, 20, 35, 80, 19, 19, 21, 34, 16, 19, 19, 32, 20, 29, 20, 20, 25, 80, 80, 26, 49, 80, 72, 24, 80, 20, 80, 42, 24, 25, 21, 18, 29, 27, 20, 25, 25, 53, 23, 24, 78, 19, 45, 14, 19, 36, 23, 19, 38, 38, 80, 21, 21, 22, 80, 80, 53, 80, 80, 28, 22, 17, 80, 28, 19, 26, 22, 41, 18, 16, 28, 21, 14, 22, 36, 17, 33, 17, 80, 26, 19, 23, 62, 31, 51, 23, 21, 33, 80, 80, 80, 80, 55, 24, 32, 70, 80, 80, 39, 33, 19, 24, 25, 28, 20, 19, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09203806150888591, "mean_inference_ms": 0.2420275398331758, "mean_action_processing_ms": 0.04363984590800761, "mean_env_wait_ms": 0.04639357388200918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015330091815128504, "StateBufferConnector_ms": 0.0012408907168379455, "ViewRequirementAgentConnector_ms": 0.028480993253048335}}, "episode_reward_max": 0.9997045840864872, "episode_reward_min": -1.0, "episode_reward_mean": -0.07568209179086727, "episode_len_mean": 37.44859813084112, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.9488291916691977, 0.9571221851553029, -1.0, 0.9430728141329852, 0.5, 0.5, 0.8064761192948106, 0.5047635986352738, -1.0, -1.0, -1.0, 0.8650816957597908, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.6103741417157631, -1.0, 0.6651303438546605, 0.5592312055158317, 0.9098434449431643, 0.5, -1.0, 0.7937681677734012, -1.0, 0.5, -1.0, -1.0, 0.7981533877319094, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5556597723240646, 0.5, 0.6805895971813858, -1.0, -1.0, 0.7223351707971402, -1.0, -1.0, 0.5, 0.8493412150920748, 0.9325018316584969, -1.0, 0.7887211195202508, 0.6856443886670562, -1.0, 0.6348867671368132, -1.0, -1.0, 0.5622323996907539, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9166691751165971, 0.5, 0.974749050617963, -1.0, 0.8707413771659205, -1.0, -1.0, -1.0, 0.7279980412159469, 0.7332928686170429, 0.9997045840864872, 0.7977777278800069, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5427852400509814, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.9262358914097265, 0.6627340635225916, 0.5, 0.9755696004438127], "episode_lengths": [22, 20, 35, 80, 19, 19, 21, 34, 16, 19, 19, 32, 20, 29, 20, 20, 25, 80, 80, 26, 49, 80, 72, 24, 80, 20, 80, 42, 24, 25, 21, 18, 29, 27, 20, 25, 25, 53, 23, 24, 78, 19, 45, 14, 19, 36, 23, 19, 38, 38, 80, 21, 21, 22, 80, 80, 53, 80, 80, 28, 22, 17, 80, 28, 19, 26, 22, 41, 18, 16, 28, 21, 14, 22, 36, 17, 33, 17, 80, 26, 19, 23, 62, 31, 51, 23, 21, 33, 80, 80, 80, 80, 55, 24, 32, 70, 80, 80, 39, 33, 19, 24, 25, 28, 20, 19, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09203806150888591, "mean_inference_ms": 0.2420275398331758, "mean_action_processing_ms": 0.04363984590800761, "mean_env_wait_ms": 0.04639357388200918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015330091815128504, "StateBufferConnector_ms": 0.0012408907168379455, "ViewRequirementAgentConnector_ms": 0.028480993253048335}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1123.0464000222773, "num_env_steps_trained_throughput_per_sec": 1123.0464000222773, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 3581.214, "sample_time_ms": 1728.548, "load_time_ms": 0.196, "load_throughput": 20373061.324, "learn_time_ms": 1851.49, "learn_throughput": 2160.422, "synch_weights_time_ms": 0.655}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 3220, "training_iteration": 41, "trial_id": "default", "date": "2024-05-22_22-17-26", "timestamp": 1716409046, "time_this_iter_s": 3.5644800662994385, "time_total_s": 145.99384951591492, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 145.99384951591492, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.099999999999998, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8884627838288583, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23505795314358496, "policy_loss": -0.006192991614181509, "vf_loss": 0.24082127653302685, "vf_explained_var": 0.34300395288775043, "kl": 0.01718673981793266, "entropy": 2.0059262516678023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 0.9997090624146456, "episode_reward_min": -1.0, "episode_reward_mean": 0.09849362306029567, "episode_len_mean": 31.975806451612904, "episode_media": {}, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5458483185668934, -1.0, -1.0, 0.5, 0.5, 0.5456328095458449, 0.7535446234013378, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.9303129217213678, 0.6354816327392727, -1.0, 0.8636619254501465, 0.5, 0.9576799204680948, -1.0, -1.0, -1.0, 0.8832457801261802, 0.6985150761024003, -1.0, 0.5, -1.0, 0.9810058231592915, -1.0, 0.5888743762059778, 0.5, -1.0, 0.9997090624146456, 0.5, 0.5191617306740192, 0.7255718968643398, 0.5, -1.0, 0.5, 0.7098891100508367, -1.0, -1.0, -1.0, 0.5, 0.8813268511415872, 0.5, 0.6795503143664683, 0.5115919878126531, -1.0, 0.5, 0.5, 0.8965208750811862, -1.0, 0.5, 0.5935084986862382, 0.7145673479878665, 0.9114812245195943, 0.5643268365880136, 0.5, -1.0, 0.5389002582515732, -1.0, 0.5, 0.8005022882237545, 0.9419273772926302, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5456341016995532, 0.9275745986749224, -1.0, -1.0, 0.7917289546007602, -1.0, 0.5, 0.8371978639394626, 0.5, 0.5515703859244697, 0.7048804638477371, -1.0, 0.9076248075958419, 0.8506082464026308, 0.5, 0.5798219853548179, -1.0, 0.9600853834241962, -1.0, 0.5737539266311049, -1.0, -1.0, 0.5, 0.6257374322472051, 0.8750536272698889, -1.0, -1.0, 0.5, 0.9101037201978959, 0.5, 0.5, -1.0, 0.7126460418288004, -1.0, 0.5018527660284473, 0.5, 0.8244947795041321, 0.6503170656011179, 0.5, 0.5, -1.0, -1.0, 0.9445355119295317, 0.5, 0.5, -1.0, 0.7046304312413982, 0.8610182980905349, 0.5], "episode_lengths": [24, 19, 18, 35, 29, 40, 17, 18, 80, 18, 41, 18, 54, 20, 80, 29, 24, 26, 18, 60, 26, 30, 15, 80, 18, 40, 20, 21, 19, 17, 22, 24, 52, 23, 23, 31, 31, 24, 21, 21, 36, 14, 31, 18, 20, 24, 65, 28, 23, 22, 18, 29, 20, 47, 24, 18, 21, 17, 16, 17, 15, 29, 18, 50, 16, 79, 23, 28, 30, 21, 53, 30, 55, 80, 29, 23, 15, 80, 17, 19, 30, 25, 20, 36, 23, 17, 63, 20, 23, 63, 16, 26, 22, 50, 25, 80, 80, 79, 19, 17, 23, 22, 26, 20, 61, 22, 13, 28, 80, 21, 17, 22, 20, 42, 32, 23, 80, 31, 19, 21, 26, 42, 22, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09213547558416386, "mean_inference_ms": 0.24204945673686465, "mean_action_processing_ms": 0.043645046920159206, "mean_env_wait_ms": 0.04641025597322233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001519918441772461, "StateBufferConnector_ms": 0.0012040138244628906, "ViewRequirementAgentConnector_ms": 0.028459679695867723}}, "episode_reward_max": 0.9997090624146456, "episode_reward_min": -1.0, "episode_reward_mean": 0.09849362306029567, "episode_len_mean": 31.975806451612904, "episodes_this_iter": 124, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5458483185668934, -1.0, -1.0, 0.5, 0.5, 0.5456328095458449, 0.7535446234013378, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.9303129217213678, 0.6354816327392727, -1.0, 0.8636619254501465, 0.5, 0.9576799204680948, -1.0, -1.0, -1.0, 0.8832457801261802, 0.6985150761024003, -1.0, 0.5, -1.0, 0.9810058231592915, -1.0, 0.5888743762059778, 0.5, -1.0, 0.9997090624146456, 0.5, 0.5191617306740192, 0.7255718968643398, 0.5, -1.0, 0.5, 0.7098891100508367, -1.0, -1.0, -1.0, 0.5, 0.8813268511415872, 0.5, 0.6795503143664683, 0.5115919878126531, -1.0, 0.5, 0.5, 0.8965208750811862, -1.0, 0.5, 0.5935084986862382, 0.7145673479878665, 0.9114812245195943, 0.5643268365880136, 0.5, -1.0, 0.5389002582515732, -1.0, 0.5, 0.8005022882237545, 0.9419273772926302, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5456341016995532, 0.9275745986749224, -1.0, -1.0, 0.7917289546007602, -1.0, 0.5, 0.8371978639394626, 0.5, 0.5515703859244697, 0.7048804638477371, -1.0, 0.9076248075958419, 0.8506082464026308, 0.5, 0.5798219853548179, -1.0, 0.9600853834241962, -1.0, 0.5737539266311049, -1.0, -1.0, 0.5, 0.6257374322472051, 0.8750536272698889, -1.0, -1.0, 0.5, 0.9101037201978959, 0.5, 0.5, -1.0, 0.7126460418288004, -1.0, 0.5018527660284473, 0.5, 0.8244947795041321, 0.6503170656011179, 0.5, 0.5, -1.0, -1.0, 0.9445355119295317, 0.5, 0.5, -1.0, 0.7046304312413982, 0.8610182980905349, 0.5], "episode_lengths": [24, 19, 18, 35, 29, 40, 17, 18, 80, 18, 41, 18, 54, 20, 80, 29, 24, 26, 18, 60, 26, 30, 15, 80, 18, 40, 20, 21, 19, 17, 22, 24, 52, 23, 23, 31, 31, 24, 21, 21, 36, 14, 31, 18, 20, 24, 65, 28, 23, 22, 18, 29, 20, 47, 24, 18, 21, 17, 16, 17, 15, 29, 18, 50, 16, 79, 23, 28, 30, 21, 53, 30, 55, 80, 29, 23, 15, 80, 17, 19, 30, 25, 20, 36, 23, 17, 63, 20, 23, 63, 16, 26, 22, 50, 25, 80, 80, 79, 19, 17, 23, 22, 26, 20, 61, 22, 13, 28, 80, 21, 17, 22, 20, 42, 32, 23, 80, 31, 19, 21, 26, 42, 22, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09213547558416386, "mean_inference_ms": 0.24204945673686465, "mean_action_processing_ms": 0.043645046920159206, "mean_env_wait_ms": 0.04641025597322233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001519918441772461, "StateBufferConnector_ms": 0.0012040138244628906, "ViewRequirementAgentConnector_ms": 0.028459679695867723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1114.83992514847, "num_env_steps_trained_throughput_per_sec": 1114.83992514847, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 3582.69, "sample_time_ms": 1729.551, "load_time_ms": 0.197, "load_throughput": 20343417.0, "learn_time_ms": 1851.971, "learn_throughput": 2159.861, "synch_weights_time_ms": 0.648}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 3344, "training_iteration": 42, "trial_id": "default", "date": "2024-05-22_22-17-29", "timestamp": 1716409049, "time_this_iter_s": 3.5908961296081543, "time_total_s": 149.58474564552307, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 149.58474564552307, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 18.1, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1530621017179183, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20138905264726045, "policy_loss": -0.010417856308080817, "vf_loss": 0.21149646887675888, "vf_explained_var": 0.39562821093425954, "kl": 0.012417576382419105, "entropy": 1.990211066507524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 0.9882334140590397, "episode_reward_min": -1.0, "episode_reward_mean": -0.007991159522473023, "episode_len_mean": 36.37837837837838, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.8258106086176873, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.9618469764578018, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.9543340305292156, 0.6156575098833692, 0.8933480391280252, 0.9264995615074578, 0.9418048870865537, 0.5, 0.5, -1.0, -1.0, 0.5, 0.761689698165034, 0.5, 0.5593741515106712, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.9843174785520562, 0.5, 0.7127066911257836, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.9492573995606582, 0.9882334140590397, 0.5, 0.7898043246876173, 0.9055488512834591, 0.8387269535139352, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6040430211644223, 0.8595133760790454, 0.8498171140532638, 0.884460348251773, -1.0, -1.0, 0.5494146128554741, -1.0, 0.8852856833780186, 0.5844826432850845, 0.5, 0.5, 0.5532340704461672, -1.0, 0.5603688872530077, 0.8771149081658326, 0.6599343088407263, 0.72743588564534, -1.0, 0.5, 0.5945108104100472, 0.5, -1.0, -1.0, -1.0, 0.6997386746701896, 0.942814384827615, 0.5, -1.0, 0.9666574276894776, 0.5, 0.586423276351647, -1.0, -1.0, -1.0, 0.5, 0.5563882170896062, -1.0, 0.9823339053061422, 0.8204791882932396, -1.0, 0.5, -1.0, 0.8935871535185985, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.8659828197624093, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [80, 22, 31, 67, 27, 39, 36, 68, 28, 19, 25, 21, 80, 69, 80, 55, 29, 49, 27, 34, 16, 50, 30, 80, 65, 15, 17, 37, 20, 21, 41, 49, 17, 18, 63, 23, 16, 22, 17, 27, 22, 11, 37, 27, 39, 20, 18, 36, 23, 30, 67, 32, 56, 80, 30, 38, 28, 32, 17, 19, 80, 41, 23, 54, 20, 27, 18, 39, 30, 47, 22, 27, 30, 36, 56, 25, 16, 27, 80, 22, 16, 26, 24, 34, 64, 19, 24, 22, 80, 31, 21, 22, 23, 32, 22, 20, 80, 17, 80, 32, 80, 23, 28, 67, 25, 18, 20, 53, 80, 25, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09219973210164951, "mean_inference_ms": 0.24206315045240284, "mean_action_processing_ms": 0.04364903295135291, "mean_env_wait_ms": 0.046421770845708275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015076216276701507, "StateBufferConnector_ms": 0.0012208749582101634, "ViewRequirementAgentConnector_ms": 0.028396082354021503}}, "episode_reward_max": 0.9882334140590397, "episode_reward_min": -1.0, "episode_reward_mean": -0.007991159522473023, "episode_len_mean": 36.37837837837838, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.8258106086176873, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.9618469764578018, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, 0.9543340305292156, 0.6156575098833692, 0.8933480391280252, 0.9264995615074578, 0.9418048870865537, 0.5, 0.5, -1.0, -1.0, 0.5, 0.761689698165034, 0.5, 0.5593741515106712, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.9843174785520562, 0.5, 0.7127066911257836, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.9492573995606582, 0.9882334140590397, 0.5, 0.7898043246876173, 0.9055488512834591, 0.8387269535139352, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6040430211644223, 0.8595133760790454, 0.8498171140532638, 0.884460348251773, -1.0, -1.0, 0.5494146128554741, -1.0, 0.8852856833780186, 0.5844826432850845, 0.5, 0.5, 0.5532340704461672, -1.0, 0.5603688872530077, 0.8771149081658326, 0.6599343088407263, 0.72743588564534, -1.0, 0.5, 0.5945108104100472, 0.5, -1.0, -1.0, -1.0, 0.6997386746701896, 0.942814384827615, 0.5, -1.0, 0.9666574276894776, 0.5, 0.586423276351647, -1.0, -1.0, -1.0, 0.5, 0.5563882170896062, -1.0, 0.9823339053061422, 0.8204791882932396, -1.0, 0.5, -1.0, 0.8935871535185985, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, 0.8659828197624093, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [80, 22, 31, 67, 27, 39, 36, 68, 28, 19, 25, 21, 80, 69, 80, 55, 29, 49, 27, 34, 16, 50, 30, 80, 65, 15, 17, 37, 20, 21, 41, 49, 17, 18, 63, 23, 16, 22, 17, 27, 22, 11, 37, 27, 39, 20, 18, 36, 23, 30, 67, 32, 56, 80, 30, 38, 28, 32, 17, 19, 80, 41, 23, 54, 20, 27, 18, 39, 30, 47, 22, 27, 30, 36, 56, 25, 16, 27, 80, 22, 16, 26, 24, 34, 64, 19, 24, 22, 80, 31, 21, 22, 23, 32, 22, 20, 80, 17, 80, 32, 80, 23, 28, 67, 25, 18, 20, 53, 80, 25, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09219973210164951, "mean_inference_ms": 0.24206315045240284, "mean_action_processing_ms": 0.04364903295135291, "mean_env_wait_ms": 0.046421770845708275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015076216276701507, "StateBufferConnector_ms": 0.0012208749582101634, "ViewRequirementAgentConnector_ms": 0.028396082354021503}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1091.0940247291517, "num_env_steps_trained_throughput_per_sec": 1091.0940247291517, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 3591.093, "sample_time_ms": 1729.329, "load_time_ms": 0.196, "load_throughput": 20415205.646, "learn_time_ms": 1860.585, "learn_throughput": 2149.861, "synch_weights_time_ms": 0.655}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 3455, "training_iteration": 43, "trial_id": "default", "date": "2024-05-22_22-17-33", "timestamp": 1716409053, "time_this_iter_s": 3.668881893157959, "time_total_s": 153.25362753868103, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.25362753868103, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.359999999999996, "ram_util_percent": 61.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.907749221978649, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1490935715397955, "policy_loss": -0.013783226802103943, "vf_loss": 0.16251560545336174, "vf_explained_var": 0.45979716636801277, "kl": 0.014447740804082603, "entropy": 1.9123368529863256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 0.9915078894976999, "episode_reward_min": -1.0, "episode_reward_mean": 0.1717749863362989, "episode_len_mean": 34.136752136752136, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5791071265651137, 0.9260860601555994, 0.5, 0.5150519279007573, 0.7995450390306195, 0.5, 0.955094103777376, 0.813035225296815, 0.5153334546306116, -1.0, -1.0, 0.6742270578222149, 0.5904101546437143, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.6754788757453647, 0.5, -1.0, 0.6773768943141607, 0.8452599052306542, -1.0, 0.5, 0.5, 0.5, 0.7856632982747178, 0.5115550505156832, 0.872294519544739, 0.5, 0.5, -1.0, -1.0, 0.7034502216109138, 0.5, 0.5, -1.0, 0.5, 0.528026565350757, 0.5, 0.5, -1.0, 0.5341866533281191, 0.5, 0.9915078894976999, -1.0, 0.5, -1.0, 0.6129090172712484, 0.5, -1.0, 0.5, -1.0, 0.8699530542615613, 0.5, 0.6941530473270554, -1.0, -1.0, 0.7572645072125743, -1.0, -1.0, 0.8560691611126418, -1.0, 0.5, 0.5, 0.602260969702039, 0.8993510980524834, 0.5697702682323311, -1.0, 0.5274441483612593, 0.825879703919366, 0.910234162685028, -1.0, 0.7497470064688665, -1.0, 0.5, 0.9002912429621438, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8255084902482819, -1.0, -1.0, 0.6891691037630615, 0.7517433816294367, 0.5476022186616345, -1.0, 0.7696197030235938, 0.8956791571024278, 0.5, 0.7463447097041751, -1.0, 0.7891784219607323, 0.7739804726001805, 0.5328921860314726, 0.5, 0.5, 0.6999581756456303, -1.0, 0.7874534484909239, 0.5, 0.9803495022835864, -1.0, 0.5, 0.5, 0.703023480026518, 0.8371535393710847, -1.0], "episode_lengths": [25, 24, 25, 22, 37, 21, 16, 23, 26, 15, 17, 80, 27, 20, 49, 17, 47, 35, 49, 22, 21, 24, 23, 28, 80, 40, 20, 25, 28, 49, 24, 27, 30, 24, 23, 42, 49, 80, 35, 23, 31, 55, 28, 28, 36, 30, 30, 19, 25, 34, 29, 20, 24, 43, 76, 80, 18, 80, 18, 31, 29, 22, 25, 34, 80, 23, 21, 59, 18, 52, 17, 24, 39, 80, 19, 27, 26, 44, 30, 49, 28, 21, 22, 18, 80, 41, 51, 80, 20, 16, 28, 80, 20, 20, 31, 50, 42, 17, 43, 23, 80, 19, 21, 17, 29, 23, 19, 80, 18, 19, 31, 18, 29, 24, 26, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09227334095342181, "mean_inference_ms": 0.24211230807328474, "mean_action_processing_ms": 0.043657309477941865, "mean_env_wait_ms": 0.04643702944433373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015279166718833467, "StateBufferConnector_ms": 0.0012249009222046942, "ViewRequirementAgentConnector_ms": 0.028541760566907052}}, "episode_reward_max": 0.9915078894976999, "episode_reward_min": -1.0, "episode_reward_mean": 0.1717749863362989, "episode_len_mean": 34.136752136752136, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5791071265651137, 0.9260860601555994, 0.5, 0.5150519279007573, 0.7995450390306195, 0.5, 0.955094103777376, 0.813035225296815, 0.5153334546306116, -1.0, -1.0, 0.6742270578222149, 0.5904101546437143, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.6754788757453647, 0.5, -1.0, 0.6773768943141607, 0.8452599052306542, -1.0, 0.5, 0.5, 0.5, 0.7856632982747178, 0.5115550505156832, 0.872294519544739, 0.5, 0.5, -1.0, -1.0, 0.7034502216109138, 0.5, 0.5, -1.0, 0.5, 0.528026565350757, 0.5, 0.5, -1.0, 0.5341866533281191, 0.5, 0.9915078894976999, -1.0, 0.5, -1.0, 0.6129090172712484, 0.5, -1.0, 0.5, -1.0, 0.8699530542615613, 0.5, 0.6941530473270554, -1.0, -1.0, 0.7572645072125743, -1.0, -1.0, 0.8560691611126418, -1.0, 0.5, 0.5, 0.602260969702039, 0.8993510980524834, 0.5697702682323311, -1.0, 0.5274441483612593, 0.825879703919366, 0.910234162685028, -1.0, 0.7497470064688665, -1.0, 0.5, 0.9002912429621438, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8255084902482819, -1.0, -1.0, 0.6891691037630615, 0.7517433816294367, 0.5476022186616345, -1.0, 0.7696197030235938, 0.8956791571024278, 0.5, 0.7463447097041751, -1.0, 0.7891784219607323, 0.7739804726001805, 0.5328921860314726, 0.5, 0.5, 0.6999581756456303, -1.0, 0.7874534484909239, 0.5, 0.9803495022835864, -1.0, 0.5, 0.5, 0.703023480026518, 0.8371535393710847, -1.0], "episode_lengths": [25, 24, 25, 22, 37, 21, 16, 23, 26, 15, 17, 80, 27, 20, 49, 17, 47, 35, 49, 22, 21, 24, 23, 28, 80, 40, 20, 25, 28, 49, 24, 27, 30, 24, 23, 42, 49, 80, 35, 23, 31, 55, 28, 28, 36, 30, 30, 19, 25, 34, 29, 20, 24, 43, 76, 80, 18, 80, 18, 31, 29, 22, 25, 34, 80, 23, 21, 59, 18, 52, 17, 24, 39, 80, 19, 27, 26, 44, 30, 49, 28, 21, 22, 18, 80, 41, 51, 80, 20, 16, 28, 80, 20, 20, 31, 50, 42, 17, 43, 23, 80, 19, 21, 17, 29, 23, 19, 80, 18, 19, 31, 18, 29, 24, 26, 33, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09227334095342181, "mean_inference_ms": 0.24211230807328474, "mean_action_processing_ms": 0.043657309477941865, "mean_env_wait_ms": 0.04643702944433373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015279166718833467, "StateBufferConnector_ms": 0.0012249009222046942, "ViewRequirementAgentConnector_ms": 0.028541760566907052}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1116.6418087221268, "num_env_steps_trained_throughput_per_sec": 1116.6418087221268, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 3591.086, "sample_time_ms": 1730.822, "load_time_ms": 0.195, "load_throughput": 20532634.928, "learn_time_ms": 1859.087, "learn_throughput": 2151.594, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3572, "training_iteration": 44, "trial_id": "default", "date": "2024-05-22_22-17-37", "timestamp": 1716409057, "time_this_iter_s": 3.585015058517456, "time_total_s": 156.8386425971985, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 156.8386425971985, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 19.019999999999996, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1402084233299377, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1935409544921738, "policy_loss": -0.008507702589756059, "vf_loss": 0.20170889390051686, "vf_explained_var": 0.24961929622516837, "kl": 0.013590520252357727, "entropy": 1.8556098759815256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 0.9911842406245998, "episode_reward_min": -1.0, "episode_reward_mean": 0.2337741433410883, "episode_len_mean": 27.908450704225352, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8685221528261742, 0.7561406955214451, 0.8853994428775203, 0.7170642400392302, 0.845378947947105, 0.5064121907638073, 0.7096537951514932, 0.7980786151693199, 0.5783130927186951, 0.5, 0.5026122025380347, 0.7223272066495613, 0.5, -1.0, -1.0, -1.0, 0.7466475779628315, 0.7852251051706872, -1.0, 0.5, -1.0, -1.0, 0.84762865557445, 0.9736981465596175, 0.5103211040705429, 0.5, 0.7035466723658401, -1.0, 0.9850421749435371, 0.8864804218330296, 0.9807730309451602, 0.8317631709189828, -1.0, 0.5, 0.6178966690496792, 0.655043088028495, 0.5, 0.8266756263684847, 0.8068216568491432, 0.5, 0.5, 0.9786571152100558, -1.0, -1.0, 0.7052327678045616, 0.5, 0.5, 0.5380477386205147, 0.6923959389362225, -1.0, -1.0, 0.6500182127898263, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7409295033202483, 0.51188181184534, 0.9858695553376504, 0.937053797219478, -1.0, 0.7875558883373056, 0.8466857340875287, -1.0, 0.8628988468870757, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8423086898377955, 0.8851042150147699, 0.9038991857537779, 0.5767769788791979, 0.7174389120241008, -1.0, 0.7032245721498744, 0.5, 0.5, -1.0, 0.9442974495314227, -1.0, 0.8585303448262017, 0.5, 0.8776535434580306, 0.7097081946938144, 0.859711368494898, 0.7544706629395597, 0.6852495351366662, -1.0, 0.7962948353842711, 0.9065329198254102, -1.0, 0.6298979315648383, -1.0, -1.0, -1.0, 0.5017063864910145, 0.5280347891455203, -1.0, 0.7956499700759474, -1.0, 0.8529849606830697, -1.0, 0.5, 0.5857079383506174, 0.8554742963769757, 0.5, 0.9899539775294535, 0.5, 0.7115119098889472, 0.5, 0.7083723724713531, 0.6172380771892159, -1.0, -1.0, 0.8797558131073799, 0.5, 0.5, 0.8586221744645636, 0.6724671704782454, 0.5, 0.5, 0.7270136051785812, 0.857073019596803, 0.9911842406245998, -1.0, 0.5120190437746532, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6690185287810929, 0.5, -1.0, 0.5, -1.0, -1.0, 0.9463481474731901, 0.5], "episode_lengths": [18, 18, 28, 18, 16, 17, 39, 38, 20, 22, 15, 25, 19, 18, 19, 80, 19, 20, 80, 27, 24, 74, 30, 22, 33, 24, 19, 29, 24, 18, 27, 21, 24, 34, 31, 33, 63, 18, 21, 40, 20, 21, 68, 65, 25, 22, 35, 23, 36, 80, 41, 18, 23, 25, 20, 32, 19, 17, 24, 25, 24, 55, 17, 23, 27, 20, 19, 38, 35, 27, 17, 17, 25, 19, 20, 22, 21, 22, 28, 22, 13, 19, 15, 19, 26, 17, 18, 19, 30, 24, 80, 25, 21, 41, 16, 25, 76, 20, 24, 63, 17, 20, 42, 24, 27, 23, 19, 20, 23, 33, 20, 18, 25, 19, 17, 23, 55, 18, 20, 37, 15, 25, 22, 32, 21, 18, 25, 28, 19, 28, 19, 48, 47, 31, 14, 20, 22, 31, 23, 30, 17, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09239792354241969, "mean_inference_ms": 0.2421434036585404, "mean_action_processing_ms": 0.043659572970176364, "mean_env_wait_ms": 0.0464558219249517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015436763494787082, "StateBufferConnector_ms": 0.001237761806434309, "ViewRequirementAgentConnector_ms": 0.028509321347088883}}, "episode_reward_max": 0.9911842406245998, "episode_reward_min": -1.0, "episode_reward_mean": 0.2337741433410883, "episode_len_mean": 27.908450704225352, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8685221528261742, 0.7561406955214451, 0.8853994428775203, 0.7170642400392302, 0.845378947947105, 0.5064121907638073, 0.7096537951514932, 0.7980786151693199, 0.5783130927186951, 0.5, 0.5026122025380347, 0.7223272066495613, 0.5, -1.0, -1.0, -1.0, 0.7466475779628315, 0.7852251051706872, -1.0, 0.5, -1.0, -1.0, 0.84762865557445, 0.9736981465596175, 0.5103211040705429, 0.5, 0.7035466723658401, -1.0, 0.9850421749435371, 0.8864804218330296, 0.9807730309451602, 0.8317631709189828, -1.0, 0.5, 0.6178966690496792, 0.655043088028495, 0.5, 0.8266756263684847, 0.8068216568491432, 0.5, 0.5, 0.9786571152100558, -1.0, -1.0, 0.7052327678045616, 0.5, 0.5, 0.5380477386205147, 0.6923959389362225, -1.0, -1.0, 0.6500182127898263, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7409295033202483, 0.51188181184534, 0.9858695553376504, 0.937053797219478, -1.0, 0.7875558883373056, 0.8466857340875287, -1.0, 0.8628988468870757, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8423086898377955, 0.8851042150147699, 0.9038991857537779, 0.5767769788791979, 0.7174389120241008, -1.0, 0.7032245721498744, 0.5, 0.5, -1.0, 0.9442974495314227, -1.0, 0.8585303448262017, 0.5, 0.8776535434580306, 0.7097081946938144, 0.859711368494898, 0.7544706629395597, 0.6852495351366662, -1.0, 0.7962948353842711, 0.9065329198254102, -1.0, 0.6298979315648383, -1.0, -1.0, -1.0, 0.5017063864910145, 0.5280347891455203, -1.0, 0.7956499700759474, -1.0, 0.8529849606830697, -1.0, 0.5, 0.5857079383506174, 0.8554742963769757, 0.5, 0.9899539775294535, 0.5, 0.7115119098889472, 0.5, 0.7083723724713531, 0.6172380771892159, -1.0, -1.0, 0.8797558131073799, 0.5, 0.5, 0.8586221744645636, 0.6724671704782454, 0.5, 0.5, 0.7270136051785812, 0.857073019596803, 0.9911842406245998, -1.0, 0.5120190437746532, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6690185287810929, 0.5, -1.0, 0.5, -1.0, -1.0, 0.9463481474731901, 0.5], "episode_lengths": [18, 18, 28, 18, 16, 17, 39, 38, 20, 22, 15, 25, 19, 18, 19, 80, 19, 20, 80, 27, 24, 74, 30, 22, 33, 24, 19, 29, 24, 18, 27, 21, 24, 34, 31, 33, 63, 18, 21, 40, 20, 21, 68, 65, 25, 22, 35, 23, 36, 80, 41, 18, 23, 25, 20, 32, 19, 17, 24, 25, 24, 55, 17, 23, 27, 20, 19, 38, 35, 27, 17, 17, 25, 19, 20, 22, 21, 22, 28, 22, 13, 19, 15, 19, 26, 17, 18, 19, 30, 24, 80, 25, 21, 41, 16, 25, 76, 20, 24, 63, 17, 20, 42, 24, 27, 23, 19, 20, 23, 33, 20, 18, 25, 19, 17, 23, 55, 18, 20, 37, 15, 25, 22, 32, 21, 18, 25, 28, 19, 28, 19, 48, 47, 31, 14, 20, 22, 31, 23, 30, 17, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09239792354241969, "mean_inference_ms": 0.2421434036585404, "mean_action_processing_ms": 0.043659572970176364, "mean_env_wait_ms": 0.0464558219249517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015436763494787082, "StateBufferConnector_ms": 0.001237761806434309, "ViewRequirementAgentConnector_ms": 0.028509321347088883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1108.086330418279, "num_env_steps_trained_throughput_per_sec": 1108.086330418279, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3594.954, "sample_time_ms": 1731.891, "load_time_ms": 0.196, "load_throughput": 20460019.512, "learn_time_ms": 1861.887, "learn_throughput": 2148.358, "synch_weights_time_ms": 0.65}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 3714, "training_iteration": 45, "trial_id": "default", "date": "2024-05-22_22-17-40", "timestamp": 1716409060, "time_this_iter_s": 3.6129422187805176, "time_total_s": 160.451584815979, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 160.451584815979, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.660000000000004, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2324638916600135, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21702038124704393, "policy_loss": -0.009239362204267132, "vf_loss": 0.2258391737016619, "vf_explained_var": 0.13927429779883355, "kl": 0.01682272264567079, "entropy": 1.749147387345632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 0.9875434554881557, "episode_reward_min": -1.0, "episode_reward_mean": 0.2002086048366693, "episode_len_mean": 29.28985507246377, "episode_media": {}, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.9657604730847689, 0.5, 0.7869729730345643, 0.5, 0.5, 0.9741765949860453, 0.5, 0.5, 0.5, 0.849727630534476, 0.5, 0.5686729200038261, 0.5, 0.5, 0.6959701300432857, -1.0, 0.8514509389896594, -1.0, 0.5761430838454061, 0.6606752917497452, 0.7328695124944937, 0.7292564741507561, 0.6649227676374492, 0.5, 0.9281624294235831, 0.5, 0.6674634990614291, 0.9875434554881557, 0.5, -1.0, 0.5, -1.0, 0.5, 0.9309708814524973, -1.0, -1.0, 0.5233911916424248, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.8762565054672649, 0.9113615257416932, 0.5120139887395052, 0.7147239576815942, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.8992422336388266, 0.5432137966077244, 0.7326804447525286, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5594972026025463, 0.7521705094400063, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7967077314467524, 0.5, 0.5, -1.0, 0.6362127796222262, -1.0, 0.966193734290828, -1.0, -1.0, 0.7762757198310567, 0.7154393334511275, 0.5, 0.5, 0.6663043925274748, -1.0, -1.0, 0.9310803274911388, -1.0, 0.9827690338626913, 0.5, -1.0, 0.5, 0.8658352909695041, 0.5, 0.6076642092832649, 0.5, 0.5, 0.7712117054396359, 0.5, 0.5, -1.0, 0.5, 0.5664449190466032, 0.9433800869781753, -1.0, 0.6222515665127524, 0.5, 0.6125816604441672, 0.9007557616795668, 0.8288490607165608, 0.5655374233870946, 0.8723440339625995, 0.5, 0.5, -1.0, 0.8406799683999906, 0.5, 0.8800017938580488, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7372666380941761, 0.5, -1.0, 0.5, -1.0, 0.5, 0.9639095788103922, 0.5, 0.862118243857429, 0.6156834566243646, 0.5, 0.6564710478510083, 0.8495275567274825], "episode_lengths": [80, 32, 17, 18, 23, 21, 37, 20, 39, 37, 22, 20, 19, 19, 17, 64, 18, 28, 18, 12, 20, 24, 39, 23, 18, 29, 21, 25, 30, 20, 24, 26, 26, 18, 18, 23, 80, 24, 56, 64, 28, 26, 47, 20, 57, 21, 64, 26, 18, 18, 21, 23, 35, 22, 33, 31, 19, 17, 19, 25, 26, 34, 25, 80, 14, 21, 17, 39, 80, 27, 80, 28, 15, 19, 15, 80, 30, 47, 18, 38, 14, 19, 19, 24, 24, 15, 49, 12, 17, 21, 18, 23, 80, 42, 18, 28, 17, 24, 33, 24, 22, 31, 21, 57, 24, 24, 33, 28, 17, 19, 24, 29, 24, 21, 34, 22, 61, 34, 26, 15, 35, 21, 17, 20, 31, 17, 19, 20, 38, 76, 16, 17, 24, 21, 43, 23, 16, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09251339276291323, "mean_inference_ms": 0.24218207107260253, "mean_action_processing_ms": 0.04366960582059055, "mean_env_wait_ms": 0.0464756049114523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015647515006687331, "StateBufferConnector_ms": 0.001230447188667629, "ViewRequirementAgentConnector_ms": 0.028461304263792175}}, "episode_reward_max": 0.9875434554881557, "episode_reward_min": -1.0, "episode_reward_mean": 0.2002086048366693, "episode_len_mean": 29.28985507246377, "episodes_this_iter": 138, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.9657604730847689, 0.5, 0.7869729730345643, 0.5, 0.5, 0.9741765949860453, 0.5, 0.5, 0.5, 0.849727630534476, 0.5, 0.5686729200038261, 0.5, 0.5, 0.6959701300432857, -1.0, 0.8514509389896594, -1.0, 0.5761430838454061, 0.6606752917497452, 0.7328695124944937, 0.7292564741507561, 0.6649227676374492, 0.5, 0.9281624294235831, 0.5, 0.6674634990614291, 0.9875434554881557, 0.5, -1.0, 0.5, -1.0, 0.5, 0.9309708814524973, -1.0, -1.0, 0.5233911916424248, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.8762565054672649, 0.9113615257416932, 0.5120139887395052, 0.7147239576815942, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.8992422336388266, 0.5432137966077244, 0.7326804447525286, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5594972026025463, 0.7521705094400063, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7967077314467524, 0.5, 0.5, -1.0, 0.6362127796222262, -1.0, 0.966193734290828, -1.0, -1.0, 0.7762757198310567, 0.7154393334511275, 0.5, 0.5, 0.6663043925274748, -1.0, -1.0, 0.9310803274911388, -1.0, 0.9827690338626913, 0.5, -1.0, 0.5, 0.8658352909695041, 0.5, 0.6076642092832649, 0.5, 0.5, 0.7712117054396359, 0.5, 0.5, -1.0, 0.5, 0.5664449190466032, 0.9433800869781753, -1.0, 0.6222515665127524, 0.5, 0.6125816604441672, 0.9007557616795668, 0.8288490607165608, 0.5655374233870946, 0.8723440339625995, 0.5, 0.5, -1.0, 0.8406799683999906, 0.5, 0.8800017938580488, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7372666380941761, 0.5, -1.0, 0.5, -1.0, 0.5, 0.9639095788103922, 0.5, 0.862118243857429, 0.6156834566243646, 0.5, 0.6564710478510083, 0.8495275567274825], "episode_lengths": [80, 32, 17, 18, 23, 21, 37, 20, 39, 37, 22, 20, 19, 19, 17, 64, 18, 28, 18, 12, 20, 24, 39, 23, 18, 29, 21, 25, 30, 20, 24, 26, 26, 18, 18, 23, 80, 24, 56, 64, 28, 26, 47, 20, 57, 21, 64, 26, 18, 18, 21, 23, 35, 22, 33, 31, 19, 17, 19, 25, 26, 34, 25, 80, 14, 21, 17, 39, 80, 27, 80, 28, 15, 19, 15, 80, 30, 47, 18, 38, 14, 19, 19, 24, 24, 15, 49, 12, 17, 21, 18, 23, 80, 42, 18, 28, 17, 24, 33, 24, 22, 31, 21, 57, 24, 24, 33, 28, 17, 19, 24, 29, 24, 21, 34, 22, 61, 34, 26, 15, 35, 21, 17, 20, 31, 17, 19, 20, 38, 76, 16, 17, 24, 21, 43, 23, 16, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09251339276291323, "mean_inference_ms": 0.24218207107260253, "mean_action_processing_ms": 0.04366960582059055, "mean_env_wait_ms": 0.0464756049114523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015647515006687331, "StateBufferConnector_ms": 0.001230447188667629, "ViewRequirementAgentConnector_ms": 0.028461304263792175}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1103.1637120688383, "num_env_steps_trained_throughput_per_sec": 1103.1637120688383, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 3590.257, "sample_time_ms": 1733.604, "load_time_ms": 0.197, "load_throughput": 20257445.062, "learn_time_ms": 1855.489, "learn_throughput": 2155.766, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 3852, "training_iteration": 46, "trial_id": "default", "date": "2024-05-22_22-17-44", "timestamp": 1716409064, "time_this_iter_s": 3.6289751529693604, "time_total_s": 164.08055996894836, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.08055996894836, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.139999999999997, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9371375421682995, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16379796467966812, "policy_loss": -0.022355979897322194, "vf_loss": 0.1857332983785259, "vf_explained_var": 0.40615791242609744, "kl": 0.016825829443743317, "entropy": 1.7078767489361506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 0.9953868925131842, "episode_reward_min": -1.0, "episode_reward_mean": 0.17156332280055941, "episode_len_mean": 27.335616438356166, "episode_media": {}, "episodes_this_iter": 146, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8610084664593082, 0.5, 0.7554779859674529, -1.0, 0.5694566391423577, 0.7876181980268921, 0.5, 0.5, 0.9259325455205785, 0.7764148135535276, -1.0, 0.5, 0.8898400183725302, 0.795614423408348, 0.5, 0.5, 0.5, 0.9044760577018559, 0.5, 0.5, 0.859337033878474, -1.0, 0.8860415127277502, 0.5, 0.7718550494615948, 0.5, 0.5, 0.5, -1.0, 0.7723909443116329, -1.0, -1.0, 0.5, 0.5, 0.5495518038288514, 0.5, 0.5, 0.5, 0.5, 0.9263807306909331, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.7982317472986515, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.9331479900013046, 0.5, 0.9348779722269971, 0.6201100127579457, -1.0, 0.6436891641857696, 0.6343519514770046, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9352154995878501, 0.860212510694498, -1.0, -1.0, 0.5061666636460457, 0.6767818630582105, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9065711386562507, 0.8046443338339193, 0.5, 0.9405429509974351, -1.0, -1.0, 0.5, -1.0, 0.5, 0.8547428933712614, 0.5, -1.0, 0.5, -1.0, 0.6504008159793977, 0.5, 0.7622706763482079, -1.0, 0.9127012182042404, -1.0, -1.0, 0.7881320827755169, 0.5, 0.5, -1.0, 0.9917207240601125, -1.0, 0.9953868925131842, 0.8024432998141705, -1.0, -1.0, 0.5, -1.0, 0.5578737590289233, 0.5, -1.0, 0.5, 0.5, -1.0, 0.659791680806058, -1.0, -1.0, 0.8856145500718202, 0.9306222769896269, 0.5, 0.6139680138395367, -1.0, 0.5, 0.5, 0.6297171232228588, -1.0, -1.0, 0.5, 0.5, 0.8170722314908716, 0.9529085469184548, 0.5, 0.8266299288815808, 0.5, 0.5, 0.5, 0.5, 0.5860036448529473, 0.6043047482389368, -1.0], "episode_lengths": [19, 20, 17, 21, 17, 16, 24, 23, 18, 18, 18, 31, 19, 19, 17, 25, 19, 23, 36, 31, 18, 20, 21, 36, 15, 42, 20, 22, 80, 19, 15, 37, 31, 41, 16, 23, 21, 24, 17, 21, 27, 18, 16, 20, 23, 20, 17, 21, 75, 20, 22, 25, 15, 24, 33, 19, 19, 55, 16, 27, 21, 22, 25, 33, 19, 21, 29, 34, 80, 18, 19, 14, 26, 32, 17, 20, 28, 30, 80, 33, 45, 22, 20, 23, 18, 34, 47, 20, 45, 20, 22, 34, 24, 22, 28, 25, 23, 15, 77, 23, 63, 50, 16, 21, 22, 25, 26, 25, 20, 28, 32, 20, 25, 53, 16, 24, 48, 20, 23, 80, 20, 20, 15, 23, 16, 27, 18, 25, 23, 31, 13, 80, 33, 56, 22, 28, 37, 25, 18, 29, 21, 25, 23, 15, 19, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09262561354233688, "mean_inference_ms": 0.24219358622580453, "mean_action_processing_ms": 0.04367493545000039, "mean_env_wait_ms": 0.046492892370167634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015892394601482234, "StateBufferConnector_ms": 0.0011984616109769637, "ViewRequirementAgentConnector_ms": 0.028509799748250884}}, "episode_reward_max": 0.9953868925131842, "episode_reward_min": -1.0, "episode_reward_mean": 0.17156332280055941, "episode_len_mean": 27.335616438356166, "episodes_this_iter": 146, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8610084664593082, 0.5, 0.7554779859674529, -1.0, 0.5694566391423577, 0.7876181980268921, 0.5, 0.5, 0.9259325455205785, 0.7764148135535276, -1.0, 0.5, 0.8898400183725302, 0.795614423408348, 0.5, 0.5, 0.5, 0.9044760577018559, 0.5, 0.5, 0.859337033878474, -1.0, 0.8860415127277502, 0.5, 0.7718550494615948, 0.5, 0.5, 0.5, -1.0, 0.7723909443116329, -1.0, -1.0, 0.5, 0.5, 0.5495518038288514, 0.5, 0.5, 0.5, 0.5, 0.9263807306909331, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.7982317472986515, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.9331479900013046, 0.5, 0.9348779722269971, 0.6201100127579457, -1.0, 0.6436891641857696, 0.6343519514770046, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9352154995878501, 0.860212510694498, -1.0, -1.0, 0.5061666636460457, 0.6767818630582105, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9065711386562507, 0.8046443338339193, 0.5, 0.9405429509974351, -1.0, -1.0, 0.5, -1.0, 0.5, 0.8547428933712614, 0.5, -1.0, 0.5, -1.0, 0.6504008159793977, 0.5, 0.7622706763482079, -1.0, 0.9127012182042404, -1.0, -1.0, 0.7881320827755169, 0.5, 0.5, -1.0, 0.9917207240601125, -1.0, 0.9953868925131842, 0.8024432998141705, -1.0, -1.0, 0.5, -1.0, 0.5578737590289233, 0.5, -1.0, 0.5, 0.5, -1.0, 0.659791680806058, -1.0, -1.0, 0.8856145500718202, 0.9306222769896269, 0.5, 0.6139680138395367, -1.0, 0.5, 0.5, 0.6297171232228588, -1.0, -1.0, 0.5, 0.5, 0.8170722314908716, 0.9529085469184548, 0.5, 0.8266299288815808, 0.5, 0.5, 0.5, 0.5, 0.5860036448529473, 0.6043047482389368, -1.0], "episode_lengths": [19, 20, 17, 21, 17, 16, 24, 23, 18, 18, 18, 31, 19, 19, 17, 25, 19, 23, 36, 31, 18, 20, 21, 36, 15, 42, 20, 22, 80, 19, 15, 37, 31, 41, 16, 23, 21, 24, 17, 21, 27, 18, 16, 20, 23, 20, 17, 21, 75, 20, 22, 25, 15, 24, 33, 19, 19, 55, 16, 27, 21, 22, 25, 33, 19, 21, 29, 34, 80, 18, 19, 14, 26, 32, 17, 20, 28, 30, 80, 33, 45, 22, 20, 23, 18, 34, 47, 20, 45, 20, 22, 34, 24, 22, 28, 25, 23, 15, 77, 23, 63, 50, 16, 21, 22, 25, 26, 25, 20, 28, 32, 20, 25, 53, 16, 24, 48, 20, 23, 80, 20, 20, 15, 23, 16, 27, 18, 25, 23, 31, 13, 80, 33, 56, 22, 28, 37, 25, 18, 29, 21, 25, 23, 15, 19, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09262561354233688, "mean_inference_ms": 0.24219358622580453, "mean_action_processing_ms": 0.04367493545000039, "mean_env_wait_ms": 0.046492892370167634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015892394601482234, "StateBufferConnector_ms": 0.0011984616109769637, "ViewRequirementAgentConnector_ms": 0.028509799748250884}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1116.4371679287672, "num_env_steps_trained_throughput_per_sec": 1116.4371679287672, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 3590.279, "sample_time_ms": 1735.348, "load_time_ms": 0.199, "load_throughput": 20073242.402, "learn_time_ms": 1853.766, "learn_throughput": 2157.77, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 3998, "training_iteration": 47, "trial_id": "default", "date": "2024-05-22_22-17-47", "timestamp": 1716409067, "time_this_iter_s": 3.5858497619628906, "time_total_s": 167.66640973091125, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 167.66640973091125, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 15.180000000000001, "ram_util_percent": 61.21999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9656129158312274, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2124694778296035, "policy_loss": -0.007961080766092705, "vf_loss": 0.2201328013252507, "vf_explained_var": 0.41349731312003185, "kl": 0.01191026894971457, "entropy": 1.6181573476842654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 0.9948382777827115, "episode_reward_min": -1.0, "episode_reward_mean": 0.12431212337921839, "episode_len_mean": 26.282894736842106, "episode_media": {}, "episodes_this_iter": 152, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, 0.673252958155701, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9948382777827115, 0.5, -1.0, -1.0, 0.5, 0.6327493073845025, 0.5499735781716024, -1.0, 0.9491095226609769, 0.8111382257637758, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9152863553082047, 0.5, 0.7859578279175884, 0.5, -1.0, 0.6941486002515349, 0.7151518160236447, 0.6280104963997661, 0.6756740776013197, 0.5, 0.6957253107518572, 0.7230316294324952, 0.516666757312053, 0.8731520444859416, -1.0, 0.9101608905637754, 0.5, 0.5, 0.8863439993967056, -1.0, -1.0, -1.0, -1.0, 0.8404662161495218, 0.7106017115232203, 0.5, 0.8717186300900523, -1.0, -1.0, 0.7287554291820306, -1.0, 0.5, -1.0, 0.9048090472192735, -1.0, 0.5, -1.0, -1.0, 0.9903701264999941, 0.5932516236317815, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.836291412487032, -1.0, 0.5, 0.5, 0.6035010424709306, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9846011975273087, 0.5, 0.5, -1.0, -1.0, 0.9668727869249593, 0.5, -1.0, 0.6102568543950537, 0.5423244117245151, 0.5, 0.9442905551383665, 0.5, 0.5, 0.5, 0.5, 0.7693838121038999, 0.7769925314282362, -1.0, 0.5, 0.7539616121266243, -1.0, 0.5, 0.7793980522604922, 0.9261396349041477, 0.9520463711683438, 0.9304751514327357, 0.6622662861561406, 0.5, -1.0, 0.5, 0.7393607665235162, 0.932941799372307, -1.0, 0.5, -1.0, 0.5, 0.6470801884908561, -1.0, 0.5, 0.7595132856165263, 0.6016338075567609, 0.5, -1.0, 0.7921980057622341, -1.0, 0.8256767833771312, -1.0, 0.8984607004924001, -1.0, -1.0, 0.8616974522875211, 0.5742516307835508, 0.905605583992305, 0.9795600642472319, 0.5, 0.8093685949240988, 0.5, 0.5, -1.0, -1.0, 0.9657077395280314, 0.9197118571647227, 0.5407687664290679, 0.8327595551841169], "episode_lengths": [21, 23, 19, 21, 24, 30, 24, 22, 19, 44, 19, 22, 59, 23, 22, 16, 33, 24, 16, 16, 26, 21, 21, 16, 15, 13, 26, 17, 18, 15, 30, 71, 34, 17, 18, 21, 20, 15, 19, 17, 21, 22, 21, 31, 18, 18, 56, 37, 25, 21, 17, 35, 17, 21, 34, 26, 19, 36, 22, 41, 23, 80, 22, 19, 26, 21, 21, 33, 23, 31, 49, 19, 31, 20, 22, 22, 31, 32, 52, 20, 24, 32, 27, 29, 24, 25, 18, 19, 17, 20, 27, 80, 16, 26, 24, 24, 28, 28, 28, 21, 24, 23, 22, 17, 15, 30, 21, 22, 80, 21, 23, 22, 17, 19, 15, 39, 25, 20, 18, 24, 24, 70, 25, 17, 16, 80, 25, 17, 17, 21, 20, 17, 28, 16, 27, 17, 80, 19, 16, 17, 24, 19, 22, 17, 21, 49, 25, 51, 17, 22, 27, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09275211141686646, "mean_inference_ms": 0.24221891172261253, "mean_action_processing_ms": 0.04368060056155216, "mean_env_wait_ms": 0.04651058703717931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015497207641601562, "StateBufferConnector_ms": 0.0012411883002833317, "ViewRequirementAgentConnector_ms": 0.02868551956979852}}, "episode_reward_max": 0.9948382777827115, "episode_reward_min": -1.0, "episode_reward_mean": 0.12431212337921839, "episode_len_mean": 26.282894736842106, "episodes_this_iter": 152, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, 0.673252958155701, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9948382777827115, 0.5, -1.0, -1.0, 0.5, 0.6327493073845025, 0.5499735781716024, -1.0, 0.9491095226609769, 0.8111382257637758, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9152863553082047, 0.5, 0.7859578279175884, 0.5, -1.0, 0.6941486002515349, 0.7151518160236447, 0.6280104963997661, 0.6756740776013197, 0.5, 0.6957253107518572, 0.7230316294324952, 0.516666757312053, 0.8731520444859416, -1.0, 0.9101608905637754, 0.5, 0.5, 0.8863439993967056, -1.0, -1.0, -1.0, -1.0, 0.8404662161495218, 0.7106017115232203, 0.5, 0.8717186300900523, -1.0, -1.0, 0.7287554291820306, -1.0, 0.5, -1.0, 0.9048090472192735, -1.0, 0.5, -1.0, -1.0, 0.9903701264999941, 0.5932516236317815, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.836291412487032, -1.0, 0.5, 0.5, 0.6035010424709306, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9846011975273087, 0.5, 0.5, -1.0, -1.0, 0.9668727869249593, 0.5, -1.0, 0.6102568543950537, 0.5423244117245151, 0.5, 0.9442905551383665, 0.5, 0.5, 0.5, 0.5, 0.7693838121038999, 0.7769925314282362, -1.0, 0.5, 0.7539616121266243, -1.0, 0.5, 0.7793980522604922, 0.9261396349041477, 0.9520463711683438, 0.9304751514327357, 0.6622662861561406, 0.5, -1.0, 0.5, 0.7393607665235162, 0.932941799372307, -1.0, 0.5, -1.0, 0.5, 0.6470801884908561, -1.0, 0.5, 0.7595132856165263, 0.6016338075567609, 0.5, -1.0, 0.7921980057622341, -1.0, 0.8256767833771312, -1.0, 0.8984607004924001, -1.0, -1.0, 0.8616974522875211, 0.5742516307835508, 0.905605583992305, 0.9795600642472319, 0.5, 0.8093685949240988, 0.5, 0.5, -1.0, -1.0, 0.9657077395280314, 0.9197118571647227, 0.5407687664290679, 0.8327595551841169], "episode_lengths": [21, 23, 19, 21, 24, 30, 24, 22, 19, 44, 19, 22, 59, 23, 22, 16, 33, 24, 16, 16, 26, 21, 21, 16, 15, 13, 26, 17, 18, 15, 30, 71, 34, 17, 18, 21, 20, 15, 19, 17, 21, 22, 21, 31, 18, 18, 56, 37, 25, 21, 17, 35, 17, 21, 34, 26, 19, 36, 22, 41, 23, 80, 22, 19, 26, 21, 21, 33, 23, 31, 49, 19, 31, 20, 22, 22, 31, 32, 52, 20, 24, 32, 27, 29, 24, 25, 18, 19, 17, 20, 27, 80, 16, 26, 24, 24, 28, 28, 28, 21, 24, 23, 22, 17, 15, 30, 21, 22, 80, 21, 23, 22, 17, 19, 15, 39, 25, 20, 18, 24, 24, 70, 25, 17, 16, 80, 25, 17, 17, 21, 20, 17, 28, 16, 27, 17, 80, 19, 16, 17, 24, 19, 22, 17, 21, 49, 25, 51, 17, 22, 27, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09275211141686646, "mean_inference_ms": 0.24221891172261253, "mean_action_processing_ms": 0.04368060056155216, "mean_env_wait_ms": 0.04651058703717931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015497207641601562, "StateBufferConnector_ms": 0.0012411883002833317, "ViewRequirementAgentConnector_ms": 0.02868551956979852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1115.3795678815773, "num_env_steps_trained_throughput_per_sec": 1115.3795678815773, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 3591.865, "sample_time_ms": 1737.323, "load_time_ms": 0.199, "load_throughput": 20082853.723, "learn_time_ms": 1853.363, "learn_throughput": 2158.239, "synch_weights_time_ms": 0.652}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 4150, "training_iteration": 48, "trial_id": "default", "date": "2024-05-22_22-17-51", "timestamp": 1716409071, "time_this_iter_s": 3.589294910430908, "time_total_s": 171.25570464134216, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 171.25570464134216, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.700000000000003, "ram_util_percent": 61.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.895626922320294, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16656096696212727, "policy_loss": -0.004064009623021208, "vf_loss": 0.17033601656195618, "vf_explained_var": 0.4316481639621078, "kl": 0.011558446981351115, "entropy": 1.560019653586931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 0.9944379640571693, "episode_reward_min": -1.0, "episode_reward_mean": 0.22894556835693813, "episode_len_mean": 27.183673469387756, "episode_media": {}, "episodes_this_iter": 147, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.989914553763772, 0.5, -1.0, 0.5499058342366053, 0.5, -1.0, 0.5, 0.5, 0.5273456930115171, 0.5, 0.5, 0.5075918469403939, -1.0, 0.5, 0.5, 0.6349714777120284, 0.6053678093539778, 0.7530284879187414, -1.0, -1.0, 0.5, -1.0, 0.9445483547183401, 0.8377030124176279, -1.0, 0.5, -1.0, 0.5734519423520329, 0.7367430943863084, -1.0, 0.8325007885595189, 0.8411542211855831, 0.6532567764205559, 0.5118361079673188, 0.7388781750018035, -1.0, 0.9346500741281363, 0.5, 0.5, 0.6630222224899182, 0.5, 0.6211659832782885, 0.8814606815748033, 0.5, 0.6305425582938959, -1.0, 0.5, 0.5, 0.5, 0.5, 0.9944379640571693, 0.791214565369464, 0.5, 0.7949122270106819, 0.5, 0.8091329057134247, 0.73567191998045, 0.5, -1.0, 0.5, 0.5, 0.5, 0.7459574642527735, -1.0, 0.5, -1.0, -1.0, 0.7093973223823113, 0.7563683972280688, 0.5, 0.5, 0.6280247287199858, -1.0, 0.5146212017797431, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.8919874340059429, -1.0, 0.9705452306943271, 0.6273794021160151, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5347063969665229, 0.9595372821438316, 0.5, 0.6343525795851603, 0.7698739487278304, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.7267994543385141, 0.5, 0.9803508026098036, 0.9704674733625188, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.8060893141567413, 0.870321851182386, 0.5, 0.5, 0.7830343911185799, -1.0, 0.81229924269226, 0.5, 0.7686663103842916, 0.581829141978528, 0.5, 0.6883280827361549, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5522864800708771, 0.5, -1.0, 0.668955379147059, -1.0, 0.8706547870193923, 0.7377551712279322, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5], "episode_lengths": [27, 21, 24, 15, 29, 17, 77, 26, 26, 19, 34, 17, 35, 20, 25, 31, 17, 25, 23, 77, 21, 17, 59, 19, 18, 31, 19, 80, 25, 29, 80, 18, 19, 31, 20, 22, 28, 15, 32, 27, 20, 18, 27, 24, 37, 25, 43, 18, 55, 27, 36, 31, 15, 25, 17, 21, 20, 16, 44, 69, 30, 20, 27, 19, 29, 21, 37, 20, 18, 16, 18, 23, 22, 18, 20, 31, 28, 22, 33, 29, 23, 19, 23, 21, 15, 17, 20, 29, 53, 21, 19, 19, 19, 26, 24, 25, 33, 15, 25, 20, 39, 60, 24, 80, 26, 22, 24, 20, 21, 17, 15, 41, 18, 25, 19, 17, 40, 30, 15, 80, 20, 29, 18, 18, 21, 20, 19, 31, 25, 24, 35, 25, 29, 46, 20, 21, 17, 25, 16, 12, 27, 16, 18, 23, 25, 19, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09285641267832065, "mean_inference_ms": 0.24224319866528657, "mean_action_processing_ms": 0.043687056233937996, "mean_env_wait_ms": 0.04652461575198909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015972422904708759, "StateBufferConnector_ms": 0.001223719849878428, "ViewRequirementAgentConnector_ms": 0.02856157263930963}}, "episode_reward_max": 0.9944379640571693, "episode_reward_min": -1.0, "episode_reward_mean": 0.22894556835693813, "episode_len_mean": 27.183673469387756, "episodes_this_iter": 147, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.989914553763772, 0.5, -1.0, 0.5499058342366053, 0.5, -1.0, 0.5, 0.5, 0.5273456930115171, 0.5, 0.5, 0.5075918469403939, -1.0, 0.5, 0.5, 0.6349714777120284, 0.6053678093539778, 0.7530284879187414, -1.0, -1.0, 0.5, -1.0, 0.9445483547183401, 0.8377030124176279, -1.0, 0.5, -1.0, 0.5734519423520329, 0.7367430943863084, -1.0, 0.8325007885595189, 0.8411542211855831, 0.6532567764205559, 0.5118361079673188, 0.7388781750018035, -1.0, 0.9346500741281363, 0.5, 0.5, 0.6630222224899182, 0.5, 0.6211659832782885, 0.8814606815748033, 0.5, 0.6305425582938959, -1.0, 0.5, 0.5, 0.5, 0.5, 0.9944379640571693, 0.791214565369464, 0.5, 0.7949122270106819, 0.5, 0.8091329057134247, 0.73567191998045, 0.5, -1.0, 0.5, 0.5, 0.5, 0.7459574642527735, -1.0, 0.5, -1.0, -1.0, 0.7093973223823113, 0.7563683972280688, 0.5, 0.5, 0.6280247287199858, -1.0, 0.5146212017797431, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.8919874340059429, -1.0, 0.9705452306943271, 0.6273794021160151, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5347063969665229, 0.9595372821438316, 0.5, 0.6343525795851603, 0.7698739487278304, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, -1.0, 0.7267994543385141, 0.5, 0.9803508026098036, 0.9704674733625188, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.8060893141567413, 0.870321851182386, 0.5, 0.5, 0.7830343911185799, -1.0, 0.81229924269226, 0.5, 0.7686663103842916, 0.581829141978528, 0.5, 0.6883280827361549, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5522864800708771, 0.5, -1.0, 0.668955379147059, -1.0, 0.8706547870193923, 0.7377551712279322, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5], "episode_lengths": [27, 21, 24, 15, 29, 17, 77, 26, 26, 19, 34, 17, 35, 20, 25, 31, 17, 25, 23, 77, 21, 17, 59, 19, 18, 31, 19, 80, 25, 29, 80, 18, 19, 31, 20, 22, 28, 15, 32, 27, 20, 18, 27, 24, 37, 25, 43, 18, 55, 27, 36, 31, 15, 25, 17, 21, 20, 16, 44, 69, 30, 20, 27, 19, 29, 21, 37, 20, 18, 16, 18, 23, 22, 18, 20, 31, 28, 22, 33, 29, 23, 19, 23, 21, 15, 17, 20, 29, 53, 21, 19, 19, 19, 26, 24, 25, 33, 15, 25, 20, 39, 60, 24, 80, 26, 22, 24, 20, 21, 17, 15, 41, 18, 25, 19, 17, 40, 30, 15, 80, 20, 29, 18, 18, 21, 20, 19, 31, 25, 24, 35, 25, 29, 46, 20, 21, 17, 25, 16, 12, 27, 16, 18, 23, 25, 19, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09285641267832065, "mean_inference_ms": 0.24224319866528657, "mean_action_processing_ms": 0.043687056233937996, "mean_env_wait_ms": 0.04652461575198909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015972422904708759, "StateBufferConnector_ms": 0.001223719849878428, "ViewRequirementAgentConnector_ms": 0.02856157263930963}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1108.0301265133924, "num_env_steps_trained_throughput_per_sec": 1108.0301265133924, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 3596.899, "sample_time_ms": 1739.33, "load_time_ms": 0.199, "load_throughput": 20054047.334, "learn_time_ms": 1856.388, "learn_throughput": 2154.722, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 4297, "training_iteration": 49, "trial_id": "default", "date": "2024-05-22_22-17-55", "timestamp": 1716409075, "time_this_iter_s": 3.613157272338867, "time_total_s": 174.86886191368103, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 174.86886191368103, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.0, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.963885696729024, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17091923748989218, "policy_loss": -0.003949786670586115, "vf_loss": 0.17452842993361334, "vf_explained_var": 0.34743325364205146, "kl": 0.01362383287572603, "entropy": 1.5691469614223768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 0.9891155191477214, "episode_reward_min": -1.0, "episode_reward_mean": 0.19046834929631276, "episode_len_mean": 26.31578947368421, "episode_media": {}, "episodes_this_iter": 152, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5745831859288424, -1.0, 0.8273751682233965, 0.5, -1.0, 0.6815183430907852, 0.7328699595324992, 0.5, 0.9189151567040816, 0.5, 0.751007620431749, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.788115207114906, 0.5, 0.5, 0.5, -1.0, 0.8198571235545362, -1.0, 0.5, 0.5, 0.5, 0.7075116977855092, -1.0, 0.8027949414217489, 0.6499149379737712, 0.5, -1.0, -1.0, 0.6063007339630342, -1.0, -1.0, 0.5936906026490134, 0.5628186713625289, 0.51734436042464, 0.5, -1.0, 0.7677976617341639, -1.0, 0.5, 0.5, 0.5, 0.6050942224879152, 0.5, 0.5, 0.5, 0.8748375925501767, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.9837891855771946, 0.8922662887756608, 0.65235220245876, 0.5, -1.0, 0.5, 0.7513402241819975, 0.7269503498634571, -1.0, 0.8516766508877478, 0.5, -1.0, 0.6882184825049849, -1.0, -1.0, -1.0, 0.5, 0.8288654650310213, 0.5, -1.0, -1.0, 0.5, 0.5, 0.9891155191477214, -1.0, 0.5, 0.9535392407255067, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.7886519139910477, 0.5, 0.9499823847193144, 0.6831158518212936, -1.0, -1.0, 0.6926582594046243, 0.5, 0.8551943004810274, -1.0, 0.5099095127204469, -1.0, 0.5621132089878869, 0.5, 0.6466470955806813, 0.6596996705901118, -1.0, 0.5, 0.5, -1.0, 0.9728892166345278, 0.9884651713615178, 0.722703189558455, 0.5, 0.5011542270132184, -1.0, -1.0, 0.5, 0.5, 0.9582627664030967, 0.5, 0.5, 0.5, 0.5, 0.6591207790963325, 0.5784634155094849, 0.5, 0.5, 0.6740174344880148, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9308106494046835, 0.5168692491864204, 0.5], "episode_lengths": [25, 26, 23, 15, 19, 12, 21, 19, 29, 24, 20, 18, 18, 62, 46, 41, 31, 31, 80, 23, 17, 34, 24, 76, 19, 40, 28, 21, 54, 21, 22, 15, 18, 80, 17, 29, 22, 22, 39, 18, 18, 16, 18, 21, 18, 37, 21, 22, 28, 17, 17, 19, 27, 80, 24, 39, 17, 26, 31, 28, 15, 17, 23, 20, 39, 43, 24, 45, 19, 21, 19, 19, 17, 41, 22, 19, 27, 20, 18, 35, 19, 24, 18, 48, 20, 19, 28, 24, 12, 18, 22, 24, 17, 26, 19, 26, 27, 19, 53, 23, 18, 26, 18, 20, 43, 17, 25, 18, 29, 16, 21, 19, 20, 23, 18, 34, 28, 21, 19, 29, 34, 16, 20, 20, 16, 25, 18, 22, 80, 22, 21, 28, 24, 28, 28, 21, 22, 23, 18, 36, 21, 17, 22, 32, 26, 29, 31, 22, 28, 29, 27, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09296609171861368, "mean_inference_ms": 0.24226782662282673, "mean_action_processing_ms": 0.043694309869743986, "mean_env_wait_ms": 0.04654234741597898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015505050358019378, "StateBufferConnector_ms": 0.0012463644931190892, "ViewRequirementAgentConnector_ms": 0.028576192102934186}}, "episode_reward_max": 0.9891155191477214, "episode_reward_min": -1.0, "episode_reward_mean": 0.19046834929631276, "episode_len_mean": 26.31578947368421, "episodes_this_iter": 152, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5745831859288424, -1.0, 0.8273751682233965, 0.5, -1.0, 0.6815183430907852, 0.7328699595324992, 0.5, 0.9189151567040816, 0.5, 0.751007620431749, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.788115207114906, 0.5, 0.5, 0.5, -1.0, 0.8198571235545362, -1.0, 0.5, 0.5, 0.5, 0.7075116977855092, -1.0, 0.8027949414217489, 0.6499149379737712, 0.5, -1.0, -1.0, 0.6063007339630342, -1.0, -1.0, 0.5936906026490134, 0.5628186713625289, 0.51734436042464, 0.5, -1.0, 0.7677976617341639, -1.0, 0.5, 0.5, 0.5, 0.6050942224879152, 0.5, 0.5, 0.5, 0.8748375925501767, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, 0.9837891855771946, 0.8922662887756608, 0.65235220245876, 0.5, -1.0, 0.5, 0.7513402241819975, 0.7269503498634571, -1.0, 0.8516766508877478, 0.5, -1.0, 0.6882184825049849, -1.0, -1.0, -1.0, 0.5, 0.8288654650310213, 0.5, -1.0, -1.0, 0.5, 0.5, 0.9891155191477214, -1.0, 0.5, 0.9535392407255067, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.7886519139910477, 0.5, 0.9499823847193144, 0.6831158518212936, -1.0, -1.0, 0.6926582594046243, 0.5, 0.8551943004810274, -1.0, 0.5099095127204469, -1.0, 0.5621132089878869, 0.5, 0.6466470955806813, 0.6596996705901118, -1.0, 0.5, 0.5, -1.0, 0.9728892166345278, 0.9884651713615178, 0.722703189558455, 0.5, 0.5011542270132184, -1.0, -1.0, 0.5, 0.5, 0.9582627664030967, 0.5, 0.5, 0.5, 0.5, 0.6591207790963325, 0.5784634155094849, 0.5, 0.5, 0.6740174344880148, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9308106494046835, 0.5168692491864204, 0.5], "episode_lengths": [25, 26, 23, 15, 19, 12, 21, 19, 29, 24, 20, 18, 18, 62, 46, 41, 31, 31, 80, 23, 17, 34, 24, 76, 19, 40, 28, 21, 54, 21, 22, 15, 18, 80, 17, 29, 22, 22, 39, 18, 18, 16, 18, 21, 18, 37, 21, 22, 28, 17, 17, 19, 27, 80, 24, 39, 17, 26, 31, 28, 15, 17, 23, 20, 39, 43, 24, 45, 19, 21, 19, 19, 17, 41, 22, 19, 27, 20, 18, 35, 19, 24, 18, 48, 20, 19, 28, 24, 12, 18, 22, 24, 17, 26, 19, 26, 27, 19, 53, 23, 18, 26, 18, 20, 43, 17, 25, 18, 29, 16, 21, 19, 20, 23, 18, 34, 28, 21, 19, 29, 34, 16, 20, 20, 16, 25, 18, 22, 80, 22, 21, 28, 24, 28, 28, 21, 22, 23, 18, 36, 21, 17, 22, 32, 26, 29, 31, 22, 28, 29, 27, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09296609171861368, "mean_inference_ms": 0.24226782662282673, "mean_action_processing_ms": 0.043694309869743986, "mean_env_wait_ms": 0.04654234741597898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015505050358019378, "StateBufferConnector_ms": 0.0012463644931190892, "ViewRequirementAgentConnector_ms": 0.028576192102934186}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1089.5304980837836, "num_env_steps_trained_throughput_per_sec": 1089.5304980837836, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 3608.39, "sample_time_ms": 1741.81, "load_time_ms": 0.2, "load_throughput": 19984771.888, "learn_time_ms": 1865.38, "learn_throughput": 2144.335, "synch_weights_time_ms": 0.667}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 4449, "training_iteration": 50, "trial_id": "default", "date": "2024-05-22_22-17-58", "timestamp": 1716409078, "time_this_iter_s": 3.6744978427886963, "time_total_s": 178.54335975646973, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 178.54335975646973, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.24, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0907617161350864, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15942167170462823, "policy_loss": -0.007351330675995879, "vf_loss": 0.16651424320755145, "vf_explained_var": 0.3411478666849034, "kl": 0.010350371192579413, "entropy": 1.5071808582992965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 0.9924854245402617, "episode_reward_min": -1.0, "episode_reward_mean": 0.283323568028354, "episode_len_mean": 26.388157894736842, "episode_media": {}, "episodes_this_iter": 152, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, 0.8272894722724563, 0.5, 0.8219883884685203, -1.0, 0.5, -1.0, 0.5, 0.6680519603870075, 0.5, 0.5, 0.5196314837218505, 0.5, 0.5, 0.9685962944601529, 0.5, 0.5, 0.7151255325917434, 0.5, 0.5, 0.5118488384367683, 0.8298590238290992, 0.94005778476767, 0.8206103626571684, 0.6723514263378021, 0.5842543147629979, 0.5, 0.8925950849229984, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5259750509040284, 0.5, -1.0, 0.9143876745991084, 0.5633009972997042, 0.9092896378231696, 0.5, -1.0, 0.9924854245402617, 0.9107041855997885, 0.7276960668589927, 0.5942457788553287, 0.5, 0.5, 0.6084757160410947, -1.0, 0.7766635448303207, 0.5, 0.5, 0.6472026911392879, 0.9625247322145499, -1.0, 0.6345062658985169, 0.7746367621327483, -1.0, -1.0, 0.8742413491294405, 0.6459197863883193, -1.0, 0.5, 0.7785837413357282, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.9556698184128705, -1.0, -1.0, 0.5, 0.7282468743265698, 0.5, 0.7833183174298368, 0.7522652375059213, -1.0, 0.8506608817283223, 0.528273069097948, -1.0, -1.0, -1.0, 0.5, 0.7841267034659433, 0.5278950322701432, 0.5, 0.6697241788082728, 0.5, 0.5, 0.7497421795653882, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8974153596292814, 0.6788920299403762, 0.5194060100277791, 0.5, 0.5298220262119551, 0.8763282722911043, -1.0, 0.7778932293110576, 0.5, 0.7536550558155224, 0.5, 0.9854113585038408, -1.0, 0.7228605639973567, -1.0, 0.5, 0.5, 0.95068312438448, 0.5, 0.5, -1.0, 0.7322854684763285, 0.5, 0.5, 0.9171605618280245, 0.8119305348008641, 0.6927079093247457, 0.5, 0.6956803952907535, 0.5, 0.5, 0.5, 0.5, 0.7158417337248995, 0.5, -1.0, 0.5213737542734679, 0.8135110951113458, 0.5, -1.0, 0.5, 0.5, 0.6244938348440292, -1.0, 0.5, 0.8153215382047061, 0.5894868185000496, 0.5, -1.0], "episode_lengths": [53, 18, 25, 20, 27, 23, 26, 29, 26, 28, 21, 20, 21, 24, 21, 38, 19, 29, 19, 17, 28, 29, 18, 21, 18, 16, 20, 22, 16, 17, 33, 29, 25, 21, 33, 24, 27, 23, 29, 24, 21, 18, 18, 18, 80, 22, 29, 21, 18, 20, 36, 18, 48, 24, 25, 52, 22, 23, 34, 20, 22, 34, 21, 17, 19, 26, 23, 23, 20, 23, 22, 26, 33, 25, 19, 80, 31, 24, 19, 18, 17, 18, 80, 22, 21, 80, 25, 22, 21, 20, 31, 23, 26, 23, 23, 17, 18, 22, 24, 18, 25, 24, 17, 25, 17, 20, 20, 20, 20, 80, 22, 36, 21, 23, 16, 73, 24, 30, 37, 36, 20, 32, 26, 21, 20, 30, 17, 25, 16, 41, 20, 20, 25, 24, 22, 19, 23, 24, 19, 24, 20, 31, 42, 18, 20, 16, 32, 23, 21, 18, 16, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09306605382605881, "mean_inference_ms": 0.2422796310228162, "mean_action_processing_ms": 0.04369740944257061, "mean_env_wait_ms": 0.04655420983245734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015558380829660517, "StateBufferConnector_ms": 0.001217189588044819, "ViewRequirementAgentConnector_ms": 0.028428592179950914}}, "episode_reward_max": 0.9924854245402617, "episode_reward_min": -1.0, "episode_reward_mean": 0.283323568028354, "episode_len_mean": 26.388157894736842, "episodes_this_iter": 152, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, 0.8272894722724563, 0.5, 0.8219883884685203, -1.0, 0.5, -1.0, 0.5, 0.6680519603870075, 0.5, 0.5, 0.5196314837218505, 0.5, 0.5, 0.9685962944601529, 0.5, 0.5, 0.7151255325917434, 0.5, 0.5, 0.5118488384367683, 0.8298590238290992, 0.94005778476767, 0.8206103626571684, 0.6723514263378021, 0.5842543147629979, 0.5, 0.8925950849229984, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5259750509040284, 0.5, -1.0, 0.9143876745991084, 0.5633009972997042, 0.9092896378231696, 0.5, -1.0, 0.9924854245402617, 0.9107041855997885, 0.7276960668589927, 0.5942457788553287, 0.5, 0.5, 0.6084757160410947, -1.0, 0.7766635448303207, 0.5, 0.5, 0.6472026911392879, 0.9625247322145499, -1.0, 0.6345062658985169, 0.7746367621327483, -1.0, -1.0, 0.8742413491294405, 0.6459197863883193, -1.0, 0.5, 0.7785837413357282, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.9556698184128705, -1.0, -1.0, 0.5, 0.7282468743265698, 0.5, 0.7833183174298368, 0.7522652375059213, -1.0, 0.8506608817283223, 0.528273069097948, -1.0, -1.0, -1.0, 0.5, 0.7841267034659433, 0.5278950322701432, 0.5, 0.6697241788082728, 0.5, 0.5, 0.7497421795653882, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8974153596292814, 0.6788920299403762, 0.5194060100277791, 0.5, 0.5298220262119551, 0.8763282722911043, -1.0, 0.7778932293110576, 0.5, 0.7536550558155224, 0.5, 0.9854113585038408, -1.0, 0.7228605639973567, -1.0, 0.5, 0.5, 0.95068312438448, 0.5, 0.5, -1.0, 0.7322854684763285, 0.5, 0.5, 0.9171605618280245, 0.8119305348008641, 0.6927079093247457, 0.5, 0.6956803952907535, 0.5, 0.5, 0.5, 0.5, 0.7158417337248995, 0.5, -1.0, 0.5213737542734679, 0.8135110951113458, 0.5, -1.0, 0.5, 0.5, 0.6244938348440292, -1.0, 0.5, 0.8153215382047061, 0.5894868185000496, 0.5, -1.0], "episode_lengths": [53, 18, 25, 20, 27, 23, 26, 29, 26, 28, 21, 20, 21, 24, 21, 38, 19, 29, 19, 17, 28, 29, 18, 21, 18, 16, 20, 22, 16, 17, 33, 29, 25, 21, 33, 24, 27, 23, 29, 24, 21, 18, 18, 18, 80, 22, 29, 21, 18, 20, 36, 18, 48, 24, 25, 52, 22, 23, 34, 20, 22, 34, 21, 17, 19, 26, 23, 23, 20, 23, 22, 26, 33, 25, 19, 80, 31, 24, 19, 18, 17, 18, 80, 22, 21, 80, 25, 22, 21, 20, 31, 23, 26, 23, 23, 17, 18, 22, 24, 18, 25, 24, 17, 25, 17, 20, 20, 20, 20, 80, 22, 36, 21, 23, 16, 73, 24, 30, 37, 36, 20, 32, 26, 21, 20, 30, 17, 25, 16, 41, 20, 20, 25, 24, 22, 19, 23, 24, 19, 24, 20, 31, 42, 18, 20, 16, 32, 23, 21, 18, 16, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09306605382605881, "mean_inference_ms": 0.2422796310228162, "mean_action_processing_ms": 0.04369740944257061, "mean_env_wait_ms": 0.04655420983245734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015558380829660517, "StateBufferConnector_ms": 0.001217189588044819, "ViewRequirementAgentConnector_ms": 0.028428592179950914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.5853147016755, "num_env_steps_trained_throughput_per_sec": 1102.5853147016755, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 3615.0, "sample_time_ms": 1743.617, "load_time_ms": 0.201, "load_throughput": 19923068.519, "learn_time_ms": 1870.184, "learn_throughput": 2138.827, "synch_weights_time_ms": 0.661}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 4601, "training_iteration": 51, "trial_id": "default", "date": "2024-05-22_22-18-02", "timestamp": 1716409082, "time_this_iter_s": 3.6312100887298584, "time_total_s": 182.17456984519958, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.17456984519958, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 18.439999999999998, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.197229285586265, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16766878569508673, "policy_loss": -0.007875213247313294, "vf_loss": 0.17530667643633582, "vf_explained_var": 0.2377047662452985, "kl": 0.00949297257081621, "entropy": 1.4644989013671874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 0.9842599137182695, "episode_reward_min": -1.0, "episode_reward_mean": 0.24860219878406756, "episode_len_mean": 25.84516129032258, "episode_media": {}, "episodes_this_iter": 155, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5040841061831276, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.904888505609363, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5846127125180571, 0.5988560619781113, 0.5, 0.5, -1.0, 0.7338464393147524, -1.0, -1.0, 0.5, 0.9789417959455355, 0.8722059709487598, 0.5620445123467512, -1.0, 0.5, 0.5, -1.0, 0.5661998101196462, 0.5, 0.9758696782424605, -1.0, 0.8815631817207622, 0.5, -1.0, 0.5, 0.5, 0.8976806011948377, 0.8041930359152141, -1.0, 0.5, -1.0, 0.5, 0.7288204151975329, 0.5, -1.0, 0.5, 0.5, -1.0, 0.8916726293491065, 0.5, 0.5, 0.5, 0.5, 0.6635077159728233, 0.6754159200744863, 0.5, 0.9813586139674183, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.792819688833294, 0.5, 0.864197453912762, 0.5, 0.9126191947282023, 0.7955581331833519, 0.9842599137182695, 0.5, 0.9479447790752566, 0.8276086820588968, -1.0, 0.7920767667994116, 0.5, 0.5, 0.5, 0.5, -1.0, 0.7331504305820202, -1.0, -1.0, 0.5150647712145969, 0.5, 0.6262652544082552, 0.5, 0.5, 0.5, 0.7542753330010219, 0.5, 0.8132916634270736, 0.5458122176358846, 0.5, 0.5, 0.5, 0.8907728281651961, 0.8155468466682884, 0.7813766159520531, 0.5, 0.5, 0.561163865064096, -1.0, 0.5, 0.6160337189970322, 0.5, 0.5, 0.5, 0.6098969794470313, 0.6309820476907964, 0.5, 0.5, -1.0, 0.9204593554711366, 0.5, 0.5, 0.5166179771385903, -1.0, 0.5, 0.6790834306888535, 0.7496125580748686, -1.0, -1.0, 0.7004838809909852, 0.5, 0.9807171094397269, -1.0, 0.7320681413574502, 0.5, 0.6670765819377754, -1.0, -1.0, -1.0, -1.0, 0.5, 0.7326588966520191, 0.5, 0.5, 0.5, 0.7828084292280046, 0.664569584792112, 0.5, 0.5, 0.7689899859935609, -1.0, 0.8127597440205154, 0.7089562445833422], "episode_lengths": [16, 34, 28, 24, 33, 17, 22, 45, 23, 26, 20, 35, 25, 21, 20, 20, 24, 16, 26, 25, 16, 31, 19, 33, 17, 42, 22, 24, 17, 29, 27, 15, 28, 19, 26, 24, 23, 74, 22, 19, 18, 15, 23, 45, 18, 17, 20, 24, 30, 17, 16, 50, 29, 31, 25, 19, 19, 20, 22, 24, 18, 23, 21, 24, 25, 18, 23, 32, 24, 28, 27, 19, 28, 21, 22, 20, 21, 21, 18, 23, 24, 33, 33, 37, 27, 31, 45, 80, 22, 32, 22, 19, 25, 19, 30, 25, 25, 23, 20, 19, 24, 26, 21, 21, 24, 20, 25, 25, 19, 39, 28, 24, 19, 20, 24, 32, 24, 21, 21, 23, 29, 17, 42, 23, 18, 21, 36, 20, 21, 40, 14, 15, 38, 22, 80, 20, 22, 38, 25, 39, 80, 24, 28, 24, 18, 20, 30, 16, 22, 18, 28, 22, 20, 18, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09320235834783729, "mean_inference_ms": 0.24236883845628618, "mean_action_processing_ms": 0.0437167099334055, "mean_env_wait_ms": 0.046587285627266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015847913680538054, "StateBufferConnector_ms": 0.0012711555727066533, "ViewRequirementAgentConnector_ms": 0.02911583069832094}}, "episode_reward_max": 0.9842599137182695, "episode_reward_min": -1.0, "episode_reward_mean": 0.24860219878406756, "episode_len_mean": 25.84516129032258, "episodes_this_iter": 155, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5040841061831276, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.904888505609363, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5846127125180571, 0.5988560619781113, 0.5, 0.5, -1.0, 0.7338464393147524, -1.0, -1.0, 0.5, 0.9789417959455355, 0.8722059709487598, 0.5620445123467512, -1.0, 0.5, 0.5, -1.0, 0.5661998101196462, 0.5, 0.9758696782424605, -1.0, 0.8815631817207622, 0.5, -1.0, 0.5, 0.5, 0.8976806011948377, 0.8041930359152141, -1.0, 0.5, -1.0, 0.5, 0.7288204151975329, 0.5, -1.0, 0.5, 0.5, -1.0, 0.8916726293491065, 0.5, 0.5, 0.5, 0.5, 0.6635077159728233, 0.6754159200744863, 0.5, 0.9813586139674183, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.792819688833294, 0.5, 0.864197453912762, 0.5, 0.9126191947282023, 0.7955581331833519, 0.9842599137182695, 0.5, 0.9479447790752566, 0.8276086820588968, -1.0, 0.7920767667994116, 0.5, 0.5, 0.5, 0.5, -1.0, 0.7331504305820202, -1.0, -1.0, 0.5150647712145969, 0.5, 0.6262652544082552, 0.5, 0.5, 0.5, 0.7542753330010219, 0.5, 0.8132916634270736, 0.5458122176358846, 0.5, 0.5, 0.5, 0.8907728281651961, 0.8155468466682884, 0.7813766159520531, 0.5, 0.5, 0.561163865064096, -1.0, 0.5, 0.6160337189970322, 0.5, 0.5, 0.5, 0.6098969794470313, 0.6309820476907964, 0.5, 0.5, -1.0, 0.9204593554711366, 0.5, 0.5, 0.5166179771385903, -1.0, 0.5, 0.6790834306888535, 0.7496125580748686, -1.0, -1.0, 0.7004838809909852, 0.5, 0.9807171094397269, -1.0, 0.7320681413574502, 0.5, 0.6670765819377754, -1.0, -1.0, -1.0, -1.0, 0.5, 0.7326588966520191, 0.5, 0.5, 0.5, 0.7828084292280046, 0.664569584792112, 0.5, 0.5, 0.7689899859935609, -1.0, 0.8127597440205154, 0.7089562445833422], "episode_lengths": [16, 34, 28, 24, 33, 17, 22, 45, 23, 26, 20, 35, 25, 21, 20, 20, 24, 16, 26, 25, 16, 31, 19, 33, 17, 42, 22, 24, 17, 29, 27, 15, 28, 19, 26, 24, 23, 74, 22, 19, 18, 15, 23, 45, 18, 17, 20, 24, 30, 17, 16, 50, 29, 31, 25, 19, 19, 20, 22, 24, 18, 23, 21, 24, 25, 18, 23, 32, 24, 28, 27, 19, 28, 21, 22, 20, 21, 21, 18, 23, 24, 33, 33, 37, 27, 31, 45, 80, 22, 32, 22, 19, 25, 19, 30, 25, 25, 23, 20, 19, 24, 26, 21, 21, 24, 20, 25, 25, 19, 39, 28, 24, 19, 20, 24, 32, 24, 21, 21, 23, 29, 17, 42, 23, 18, 21, 36, 20, 21, 40, 14, 15, 38, 22, 80, 20, 22, 38, 25, 39, 80, 24, 28, 24, 18, 20, 30, 16, 22, 18, 28, 22, 20, 18, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09320235834783729, "mean_inference_ms": 0.24236883845628618, "mean_action_processing_ms": 0.0437167099334055, "mean_env_wait_ms": 0.046587285627266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015847913680538054, "StateBufferConnector_ms": 0.0012711555727066533, "ViewRequirementAgentConnector_ms": 0.02911583069832094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1064.825773719852, "num_env_steps_trained_throughput_per_sec": 1064.825773719852, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 3631.852, "sample_time_ms": 1747.678, "load_time_ms": 0.201, "load_throughput": 19934904.943, "learn_time_ms": 1882.969, "learn_throughput": 2124.304, "synch_weights_time_ms": 0.663}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 4756, "training_iteration": 52, "trial_id": "default", "date": "2024-05-22_22-18-06", "timestamp": 1716409086, "time_this_iter_s": 3.759906053543091, "time_total_s": 185.93447589874268, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 185.93447589874268, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.360000000000003, "ram_util_percent": 61.18000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3240292689492628, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15030376523181105, "policy_loss": -0.0027602596979548213, "vf_loss": 0.1527588632839021, "vf_explained_var": 0.42925342648260056, "kl": 0.01220645644636386, "entropy": 1.4105180187891888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 0.9986240886898442, "episode_reward_min": -1.0, "episode_reward_mean": 0.22614836457190418, "episode_len_mean": 24.8625, "episode_media": {}, "episodes_this_iter": 160, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, -1.0, 0.9400958977846372, 0.5, 0.7720152430407609, -1.0, 0.5, 0.7023846223056136, -1.0, 0.971484471499024, 0.9203783214313437, 0.5, -1.0, 0.5, 0.803434753923417, 0.5, 0.6190819423980116, 0.9754722792394002, 0.7306443977479204, 0.5, 0.5097629826751078, -1.0, 0.7742931991342822, 0.5, -1.0, 0.663949687730166, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5076518647061529, 0.9234885733321656, 0.5, 0.5, -1.0, 0.5, 0.7401161389674265, 0.7020945624051875, 0.5, 0.5, 0.6546715364720997, -1.0, 0.8157812271815097, 0.5, -1.0, 0.6647395214919266, 0.8042091119627702, 0.7440053952730129, 0.5, 0.5, 0.5, 0.7490416063907469, 0.7282739943481702, -1.0, 0.7208648355999316, 0.8378300423667557, 0.7035272890311994, -1.0, -1.0, 0.873296929462573, -1.0, 0.5, 0.9333028998907471, -1.0, 0.9753275270215813, -1.0, 0.5, -1.0, 0.5, 0.9411040804378235, 0.5, 0.7533866639962744, 0.5, 0.5, 0.5, 0.8077390861223726, 0.5, 0.6124686274646409, 0.7214592589907033, 0.5, 0.8711783784700273, 0.8555524456959446, 0.5, 0.7974302559568012, -1.0, 0.6316540243632562, -1.0, -1.0, 0.9986240886898442, 0.5, -1.0, 0.6476197440744546, 0.9938265593408326, 0.5, 0.6278509035367443, -1.0, 0.5, -1.0, 0.5, 0.653149915669485, 0.5, 0.5067578496614598, 0.5, -1.0, 0.5, 0.5, 0.9754468984576746, -1.0, 0.7051504268109103, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5083942447015359, 0.5, -1.0, 0.5, -1.0, 0.7067273442128653, 0.742989330004707, 0.5, 0.5, 0.6934095532944612, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.8167736780840466, 0.5, 0.5, 0.5, 0.7438100905557283, 0.5, 0.689127893560953, 0.5, 0.5, 0.5, 0.6386590852107297, -1.0, -1.0, 0.8301547958013884, -1.0, -1.0, 0.5, 0.7520722535253561, 0.5, 0.5, 0.5], "episode_lengths": [20, 20, 24, 21, 26, 19, 80, 23, 17, 24, 20, 17, 17, 30, 21, 23, 23, 17, 19, 20, 23, 22, 24, 22, 27, 27, 20, 20, 32, 39, 23, 20, 27, 25, 33, 19, 22, 22, 18, 25, 25, 31, 30, 26, 21, 24, 25, 20, 22, 28, 21, 20, 17, 22, 29, 20, 18, 19, 33, 18, 24, 24, 16, 27, 18, 11, 19, 16, 24, 23, 33, 23, 22, 24, 20, 29, 17, 26, 19, 35, 19, 25, 28, 29, 21, 26, 21, 43, 26, 80, 18, 25, 27, 24, 42, 24, 25, 19, 34, 29, 25, 30, 18, 20, 21, 24, 28, 26, 49, 27, 28, 19, 26, 23, 27, 23, 21, 18, 80, 21, 22, 18, 30, 19, 31, 40, 20, 20, 24, 22, 20, 25, 19, 22, 27, 26, 23, 23, 26, 22, 21, 34, 18, 18, 19, 19, 24, 17, 19, 21, 22, 80, 20, 24, 16, 19, 16, 22, 16, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09337657167132388, "mean_inference_ms": 0.242523488889056, "mean_action_processing_ms": 0.04375166093654625, "mean_env_wait_ms": 0.0466390211422118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001573711633682251, "StateBufferConnector_ms": 0.001291036605834961, "ViewRequirementAgentConnector_ms": 0.029559433460235596}}, "episode_reward_max": 0.9986240886898442, "episode_reward_min": -1.0, "episode_reward_mean": 0.22614836457190418, "episode_len_mean": 24.8625, "episodes_this_iter": 160, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, -1.0, 0.9400958977846372, 0.5, 0.7720152430407609, -1.0, 0.5, 0.7023846223056136, -1.0, 0.971484471499024, 0.9203783214313437, 0.5, -1.0, 0.5, 0.803434753923417, 0.5, 0.6190819423980116, 0.9754722792394002, 0.7306443977479204, 0.5, 0.5097629826751078, -1.0, 0.7742931991342822, 0.5, -1.0, 0.663949687730166, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5076518647061529, 0.9234885733321656, 0.5, 0.5, -1.0, 0.5, 0.7401161389674265, 0.7020945624051875, 0.5, 0.5, 0.6546715364720997, -1.0, 0.8157812271815097, 0.5, -1.0, 0.6647395214919266, 0.8042091119627702, 0.7440053952730129, 0.5, 0.5, 0.5, 0.7490416063907469, 0.7282739943481702, -1.0, 0.7208648355999316, 0.8378300423667557, 0.7035272890311994, -1.0, -1.0, 0.873296929462573, -1.0, 0.5, 0.9333028998907471, -1.0, 0.9753275270215813, -1.0, 0.5, -1.0, 0.5, 0.9411040804378235, 0.5, 0.7533866639962744, 0.5, 0.5, 0.5, 0.8077390861223726, 0.5, 0.6124686274646409, 0.7214592589907033, 0.5, 0.8711783784700273, 0.8555524456959446, 0.5, 0.7974302559568012, -1.0, 0.6316540243632562, -1.0, -1.0, 0.9986240886898442, 0.5, -1.0, 0.6476197440744546, 0.9938265593408326, 0.5, 0.6278509035367443, -1.0, 0.5, -1.0, 0.5, 0.653149915669485, 0.5, 0.5067578496614598, 0.5, -1.0, 0.5, 0.5, 0.9754468984576746, -1.0, 0.7051504268109103, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5083942447015359, 0.5, -1.0, 0.5, -1.0, 0.7067273442128653, 0.742989330004707, 0.5, 0.5, 0.6934095532944612, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.8167736780840466, 0.5, 0.5, 0.5, 0.7438100905557283, 0.5, 0.689127893560953, 0.5, 0.5, 0.5, 0.6386590852107297, -1.0, -1.0, 0.8301547958013884, -1.0, -1.0, 0.5, 0.7520722535253561, 0.5, 0.5, 0.5], "episode_lengths": [20, 20, 24, 21, 26, 19, 80, 23, 17, 24, 20, 17, 17, 30, 21, 23, 23, 17, 19, 20, 23, 22, 24, 22, 27, 27, 20, 20, 32, 39, 23, 20, 27, 25, 33, 19, 22, 22, 18, 25, 25, 31, 30, 26, 21, 24, 25, 20, 22, 28, 21, 20, 17, 22, 29, 20, 18, 19, 33, 18, 24, 24, 16, 27, 18, 11, 19, 16, 24, 23, 33, 23, 22, 24, 20, 29, 17, 26, 19, 35, 19, 25, 28, 29, 21, 26, 21, 43, 26, 80, 18, 25, 27, 24, 42, 24, 25, 19, 34, 29, 25, 30, 18, 20, 21, 24, 28, 26, 49, 27, 28, 19, 26, 23, 27, 23, 21, 18, 80, 21, 22, 18, 30, 19, 31, 40, 20, 20, 24, 22, 20, 25, 19, 22, 27, 26, 23, 23, 26, 22, 21, 34, 18, 18, 19, 19, 24, 17, 19, 21, 22, 80, 20, 24, 16, 19, 16, 22, 16, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09337657167132388, "mean_inference_ms": 0.242523488889056, "mean_action_processing_ms": 0.04375166093654625, "mean_env_wait_ms": 0.0466390211422118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001573711633682251, "StateBufferConnector_ms": 0.001291036605834961, "ViewRequirementAgentConnector_ms": 0.029559433460235596}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1065.3479052406924, "num_env_steps_trained_throughput_per_sec": 1065.3479052406924, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 3640.712, "sample_time_ms": 1755.642, "load_time_ms": 0.204, "load_throughput": 19638553.201, "learn_time_ms": 1883.863, "learn_throughput": 2123.296, "synch_weights_time_ms": 0.663}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 4916, "training_iteration": 53, "trial_id": "default", "date": "2024-05-22_22-18-10", "timestamp": 1716409090, "time_this_iter_s": 3.7578771114349365, "time_total_s": 189.6923530101776, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 189.6923530101776, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 26.566666666666666, "ram_util_percent": 61.383333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.953436211232216, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13049239297513224, "policy_loss": -0.003326215751729505, "vf_loss": 0.13357684727688068, "vf_explained_var": 0.4553217466159533, "kl": 0.009670452867892572, "entropy": 1.4895997217906418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 0.9948079614428521, "episode_reward_min": -1.0, "episode_reward_mean": 0.3059310977324867, "episode_len_mean": 24.524390243902438, "episode_media": {}, "episodes_this_iter": 164, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.5360301324652315, -1.0, 0.8216347946276819, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.531848492714468, 0.6463406673543617, 0.7765345887373477, 0.7607592225547364, -1.0, 0.7605556609128936, 0.9860788165442691, -1.0, -1.0, -1.0, 0.8044759244875354, 0.5, 0.7912314241203607, 0.6404262372470337, 0.5997459404835725, 0.5, 0.7129727004748974, -1.0, 0.842138324216591, 0.5589655084773244, 0.5, 0.5453423977063503, -1.0, 0.9314711190077227, 0.9948079614428521, 0.5738467940541905, 0.5, 0.6874170896192826, 0.8318914702159667, 0.5, -1.0, 0.8813537760431619, -1.0, 0.9178021410984083, 0.5, 0.9211097819877416, 0.5, 0.5, -1.0, 0.9485126893309477, 0.5, 0.5, 0.6468016616669257, 0.748055454642129, 0.6411068622858254, 0.6954483905399407, 0.5, -1.0, 0.9501218930826383, 0.9097595373932941, 0.5, 0.8043682056918553, 0.7446075473236986, 0.9666774433893861, -1.0, 0.7840469467532052, 0.6595795592103701, 0.5, 0.5, 0.8735344926820776, 0.5, 0.5, 0.5, 0.5849941268705281, 0.8195107974467843, 0.5, -1.0, 0.9156790662834489, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5861289439060949, 0.733224262315022, 0.5784663966116391, 0.5, 0.9919755365757893, 0.5, 0.898986881205986, 0.7381016123122832, 0.5, 0.8766987478127135, 0.5, 0.5924497771768136, 0.5, 0.5391191826307924, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5545428254906879, 0.7023328359404484, 0.5, 0.8710471691488172, -1.0, 0.6874970729487326, 0.8347809008684943, 0.5, 0.9262043961059429, 0.5, 0.816572328817339, 0.5, -1.0, 0.5, 0.5, 0.8213004276218295, -1.0, -1.0, 0.5, -1.0, 0.5, 0.6877493706085477, -1.0, 0.6191694213816963, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8386806200672698, 0.7463771137160586, 0.8551892606443838, -1.0, 0.5, 0.5, -1.0, 0.5, 0.8009537586701144, 0.5909709546410095, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5394945256298176, 0.5, 0.5, 0.724667923767959, 0.7649578762866074, 0.5, 0.5729786753912673, 0.5538518299932191, 0.5, 0.8806437586534102], "episode_lengths": [29, 26, 26, 24, 22, 19, 25, 22, 27, 23, 25, 26, 41, 19, 19, 22, 33, 19, 17, 17, 29, 80, 18, 15, 34, 19, 22, 21, 21, 17, 21, 21, 40, 17, 39, 19, 16, 17, 20, 19, 19, 23, 80, 22, 23, 23, 21, 17, 19, 23, 36, 17, 24, 23, 19, 24, 22, 19, 25, 23, 15, 16, 27, 18, 25, 17, 80, 17, 15, 26, 26, 15, 19, 19, 36, 23, 16, 30, 29, 21, 18, 18, 22, 22, 19, 16, 16, 19, 18, 27, 30, 18, 16, 24, 29, 30, 24, 22, 28, 22, 31, 27, 67, 16, 32, 21, 19, 26, 19, 17, 15, 15, 20, 18, 15, 25, 18, 20, 35, 21, 27, 22, 27, 20, 19, 45, 21, 20, 17, 20, 23, 28, 18, 25, 80, 20, 13, 80, 19, 18, 16, 23, 35, 21, 32, 29, 21, 18, 17, 31, 25, 22, 25, 21, 33, 32, 18, 25, 15, 20, 20, 22, 24, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09352942165309926, "mean_inference_ms": 0.24262561219094453, "mean_action_processing_ms": 0.04377277074444358, "mean_env_wait_ms": 0.046675874378055766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016750358953708556, "StateBufferConnector_ms": 0.0012697243108981994, "ViewRequirementAgentConnector_ms": 0.02940209900460592}}, "episode_reward_max": 0.9948079614428521, "episode_reward_min": -1.0, "episode_reward_mean": 0.3059310977324867, "episode_len_mean": 24.524390243902438, "episodes_this_iter": 164, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.5360301324652315, -1.0, 0.8216347946276819, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.531848492714468, 0.6463406673543617, 0.7765345887373477, 0.7607592225547364, -1.0, 0.7605556609128936, 0.9860788165442691, -1.0, -1.0, -1.0, 0.8044759244875354, 0.5, 0.7912314241203607, 0.6404262372470337, 0.5997459404835725, 0.5, 0.7129727004748974, -1.0, 0.842138324216591, 0.5589655084773244, 0.5, 0.5453423977063503, -1.0, 0.9314711190077227, 0.9948079614428521, 0.5738467940541905, 0.5, 0.6874170896192826, 0.8318914702159667, 0.5, -1.0, 0.8813537760431619, -1.0, 0.9178021410984083, 0.5, 0.9211097819877416, 0.5, 0.5, -1.0, 0.9485126893309477, 0.5, 0.5, 0.6468016616669257, 0.748055454642129, 0.6411068622858254, 0.6954483905399407, 0.5, -1.0, 0.9501218930826383, 0.9097595373932941, 0.5, 0.8043682056918553, 0.7446075473236986, 0.9666774433893861, -1.0, 0.7840469467532052, 0.6595795592103701, 0.5, 0.5, 0.8735344926820776, 0.5, 0.5, 0.5, 0.5849941268705281, 0.8195107974467843, 0.5, -1.0, 0.9156790662834489, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5861289439060949, 0.733224262315022, 0.5784663966116391, 0.5, 0.9919755365757893, 0.5, 0.898986881205986, 0.7381016123122832, 0.5, 0.8766987478127135, 0.5, 0.5924497771768136, 0.5, 0.5391191826307924, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5545428254906879, 0.7023328359404484, 0.5, 0.8710471691488172, -1.0, 0.6874970729487326, 0.8347809008684943, 0.5, 0.9262043961059429, 0.5, 0.816572328817339, 0.5, -1.0, 0.5, 0.5, 0.8213004276218295, -1.0, -1.0, 0.5, -1.0, 0.5, 0.6877493706085477, -1.0, 0.6191694213816963, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8386806200672698, 0.7463771137160586, 0.8551892606443838, -1.0, 0.5, 0.5, -1.0, 0.5, 0.8009537586701144, 0.5909709546410095, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5394945256298176, 0.5, 0.5, 0.724667923767959, 0.7649578762866074, 0.5, 0.5729786753912673, 0.5538518299932191, 0.5, 0.8806437586534102], "episode_lengths": [29, 26, 26, 24, 22, 19, 25, 22, 27, 23, 25, 26, 41, 19, 19, 22, 33, 19, 17, 17, 29, 80, 18, 15, 34, 19, 22, 21, 21, 17, 21, 21, 40, 17, 39, 19, 16, 17, 20, 19, 19, 23, 80, 22, 23, 23, 21, 17, 19, 23, 36, 17, 24, 23, 19, 24, 22, 19, 25, 23, 15, 16, 27, 18, 25, 17, 80, 17, 15, 26, 26, 15, 19, 19, 36, 23, 16, 30, 29, 21, 18, 18, 22, 22, 19, 16, 16, 19, 18, 27, 30, 18, 16, 24, 29, 30, 24, 22, 28, 22, 31, 27, 67, 16, 32, 21, 19, 26, 19, 17, 15, 15, 20, 18, 15, 25, 18, 20, 35, 21, 27, 22, 27, 20, 19, 45, 21, 20, 17, 20, 23, 28, 18, 25, 80, 20, 13, 80, 19, 18, 16, 23, 35, 21, 32, 29, 21, 18, 17, 31, 25, 22, 25, 21, 33, 32, 18, 25, 15, 20, 20, 22, 24, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09352942165309926, "mean_inference_ms": 0.24262561219094453, "mean_action_processing_ms": 0.04377277074444358, "mean_env_wait_ms": 0.046675874378055766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016750358953708556, "StateBufferConnector_ms": 0.0012697243108981994, "ViewRequirementAgentConnector_ms": 0.02940209900460592}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1069.3631497626454, "num_env_steps_trained_throughput_per_sec": 1069.3631497626454, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3656.549, "sample_time_ms": 1760.667, "load_time_ms": 0.204, "load_throughput": 19576681.447, "learn_time_ms": 1894.665, "learn_throughput": 2111.191, "synch_weights_time_ms": 0.666}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 5080, "training_iteration": 54, "trial_id": "default", "date": "2024-05-22_22-18-13", "timestamp": 1716409093, "time_this_iter_s": 3.743880033493042, "time_total_s": 193.43623304367065, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 193.43623304367065, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 23.4, "ram_util_percent": 61.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.993080063981395, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1309310888733542, "policy_loss": -0.009383472356624822, "vf_loss": 0.13995333750812358, "vf_explained_var": 0.14254895051320393, "kl": 0.014448984162300007, "entropy": 1.3191117623800872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 0.9994513174610862, "episode_reward_min": -1.0, "episode_reward_mean": 0.4149736510271869, "episode_len_mean": 22.977011494252874, "episode_media": {}, "episodes_this_iter": 174, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7056147415603634, 0.666838385926598, 0.7004145979567725, -1.0, 0.864066014148319, -1.0, 0.5, 0.8313185413808961, 0.5, 0.7978512098527567, 0.5, 0.8288857006848168, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9844004268387204, 0.5756133254061672, 0.9567883610660144, 0.5, -1.0, 0.7080437516810056, 0.7618242314584069, 0.8547816878584062, 0.5, 0.5, 0.5, 0.5, 0.8645489994396361, 0.5, -1.0, 0.5, 0.6452901431809053, 0.8634352048781117, 0.5, 0.5, 0.5, 0.5074904155278508, 0.5, 0.5, 0.6707575246141897, -1.0, 0.8775803692742085, 0.7427693997243034, 0.5502010986904821, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5286329414866482, 0.5, 0.5, 0.6994054629052415, 0.6990938864048248, 0.5, 0.5774703494478864, 0.5, 0.9239130004044164, 0.7579579597518522, 0.9520092947180842, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8136780985155774, 0.5, 0.5, 0.5, -1.0, 0.5956097480411963, 0.5, 0.8167198753628842, 0.5, 0.5, 0.7293887589521174, -1.0, 0.5, 0.5, 0.9093717887546231, 0.8175797878373132, 0.5, 0.5904670284059275, 0.5049170150628859, 0.8681252235356101, 0.5, 0.5, -1.0, 0.5, 0.640738848450853, 0.5141307945230025, 0.5, 0.5, 0.7991465376083702, 0.5988471293787073, 0.5, 0.7335700081683937, 0.7720870298643909, 0.5533884084940117, 0.5, 0.8532848940217319, 0.5544415533779867, 0.5278822641763294, 0.5, 0.5, 0.5, 0.5, 0.5961170532394635, -1.0, 0.539684413823353, -1.0, 0.9235275406530695, -1.0, 0.9311918248855726, -1.0, 0.5, 0.8943630979962862, 0.8536154321875693, 0.5765176825461537, 0.8278215459026845, 0.5, 0.8363180189466805, 0.5484502651074584, 0.9171112003173431, 0.5, -1.0, 0.6584559238182057, 0.5, 0.5, 0.5, 0.5, 0.7242652703966302, -1.0, 0.9435818390515616, 0.6091551364227248, 0.7179997015314525, 0.8387711834913794, -1.0, 0.5, 0.9495702768830259, 0.5, 0.5, 0.925902744581016, 0.5, 0.8279012219511613, 0.5, -1.0, 0.5, -1.0, 0.9773283397132744, 0.9302074730109282, 0.6233402937909763, 0.9994513174610862, 0.7285390999696764, 0.5, 0.5114869086321439, 0.5043686536198468, 0.5, 0.5, 0.5], "episode_lengths": [22, 21, 19, 11, 15, 21, 30, 21, 21, 27, 22, 24, 16, 34, 33, 12, 20, 22, 22, 22, 21, 19, 25, 29, 19, 18, 20, 18, 24, 29, 28, 18, 18, 24, 28, 17, 21, 17, 22, 28, 22, 19, 23, 22, 18, 18, 24, 23, 38, 16, 80, 25, 20, 20, 18, 22, 25, 27, 19, 26, 34, 21, 17, 21, 20, 18, 30, 16, 25, 18, 18, 21, 23, 30, 18, 28, 20, 27, 35, 23, 22, 37, 26, 18, 19, 29, 21, 22, 25, 16, 30, 19, 24, 17, 18, 17, 28, 24, 20, 19, 23, 28, 20, 23, 17, 21, 26, 16, 24, 21, 17, 21, 17, 28, 16, 29, 33, 25, 19, 60, 22, 21, 25, 18, 22, 19, 27, 20, 80, 19, 23, 19, 22, 18, 20, 24, 19, 25, 17, 27, 29, 24, 26, 27, 21, 23, 30, 22, 19, 17, 16, 22, 23, 20, 19, 30, 15, 16, 15, 19, 23, 25, 16, 18, 16, 21, 24, 19, 26, 24, 16, 24, 24, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09370012824446214, "mean_inference_ms": 0.24274431126395601, "mean_action_processing_ms": 0.04379877642568333, "mean_env_wait_ms": 0.046719410251043834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015949380808863147, "StateBufferConnector_ms": 0.001271154688692641, "ViewRequirementAgentConnector_ms": 0.029376183433094245}}, "episode_reward_max": 0.9994513174610862, "episode_reward_min": -1.0, "episode_reward_mean": 0.4149736510271869, "episode_len_mean": 22.977011494252874, "episodes_this_iter": 174, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7056147415603634, 0.666838385926598, 0.7004145979567725, -1.0, 0.864066014148319, -1.0, 0.5, 0.8313185413808961, 0.5, 0.7978512098527567, 0.5, 0.8288857006848168, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9844004268387204, 0.5756133254061672, 0.9567883610660144, 0.5, -1.0, 0.7080437516810056, 0.7618242314584069, 0.8547816878584062, 0.5, 0.5, 0.5, 0.5, 0.8645489994396361, 0.5, -1.0, 0.5, 0.6452901431809053, 0.8634352048781117, 0.5, 0.5, 0.5, 0.5074904155278508, 0.5, 0.5, 0.6707575246141897, -1.0, 0.8775803692742085, 0.7427693997243034, 0.5502010986904821, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5286329414866482, 0.5, 0.5, 0.6994054629052415, 0.6990938864048248, 0.5, 0.5774703494478864, 0.5, 0.9239130004044164, 0.7579579597518522, 0.9520092947180842, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8136780985155774, 0.5, 0.5, 0.5, -1.0, 0.5956097480411963, 0.5, 0.8167198753628842, 0.5, 0.5, 0.7293887589521174, -1.0, 0.5, 0.5, 0.9093717887546231, 0.8175797878373132, 0.5, 0.5904670284059275, 0.5049170150628859, 0.8681252235356101, 0.5, 0.5, -1.0, 0.5, 0.640738848450853, 0.5141307945230025, 0.5, 0.5, 0.7991465376083702, 0.5988471293787073, 0.5, 0.7335700081683937, 0.7720870298643909, 0.5533884084940117, 0.5, 0.8532848940217319, 0.5544415533779867, 0.5278822641763294, 0.5, 0.5, 0.5, 0.5, 0.5961170532394635, -1.0, 0.539684413823353, -1.0, 0.9235275406530695, -1.0, 0.9311918248855726, -1.0, 0.5, 0.8943630979962862, 0.8536154321875693, 0.5765176825461537, 0.8278215459026845, 0.5, 0.8363180189466805, 0.5484502651074584, 0.9171112003173431, 0.5, -1.0, 0.6584559238182057, 0.5, 0.5, 0.5, 0.5, 0.7242652703966302, -1.0, 0.9435818390515616, 0.6091551364227248, 0.7179997015314525, 0.8387711834913794, -1.0, 0.5, 0.9495702768830259, 0.5, 0.5, 0.925902744581016, 0.5, 0.8279012219511613, 0.5, -1.0, 0.5, -1.0, 0.9773283397132744, 0.9302074730109282, 0.6233402937909763, 0.9994513174610862, 0.7285390999696764, 0.5, 0.5114869086321439, 0.5043686536198468, 0.5, 0.5, 0.5], "episode_lengths": [22, 21, 19, 11, 15, 21, 30, 21, 21, 27, 22, 24, 16, 34, 33, 12, 20, 22, 22, 22, 21, 19, 25, 29, 19, 18, 20, 18, 24, 29, 28, 18, 18, 24, 28, 17, 21, 17, 22, 28, 22, 19, 23, 22, 18, 18, 24, 23, 38, 16, 80, 25, 20, 20, 18, 22, 25, 27, 19, 26, 34, 21, 17, 21, 20, 18, 30, 16, 25, 18, 18, 21, 23, 30, 18, 28, 20, 27, 35, 23, 22, 37, 26, 18, 19, 29, 21, 22, 25, 16, 30, 19, 24, 17, 18, 17, 28, 24, 20, 19, 23, 28, 20, 23, 17, 21, 26, 16, 24, 21, 17, 21, 17, 28, 16, 29, 33, 25, 19, 60, 22, 21, 25, 18, 22, 19, 27, 20, 80, 19, 23, 19, 22, 18, 20, 24, 19, 25, 17, 27, 29, 24, 26, 27, 21, 23, 30, 22, 19, 17, 16, 22, 23, 20, 19, 30, 15, 16, 15, 19, 23, 25, 16, 18, 16, 21, 24, 19, 26, 24, 16, 24, 24, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09370012824446214, "mean_inference_ms": 0.24274431126395601, "mean_action_processing_ms": 0.04379877642568333, "mean_env_wait_ms": 0.046719410251043834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015949380808863147, "StateBufferConnector_ms": 0.001271154688692641, "ViewRequirementAgentConnector_ms": 0.029376183433094245}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1072.335194742308, "num_env_steps_trained_throughput_per_sec": 1072.335194742308, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 3668.584, "sample_time_ms": 1766.347, "load_time_ms": 0.204, "load_throughput": 19643151.856, "learn_time_ms": 1901.022, "learn_throughput": 2104.132, "synch_weights_time_ms": 0.666}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 5254, "training_iteration": 55, "trial_id": "default", "date": "2024-05-22_22-18-17", "timestamp": 1716409097, "time_this_iter_s": 3.7335238456726074, "time_total_s": 197.16975688934326, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 197.16975688934326, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 23.060000000000002, "ram_util_percent": 61.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.993798522923582, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12803138717608425, "policy_loss": -0.005982209636919922, "vf_loss": 0.1337816907278192, "vf_explained_var": 0.40113629897435504, "kl": 0.009276217669513157, "entropy": 1.3709185085629905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 0.9985834011808987, "episode_reward_min": -1.0, "episode_reward_mean": 0.3756505095241062, "episode_len_mean": 22.376404494382022, "episode_media": {}, "episodes_this_iter": 178, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.954628183006569, 0.9727608562561265, 0.608665369639915, 0.5, 0.9268357803941292, -1.0, 0.8811758758459677, 0.8178550423135693, 0.5, 0.7512925842643964, 0.5, -1.0, 0.7046434947821144, 0.5, 0.5160954871764629, -1.0, 0.5, 0.9621062457253371, -1.0, 0.5, -1.0, 0.5723032450539085, 0.8345733901037409, 0.5, 0.8912245357385182, 0.6257573278042436, 0.9306207996339073, 0.8853601631586709, 0.6377281419204948, 0.5, 0.914706603922385, 0.5, 0.6976847236418227, 0.6069939324524414, 0.5623920349442234, -1.0, -1.0, 0.5, 0.5, 0.5, 0.864890042089468, 0.5, 0.5, 0.8367440409841183, 0.9985834011808987, 0.7191424032099998, 0.6017331560342383, 0.5, -1.0, 0.8752219770397366, 0.8013361385995682, 0.5, 0.5, 0.5179467006943161, 0.6189358231385171, 0.579553674790464, 0.5, 0.6951804509549506, -1.0, 0.6095081410272227, 0.560338711359319, 0.525665041659264, 0.7908753718781432, 0.5, 0.5, 0.5, 0.7090939239137676, 0.8526446750467185, 0.5, 0.5, 0.5, 0.7139524745752328, 0.5, -1.0, 0.9737107058744279, -1.0, 0.9255473696656217, -1.0, -1.0, 0.6875230792729341, 0.5, 0.5840501433802434, 0.5, 0.5, -1.0, 0.9396502396679218, -1.0, 0.5, 0.5, 0.5, 0.7123121826817483, 0.5020543053914237, -1.0, 0.7914573270190535, 0.7971279438772697, 0.6743860989281644, 0.5259004843694226, 0.5, 0.5, 0.5496969737055842, 0.5289960826442779, 0.5, 0.5, 0.9180274263069905, 0.5, -1.0, 0.5235277455120569, -1.0, 0.5, 0.5, 0.5, 0.9195823375479947, 0.6286965027948863, 0.5, 0.5, 0.6041058675010831, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5136445764072134, 0.5, 0.712187586042144, 0.6129523273682935, -1.0, 0.5, -1.0, 0.9331799001334052, 0.9850016829604981, 0.7672847559687803, 0.5, 0.6427629612272954, 0.5, 0.5, -1.0, 0.5064692940427906, 0.5, 0.8339711729441222, 0.6246408905983095, 0.7044448040789568, 0.5864338900335937, 0.7696182082530492, 0.6730634560200315, 0.6686567547232345, -1.0, 0.5827628561877183, 0.8168253926994773, 0.5, -1.0, 0.5, 0.5363609305820993, 0.7291336074424493, 0.8347917874095432, 0.6925523215247552, 0.5, 0.5, 0.9724641138063296, 0.8175540902478795, 0.580597852129167, -1.0, 0.6516329262521734, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.8160655558565819, 0.7475879634706457, -1.0, 0.5, 0.7476521250728682, -1.0, 0.523949774822137, 0.8684443548893808], "episode_lengths": [16, 22, 19, 28, 23, 24, 19, 17, 20, 26, 31, 16, 25, 23, 16, 22, 20, 15, 30, 29, 32, 21, 21, 26, 20, 19, 23, 17, 21, 21, 18, 27, 20, 17, 23, 27, 17, 19, 35, 22, 17, 23, 24, 16, 26, 19, 25, 28, 24, 17, 15, 28, 21, 18, 20, 16, 19, 18, 38, 20, 20, 31, 16, 28, 19, 18, 24, 15, 24, 19, 30, 15, 31, 23, 26, 28, 18, 16, 27, 17, 21, 24, 27, 24, 23, 18, 16, 22, 19, 15, 21, 20, 31, 17, 18, 21, 17, 19, 24, 17, 27, 27, 24, 15, 24, 52, 20, 47, 23, 25, 19, 16, 20, 19, 25, 18, 23, 23, 26, 33, 27, 51, 33, 23, 23, 18, 17, 26, 18, 44, 16, 20, 20, 23, 15, 25, 29, 37, 22, 21, 16, 18, 18, 22, 18, 20, 23, 15, 15, 21, 22, 24, 24, 20, 17, 18, 29, 21, 23, 23, 19, 20, 24, 17, 33, 18, 21, 22, 20, 22, 21, 20, 33, 20, 18, 16, 18, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09390028582476671, "mean_inference_ms": 0.2429288019907837, "mean_action_processing_ms": 0.04383450868379313, "mean_env_wait_ms": 0.046772055140331434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015996815113539105, "StateBufferConnector_ms": 0.001320142424508427, "ViewRequirementAgentConnector_ms": 0.029788794142476628}}, "episode_reward_max": 0.9985834011808987, "episode_reward_min": -1.0, "episode_reward_mean": 0.3756505095241062, "episode_len_mean": 22.376404494382022, "episodes_this_iter": 178, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.954628183006569, 0.9727608562561265, 0.608665369639915, 0.5, 0.9268357803941292, -1.0, 0.8811758758459677, 0.8178550423135693, 0.5, 0.7512925842643964, 0.5, -1.0, 0.7046434947821144, 0.5, 0.5160954871764629, -1.0, 0.5, 0.9621062457253371, -1.0, 0.5, -1.0, 0.5723032450539085, 0.8345733901037409, 0.5, 0.8912245357385182, 0.6257573278042436, 0.9306207996339073, 0.8853601631586709, 0.6377281419204948, 0.5, 0.914706603922385, 0.5, 0.6976847236418227, 0.6069939324524414, 0.5623920349442234, -1.0, -1.0, 0.5, 0.5, 0.5, 0.864890042089468, 0.5, 0.5, 0.8367440409841183, 0.9985834011808987, 0.7191424032099998, 0.6017331560342383, 0.5, -1.0, 0.8752219770397366, 0.8013361385995682, 0.5, 0.5, 0.5179467006943161, 0.6189358231385171, 0.579553674790464, 0.5, 0.6951804509549506, -1.0, 0.6095081410272227, 0.560338711359319, 0.525665041659264, 0.7908753718781432, 0.5, 0.5, 0.5, 0.7090939239137676, 0.8526446750467185, 0.5, 0.5, 0.5, 0.7139524745752328, 0.5, -1.0, 0.9737107058744279, -1.0, 0.9255473696656217, -1.0, -1.0, 0.6875230792729341, 0.5, 0.5840501433802434, 0.5, 0.5, -1.0, 0.9396502396679218, -1.0, 0.5, 0.5, 0.5, 0.7123121826817483, 0.5020543053914237, -1.0, 0.7914573270190535, 0.7971279438772697, 0.6743860989281644, 0.5259004843694226, 0.5, 0.5, 0.5496969737055842, 0.5289960826442779, 0.5, 0.5, 0.9180274263069905, 0.5, -1.0, 0.5235277455120569, -1.0, 0.5, 0.5, 0.5, 0.9195823375479947, 0.6286965027948863, 0.5, 0.5, 0.6041058675010831, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5136445764072134, 0.5, 0.712187586042144, 0.6129523273682935, -1.0, 0.5, -1.0, 0.9331799001334052, 0.9850016829604981, 0.7672847559687803, 0.5, 0.6427629612272954, 0.5, 0.5, -1.0, 0.5064692940427906, 0.5, 0.8339711729441222, 0.6246408905983095, 0.7044448040789568, 0.5864338900335937, 0.7696182082530492, 0.6730634560200315, 0.6686567547232345, -1.0, 0.5827628561877183, 0.8168253926994773, 0.5, -1.0, 0.5, 0.5363609305820993, 0.7291336074424493, 0.8347917874095432, 0.6925523215247552, 0.5, 0.5, 0.9724641138063296, 0.8175540902478795, 0.580597852129167, -1.0, 0.6516329262521734, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.8160655558565819, 0.7475879634706457, -1.0, 0.5, 0.7476521250728682, -1.0, 0.523949774822137, 0.8684443548893808], "episode_lengths": [16, 22, 19, 28, 23, 24, 19, 17, 20, 26, 31, 16, 25, 23, 16, 22, 20, 15, 30, 29, 32, 21, 21, 26, 20, 19, 23, 17, 21, 21, 18, 27, 20, 17, 23, 27, 17, 19, 35, 22, 17, 23, 24, 16, 26, 19, 25, 28, 24, 17, 15, 28, 21, 18, 20, 16, 19, 18, 38, 20, 20, 31, 16, 28, 19, 18, 24, 15, 24, 19, 30, 15, 31, 23, 26, 28, 18, 16, 27, 17, 21, 24, 27, 24, 23, 18, 16, 22, 19, 15, 21, 20, 31, 17, 18, 21, 17, 19, 24, 17, 27, 27, 24, 15, 24, 52, 20, 47, 23, 25, 19, 16, 20, 19, 25, 18, 23, 23, 26, 33, 27, 51, 33, 23, 23, 18, 17, 26, 18, 44, 16, 20, 20, 23, 15, 25, 29, 37, 22, 21, 16, 18, 18, 22, 18, 20, 23, 15, 15, 21, 22, 24, 24, 20, 17, 18, 29, 21, 23, 23, 19, 20, 24, 17, 33, 18, 21, 22, 20, 22, 21, 20, 33, 20, 18, 16, 18, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09390028582476671, "mean_inference_ms": 0.2429288019907837, "mean_action_processing_ms": 0.04383450868379313, "mean_env_wait_ms": 0.046772055140331434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015996815113539105, "StateBufferConnector_ms": 0.001320142424508427, "ViewRequirementAgentConnector_ms": 0.029788794142476628}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1079.6477910814144, "num_env_steps_trained_throughput_per_sec": 1079.6477910814144, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 3676.482, "sample_time_ms": 1774.54, "load_time_ms": 0.203, "load_throughput": 19689257.129, "learn_time_ms": 1900.726, "learn_throughput": 2104.459, "synch_weights_time_ms": 0.664}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 5432, "training_iteration": 56, "trial_id": "default", "date": "2024-05-22_22-18-21", "timestamp": 1716409101, "time_this_iter_s": 3.708296060562134, "time_total_s": 200.8780529499054, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 200.8780529499054, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.166666666666668, "ram_util_percent": 61.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0510125576167977, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1003232300319078, "policy_loss": -0.00882700108021738, "vf_loss": 0.10885462564145845, "vf_explained_var": 0.11842248382106904, "kl": 0.011824166768870421, "entropy": 1.266095079786034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 0.9967754162297464, "episode_reward_min": -1.0, "episode_reward_mean": 0.42030658615069416, "episode_len_mean": 22.154696132596683, "episode_media": {}, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6012845475247786, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7439125501509514, 0.5, 0.937389503208133, 0.5, 0.759289438581648, -1.0, 0.7872615792279765, 0.5, -1.0, 0.5, 0.5, -1.0, 0.6821688643352768, 0.6951899133005035, 0.9629343386934921, 0.8920537150524626, 0.6433004265487265, -1.0, 0.8247978214286531, 0.9070488567370574, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7339819478837805, 0.5, 0.6970111118837727, 0.7599524260327775, 0.5, 0.8817382662552623, 0.838764597344688, 0.6600382050998985, 0.5, 0.5, -1.0, 0.8630162618156986, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5592453277576352, 0.5, 0.5799936898117826, 0.7585336145011287, 0.5, 0.5413604580219352, 0.5251631219538212, 0.5848739927092242, 0.7725170296142891, 0.9291125065635264, 0.527072276313292, 0.9578602800259524, 0.732991335610673, 0.6334201008672566, -1.0, 0.6572818154443938, 0.5, 0.5, 0.8927394264752496, 0.5, 0.5, 0.5, 0.5, 0.5, 0.807007470519904, 0.5065738632537355, 0.5831145115190156, 0.5, 0.5, 0.6508817690449671, 0.8905326305433343, 0.6007375181117339, 0.6687317436927686, 0.5, 0.5299138660857514, 0.5, 0.5, 0.5721305289447945, 0.5161491265485717, -1.0, -1.0, 0.5, 0.9492143127796246, 0.5, 0.6668399785601256, 0.5, 0.8481277884301954, 0.5, 0.5, 0.5, 0.8688172001276238, 0.7274364173731065, 0.5, 0.5, -1.0, 0.5, 0.5, 0.796873254242566, 0.5, 0.9815892805932079, 0.5, 0.5, 0.5, -1.0, -1.0, 0.8253931773873345, 0.8898398580991, 0.5, 0.7136687029043098, 0.5, 0.9967754162297464, 0.899981993443753, 0.5, 0.5, 0.675892117655897, 0.5852396827132937, 0.5, 0.6698080668560724, 0.5, 0.9437437225060606, -1.0, 0.8497392030096479, 0.5, 0.9695366547467617, 0.5, 0.709468152309527, 0.5625060641992456, 0.5, -1.0, 0.5, 0.9574205651587787, 0.5, 0.5, 0.8522626959665394, 0.6738551158016914, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5630180040209212, 0.5, 0.6687718668913726, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8247981296114781, 0.5696409814896661, 0.5, 0.7960305600473752, -1.0, 0.7809304835156003, 0.5, 0.8708364950399137, 0.5, 0.7885523959109888, 0.5, 0.5, 0.6628747391458731, 0.5869366414679664, 0.5, -1.0, 0.5], "episode_lengths": [22, 20, 24, 21, 27, 26, 19, 19, 19, 29, 17, 18, 18, 20, 23, 22, 19, 30, 16, 19, 20, 19, 30, 20, 20, 26, 21, 15, 25, 21, 18, 18, 20, 24, 17, 24, 25, 23, 25, 19, 18, 20, 17, 22, 19, 55, 20, 24, 33, 25, 16, 19, 45, 27, 19, 28, 17, 34, 18, 16, 21, 26, 25, 20, 18, 15, 26, 18, 18, 20, 28, 23, 24, 25, 17, 23, 19, 27, 27, 23, 18, 20, 15, 28, 27, 17, 18, 22, 18, 29, 18, 36, 27, 19, 15, 20, 27, 42, 17, 27, 19, 15, 21, 32, 21, 26, 18, 19, 14, 25, 61, 21, 15, 18, 25, 18, 22, 25, 36, 19, 14, 14, 21, 18, 16, 18, 19, 16, 29, 25, 20, 15, 30, 17, 31, 19, 27, 17, 18, 19, 36, 14, 19, 23, 30, 21, 17, 23, 27, 17, 16, 27, 21, 25, 21, 20, 22, 16, 17, 29, 16, 33, 26, 26, 16, 25, 21, 19, 20, 19, 18, 16, 22, 19, 22, 34, 22, 24, 15, 14, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09404972616711973, "mean_inference_ms": 0.24298777165686603, "mean_action_processing_ms": 0.04384634170104916, "mean_env_wait_ms": 0.046799804774702254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016298083310627807, "StateBufferConnector_ms": 0.0012463627599220907, "ViewRequirementAgentConnector_ms": 0.029102083069184867}}, "episode_reward_max": 0.9967754162297464, "episode_reward_min": -1.0, "episode_reward_mean": 0.42030658615069416, "episode_len_mean": 22.154696132596683, "episodes_this_iter": 181, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6012845475247786, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7439125501509514, 0.5, 0.937389503208133, 0.5, 0.759289438581648, -1.0, 0.7872615792279765, 0.5, -1.0, 0.5, 0.5, -1.0, 0.6821688643352768, 0.6951899133005035, 0.9629343386934921, 0.8920537150524626, 0.6433004265487265, -1.0, 0.8247978214286531, 0.9070488567370574, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7339819478837805, 0.5, 0.6970111118837727, 0.7599524260327775, 0.5, 0.8817382662552623, 0.838764597344688, 0.6600382050998985, 0.5, 0.5, -1.0, 0.8630162618156986, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5592453277576352, 0.5, 0.5799936898117826, 0.7585336145011287, 0.5, 0.5413604580219352, 0.5251631219538212, 0.5848739927092242, 0.7725170296142891, 0.9291125065635264, 0.527072276313292, 0.9578602800259524, 0.732991335610673, 0.6334201008672566, -1.0, 0.6572818154443938, 0.5, 0.5, 0.8927394264752496, 0.5, 0.5, 0.5, 0.5, 0.5, 0.807007470519904, 0.5065738632537355, 0.5831145115190156, 0.5, 0.5, 0.6508817690449671, 0.8905326305433343, 0.6007375181117339, 0.6687317436927686, 0.5, 0.5299138660857514, 0.5, 0.5, 0.5721305289447945, 0.5161491265485717, -1.0, -1.0, 0.5, 0.9492143127796246, 0.5, 0.6668399785601256, 0.5, 0.8481277884301954, 0.5, 0.5, 0.5, 0.8688172001276238, 0.7274364173731065, 0.5, 0.5, -1.0, 0.5, 0.5, 0.796873254242566, 0.5, 0.9815892805932079, 0.5, 0.5, 0.5, -1.0, -1.0, 0.8253931773873345, 0.8898398580991, 0.5, 0.7136687029043098, 0.5, 0.9967754162297464, 0.899981993443753, 0.5, 0.5, 0.675892117655897, 0.5852396827132937, 0.5, 0.6698080668560724, 0.5, 0.9437437225060606, -1.0, 0.8497392030096479, 0.5, 0.9695366547467617, 0.5, 0.709468152309527, 0.5625060641992456, 0.5, -1.0, 0.5, 0.9574205651587787, 0.5, 0.5, 0.8522626959665394, 0.6738551158016914, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5630180040209212, 0.5, 0.6687718668913726, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8247981296114781, 0.5696409814896661, 0.5, 0.7960305600473752, -1.0, 0.7809304835156003, 0.5, 0.8708364950399137, 0.5, 0.7885523959109888, 0.5, 0.5, 0.6628747391458731, 0.5869366414679664, 0.5, -1.0, 0.5], "episode_lengths": [22, 20, 24, 21, 27, 26, 19, 19, 19, 29, 17, 18, 18, 20, 23, 22, 19, 30, 16, 19, 20, 19, 30, 20, 20, 26, 21, 15, 25, 21, 18, 18, 20, 24, 17, 24, 25, 23, 25, 19, 18, 20, 17, 22, 19, 55, 20, 24, 33, 25, 16, 19, 45, 27, 19, 28, 17, 34, 18, 16, 21, 26, 25, 20, 18, 15, 26, 18, 18, 20, 28, 23, 24, 25, 17, 23, 19, 27, 27, 23, 18, 20, 15, 28, 27, 17, 18, 22, 18, 29, 18, 36, 27, 19, 15, 20, 27, 42, 17, 27, 19, 15, 21, 32, 21, 26, 18, 19, 14, 25, 61, 21, 15, 18, 25, 18, 22, 25, 36, 19, 14, 14, 21, 18, 16, 18, 19, 16, 29, 25, 20, 15, 30, 17, 31, 19, 27, 17, 18, 19, 36, 14, 19, 23, 30, 21, 17, 23, 27, 17, 16, 27, 21, 25, 21, 20, 22, 16, 17, 29, 16, 33, 26, 26, 16, 25, 21, 19, 20, 19, 18, 16, 22, 19, 22, 34, 22, 24, 15, 14, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09404972616711973, "mean_inference_ms": 0.24298777165686603, "mean_action_processing_ms": 0.04384634170104916, "mean_env_wait_ms": 0.046799804774702254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016298083310627807, "StateBufferConnector_ms": 0.0012463627599220907, "ViewRequirementAgentConnector_ms": 0.029102083069184867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1076.5464946019688, "num_env_steps_trained_throughput_per_sec": 1076.5464946019688, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 3689.758, "sample_time_ms": 1778.531, "load_time_ms": 0.2, "load_throughput": 19975254.197, "learn_time_ms": 1909.994, "learn_throughput": 2094.248, "synch_weights_time_ms": 0.679}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 5613, "training_iteration": 57, "trial_id": "default", "date": "2024-05-22_22-18-24", "timestamp": 1716409104, "time_this_iter_s": 3.7191059589385986, "time_total_s": 204.597158908844, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.597158908844, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 16.660000000000004, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0537248451222654, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11996635397275289, "policy_loss": -0.007478143931717001, "vf_loss": 0.12721190345673872, "vf_explained_var": 0.09595645851986383, "kl": 0.00930375781556339, "entropy": 1.3093809398271705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 0.9979781571623109, "episode_reward_min": -1.0, "episode_reward_mean": 0.4463332034239034, "episode_len_mean": 21.63783783783784, "episode_media": {}, "episodes_this_iter": 185, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.6478171067549253, 0.5, 0.5, 0.9606975750770137, 0.887119566990611, 0.8062357188649546, 0.5, 0.5, 0.5, 0.5629216097551684, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.8284724890706916, 0.5787097257999865, 0.5600579386354934, 0.9809280492673151, 0.5, 0.9370044016435302, 0.81248966463053, 0.5, 0.5, 0.9959341924619658, 0.5, 0.8116666119571244, -1.0, 0.5, 0.5, 0.5, 0.7979719515850926, 0.5, -1.0, 0.5, 0.6486515952570674, 0.5771618996021616, 0.5, 0.8778512921584698, 0.5, 0.5, 0.7226909328338924, 0.7987931070298148, 0.7113086810552451, 0.5, 0.7333143529337323, 0.5021035351788002, 0.731943125577901, -1.0, -1.0, 0.5, 0.8384333474640582, 0.5, 0.9514207066957079, 0.5493953487466254, 0.5, 0.5, 0.9022935276751979, 0.5, 0.5305320761602673, 0.9040123910619814, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8310363328296198, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8045081689974233, -1.0, -1.0, 0.5, 0.9869548511100658, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.703433496603957, 0.5, 0.6431567605984545, 0.9480412447465286, 0.944778769746811, 0.5, 0.8162651534697329, -1.0, 0.5244925778701308, 0.8192124092229716, 0.8966635581816437, 0.5, 0.8926774824901884, 0.5, 0.6318122678982159, 0.5, 0.5, 0.5, 0.6499090630828497, 0.7611531234211706, 0.5517378232933587, 0.7747199213558753, 0.6295699866626183, 0.6074137833265323, 0.5, 0.5, 0.5, 0.8473018272015787, 0.5, 0.5, 0.5437822029834354, 0.6930767010369707, 0.5, 0.8551642447444199, 0.5860472791163616, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.806476737491681, 0.8977101338542816, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.666383388568678, 0.9922505000075722, 0.7838794223644189, -1.0, 0.6170142400269518, -1.0, 0.5, 0.5, 0.5, 0.5, 0.9094297833030263, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8554250298790314, 0.5, 0.5, 0.5, 0.8537075183813267, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8621407479158315, 0.5188619928482929, 0.5, 0.5764297123908518, 0.5, -1.0, 0.8779554131045058, 0.5, 0.567869678256102, -1.0, 0.5, 0.9979781571623109, 0.5, 0.5585305145591524, 0.5, 0.5, 0.5, 0.6502841082257893, 0.5, 0.9884740031660944], "episode_lengths": [18, 20, 20, 25, 15, 18, 16, 26, 22, 19, 22, 30, 20, 20, 28, 25, 17, 22, 15, 21, 25, 18, 22, 17, 19, 30, 21, 15, 23, 19, 24, 17, 21, 21, 22, 24, 23, 23, 20, 17, 19, 13, 27, 22, 20, 19, 22, 27, 18, 18, 21, 28, 29, 23, 17, 19, 18, 17, 19, 29, 16, 30, 21, 15, 26, 25, 17, 20, 23, 18, 22, 22, 21, 48, 22, 17, 16, 29, 23, 41, 17, 37, 28, 19, 26, 28, 16, 22, 16, 16, 18, 15, 19, 19, 37, 20, 17, 20, 18, 17, 23, 18, 17, 18, 18, 17, 25, 16, 15, 15, 17, 25, 22, 38, 17, 19, 16, 19, 19, 34, 18, 19, 24, 24, 17, 19, 24, 20, 24, 43, 17, 17, 17, 80, 27, 26, 19, 19, 21, 17, 15, 14, 20, 16, 24, 51, 22, 25, 19, 19, 23, 20, 34, 25, 19, 18, 23, 20, 27, 14, 17, 19, 25, 16, 24, 23, 23, 20, 19, 21, 23, 18, 19, 18, 14, 21, 20, 18, 18, 20, 21, 22, 20, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09418341000136292, "mean_inference_ms": 0.2433931870038984, "mean_action_processing_ms": 0.043855527409793975, "mean_env_wait_ms": 0.04682219297052327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015812951165276605, "StateBufferConnector_ms": 0.0012406787356814824, "ViewRequirementAgentConnector_ms": 0.02873201627989073}}, "episode_reward_max": 0.9979781571623109, "episode_reward_min": -1.0, "episode_reward_mean": 0.4463332034239034, "episode_len_mean": 21.63783783783784, "episodes_this_iter": 185, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.6478171067549253, 0.5, 0.5, 0.9606975750770137, 0.887119566990611, 0.8062357188649546, 0.5, 0.5, 0.5, 0.5629216097551684, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.8284724890706916, 0.5787097257999865, 0.5600579386354934, 0.9809280492673151, 0.5, 0.9370044016435302, 0.81248966463053, 0.5, 0.5, 0.9959341924619658, 0.5, 0.8116666119571244, -1.0, 0.5, 0.5, 0.5, 0.7979719515850926, 0.5, -1.0, 0.5, 0.6486515952570674, 0.5771618996021616, 0.5, 0.8778512921584698, 0.5, 0.5, 0.7226909328338924, 0.7987931070298148, 0.7113086810552451, 0.5, 0.7333143529337323, 0.5021035351788002, 0.731943125577901, -1.0, -1.0, 0.5, 0.8384333474640582, 0.5, 0.9514207066957079, 0.5493953487466254, 0.5, 0.5, 0.9022935276751979, 0.5, 0.5305320761602673, 0.9040123910619814, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8310363328296198, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8045081689974233, -1.0, -1.0, 0.5, 0.9869548511100658, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.703433496603957, 0.5, 0.6431567605984545, 0.9480412447465286, 0.944778769746811, 0.5, 0.8162651534697329, -1.0, 0.5244925778701308, 0.8192124092229716, 0.8966635581816437, 0.5, 0.8926774824901884, 0.5, 0.6318122678982159, 0.5, 0.5, 0.5, 0.6499090630828497, 0.7611531234211706, 0.5517378232933587, 0.7747199213558753, 0.6295699866626183, 0.6074137833265323, 0.5, 0.5, 0.5, 0.8473018272015787, 0.5, 0.5, 0.5437822029834354, 0.6930767010369707, 0.5, 0.8551642447444199, 0.5860472791163616, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5, 0.806476737491681, 0.8977101338542816, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.666383388568678, 0.9922505000075722, 0.7838794223644189, -1.0, 0.6170142400269518, -1.0, 0.5, 0.5, 0.5, 0.5, 0.9094297833030263, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8554250298790314, 0.5, 0.5, 0.5, 0.8537075183813267, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8621407479158315, 0.5188619928482929, 0.5, 0.5764297123908518, 0.5, -1.0, 0.8779554131045058, 0.5, 0.567869678256102, -1.0, 0.5, 0.9979781571623109, 0.5, 0.5585305145591524, 0.5, 0.5, 0.5, 0.6502841082257893, 0.5, 0.9884740031660944], "episode_lengths": [18, 20, 20, 25, 15, 18, 16, 26, 22, 19, 22, 30, 20, 20, 28, 25, 17, 22, 15, 21, 25, 18, 22, 17, 19, 30, 21, 15, 23, 19, 24, 17, 21, 21, 22, 24, 23, 23, 20, 17, 19, 13, 27, 22, 20, 19, 22, 27, 18, 18, 21, 28, 29, 23, 17, 19, 18, 17, 19, 29, 16, 30, 21, 15, 26, 25, 17, 20, 23, 18, 22, 22, 21, 48, 22, 17, 16, 29, 23, 41, 17, 37, 28, 19, 26, 28, 16, 22, 16, 16, 18, 15, 19, 19, 37, 20, 17, 20, 18, 17, 23, 18, 17, 18, 18, 17, 25, 16, 15, 15, 17, 25, 22, 38, 17, 19, 16, 19, 19, 34, 18, 19, 24, 24, 17, 19, 24, 20, 24, 43, 17, 17, 17, 80, 27, 26, 19, 19, 21, 17, 15, 14, 20, 16, 24, 51, 22, 25, 19, 19, 23, 20, 34, 25, 19, 18, 23, 20, 27, 14, 17, 19, 25, 16, 24, 23, 23, 20, 19, 21, 23, 18, 19, 18, 14, 21, 20, 18, 18, 20, 21, 22, 20, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09418341000136292, "mean_inference_ms": 0.2433931870038984, "mean_action_processing_ms": 0.043855527409793975, "mean_env_wait_ms": 0.04682219297052327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015812951165276605, "StateBufferConnector_ms": 0.0012406787356814824, "ViewRequirementAgentConnector_ms": 0.02873201627989073}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1076.114372096278, "num_env_steps_trained_throughput_per_sec": 1076.114372096278, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 3702.843, "sample_time_ms": 1789.506, "load_time_ms": 0.2, "load_throughput": 19982391.615, "learn_time_ms": 1912.107, "learn_throughput": 2091.933, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 5798, "training_iteration": 58, "trial_id": "default", "date": "2024-05-22_22-18-28", "timestamp": 1716409108, "time_this_iter_s": 3.7205450534820557, "time_total_s": 208.31770396232605, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 208.31770396232605, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 19.340000000000003, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.566019674590839, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07853736607758428, "policy_loss": -0.01147695722719354, "vf_loss": 0.08974563543564609, "vf_explained_var": 0.20904667422335635, "kl": 0.010747501613741037, "entropy": 1.2716427676780249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 0.9982952623208637, "episode_reward_min": -1.0, "episode_reward_mean": 0.5039173163739722, "episode_len_mean": 19.935, "episode_media": {}, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7643164843850445, 0.7993560453571493, 0.5, 0.5, 0.6630570367056883, 0.5, 0.7833236792017966, 0.5, 0.5, 0.7144123373450366, 0.5, 0.8871680938357767, 0.5, 0.8714072273507799, 0.5, 0.7940371701223821, 0.5, -1.0, 0.5218829522703786, 0.5, 0.7192244940466113, 0.5, 0.9333512526243486, 0.8370966102750107, 0.9200956925440517, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9109176654849669, 0.5, 0.8442623736288339, 0.6212954680552236, 0.7278608889446667, -1.0, 0.5, 0.9263173989390073, 0.6864058485790852, 0.8669880447283638, -1.0, 0.5, 0.7407939328455082, -1.0, 0.5, 0.5, 0.9708418659211899, 0.9777199646750645, -1.0, 0.5, 0.6409864457389126, 0.8317591301411725, 0.5, 0.8714280120090983, 0.5, 0.6409169507014608, 0.5, 0.6923002776741922, 0.8607179197759804, 0.7147175484525055, 0.5, 0.5, 0.5741493217654583, 0.5, -1.0, 0.8880960973296803, 0.658142112854925, -1.0, 0.9226975940951734, 0.5, 0.5, 0.5, 0.5, 0.6129302378017291, 0.5, 0.8131935495936163, 0.735918713996758, 0.6577554463916174, 0.7007288383611586, 0.5, 0.6700769262042441, 0.7578186252080074, 0.5, 0.5, 0.5, 0.5388512369785812, 0.5, 0.5, 0.8570899624804456, 0.5, -1.0, 0.5, 0.5445290999992435, 0.5, 0.9142005153627873, 0.5, 0.5, 0.9108906825672203, 0.9462738713269097, 0.6421256175745169, 0.5, 0.5, 0.6975500045990661, 0.5, 0.8013512615611158, 0.5, 0.5564888912659121, 0.5, 0.7084237103643349, 0.5, 0.8070930174911175, 0.5, 0.7565314641513284, 0.8778214780980405, 0.70944987274759, 0.5, 0.5, 0.6672913134145779, 0.5, 0.5, 0.7924885811669455, 0.9101488733425378, 0.9459725596848165, 0.7011836731401198, -1.0, 0.5, 0.5, 0.7743659743360456, 0.5, 0.5, 0.7850368756346104, 0.7258206531733407, 0.5, 0.864447790735663, 0.9475540618412618, 0.5, 0.6242808487859024, 0.5, 0.5, 0.5987575691002419, 0.5, 0.665978752374242, -1.0, 0.7327878540329926, 0.7722263408882591, 0.5, 0.6678255398971966, -1.0, 0.5, 0.5, 0.743504915401306, 0.5250044176005427, -1.0, 0.7925622187260939, 0.5, 0.5, 0.8904304711891855, 0.5, 0.5, 0.6893625377257684, -1.0, 0.7604486146659455, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6939946959393755, 0.5, 0.5, 0.5, 0.7064890598517142, 0.6859947444297602, 0.9760282898943767, 0.5116701218265325, 0.5, 0.8931760891864515, 0.8534026310122157, 0.7247705492800729, 0.6151296605370739, 0.5, 0.5, 0.7141144486194642, 0.5, 0.5, -1.0, 0.8580226240666498, 0.5, 0.8697653665798301, 0.5, 0.5, 0.9982952623208637, 0.5, 0.7124871303727527, 0.5, 0.8975052014898369, 0.5], "episode_lengths": [18, 16, 24, 28, 19, 19, 19, 16, 23, 19, 16, 18, 22, 17, 18, 15, 22, 24, 18, 17, 21, 16, 20, 17, 17, 80, 25, 24, 40, 39, 21, 19, 17, 18, 14, 23, 18, 18, 24, 16, 16, 16, 20, 25, 20, 25, 27, 17, 16, 23, 16, 18, 15, 17, 16, 16, 23, 18, 19, 17, 15, 17, 23, 27, 16, 18, 19, 17, 15, 15, 20, 19, 17, 21, 16, 18, 17, 21, 21, 20, 15, 16, 14, 19, 20, 24, 27, 17, 20, 17, 16, 18, 33, 26, 17, 32, 14, 25, 19, 17, 17, 27, 23, 23, 16, 27, 17, 22, 16, 19, 16, 17, 16, 19, 16, 14, 17, 25, 31, 18, 16, 19, 16, 20, 17, 22, 14, 19, 19, 18, 23, 21, 22, 17, 19, 16, 16, 21, 17, 17, 23, 18, 19, 16, 25, 21, 26, 19, 24, 26, 22, 25, 17, 16, 16, 19, 19, 20, 16, 18, 34, 15, 28, 18, 26, 18, 18, 18, 25, 27, 17, 25, 22, 18, 18, 16, 15, 21, 16, 17, 16, 16, 16, 28, 19, 16, 15, 22, 16, 16, 16, 16, 24, 20, 16, 24, 20, 20, 18, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09433223467957241, "mean_inference_ms": 0.24343765483919902, "mean_action_processing_ms": 0.0438678012107448, "mean_env_wait_ms": 0.046847985462927386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00156402587890625, "StateBufferConnector_ms": 0.0012267827987670898, "ViewRequirementAgentConnector_ms": 0.028784751892089844}}, "episode_reward_max": 0.9982952623208637, "episode_reward_min": -1.0, "episode_reward_mean": 0.5039173163739722, "episode_len_mean": 19.935, "episodes_this_iter": 200, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7643164843850445, 0.7993560453571493, 0.5, 0.5, 0.6630570367056883, 0.5, 0.7833236792017966, 0.5, 0.5, 0.7144123373450366, 0.5, 0.8871680938357767, 0.5, 0.8714072273507799, 0.5, 0.7940371701223821, 0.5, -1.0, 0.5218829522703786, 0.5, 0.7192244940466113, 0.5, 0.9333512526243486, 0.8370966102750107, 0.9200956925440517, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9109176654849669, 0.5, 0.8442623736288339, 0.6212954680552236, 0.7278608889446667, -1.0, 0.5, 0.9263173989390073, 0.6864058485790852, 0.8669880447283638, -1.0, 0.5, 0.7407939328455082, -1.0, 0.5, 0.5, 0.9708418659211899, 0.9777199646750645, -1.0, 0.5, 0.6409864457389126, 0.8317591301411725, 0.5, 0.8714280120090983, 0.5, 0.6409169507014608, 0.5, 0.6923002776741922, 0.8607179197759804, 0.7147175484525055, 0.5, 0.5, 0.5741493217654583, 0.5, -1.0, 0.8880960973296803, 0.658142112854925, -1.0, 0.9226975940951734, 0.5, 0.5, 0.5, 0.5, 0.6129302378017291, 0.5, 0.8131935495936163, 0.735918713996758, 0.6577554463916174, 0.7007288383611586, 0.5, 0.6700769262042441, 0.7578186252080074, 0.5, 0.5, 0.5, 0.5388512369785812, 0.5, 0.5, 0.8570899624804456, 0.5, -1.0, 0.5, 0.5445290999992435, 0.5, 0.9142005153627873, 0.5, 0.5, 0.9108906825672203, 0.9462738713269097, 0.6421256175745169, 0.5, 0.5, 0.6975500045990661, 0.5, 0.8013512615611158, 0.5, 0.5564888912659121, 0.5, 0.7084237103643349, 0.5, 0.8070930174911175, 0.5, 0.7565314641513284, 0.8778214780980405, 0.70944987274759, 0.5, 0.5, 0.6672913134145779, 0.5, 0.5, 0.7924885811669455, 0.9101488733425378, 0.9459725596848165, 0.7011836731401198, -1.0, 0.5, 0.5, 0.7743659743360456, 0.5, 0.5, 0.7850368756346104, 0.7258206531733407, 0.5, 0.864447790735663, 0.9475540618412618, 0.5, 0.6242808487859024, 0.5, 0.5, 0.5987575691002419, 0.5, 0.665978752374242, -1.0, 0.7327878540329926, 0.7722263408882591, 0.5, 0.6678255398971966, -1.0, 0.5, 0.5, 0.743504915401306, 0.5250044176005427, -1.0, 0.7925622187260939, 0.5, 0.5, 0.8904304711891855, 0.5, 0.5, 0.6893625377257684, -1.0, 0.7604486146659455, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6939946959393755, 0.5, 0.5, 0.5, 0.7064890598517142, 0.6859947444297602, 0.9760282898943767, 0.5116701218265325, 0.5, 0.8931760891864515, 0.8534026310122157, 0.7247705492800729, 0.6151296605370739, 0.5, 0.5, 0.7141144486194642, 0.5, 0.5, -1.0, 0.8580226240666498, 0.5, 0.8697653665798301, 0.5, 0.5, 0.9982952623208637, 0.5, 0.7124871303727527, 0.5, 0.8975052014898369, 0.5], "episode_lengths": [18, 16, 24, 28, 19, 19, 19, 16, 23, 19, 16, 18, 22, 17, 18, 15, 22, 24, 18, 17, 21, 16, 20, 17, 17, 80, 25, 24, 40, 39, 21, 19, 17, 18, 14, 23, 18, 18, 24, 16, 16, 16, 20, 25, 20, 25, 27, 17, 16, 23, 16, 18, 15, 17, 16, 16, 23, 18, 19, 17, 15, 17, 23, 27, 16, 18, 19, 17, 15, 15, 20, 19, 17, 21, 16, 18, 17, 21, 21, 20, 15, 16, 14, 19, 20, 24, 27, 17, 20, 17, 16, 18, 33, 26, 17, 32, 14, 25, 19, 17, 17, 27, 23, 23, 16, 27, 17, 22, 16, 19, 16, 17, 16, 19, 16, 14, 17, 25, 31, 18, 16, 19, 16, 20, 17, 22, 14, 19, 19, 18, 23, 21, 22, 17, 19, 16, 16, 21, 17, 17, 23, 18, 19, 16, 25, 21, 26, 19, 24, 26, 22, 25, 17, 16, 16, 19, 19, 20, 16, 18, 34, 15, 28, 18, 26, 18, 18, 18, 25, 27, 17, 25, 22, 18, 18, 16, 15, 21, 16, 17, 16, 16, 16, 28, 19, 16, 15, 22, 16, 16, 16, 16, 24, 20, 16, 24, 20, 20, 18, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09433223467957241, "mean_inference_ms": 0.24343765483919902, "mean_action_processing_ms": 0.0438678012107448, "mean_env_wait_ms": 0.046847985462927386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00156402587890625, "StateBufferConnector_ms": 0.0012267827987670898, "ViewRequirementAgentConnector_ms": 0.028784751892089844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1095.758612521113, "num_env_steps_trained_throughput_per_sec": 1095.758612521113, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 3706.886, "sample_time_ms": 1793.325, "load_time_ms": 0.213, "load_throughput": 18791684.588, "learn_time_ms": 1912.32, "learn_throughput": 2091.7, "synch_weights_time_ms": 0.672}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 5998, "training_iteration": 59, "trial_id": "default", "date": "2024-05-22_22-18-32", "timestamp": 1716409112, "time_this_iter_s": 3.6539459228515625, "time_total_s": 211.9716498851776, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 211.9716498851776, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.855075019021188, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08083453400446082, "policy_loss": -0.011518144542952219, "vf_loss": 0.09197952357691623, "vf_explained_var": -0.04915740957824133, "kl": 0.014926159576255945, "entropy": 1.1163814070404217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 0.9971806021743995, "episode_reward_min": -1.0, "episode_reward_mean": 0.4929502553092859, "episode_len_mean": 19.04739336492891, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.7471336593936, 0.6187859291886957, 0.5, 0.5597896913278795, 0.5, 0.5, 0.6375570785458655, 0.7894159776495984, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5971424398823071, 0.5, 0.7885685000413237, 0.5, 0.5, 0.5, 0.8057119256811136, 0.5, 0.5, 0.5, 0.9456317834407477, 0.7759670439652413, 0.5, 0.876335876539359, 0.9327585285519493, 0.5, 0.7111341290016723, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5991934195989062, 0.5826969984685854, 0.8301697915260295, 0.5389481946607708, 0.5, 0.5, 0.6928251496517525, 0.5, 0.8942967513913656, 0.5, 0.5015939885737319, 0.9552002556027586, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5100740428127954, 0.6063432363792802, 0.8169625828701491, 0.5, 0.5980603562332887, 0.9888712511953318, 0.5, 0.8932306061442158, 0.591447057845297, 0.5, 0.5, 0.5, 0.7891149230015964, 0.5, -1.0, 0.5, 0.5, 0.5, 0.9701104776666779, 0.5, 0.5, 0.5, 0.8124652717083957, 0.5, 0.5, 0.5089494060424785, 0.5, 0.7374786776446589, 0.5, 0.5, 0.5, 0.5737221763306061, 0.5013966771808716, 0.5, 0.5, 0.5, 0.5, 0.7314479095470178, 0.5, 0.5926052522928347, 0.5, 0.8785286707058799, 0.5, 0.8268250786932566, 0.8317854325247066, 0.5262639746766526, 0.6057627934291522, -1.0, -1.0, 0.8603208044444441, -1.0, 0.5, 0.5, 0.9294376400838397, 0.8569342872139151, 0.5, 0.7063806116289135, 0.5506669351974405, 0.576211754353202, 0.6430389024866429, 0.5, 0.9364862553415185, 0.5254932097228039, -1.0, 0.6936272344621512, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9618676055605133, 0.5033706701947681, 0.7338740200027303, 0.8798378005865313, 0.5, 0.5, 0.7902828458377629, 0.5, 0.6975258836931862, 0.7152806900786626, -1.0, -1.0, 0.9971806021743995, 0.5, 0.9795314970467085, 0.7167630676444783, -1.0, 0.7921409692669341, 0.5, 0.9664818573982228, 0.5, 0.7782084002323427, 0.5, -1.0, 0.5891191957753785, 0.9234850802639887, 0.5, 0.5, 0.5, -1.0, 0.7779321819862918, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5958747283572907, 0.5, 0.5, -1.0, 0.5065954430636939, 0.8083203419391649, 0.5, 0.5, 0.5, 0.5, 0.5, 0.787053655528451, 0.5, 0.6280171381842468, 0.6318574531707126, 0.6202987067095297, 0.8051556213049733, 0.7301237950299855, 0.5, 0.9739780471271462, 0.7266640744796597, 0.6101670698081585, 0.6030576771471363, 0.5, 0.9495110633428753, 0.5, 0.7723640617955555, 0.5, 0.5, 0.5923596901312229, 0.5, 0.5, 0.657129504943726, 0.9569288996028066, 0.5, 0.5, 0.8293828306426932, 0.5, 0.5, 0.7921071147591757, 0.9160490603935016, 0.5, 0.5, 0.975062448457269, 0.7990795284272862, 0.5, 0.8915829456268939, 0.5], "episode_lengths": [23, 20, 16, 27, 16, 18, 20, 19, 16, 19, 20, 23, 15, 21, 20, 16, 18, 19, 15, 22, 18, 26, 30, 31, 16, 19, 30, 14, 18, 28, 16, 24, 20, 20, 19, 21, 29, 17, 19, 14, 22, 18, 21, 22, 29, 15, 22, 16, 14, 20, 18, 18, 22, 23, 20, 17, 17, 28, 16, 16, 23, 17, 16, 18, 24, 21, 17, 22, 25, 28, 16, 22, 14, 26, 19, 17, 16, 22, 28, 22, 20, 16, 23, 20, 21, 15, 16, 18, 21, 17, 24, 16, 15, 14, 21, 19, 22, 15, 20, 21, 17, 13, 11, 14, 26, 20, 18, 14, 15, 24, 14, 18, 18, 19, 23, 14, 19, 14, 20, 25, 20, 21, 15, 24, 24, 18, 25, 17, 17, 15, 14, 19, 16, 15, 16, 16, 17, 13, 16, 16, 23, 19, 17, 21, 16, 19, 16, 17, 15, 17, 15, 19, 16, 24, 29, 20, 21, 17, 13, 18, 15, 21, 15, 17, 20, 20, 24, 17, 14, 17, 17, 19, 15, 27, 15, 19, 20, 17, 19, 17, 16, 16, 18, 19, 18, 19, 18, 20, 19, 15, 23, 23, 16, 23, 25, 19, 17, 26, 20, 17, 18, 18, 22, 16, 19, 20, 15, 18, 15, 15, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09449131158462552, "mean_inference_ms": 0.24346715790502796, "mean_action_processing_ms": 0.043876699574573304, "mean_env_wait_ms": 0.04686920386186319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015888168913493223, "StateBufferConnector_ms": 0.0012516410429895771, "ViewRequirementAgentConnector_ms": 0.028741190218812482}}, "episode_reward_max": 0.9971806021743995, "episode_reward_min": -1.0, "episode_reward_mean": 0.4929502553092859, "episode_len_mean": 19.04739336492891, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.7471336593936, 0.6187859291886957, 0.5, 0.5597896913278795, 0.5, 0.5, 0.6375570785458655, 0.7894159776495984, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5971424398823071, 0.5, 0.7885685000413237, 0.5, 0.5, 0.5, 0.8057119256811136, 0.5, 0.5, 0.5, 0.9456317834407477, 0.7759670439652413, 0.5, 0.876335876539359, 0.9327585285519493, 0.5, 0.7111341290016723, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5991934195989062, 0.5826969984685854, 0.8301697915260295, 0.5389481946607708, 0.5, 0.5, 0.6928251496517525, 0.5, 0.8942967513913656, 0.5, 0.5015939885737319, 0.9552002556027586, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5100740428127954, 0.6063432363792802, 0.8169625828701491, 0.5, 0.5980603562332887, 0.9888712511953318, 0.5, 0.8932306061442158, 0.591447057845297, 0.5, 0.5, 0.5, 0.7891149230015964, 0.5, -1.0, 0.5, 0.5, 0.5, 0.9701104776666779, 0.5, 0.5, 0.5, 0.8124652717083957, 0.5, 0.5, 0.5089494060424785, 0.5, 0.7374786776446589, 0.5, 0.5, 0.5, 0.5737221763306061, 0.5013966771808716, 0.5, 0.5, 0.5, 0.5, 0.7314479095470178, 0.5, 0.5926052522928347, 0.5, 0.8785286707058799, 0.5, 0.8268250786932566, 0.8317854325247066, 0.5262639746766526, 0.6057627934291522, -1.0, -1.0, 0.8603208044444441, -1.0, 0.5, 0.5, 0.9294376400838397, 0.8569342872139151, 0.5, 0.7063806116289135, 0.5506669351974405, 0.576211754353202, 0.6430389024866429, 0.5, 0.9364862553415185, 0.5254932097228039, -1.0, 0.6936272344621512, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9618676055605133, 0.5033706701947681, 0.7338740200027303, 0.8798378005865313, 0.5, 0.5, 0.7902828458377629, 0.5, 0.6975258836931862, 0.7152806900786626, -1.0, -1.0, 0.9971806021743995, 0.5, 0.9795314970467085, 0.7167630676444783, -1.0, 0.7921409692669341, 0.5, 0.9664818573982228, 0.5, 0.7782084002323427, 0.5, -1.0, 0.5891191957753785, 0.9234850802639887, 0.5, 0.5, 0.5, -1.0, 0.7779321819862918, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5958747283572907, 0.5, 0.5, -1.0, 0.5065954430636939, 0.8083203419391649, 0.5, 0.5, 0.5, 0.5, 0.5, 0.787053655528451, 0.5, 0.6280171381842468, 0.6318574531707126, 0.6202987067095297, 0.8051556213049733, 0.7301237950299855, 0.5, 0.9739780471271462, 0.7266640744796597, 0.6101670698081585, 0.6030576771471363, 0.5, 0.9495110633428753, 0.5, 0.7723640617955555, 0.5, 0.5, 0.5923596901312229, 0.5, 0.5, 0.657129504943726, 0.9569288996028066, 0.5, 0.5, 0.8293828306426932, 0.5, 0.5, 0.7921071147591757, 0.9160490603935016, 0.5, 0.5, 0.975062448457269, 0.7990795284272862, 0.5, 0.8915829456268939, 0.5], "episode_lengths": [23, 20, 16, 27, 16, 18, 20, 19, 16, 19, 20, 23, 15, 21, 20, 16, 18, 19, 15, 22, 18, 26, 30, 31, 16, 19, 30, 14, 18, 28, 16, 24, 20, 20, 19, 21, 29, 17, 19, 14, 22, 18, 21, 22, 29, 15, 22, 16, 14, 20, 18, 18, 22, 23, 20, 17, 17, 28, 16, 16, 23, 17, 16, 18, 24, 21, 17, 22, 25, 28, 16, 22, 14, 26, 19, 17, 16, 22, 28, 22, 20, 16, 23, 20, 21, 15, 16, 18, 21, 17, 24, 16, 15, 14, 21, 19, 22, 15, 20, 21, 17, 13, 11, 14, 26, 20, 18, 14, 15, 24, 14, 18, 18, 19, 23, 14, 19, 14, 20, 25, 20, 21, 15, 24, 24, 18, 25, 17, 17, 15, 14, 19, 16, 15, 16, 16, 17, 13, 16, 16, 23, 19, 17, 21, 16, 19, 16, 17, 15, 17, 15, 19, 16, 24, 29, 20, 21, 17, 13, 18, 15, 21, 15, 17, 20, 20, 24, 17, 14, 17, 17, 19, 15, 27, 15, 19, 20, 17, 19, 17, 16, 16, 18, 19, 18, 19, 18, 20, 19, 15, 23, 23, 16, 23, 25, 19, 17, 26, 20, 17, 18, 18, 22, 16, 19, 20, 15, 18, 15, 15, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09449131158462552, "mean_inference_ms": 0.24346715790502796, "mean_action_processing_ms": 0.043876699574573304, "mean_env_wait_ms": 0.04686920386186319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015888168913493223, "StateBufferConnector_ms": 0.0012516410429895771, "ViewRequirementAgentConnector_ms": 0.028741190218812482}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1086.3683794916856, "num_env_steps_trained_throughput_per_sec": 1086.3683794916856, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 3707.955, "sample_time_ms": 1796.68, "load_time_ms": 0.213, "load_throughput": 18783269.145, "learn_time_ms": 1910.053, "learn_throughput": 2094.183, "synch_weights_time_ms": 0.657}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 6209, "training_iteration": 60, "trial_id": "default", "date": "2024-05-22_22-18-36", "timestamp": 1716409116, "time_this_iter_s": 3.6857759952545166, "time_total_s": 215.65742588043213, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 215.65742588043213, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 15.98, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6583740646159777, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04792706356690546, "policy_loss": -0.014376569245891866, "vf_loss": 0.06193366303228803, "vf_explained_var": 0.06424970735785782, "kl": 0.014798797266848986, "entropy": 1.166733616654591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 0.9846531697836952, "episode_reward_min": -1.0, "episode_reward_mean": 0.52544860824871, "episode_len_mean": 20.207070707070706, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7338097994569557, 0.8070973971032994, 0.871317612775815, 0.6255582717933332, 0.5535804039654164, -1.0, 0.5, 0.6874310282780596, 0.5, 0.5, 0.6057972828097727, 0.5, 0.8121219291948305, -1.0, 0.5047827489139254, 0.7330172663501473, 0.5, 0.5808114613877637, 0.5813568968600444, 0.5, 0.5, 0.5436911171355202, 0.5, 0.5, 0.5, 0.5, 0.6552596556746823, 0.5, 0.5, 0.6438745963836283, 0.7234965692860479, 0.6303756498033067, 0.5, 0.5, 0.6603965803310324, 0.6758062751116997, 0.6709622452929029, -1.0, 0.5, 0.5, 0.5981200556059635, 0.7850047732902506, 0.8746518695523298, 0.5579632707567079, 0.5639585356735966, 0.777904782939388, 0.5, 0.6442161647067808, 0.5, 0.6329910990151246, 0.5, 0.7622695499582377, 0.8922830606235195, 0.5, 0.5, 0.6729485284447674, 0.5253061382245248, 0.5, 0.6553327845910626, 0.708266065135218, 0.5, 0.9577902715711476, 0.5, 0.6668558023596562, 0.7023538385052608, 0.5, 0.5, 0.9626776024461003, 0.9663232101183675, 0.8061660581009977, 0.5, 0.5, 0.9725253731390668, 0.5, 0.9240456974534487, 0.5, 0.5, 0.6267483600688522, 0.5090688948636677, 0.6929695467886376, 0.5, 0.5, -1.0, 0.5, 0.5, 0.9778553727672732, 0.5, 0.5, 0.5, 0.5, 0.9820239812285111, 0.6383287556318478, 0.5760870095664972, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.687650923427571, 0.5, 0.5, 0.5, 0.8511232747850194, 0.5, 0.7878234059176894, 0.7315687085552671, 0.5, 0.5, 0.734019863133073, 0.8568465537016471, 0.6874867964843598, 0.5, -1.0, 0.5531766007209648, 0.5, 0.9447004804309845, 0.5, 0.8133029812469499, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5015465048451474, 0.7593053241801453, 0.5, 0.5, 0.5, -1.0, -1.0, 0.9107775734154543, 0.5, 0.5913173838579049, 0.9582250421462399, 0.5719891378729998, 0.7576861216571151, 0.528073062766817, 0.5, 0.5361153204946615, 0.6354405724036729, 0.5, 0.5, 0.6354553768442899, 0.5, 0.5260907835463189, -1.0, 0.9462730901803882, 0.8114701441717452, 0.661074132091626, 0.8954318656932219, 0.6338913084872114, 0.9016979531607056, 0.5, 0.5, 0.5, 0.5, 0.5339665236991691, 0.5, 0.5, 0.5, 0.5, 0.8528885447064075, -1.0, 0.5, 0.6981431087164693, 0.5, 0.5, 0.5, 0.8439922873035277, 0.7552809898539924, 0.5, 0.7629861997397043, 0.5, 0.8110319011485386, -1.0, 0.8021368382242698, 0.9846531697836952, 0.5775681590239928, 0.5, 0.6995127269152779, 0.5, 0.8432187440370764, 0.5, 0.5, 0.5, 0.5804474661244506, 0.5, 0.7787164261645125, 0.5937650458358842, 0.6404117040455517, 0.5, 0.8664698723491345, 0.9844445296179553, 0.5, 0.6060486687007725], "episode_lengths": [18, 18, 17, 22, 19, 28, 22, 22, 23, 25, 19, 22, 16, 17, 17, 18, 24, 18, 18, 19, 33, 17, 30, 26, 18, 25, 17, 33, 21, 18, 19, 17, 18, 21, 21, 16, 20, 14, 16, 22, 15, 17, 15, 19, 18, 19, 20, 17, 21, 22, 25, 17, 16, 18, 17, 20, 19, 26, 24, 25, 21, 14, 25, 16, 16, 29, 17, 18, 19, 16, 23, 23, 16, 24, 16, 19, 23, 17, 17, 19, 23, 25, 30, 25, 35, 15, 17, 20, 20, 25, 16, 20, 20, 26, 19, 22, 13, 20, 20, 18, 18, 44, 19, 21, 17, 23, 15, 18, 20, 26, 21, 17, 18, 19, 14, 16, 27, 17, 17, 17, 16, 23, 22, 25, 18, 16, 19, 15, 25, 23, 19, 40, 19, 16, 20, 18, 20, 21, 16, 20, 24, 19, 15, 19, 25, 20, 29, 19, 24, 16, 22, 16, 16, 19, 15, 22, 22, 18, 20, 17, 19, 26, 19, 19, 15, 23, 18, 14, 22, 23, 19, 20, 19, 27, 21, 21, 24, 16, 16, 18, 20, 19, 21, 20, 20, 20, 18, 22, 19, 23, 18, 19, 22, 21, 19, 19, 18, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09464209787403004, "mean_inference_ms": 0.24352292114675808, "mean_action_processing_ms": 0.043888617654115884, "mean_env_wait_ms": 0.04689770672825621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016302773446747751, "StateBufferConnector_ms": 0.0012379704099712949, "ViewRequirementAgentConnector_ms": 0.028929084238379893}}, "episode_reward_max": 0.9846531697836952, "episode_reward_min": -1.0, "episode_reward_mean": 0.52544860824871, "episode_len_mean": 20.207070707070706, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7338097994569557, 0.8070973971032994, 0.871317612775815, 0.6255582717933332, 0.5535804039654164, -1.0, 0.5, 0.6874310282780596, 0.5, 0.5, 0.6057972828097727, 0.5, 0.8121219291948305, -1.0, 0.5047827489139254, 0.7330172663501473, 0.5, 0.5808114613877637, 0.5813568968600444, 0.5, 0.5, 0.5436911171355202, 0.5, 0.5, 0.5, 0.5, 0.6552596556746823, 0.5, 0.5, 0.6438745963836283, 0.7234965692860479, 0.6303756498033067, 0.5, 0.5, 0.6603965803310324, 0.6758062751116997, 0.6709622452929029, -1.0, 0.5, 0.5, 0.5981200556059635, 0.7850047732902506, 0.8746518695523298, 0.5579632707567079, 0.5639585356735966, 0.777904782939388, 0.5, 0.6442161647067808, 0.5, 0.6329910990151246, 0.5, 0.7622695499582377, 0.8922830606235195, 0.5, 0.5, 0.6729485284447674, 0.5253061382245248, 0.5, 0.6553327845910626, 0.708266065135218, 0.5, 0.9577902715711476, 0.5, 0.6668558023596562, 0.7023538385052608, 0.5, 0.5, 0.9626776024461003, 0.9663232101183675, 0.8061660581009977, 0.5, 0.5, 0.9725253731390668, 0.5, 0.9240456974534487, 0.5, 0.5, 0.6267483600688522, 0.5090688948636677, 0.6929695467886376, 0.5, 0.5, -1.0, 0.5, 0.5, 0.9778553727672732, 0.5, 0.5, 0.5, 0.5, 0.9820239812285111, 0.6383287556318478, 0.5760870095664972, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.687650923427571, 0.5, 0.5, 0.5, 0.8511232747850194, 0.5, 0.7878234059176894, 0.7315687085552671, 0.5, 0.5, 0.734019863133073, 0.8568465537016471, 0.6874867964843598, 0.5, -1.0, 0.5531766007209648, 0.5, 0.9447004804309845, 0.5, 0.8133029812469499, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5015465048451474, 0.7593053241801453, 0.5, 0.5, 0.5, -1.0, -1.0, 0.9107775734154543, 0.5, 0.5913173838579049, 0.9582250421462399, 0.5719891378729998, 0.7576861216571151, 0.528073062766817, 0.5, 0.5361153204946615, 0.6354405724036729, 0.5, 0.5, 0.6354553768442899, 0.5, 0.5260907835463189, -1.0, 0.9462730901803882, 0.8114701441717452, 0.661074132091626, 0.8954318656932219, 0.6338913084872114, 0.9016979531607056, 0.5, 0.5, 0.5, 0.5, 0.5339665236991691, 0.5, 0.5, 0.5, 0.5, 0.8528885447064075, -1.0, 0.5, 0.6981431087164693, 0.5, 0.5, 0.5, 0.8439922873035277, 0.7552809898539924, 0.5, 0.7629861997397043, 0.5, 0.8110319011485386, -1.0, 0.8021368382242698, 0.9846531697836952, 0.5775681590239928, 0.5, 0.6995127269152779, 0.5, 0.8432187440370764, 0.5, 0.5, 0.5, 0.5804474661244506, 0.5, 0.7787164261645125, 0.5937650458358842, 0.6404117040455517, 0.5, 0.8664698723491345, 0.9844445296179553, 0.5, 0.6060486687007725], "episode_lengths": [18, 18, 17, 22, 19, 28, 22, 22, 23, 25, 19, 22, 16, 17, 17, 18, 24, 18, 18, 19, 33, 17, 30, 26, 18, 25, 17, 33, 21, 18, 19, 17, 18, 21, 21, 16, 20, 14, 16, 22, 15, 17, 15, 19, 18, 19, 20, 17, 21, 22, 25, 17, 16, 18, 17, 20, 19, 26, 24, 25, 21, 14, 25, 16, 16, 29, 17, 18, 19, 16, 23, 23, 16, 24, 16, 19, 23, 17, 17, 19, 23, 25, 30, 25, 35, 15, 17, 20, 20, 25, 16, 20, 20, 26, 19, 22, 13, 20, 20, 18, 18, 44, 19, 21, 17, 23, 15, 18, 20, 26, 21, 17, 18, 19, 14, 16, 27, 17, 17, 17, 16, 23, 22, 25, 18, 16, 19, 15, 25, 23, 19, 40, 19, 16, 20, 18, 20, 21, 16, 20, 24, 19, 15, 19, 25, 20, 29, 19, 24, 16, 22, 16, 16, 19, 15, 22, 22, 18, 20, 17, 19, 26, 19, 19, 15, 23, 18, 14, 22, 23, 19, 20, 19, 27, 21, 21, 24, 16, 16, 18, 20, 19, 21, 20, 20, 20, 18, 22, 19, 23, 18, 19, 22, 21, 19, 19, 18, 21]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09464209787403004, "mean_inference_ms": 0.24352292114675808, "mean_action_processing_ms": 0.043888617654115884, "mean_env_wait_ms": 0.04689770672825621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016302773446747751, "StateBufferConnector_ms": 0.0012379704099712949, "ViewRequirementAgentConnector_ms": 0.028929084238379893}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1093.2596396636034, "num_env_steps_trained_throughput_per_sec": 1093.2596396636034, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 3711.049, "sample_time_ms": 1801.526, "load_time_ms": 0.216, "load_throughput": 18534264.251, "learn_time_ms": 1908.305, "learn_throughput": 2096.101, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 6407, "training_iteration": 61, "trial_id": "default", "date": "2024-05-22_22-18-39", "timestamp": 1716409119, "time_this_iter_s": 3.6624388694763184, "time_total_s": 219.31986474990845, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 219.31986474990845, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 12.84, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.152578862251774, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08026581398243966, "policy_loss": -0.0030263503172224568, "vf_loss": 0.08301844983962514, "vf_explained_var": 0.325467082121039, "kl": 0.010948563417848991, "entropy": 1.0760308836096077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 0.9966231596523328, "episode_reward_min": -1.0, "episode_reward_mean": 0.5307406634276645, "episode_len_mean": 19.777227722772277, "episode_media": {}, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5026070035904533, 0.9703479213735146, 0.7609788120811853, 0.5, 0.9773649597637788, 0.6260981545321704, 0.7102373119963641, 0.5897487764544724, 0.926405875051468, 0.879913741023335, -1.0, 0.5, 0.8251236872104977, 0.7753609102600865, 0.6682999610937066, 0.9874833206653412, 0.989902273626625, 0.6606410039579986, 0.8326809144907277, 0.6874523232784089, 0.5313769147182614, 0.5, -1.0, 0.7248505748314304, 0.7463488760695797, 0.5, 0.6516281505187993, 0.597644739034829, 0.5180235160008413, 0.5455897622430161, 0.5, 0.8529284743474627, -1.0, 0.8304675739410173, 0.5134640520697189, 0.9702019256274401, 0.5, 0.5, 0.8958862855438257, 0.5, 0.8565449291493543, 0.5, 0.5, 0.6955043034207704, 0.6402813872086486, 0.5, 0.591687539137663, 0.5, 0.5, 0.5, 0.5, 0.9226700679183286, -1.0, 0.5, 0.5, -1.0, 0.5, 0.9734695989162381, 0.5, 0.7330363691908635, 0.8015091950441369, 0.6433446101721467, 0.9878807571580317, 0.5, 0.5, 0.5, 0.5564846180297207, -1.0, 0.5234200114786349, 0.5, 0.5, 0.5, 0.5, 0.5307005633534374, 0.5, 0.6362001129788382, 0.8310771597474756, 0.9553406330957449, 0.9481553922507407, -1.0, 0.5, 0.7464385174399324, 0.5, 0.9542066662127356, 0.6550031993281937, -1.0, 0.5, 0.88583524708899, 0.8465496009477704, 0.9297805740746374, 0.5, 0.5906816240764305, 0.5, 0.925274111056264, 0.5, 0.946542720595287, 0.5, 0.5, 0.9966231596523328, 0.5095109623208056, 0.5, 0.6567816281655987, 0.6998030839003817, 0.5, 0.581105866171991, 0.9672732858692107, 0.9763092823748771, 0.9209812731695901, 0.7551071013476411, 0.6667940911890183, 0.6067286539488485, 0.5, 0.935590285909581, 0.5, 0.5, 0.5, 0.5612755976525089, 0.5416035583156118, 0.8837477469492048, 0.5, 0.5, 0.5, 0.8428431496600693, 0.928031880645742, 0.5, 0.5, 0.5, 0.8139142606758798, 0.9082289422320771, 0.6251129643545502, 0.9255159163225686, 0.5, 0.5, 0.5138353173171337, 0.5, 0.5143816917118571, 0.5, 0.6660740521981214, 0.5, 0.5, -1.0, -1.0, 0.5, 0.9346519060337997, 0.5, -1.0, 0.7865857554113833, 0.5, 0.9175648021305931, 0.6958235234182384, 0.7150442390758588, 0.9866976923066912, 0.8561127890300217, -1.0, 0.8708670228376756, 0.8445258630490317, 0.517502356977658, 0.8643472711198448, 0.6616736544143837, 0.6925817096841388, -1.0, 0.9024519424111601, 0.5, 0.6154838911251554, -1.0, 0.5, 0.5, 0.5, 0.9345465482447077, 0.600225694134072, 0.5495499025323556, 0.7415412471411387, 0.5, 0.7603973085249389, 0.6309772431414141, 0.7396913389490947, 0.5673324589306792, 0.8150881660069489, 0.5, 0.6854433562493671, 0.625411138040945, 0.9783701463283399, -1.0, 0.7088471943174658, -1.0, 0.658247869930596, 0.9699613435236613, 0.5, 0.5206751074818345, 0.8483579551070513, 0.5, 0.5731560642861702, 0.7465785535231142, 0.6024029515209511, 0.982914000916587, 0.5, 0.691344463720948, 0.5105535587982055, 0.6259535473584577, 0.7262813781309555, 0.5, 0.5], "episode_lengths": [16, 15, 18, 40, 21, 21, 17, 16, 14, 14, 15, 22, 19, 17, 18, 18, 16, 17, 17, 16, 21, 18, 31, 17, 15, 21, 16, 20, 16, 20, 25, 21, 16, 14, 20, 17, 19, 26, 17, 24, 18, 22, 24, 19, 16, 23, 22, 19, 19, 32, 21, 15, 25, 22, 21, 80, 25, 14, 19, 17, 15, 16, 15, 27, 18, 23, 16, 21, 19, 24, 24, 21, 24, 23, 22, 18, 16, 18, 15, 14, 24, 17, 22, 13, 15, 14, 26, 24, 15, 13, 15, 23, 19, 17, 18, 15, 19, 18, 16, 22, 21, 16, 18, 20, 18, 17, 18, 14, 16, 15, 17, 34, 18, 19, 20, 28, 17, 18, 22, 26, 20, 32, 16, 19, 17, 21, 26, 19, 17, 18, 16, 28, 15, 14, 26, 19, 23, 18, 18, 16, 17, 20, 23, 16, 25, 17, 16, 16, 17, 18, 18, 15, 14, 39, 18, 21, 16, 18, 16, 18, 42, 16, 21, 17, 40, 20, 20, 23, 18, 20, 18, 24, 23, 17, 18, 16, 17, 14, 19, 17, 15, 20, 27, 16, 14, 18, 18, 17, 15, 16, 21, 18, 21, 21, 17, 23, 16, 23, 22, 19, 18, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09477341318466391, "mean_inference_ms": 0.2435385397608516, "mean_action_processing_ms": 0.043893340997142434, "mean_env_wait_ms": 0.046914809389486736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015625859251116763, "StateBufferConnector_ms": 0.001258897309256072, "ViewRequirementAgentConnector_ms": 0.02863725813308565}}, "episode_reward_max": 0.9966231596523328, "episode_reward_min": -1.0, "episode_reward_mean": 0.5307406634276645, "episode_len_mean": 19.777227722772277, "episodes_this_iter": 202, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5026070035904533, 0.9703479213735146, 0.7609788120811853, 0.5, 0.9773649597637788, 0.6260981545321704, 0.7102373119963641, 0.5897487764544724, 0.926405875051468, 0.879913741023335, -1.0, 0.5, 0.8251236872104977, 0.7753609102600865, 0.6682999610937066, 0.9874833206653412, 0.989902273626625, 0.6606410039579986, 0.8326809144907277, 0.6874523232784089, 0.5313769147182614, 0.5, -1.0, 0.7248505748314304, 0.7463488760695797, 0.5, 0.6516281505187993, 0.597644739034829, 0.5180235160008413, 0.5455897622430161, 0.5, 0.8529284743474627, -1.0, 0.8304675739410173, 0.5134640520697189, 0.9702019256274401, 0.5, 0.5, 0.8958862855438257, 0.5, 0.8565449291493543, 0.5, 0.5, 0.6955043034207704, 0.6402813872086486, 0.5, 0.591687539137663, 0.5, 0.5, 0.5, 0.5, 0.9226700679183286, -1.0, 0.5, 0.5, -1.0, 0.5, 0.9734695989162381, 0.5, 0.7330363691908635, 0.8015091950441369, 0.6433446101721467, 0.9878807571580317, 0.5, 0.5, 0.5, 0.5564846180297207, -1.0, 0.5234200114786349, 0.5, 0.5, 0.5, 0.5, 0.5307005633534374, 0.5, 0.6362001129788382, 0.8310771597474756, 0.9553406330957449, 0.9481553922507407, -1.0, 0.5, 0.7464385174399324, 0.5, 0.9542066662127356, 0.6550031993281937, -1.0, 0.5, 0.88583524708899, 0.8465496009477704, 0.9297805740746374, 0.5, 0.5906816240764305, 0.5, 0.925274111056264, 0.5, 0.946542720595287, 0.5, 0.5, 0.9966231596523328, 0.5095109623208056, 0.5, 0.6567816281655987, 0.6998030839003817, 0.5, 0.581105866171991, 0.9672732858692107, 0.9763092823748771, 0.9209812731695901, 0.7551071013476411, 0.6667940911890183, 0.6067286539488485, 0.5, 0.935590285909581, 0.5, 0.5, 0.5, 0.5612755976525089, 0.5416035583156118, 0.8837477469492048, 0.5, 0.5, 0.5, 0.8428431496600693, 0.928031880645742, 0.5, 0.5, 0.5, 0.8139142606758798, 0.9082289422320771, 0.6251129643545502, 0.9255159163225686, 0.5, 0.5, 0.5138353173171337, 0.5, 0.5143816917118571, 0.5, 0.6660740521981214, 0.5, 0.5, -1.0, -1.0, 0.5, 0.9346519060337997, 0.5, -1.0, 0.7865857554113833, 0.5, 0.9175648021305931, 0.6958235234182384, 0.7150442390758588, 0.9866976923066912, 0.8561127890300217, -1.0, 0.8708670228376756, 0.8445258630490317, 0.517502356977658, 0.8643472711198448, 0.6616736544143837, 0.6925817096841388, -1.0, 0.9024519424111601, 0.5, 0.6154838911251554, -1.0, 0.5, 0.5, 0.5, 0.9345465482447077, 0.600225694134072, 0.5495499025323556, 0.7415412471411387, 0.5, 0.7603973085249389, 0.6309772431414141, 0.7396913389490947, 0.5673324589306792, 0.8150881660069489, 0.5, 0.6854433562493671, 0.625411138040945, 0.9783701463283399, -1.0, 0.7088471943174658, -1.0, 0.658247869930596, 0.9699613435236613, 0.5, 0.5206751074818345, 0.8483579551070513, 0.5, 0.5731560642861702, 0.7465785535231142, 0.6024029515209511, 0.982914000916587, 0.5, 0.691344463720948, 0.5105535587982055, 0.6259535473584577, 0.7262813781309555, 0.5, 0.5], "episode_lengths": [16, 15, 18, 40, 21, 21, 17, 16, 14, 14, 15, 22, 19, 17, 18, 18, 16, 17, 17, 16, 21, 18, 31, 17, 15, 21, 16, 20, 16, 20, 25, 21, 16, 14, 20, 17, 19, 26, 17, 24, 18, 22, 24, 19, 16, 23, 22, 19, 19, 32, 21, 15, 25, 22, 21, 80, 25, 14, 19, 17, 15, 16, 15, 27, 18, 23, 16, 21, 19, 24, 24, 21, 24, 23, 22, 18, 16, 18, 15, 14, 24, 17, 22, 13, 15, 14, 26, 24, 15, 13, 15, 23, 19, 17, 18, 15, 19, 18, 16, 22, 21, 16, 18, 20, 18, 17, 18, 14, 16, 15, 17, 34, 18, 19, 20, 28, 17, 18, 22, 26, 20, 32, 16, 19, 17, 21, 26, 19, 17, 18, 16, 28, 15, 14, 26, 19, 23, 18, 18, 16, 17, 20, 23, 16, 25, 17, 16, 16, 17, 18, 18, 15, 14, 39, 18, 21, 16, 18, 16, 18, 42, 16, 21, 17, 40, 20, 20, 23, 18, 20, 18, 24, 23, 17, 18, 16, 17, 14, 19, 17, 15, 20, 27, 16, 14, 18, 18, 17, 15, 16, 21, 18, 21, 21, 17, 23, 16, 23, 22, 19, 18, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09477341318466391, "mean_inference_ms": 0.2435385397608516, "mean_action_processing_ms": 0.043893340997142434, "mean_env_wait_ms": 0.046914809389486736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015625859251116763, "StateBufferConnector_ms": 0.001258897309256072, "ViewRequirementAgentConnector_ms": 0.02863725813308565}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.236307959953, "num_env_steps_trained_throughput_per_sec": 1102.236307959953, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 3698.3, "sample_time_ms": 1801.31, "load_time_ms": 0.218, "load_throughput": 18337759.318, "learn_time_ms": 1895.767, "learn_throughput": 2109.964, "synch_weights_time_ms": 0.655}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 6609, "training_iteration": 62, "trial_id": "default", "date": "2024-05-22_22-18-43", "timestamp": 1716409123, "time_this_iter_s": 3.6326260566711426, "time_total_s": 222.9524908065796, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.9524908065796, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 19.919999999999998, "ram_util_percent": 61.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.103915617991519, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03888401836078609, "policy_loss": -0.012054691025085988, "vf_loss": 0.05049289823910322, "vf_explained_var": 0.25597609005948546, "kl": 0.017832464331830614, "entropy": 0.9676992965641842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 0.9854366106431588, "episode_reward_min": -1.0, "episode_reward_mean": 0.588067749661021, "episode_len_mean": 19.270531400966185, "episode_media": {}, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.7670909906239842, 0.5, 0.9266365103864916, 0.6660610482656826, 0.5482425611677708, 0.7570188512767682, 0.6808443162729314, 0.5, 0.5, 0.5, 0.7179337244392486, 0.9738029348310389, 0.5239024520148636, 0.9616804332105974, 0.6327061547958133, 0.888095282898046, 0.6008208244843185, 0.5, 0.6589702490053191, -1.0, 0.5080410113964988, 0.9494274048776717, 0.9733733125192118, 0.5387677283831582, 0.9368653790418614, 0.5, 0.7367916856957524, 0.7200069927876213, 0.5, 0.5, 0.5, 0.6523739232335063, 0.822882657533432, 0.6075585005798855, 0.5352317708206238, 0.5, 0.7182303566207822, -1.0, 0.763049943624019, 0.9770275383508713, 0.5359519138066117, 0.6788689103994006, 0.5, 0.96615247139617, 0.8085159571849039, 0.5, 0.5, 0.5714535064521802, 0.7919276684161481, 0.5, 0.5, 0.5, 0.5, 0.880435386367289, -1.0, 0.5, 0.694632338470359, 0.5, 0.917232689590109, 0.922501346618631, 0.8700738252729017, 0.8629964523758366, 0.9722906372305878, -1.0, 0.9759005326299758, 0.9622300140970292, 0.5, 0.5, 0.7396468479073597, 0.9691698013567961, 0.7209929061984056, 0.5, 0.8800706734146436, 0.5, 0.6699823058754384, 0.5, 0.5, 0.9202617643300299, 0.9593111083869363, 0.6285930987009947, 0.5, 0.5526216572915628, 0.7794677830652189, 0.5, 0.5, 0.5913371083589769, 0.8172474012531006, 0.5, 0.5881485470855774, 0.566206378422718, 0.5, 0.8380127607719614, 0.5, 0.9050340226016966, -1.0, 0.5, 0.5, 0.6340737997207175, 0.5, 0.5, 0.5, 0.7295364542183538, 0.8761630958984554, 0.972083064762811, 0.9753795330000495, 0.5, -1.0, 0.5, 0.5, 0.5, 0.557513451686946, 0.9213801208199193, 0.7145862609486545, 0.5, 0.5, 0.5, 0.7179244102361986, 0.7853529623525591, 0.5, -1.0, 0.7127379433871819, 0.5, 0.5, 0.5, 0.6606568298707365, 0.8525785812784203, 0.5, 0.5, 0.7270656626054454, 0.5, 0.5, 0.7779474771774659, 0.5, 0.8581005465324762, 0.5, 0.5, 0.5, 0.9829234928972956, 0.5, 0.9763269668409632, 0.5545250086743232, 0.7532932096982495, 0.9607947264088785, 0.9854366106431588, 0.7156655958722498, 0.5, 0.5, 0.5420415489125185, 0.5143840478655383, 0.5712033484160277, 0.6687369079576212, 0.7762784496393484, 0.8758038844088742, 0.5, 0.5, 0.8092860189656245, 0.7530402407293101, 0.5, 0.5, 0.589581717450399, 0.7751987783217453, 0.9194352012068189, 0.8104335088128525, 0.5, 0.5, 0.5, 0.957277123616026, 0.5, 0.8042941708598215, 0.8150164193962056, 0.7276458027684982, -1.0, 0.9676359760328372, 0.577095946912755, 0.5, 0.5, 0.5, 0.9298089070040184, 0.5, 0.7499034850609618, 0.5, 0.9662052556378642, 0.563379442606835, 0.5327300874798389, -1.0, 0.7995767608769656, 0.9256517219336146, 0.5, 0.615867957522226, 0.9704893826633373, 0.8524731589360819, 0.7409815953478325, 0.5, 0.5, 0.6229198821640962, 0.7204035094367227, 0.5308580495902462, 0.7062841704559946, 0.5, 0.5, 0.785061732805095, 0.721167790061665, 0.8591240379763054, 0.5, 0.5], "episode_lengths": [19, 19, 17, 32, 17, 18, 16, 16, 18, 37, 23, 17, 19, 16, 20, 16, 28, 15, 16, 20, 16, 14, 18, 16, 14, 19, 18, 22, 16, 15, 16, 28, 19, 25, 16, 13, 18, 19, 16, 33, 17, 18, 19, 16, 28, 17, 15, 24, 18, 22, 17, 18, 19, 17, 19, 18, 26, 22, 15, 31, 15, 14, 18, 15, 15, 18, 19, 14, 19, 24, 15, 18, 17, 20, 16, 21, 16, 24, 17, 15, 15, 16, 25, 17, 19, 23, 16, 18, 16, 21, 18, 16, 18, 16, 20, 16, 18, 25, 33, 19, 20, 19, 24, 16, 16, 15, 14, 21, 14, 21, 19, 26, 18, 16, 16, 22, 17, 16, 17, 17, 19, 21, 16, 20, 21, 21, 16, 16, 20, 22, 17, 20, 29, 16, 23, 18, 16, 24, 17, 14, 22, 16, 21, 16, 13, 17, 18, 18, 27, 21, 21, 18, 18, 16, 20, 26, 31, 15, 15, 18, 23, 17, 19, 14, 13, 22, 21, 18, 22, 24, 18, 19, 15, 61, 17, 22, 18, 28, 28, 18, 18, 18, 18, 19, 19, 17, 42, 16, 18, 18, 16, 17, 16, 16, 19, 24, 22, 15, 19, 17, 21, 21, 17, 16, 16, 20, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09490669997197167, "mean_inference_ms": 0.24355946309752857, "mean_action_processing_ms": 0.04389968171137608, "mean_env_wait_ms": 0.04693386871198502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015186226886251698, "StateBufferConnector_ms": 0.001230101654495018, "ViewRequirementAgentConnector_ms": 0.02873335483569454}}, "episode_reward_max": 0.9854366106431588, "episode_reward_min": -1.0, "episode_reward_mean": 0.588067749661021, "episode_len_mean": 19.270531400966185, "episodes_this_iter": 207, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.7670909906239842, 0.5, 0.9266365103864916, 0.6660610482656826, 0.5482425611677708, 0.7570188512767682, 0.6808443162729314, 0.5, 0.5, 0.5, 0.7179337244392486, 0.9738029348310389, 0.5239024520148636, 0.9616804332105974, 0.6327061547958133, 0.888095282898046, 0.6008208244843185, 0.5, 0.6589702490053191, -1.0, 0.5080410113964988, 0.9494274048776717, 0.9733733125192118, 0.5387677283831582, 0.9368653790418614, 0.5, 0.7367916856957524, 0.7200069927876213, 0.5, 0.5, 0.5, 0.6523739232335063, 0.822882657533432, 0.6075585005798855, 0.5352317708206238, 0.5, 0.7182303566207822, -1.0, 0.763049943624019, 0.9770275383508713, 0.5359519138066117, 0.6788689103994006, 0.5, 0.96615247139617, 0.8085159571849039, 0.5, 0.5, 0.5714535064521802, 0.7919276684161481, 0.5, 0.5, 0.5, 0.5, 0.880435386367289, -1.0, 0.5, 0.694632338470359, 0.5, 0.917232689590109, 0.922501346618631, 0.8700738252729017, 0.8629964523758366, 0.9722906372305878, -1.0, 0.9759005326299758, 0.9622300140970292, 0.5, 0.5, 0.7396468479073597, 0.9691698013567961, 0.7209929061984056, 0.5, 0.8800706734146436, 0.5, 0.6699823058754384, 0.5, 0.5, 0.9202617643300299, 0.9593111083869363, 0.6285930987009947, 0.5, 0.5526216572915628, 0.7794677830652189, 0.5, 0.5, 0.5913371083589769, 0.8172474012531006, 0.5, 0.5881485470855774, 0.566206378422718, 0.5, 0.8380127607719614, 0.5, 0.9050340226016966, -1.0, 0.5, 0.5, 0.6340737997207175, 0.5, 0.5, 0.5, 0.7295364542183538, 0.8761630958984554, 0.972083064762811, 0.9753795330000495, 0.5, -1.0, 0.5, 0.5, 0.5, 0.557513451686946, 0.9213801208199193, 0.7145862609486545, 0.5, 0.5, 0.5, 0.7179244102361986, 0.7853529623525591, 0.5, -1.0, 0.7127379433871819, 0.5, 0.5, 0.5, 0.6606568298707365, 0.8525785812784203, 0.5, 0.5, 0.7270656626054454, 0.5, 0.5, 0.7779474771774659, 0.5, 0.8581005465324762, 0.5, 0.5, 0.5, 0.9829234928972956, 0.5, 0.9763269668409632, 0.5545250086743232, 0.7532932096982495, 0.9607947264088785, 0.9854366106431588, 0.7156655958722498, 0.5, 0.5, 0.5420415489125185, 0.5143840478655383, 0.5712033484160277, 0.6687369079576212, 0.7762784496393484, 0.8758038844088742, 0.5, 0.5, 0.8092860189656245, 0.7530402407293101, 0.5, 0.5, 0.589581717450399, 0.7751987783217453, 0.9194352012068189, 0.8104335088128525, 0.5, 0.5, 0.5, 0.957277123616026, 0.5, 0.8042941708598215, 0.8150164193962056, 0.7276458027684982, -1.0, 0.9676359760328372, 0.577095946912755, 0.5, 0.5, 0.5, 0.9298089070040184, 0.5, 0.7499034850609618, 0.5, 0.9662052556378642, 0.563379442606835, 0.5327300874798389, -1.0, 0.7995767608769656, 0.9256517219336146, 0.5, 0.615867957522226, 0.9704893826633373, 0.8524731589360819, 0.7409815953478325, 0.5, 0.5, 0.6229198821640962, 0.7204035094367227, 0.5308580495902462, 0.7062841704559946, 0.5, 0.5, 0.785061732805095, 0.721167790061665, 0.8591240379763054, 0.5, 0.5], "episode_lengths": [19, 19, 17, 32, 17, 18, 16, 16, 18, 37, 23, 17, 19, 16, 20, 16, 28, 15, 16, 20, 16, 14, 18, 16, 14, 19, 18, 22, 16, 15, 16, 28, 19, 25, 16, 13, 18, 19, 16, 33, 17, 18, 19, 16, 28, 17, 15, 24, 18, 22, 17, 18, 19, 17, 19, 18, 26, 22, 15, 31, 15, 14, 18, 15, 15, 18, 19, 14, 19, 24, 15, 18, 17, 20, 16, 21, 16, 24, 17, 15, 15, 16, 25, 17, 19, 23, 16, 18, 16, 21, 18, 16, 18, 16, 20, 16, 18, 25, 33, 19, 20, 19, 24, 16, 16, 15, 14, 21, 14, 21, 19, 26, 18, 16, 16, 22, 17, 16, 17, 17, 19, 21, 16, 20, 21, 21, 16, 16, 20, 22, 17, 20, 29, 16, 23, 18, 16, 24, 17, 14, 22, 16, 21, 16, 13, 17, 18, 18, 27, 21, 21, 18, 18, 16, 20, 26, 31, 15, 15, 18, 23, 17, 19, 14, 13, 22, 21, 18, 22, 24, 18, 19, 15, 61, 17, 22, 18, 28, 28, 18, 18, 18, 18, 19, 19, 17, 42, 16, 18, 18, 16, 17, 16, 16, 19, 24, 22, 15, 19, 17, 21, 21, 17, 16, 16, 20, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09490669997197167, "mean_inference_ms": 0.24355946309752857, "mean_action_processing_ms": 0.04389968171137608, "mean_env_wait_ms": 0.04693386871198502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015186226886251698, "StateBufferConnector_ms": 0.001230101654495018, "ViewRequirementAgentConnector_ms": 0.02873335483569454}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1094.6496676815061, "num_env_steps_trained_throughput_per_sec": 1094.6496676815061, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3688.249, "sample_time_ms": 1798.284, "load_time_ms": 0.218, "load_throughput": 18347786.527, "learn_time_ms": 1888.752, "learn_throughput": 2117.801, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 6816, "training_iteration": 63, "trial_id": "default", "date": "2024-05-22_22-18-47", "timestamp": 1716409127, "time_this_iter_s": 3.6578469276428223, "time_total_s": 226.6103377342224, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.6103377342224, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 18.96, "ram_util_percent": 61.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0335461136474406, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.057881511051191506, "policy_loss": -0.010214540843291068, "vf_loss": 0.0677090940431201, "vf_explained_var": 0.37485759194179247, "kl": 0.01547838408945999, "entropy": 0.8382946123679479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 0.9999081591245159, "episode_reward_min": -1.0, "episode_reward_mean": 0.6010858186968955, "episode_len_mean": 20.237373737373737, "episode_media": {}, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8849047424759444, 0.5, 0.5122935663149375, 0.8366625822027971, 0.9251593994923603, 0.8170786513427458, 0.5, 0.5, 0.603199296278361, 0.6478240976965127, 0.7722492895967822, -1.0, 0.7989007841106356, 0.86326765573624, 0.5, 0.5, -1.0, 0.861818757475882, 0.6955186711269055, 0.5, 0.9999081591245159, 0.9090695190775995, 0.9063248336677548, 0.5, 0.8742485870483048, 0.880033410385246, 0.5746291437027115, 0.8390137135091441, 0.864805912086266, 0.5, 0.5, 0.5, 0.9366963149723626, -1.0, 0.5, -1.0, 0.8783066043278022, 0.5, 0.8847092438664521, 0.5, 0.6755844244063007, 0.7932689986074397, 0.5, 0.677417668343871, 0.9344458111144417, 0.814784417466585, 0.5, 0.5, 0.928185105954479, 0.8719858357438488, -1.0, 0.8227312670005847, 0.5, 0.513822686550371, 0.5, 0.5, 0.5, 0.5, 0.9969580025498256, 0.9801670406098518, 0.8540475580067071, 0.5, 0.9617856161281652, 0.8642339992593937, 0.6240169257989839, 0.8661375525454972, 0.9823827763004571, 0.8910054145482957, 0.9760152165692579, 0.5, 0.5, 0.5, 0.9404244684890852, 0.7610482969951402, 0.5, 0.865493601635079, 0.5, 0.5, 0.9713207135358213, 0.5707592868403424, 0.5, 0.8145711315483787, 0.9733458116023836, 0.5, 0.5, 0.5, 0.8845413785533348, 0.8527627263660134, 0.7307030632580148, 0.5717234070448263, -1.0, 0.7032875305904693, 0.8870690044589952, 0.5, 0.9706870401985404, 0.6044908563907995, 0.7533955237538076, 0.5, 0.9686164024790421, 0.540760211558889, 0.5, 0.8014690704670863, 0.5, 0.5, 0.7734126818299568, 0.5, 0.5, 0.9748809429235651, 0.5, 0.5, 0.7819223569171361, 0.9271685815639579, 0.5, 0.7361119869887927, 0.5, 0.691478349577536, 0.9272082732260092, 0.8617383442610065, 0.7412490018276707, 0.9939739439937951, 0.9697556896762178, 0.8121884919469459, 0.8612235101712562, 0.5, 0.8925027911550224, 0.5, 0.5, 0.8792240381647947, 0.555521908940477, 0.6528968670079153, 0.5, 0.5, 0.5, 0.9901023235655037, 0.9671467852677758, 0.5, 0.728671060565928, 0.5, 0.5, 0.5, 0.5, 0.548258803872942, -1.0, 0.5, 0.6472770559682048, 0.5, 0.7917518083260578, 0.5, 0.5, 0.9723628044294524, 0.6678049367905581, 0.7247936053593753, 0.6514096179098278, 0.5, 0.908627367442323, 0.5096942981059298, 0.7644974185082708, 0.5, 0.6118792140816072, 0.789918098480541, 0.839452229633322, 0.984698588501813, 0.78859749602297, 0.5, 0.5, 0.5, 0.8810126434592602, 0.8502269632683238, 0.5, 0.7243533550803696, 0.922735087316602, 0.5, -1.0, 0.8816526440948629, 0.5290955697285133, 0.5, 0.8587275655581261, 0.6169230577042328, 0.9481469770341655, 0.9782289378123705, 0.6091289899609003, 0.7474202052388557, 0.6779950572107747, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9732702000464638, 0.5, 0.5334439896632499, 0.9730208293846417, -1.0, 0.5, -1.0, 0.5, 0.5, 0.9281399775304681], "episode_lengths": [18, 24, 20, 17, 15, 14, 40, 21, 17, 16, 15, 25, 16, 16, 17, 18, 10, 17, 15, 24, 16, 16, 17, 29, 16, 17, 22, 16, 19, 29, 38, 19, 16, 26, 20, 27, 19, 18, 14, 16, 19, 17, 22, 17, 17, 16, 20, 22, 16, 14, 17, 18, 38, 25, 21, 26, 15, 71, 16, 15, 16, 23, 15, 16, 18, 16, 16, 16, 16, 16, 19, 33, 15, 17, 25, 15, 21, 22, 16, 21, 18, 14, 16, 32, 31, 27, 16, 16, 14, 17, 26, 18, 14, 25, 18, 17, 14, 31, 15, 15, 20, 15, 24, 27, 21, 17, 29, 16, 29, 30, 17, 16, 17, 17, 32, 17, 15, 16, 16, 15, 15, 21, 16, 23, 13, 18, 27, 14, 19, 17, 24, 22, 21, 15, 17, 24, 16, 23, 23, 27, 26, 19, 11, 35, 16, 24, 21, 35, 34, 20, 17, 19, 15, 33, 17, 18, 14, 18, 21, 18, 16, 17, 16, 19, 18, 19, 16, 15, 48, 18, 16, 17, 16, 15, 21, 21, 16, 18, 17, 16, 16, 14, 24, 17, 24, 19, 36, 15, 16, 20, 17, 15, 76, 17, 29, 18, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09504754500622094, "mean_inference_ms": 0.24362036323373767, "mean_action_processing_ms": 0.04391395376206197, "mean_env_wait_ms": 0.04696225936152759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015673011240333018, "StateBufferConnector_ms": 0.0012675921122233074, "ViewRequirementAgentConnector_ms": 0.028974239272300643}}, "episode_reward_max": 0.9999081591245159, "episode_reward_min": -1.0, "episode_reward_mean": 0.6010858186968955, "episode_len_mean": 20.237373737373737, "episodes_this_iter": 198, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8849047424759444, 0.5, 0.5122935663149375, 0.8366625822027971, 0.9251593994923603, 0.8170786513427458, 0.5, 0.5, 0.603199296278361, 0.6478240976965127, 0.7722492895967822, -1.0, 0.7989007841106356, 0.86326765573624, 0.5, 0.5, -1.0, 0.861818757475882, 0.6955186711269055, 0.5, 0.9999081591245159, 0.9090695190775995, 0.9063248336677548, 0.5, 0.8742485870483048, 0.880033410385246, 0.5746291437027115, 0.8390137135091441, 0.864805912086266, 0.5, 0.5, 0.5, 0.9366963149723626, -1.0, 0.5, -1.0, 0.8783066043278022, 0.5, 0.8847092438664521, 0.5, 0.6755844244063007, 0.7932689986074397, 0.5, 0.677417668343871, 0.9344458111144417, 0.814784417466585, 0.5, 0.5, 0.928185105954479, 0.8719858357438488, -1.0, 0.8227312670005847, 0.5, 0.513822686550371, 0.5, 0.5, 0.5, 0.5, 0.9969580025498256, 0.9801670406098518, 0.8540475580067071, 0.5, 0.9617856161281652, 0.8642339992593937, 0.6240169257989839, 0.8661375525454972, 0.9823827763004571, 0.8910054145482957, 0.9760152165692579, 0.5, 0.5, 0.5, 0.9404244684890852, 0.7610482969951402, 0.5, 0.865493601635079, 0.5, 0.5, 0.9713207135358213, 0.5707592868403424, 0.5, 0.8145711315483787, 0.9733458116023836, 0.5, 0.5, 0.5, 0.8845413785533348, 0.8527627263660134, 0.7307030632580148, 0.5717234070448263, -1.0, 0.7032875305904693, 0.8870690044589952, 0.5, 0.9706870401985404, 0.6044908563907995, 0.7533955237538076, 0.5, 0.9686164024790421, 0.540760211558889, 0.5, 0.8014690704670863, 0.5, 0.5, 0.7734126818299568, 0.5, 0.5, 0.9748809429235651, 0.5, 0.5, 0.7819223569171361, 0.9271685815639579, 0.5, 0.7361119869887927, 0.5, 0.691478349577536, 0.9272082732260092, 0.8617383442610065, 0.7412490018276707, 0.9939739439937951, 0.9697556896762178, 0.8121884919469459, 0.8612235101712562, 0.5, 0.8925027911550224, 0.5, 0.5, 0.8792240381647947, 0.555521908940477, 0.6528968670079153, 0.5, 0.5, 0.5, 0.9901023235655037, 0.9671467852677758, 0.5, 0.728671060565928, 0.5, 0.5, 0.5, 0.5, 0.548258803872942, -1.0, 0.5, 0.6472770559682048, 0.5, 0.7917518083260578, 0.5, 0.5, 0.9723628044294524, 0.6678049367905581, 0.7247936053593753, 0.6514096179098278, 0.5, 0.908627367442323, 0.5096942981059298, 0.7644974185082708, 0.5, 0.6118792140816072, 0.789918098480541, 0.839452229633322, 0.984698588501813, 0.78859749602297, 0.5, 0.5, 0.5, 0.8810126434592602, 0.8502269632683238, 0.5, 0.7243533550803696, 0.922735087316602, 0.5, -1.0, 0.8816526440948629, 0.5290955697285133, 0.5, 0.8587275655581261, 0.6169230577042328, 0.9481469770341655, 0.9782289378123705, 0.6091289899609003, 0.7474202052388557, 0.6779950572107747, 0.5, 0.5, 0.5, 0.5, 0.5, 0.9732702000464638, 0.5, 0.5334439896632499, 0.9730208293846417, -1.0, 0.5, -1.0, 0.5, 0.5, 0.9281399775304681], "episode_lengths": [18, 24, 20, 17, 15, 14, 40, 21, 17, 16, 15, 25, 16, 16, 17, 18, 10, 17, 15, 24, 16, 16, 17, 29, 16, 17, 22, 16, 19, 29, 38, 19, 16, 26, 20, 27, 19, 18, 14, 16, 19, 17, 22, 17, 17, 16, 20, 22, 16, 14, 17, 18, 38, 25, 21, 26, 15, 71, 16, 15, 16, 23, 15, 16, 18, 16, 16, 16, 16, 16, 19, 33, 15, 17, 25, 15, 21, 22, 16, 21, 18, 14, 16, 32, 31, 27, 16, 16, 14, 17, 26, 18, 14, 25, 18, 17, 14, 31, 15, 15, 20, 15, 24, 27, 21, 17, 29, 16, 29, 30, 17, 16, 17, 17, 32, 17, 15, 16, 16, 15, 15, 21, 16, 23, 13, 18, 27, 14, 19, 17, 24, 22, 21, 15, 17, 24, 16, 23, 23, 27, 26, 19, 11, 35, 16, 24, 21, 35, 34, 20, 17, 19, 15, 33, 17, 18, 14, 18, 21, 18, 16, 17, 16, 19, 18, 19, 16, 15, 48, 18, 16, 17, 16, 15, 21, 21, 16, 18, 17, 16, 16, 14, 24, 17, 24, 19, 36, 15, 16, 20, 17, 15, 76, 17, 29, 18, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09504754500622094, "mean_inference_ms": 0.24362036323373767, "mean_action_processing_ms": 0.04391395376206197, "mean_env_wait_ms": 0.04696225936152759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015673011240333018, "StateBufferConnector_ms": 0.0012675921122233074, "ViewRequirementAgentConnector_ms": 0.028974239272300643}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1057.5545055578732, "num_env_steps_trained_throughput_per_sec": 1057.5545055578732, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 3692.426, "sample_time_ms": 1799.001, "load_time_ms": 0.222, "load_throughput": 17980083.592, "learn_time_ms": 1892.203, "learn_throughput": 2113.938, "synch_weights_time_ms": 0.655}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 7014, "training_iteration": 64, "trial_id": "default", "date": "2024-05-22_22-18-50", "timestamp": 1716409130, "time_this_iter_s": 3.78609037399292, "time_total_s": 230.39642810821533, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 230.39642810821533, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 20.566666666666666, "ram_util_percent": 61.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6684476826139676, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06100626547901606, "policy_loss": -0.007826633185588865, "vf_loss": 0.06855783222233175, "vf_explained_var": 0.2122590809740046, "kl": 0.011002714348135963, "entropy": 0.8763776729504268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 0.9981399694657169, "episode_reward_min": -1.0, "episode_reward_mean": 0.6144772702215363, "episode_len_mean": 21.137566137566136, "episode_media": {}, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9088579684632293, 0.9981399694657169, 0.501322250709499, 0.63278848284473, 0.5, 0.6479718792816045, 0.5170513847114536, 0.5566990609337605, -1.0, 0.7008808848661656, 0.5028709337131193, 0.8472483391093427, 0.9698638352838338, 0.7977875968918615, 0.7867438105300857, 0.6177352803558223, 0.8146890179081604, 0.5, 0.7962780495474259, 0.843834640387874, 0.5, 0.5, 0.5, 0.5061414594065728, 0.7662012441110214, 0.7248816466537349, 0.787055818353553, 0.5, 0.8244477846560098, 0.5, 0.9033310360345995, 0.5, 0.8060407416200511, 0.8921012586616236, 0.5, 0.5, 0.9438006318163799, 0.8145070474383206, 0.5, 0.5, 0.5, 0.5, 0.9780540163608873, 0.5, 0.5, 0.7570096874982026, 0.5, 0.5, 0.8619078017907073, 0.8113492576877603, 0.5, 0.8528331925281711, 0.5, 0.5, 0.763583863729808, 0.5, 0.9584161461866071, 0.6650252351462946, 0.5, 0.5, 0.5, 0.7038816598558371, 0.5703563999043904, 0.9764167795801145, 0.5, 0.7564924940037497, 0.7338030568209717, 0.5767874368286827, 0.7008165589836232, 0.5, -1.0, 0.5048199465003071, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5995299127330438, 0.581184272778807, 0.9572033691687715, 0.5811502355581878, 0.8216772571959574, 0.6671542862117457, 0.5, 0.7740236940396774, 0.6615273535308785, 0.5, 0.5, 0.5728401708124562, 0.8922346468029165, 0.9750152177609643, 0.8727648645529109, 0.5605765985815543, 0.5, 0.6101488608308014, 0.8208593648953021, 0.5, 0.5, 0.5101776362318946, 0.6422646872405016, 0.7934258247810592, 0.5947879029540788, 0.5, 0.5, 0.7690652656309895, 0.7153674540177695, 0.5931773393442297, 0.7661402265715779, 0.8085900484550832, 0.5, 0.7435416676938595, 0.5, 0.5, 0.5, 0.8964301765064955, 0.555169664343087, 0.5, 0.9800281743531027, -1.0, 0.7485821132313536, 0.5, 0.9275940850965747, 0.5, 0.513741773902553, 0.9750284225770464, 0.9710211840179209, 0.7636477060936361, 0.5, 0.5372617681176117, -1.0, 0.5, 0.5, 0.5986950426667315, -1.0, 0.8750246056989923, 0.5, 0.9869277083968759, 0.5311746237794885, 0.9450692336771516, 0.828279288367523, 0.9732306243142926, 0.7033989599245398, 0.804386173257243, 0.7911706808799913, 0.5, 0.5483468633984115, 0.5, 0.8770459805251027, 0.6700761955812427, 0.5, 0.8421795977243597, 0.9553869699982483, 0.8532212249494405, 0.5667478783129247, 0.835384292984182, 0.5, 0.9036349354396498, 0.7533291364407022, -1.0, 0.6214663886431595, 0.8540395820476023, 0.9912541805515788, 0.6765097684366692, 0.5, 0.8766355939198992, 0.9622305153013037, 0.7093290583333427, 0.5, 0.6621954909940535, 0.5, 0.9582788194485425, 0.5, 0.5393925515133366, 0.5, 0.8847631603630984, 0.5, 0.5, 0.5, 0.5, 0.8845614892733831, 0.5, 0.6736724534590719, 0.7719450304019034, 0.5366162585926717, 0.9945313224419805, 0.5823637965529196, 0.6414341014571652, 0.9151784776370085, 0.7233372024085138], "episode_lengths": [16, 15, 17, 16, 39, 23, 25, 19, 35, 18, 18, 17, 17, 17, 17, 20, 15, 52, 16, 13, 20, 24, 23, 17, 14, 17, 19, 22, 17, 21, 16, 24, 14, 15, 20, 22, 16, 16, 36, 15, 29, 16, 18, 17, 17, 17, 56, 28, 15, 15, 17, 16, 56, 27, 16, 18, 18, 15, 22, 29, 17, 15, 17, 14, 47, 16, 15, 16, 19, 18, 21, 21, 37, 41, 22, 24, 32, 17, 20, 16, 16, 17, 18, 16, 16, 18, 19, 28, 24, 16, 15, 16, 20, 32, 18, 17, 15, 17, 15, 20, 19, 15, 15, 27, 15, 17, 24, 15, 14, 57, 15, 28, 30, 24, 14, 21, 29, 16, 80, 16, 27, 16, 25, 15, 16, 15, 15, 76, 21, 35, 21, 23, 16, 46, 17, 22, 18, 19, 17, 17, 14, 16, 16, 15, 18, 20, 17, 16, 17, 17, 16, 16, 16, 23, 19, 35, 16, 14, 14, 17, 15, 15, 17, 24, 16, 15, 14, 47, 28, 22, 15, 16, 20, 19, 15, 22, 31, 26, 20, 17, 26, 21, 16, 20, 17, 15, 17, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09515533712239348, "mean_inference_ms": 0.24363982503277273, "mean_action_processing_ms": 0.04392016189418325, "mean_env_wait_ms": 0.04697888535377909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015517391225017567, "StateBufferConnector_ms": 0.001251129876999628, "ViewRequirementAgentConnector_ms": 0.028860884368735015}}, "episode_reward_max": 0.9981399694657169, "episode_reward_min": -1.0, "episode_reward_mean": 0.6144772702215363, "episode_len_mean": 21.137566137566136, "episodes_this_iter": 189, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9088579684632293, 0.9981399694657169, 0.501322250709499, 0.63278848284473, 0.5, 0.6479718792816045, 0.5170513847114536, 0.5566990609337605, -1.0, 0.7008808848661656, 0.5028709337131193, 0.8472483391093427, 0.9698638352838338, 0.7977875968918615, 0.7867438105300857, 0.6177352803558223, 0.8146890179081604, 0.5, 0.7962780495474259, 0.843834640387874, 0.5, 0.5, 0.5, 0.5061414594065728, 0.7662012441110214, 0.7248816466537349, 0.787055818353553, 0.5, 0.8244477846560098, 0.5, 0.9033310360345995, 0.5, 0.8060407416200511, 0.8921012586616236, 0.5, 0.5, 0.9438006318163799, 0.8145070474383206, 0.5, 0.5, 0.5, 0.5, 0.9780540163608873, 0.5, 0.5, 0.7570096874982026, 0.5, 0.5, 0.8619078017907073, 0.8113492576877603, 0.5, 0.8528331925281711, 0.5, 0.5, 0.763583863729808, 0.5, 0.9584161461866071, 0.6650252351462946, 0.5, 0.5, 0.5, 0.7038816598558371, 0.5703563999043904, 0.9764167795801145, 0.5, 0.7564924940037497, 0.7338030568209717, 0.5767874368286827, 0.7008165589836232, 0.5, -1.0, 0.5048199465003071, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5995299127330438, 0.581184272778807, 0.9572033691687715, 0.5811502355581878, 0.8216772571959574, 0.6671542862117457, 0.5, 0.7740236940396774, 0.6615273535308785, 0.5, 0.5, 0.5728401708124562, 0.8922346468029165, 0.9750152177609643, 0.8727648645529109, 0.5605765985815543, 0.5, 0.6101488608308014, 0.8208593648953021, 0.5, 0.5, 0.5101776362318946, 0.6422646872405016, 0.7934258247810592, 0.5947879029540788, 0.5, 0.5, 0.7690652656309895, 0.7153674540177695, 0.5931773393442297, 0.7661402265715779, 0.8085900484550832, 0.5, 0.7435416676938595, 0.5, 0.5, 0.5, 0.8964301765064955, 0.555169664343087, 0.5, 0.9800281743531027, -1.0, 0.7485821132313536, 0.5, 0.9275940850965747, 0.5, 0.513741773902553, 0.9750284225770464, 0.9710211840179209, 0.7636477060936361, 0.5, 0.5372617681176117, -1.0, 0.5, 0.5, 0.5986950426667315, -1.0, 0.8750246056989923, 0.5, 0.9869277083968759, 0.5311746237794885, 0.9450692336771516, 0.828279288367523, 0.9732306243142926, 0.7033989599245398, 0.804386173257243, 0.7911706808799913, 0.5, 0.5483468633984115, 0.5, 0.8770459805251027, 0.6700761955812427, 0.5, 0.8421795977243597, 0.9553869699982483, 0.8532212249494405, 0.5667478783129247, 0.835384292984182, 0.5, 0.9036349354396498, 0.7533291364407022, -1.0, 0.6214663886431595, 0.8540395820476023, 0.9912541805515788, 0.6765097684366692, 0.5, 0.8766355939198992, 0.9622305153013037, 0.7093290583333427, 0.5, 0.6621954909940535, 0.5, 0.9582788194485425, 0.5, 0.5393925515133366, 0.5, 0.8847631603630984, 0.5, 0.5, 0.5, 0.5, 0.8845614892733831, 0.5, 0.6736724534590719, 0.7719450304019034, 0.5366162585926717, 0.9945313224419805, 0.5823637965529196, 0.6414341014571652, 0.9151784776370085, 0.7233372024085138], "episode_lengths": [16, 15, 17, 16, 39, 23, 25, 19, 35, 18, 18, 17, 17, 17, 17, 20, 15, 52, 16, 13, 20, 24, 23, 17, 14, 17, 19, 22, 17, 21, 16, 24, 14, 15, 20, 22, 16, 16, 36, 15, 29, 16, 18, 17, 17, 17, 56, 28, 15, 15, 17, 16, 56, 27, 16, 18, 18, 15, 22, 29, 17, 15, 17, 14, 47, 16, 15, 16, 19, 18, 21, 21, 37, 41, 22, 24, 32, 17, 20, 16, 16, 17, 18, 16, 16, 18, 19, 28, 24, 16, 15, 16, 20, 32, 18, 17, 15, 17, 15, 20, 19, 15, 15, 27, 15, 17, 24, 15, 14, 57, 15, 28, 30, 24, 14, 21, 29, 16, 80, 16, 27, 16, 25, 15, 16, 15, 15, 76, 21, 35, 21, 23, 16, 46, 17, 22, 18, 19, 17, 17, 14, 16, 16, 15, 18, 20, 17, 16, 17, 17, 16, 16, 16, 23, 19, 35, 16, 14, 14, 17, 15, 15, 17, 24, 16, 15, 14, 47, 28, 22, 15, 16, 20, 19, 15, 22, 31, 26, 20, 17, 26, 21, 16, 20, 17, 15, 17, 17, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09515533712239348, "mean_inference_ms": 0.24363982503277273, "mean_action_processing_ms": 0.04392016189418325, "mean_env_wait_ms": 0.04697888535377909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015517391225017567, "StateBufferConnector_ms": 0.001251129876999628, "ViewRequirementAgentConnector_ms": 0.028860884368735015}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1091.2622223112605, "num_env_steps_trained_throughput_per_sec": 1091.2622223112605, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 3685.956, "sample_time_ms": 1796.09, "load_time_ms": 0.238, "load_throughput": 16837832.196, "learn_time_ms": 1888.592, "learn_throughput": 2117.98, "synch_weights_time_ms": 0.676}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 7203, "training_iteration": 65, "trial_id": "default", "date": "2024-05-22_22-18-54", "timestamp": 1716409134, "time_this_iter_s": 3.6698968410491943, "time_total_s": 234.06632494926453, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 234.06632494926453, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 19.78, "ram_util_percent": 61.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.13051613530805, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.060884356072112435, "policy_loss": -0.0007736303803500949, "vf_loss": 0.06128759278455168, "vf_explained_var": 0.26373296315952016, "kl": 0.014815758085321295, "entropy": 1.0307173248260253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 0.9972979730695336, "episode_reward_min": -1.0, "episode_reward_mean": 0.6008364215114735, "episode_len_mean": 19.529411764705884, "episode_media": {}, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.8450114913432282, 0.8213180136086453, 0.7189366774932539, 0.9837963487054271, 0.9022300795835754, 0.5, 0.9962877726128093, 0.8266716703078603, 0.5, 0.7590988652499391, 0.6061149479569994, 0.9192126284556331, 0.6996988265029471, 0.7718516260685097, 0.8657619637897231, 0.5, 0.9204664456974104, 0.5, 0.5678577465603581, 0.5, 0.54511857467024, 0.9926702564293465, 0.5, 0.6937022505278052, 0.5, 0.6122202363355405, 0.8298195869896666, 0.5, 0.9898359696849546, 0.9220570993064126, 0.9394751668855658, 0.7915277533957741, 0.5814832939412887, 0.5692236587028108, 0.7212514752503025, 0.8083065326417155, 0.8237313595240496, 0.5, 0.6426830361571222, 0.9503881215223614, 0.8929486199425284, 0.8406988196076772, 0.5, 0.6419581528204219, 0.6831551579727706, 0.8778727983880275, 0.5, 0.5, 0.6722591990882032, 0.9090224646665918, 0.6904059264945301, 0.8349922578370724, 0.5, 0.8962588458050128, 0.5035747701962944, 0.7417765637300183, -1.0, 0.5710625479827269, 0.5725228477726447, 0.7666133989836244, 0.8920931765684015, 0.5, 0.5, 0.8604159971715871, 0.5, 0.5, 0.5, 0.8321016736686873, 0.6356654909335415, 0.5, 0.5, 0.5029723972652914, 0.821873155702967, 0.8541517904713694, 0.7135610003097905, 0.8267366041036621, 0.5, 0.7659688850670113, 0.5, 0.7655704095343203, 0.8933278386223648, 0.8823644696335103, 0.8632235607716487, 0.8374225315198911, 0.5806462611126838, 0.5, 0.9006304212107148, 0.5, 0.8788521356515921, 0.6722006654286743, 0.5, 0.5, 0.9357228189509809, 0.5, 0.5152770276319982, 0.5, 0.627063035767593, 0.5, 0.9948167679750554, 0.5, 0.5, 0.5, 0.7996811403231286, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5548730637344517, 0.5, 0.5, 0.7070491896966944, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6638103185686751, -1.0, 0.5, 0.6586074183663252, 0.8309230341546574, 0.8187658238834512, 0.5, 0.5, 0.5, 0.7294846210140622, 0.7810210290388284, 0.7406874379438338, 0.5, 0.7409604197247721, 0.7192926835889211, 0.5, 0.5772515887039491, 0.6410018391864507, 0.5, 0.5, 0.5082057249459164, 0.5156819613709005, 0.5, 0.7222225945891145, 0.8966149884678293, 0.9039379962235858, 0.5939365567042949, 0.6613334426591029, 0.5, 0.5, -1.0, 0.9698427802810905, 0.5571171857275135, 0.7132467591059106, -1.0, 0.9302328327464995, 0.8454180218899938, 0.9479540047756995, 0.8140997499335363, 0.8982395334813065, 0.9888054824998723, 0.8867232102993119, 0.9972979730695336, 0.9527929658213959, 0.559890050539161, 0.7008685340964328, 0.7081769785331113, 0.7179875373401673, 0.6977387829829319, 0.8352539453519866, 0.7197492960000265, 0.543465797840113, 0.5, 0.5, 0.5, -1.0, 0.7640960846902417, 0.888865076479993, 0.5, -1.0, 0.844498953098792, 0.5, 0.7591187692654235, 0.5405464714650361, 0.9935170847238457, 0.7206163437996612, 0.7756746138726647, 0.6965937788227721, 0.9879510719411474, -1.0, 0.9193728257770861, 0.7550070856289894, -1.0, 0.8086634243448372, 0.5, 0.5, 0.5, 0.543453418184461, 0.5212885440262676, 0.9238322258402547, 0.926118628714696, -1.0, 0.9910044604028976, 0.7926586467415865, 0.9019182230526542, 0.5], "episode_lengths": [42, 17, 16, 16, 17, 17, 21, 15, 18, 20, 19, 19, 16, 16, 19, 17, 19, 15, 19, 28, 27, 18, 15, 30, 16, 23, 20, 17, 19, 14, 17, 16, 19, 16, 23, 15, 15, 18, 33, 15, 15, 17, 15, 29, 15, 15, 17, 18, 29, 23, 16, 19, 17, 29, 14, 22, 19, 18, 16, 18, 18, 16, 39, 23, 15, 30, 18, 16, 15, 18, 27, 19, 22, 15, 19, 20, 17, 21, 18, 20, 18, 17, 14, 15, 16, 20, 28, 15, 23, 15, 15, 20, 23, 22, 21, 21, 22, 20, 25, 17, 20, 20, 31, 14, 18, 22, 31, 26, 23, 21, 22, 21, 16, 26, 34, 30, 25, 29, 17, 14, 17, 17, 19, 16, 18, 16, 17, 19, 18, 19, 34, 18, 17, 17, 16, 21, 22, 21, 18, 19, 18, 18, 17, 16, 18, 17, 38, 18, 14, 15, 19, 19, 17, 16, 15, 16, 14, 20, 14, 16, 14, 17, 23, 16, 16, 22, 17, 17, 15, 18, 24, 32, 22, 20, 19, 15, 38, 14, 16, 17, 20, 17, 15, 16, 19, 20, 15, 28, 15, 17, 27, 16, 18, 28, 21, 20, 19, 17, 16, 21, 16, 17, 15, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09527825981741035, "mean_inference_ms": 0.24366866185769617, "mean_action_processing_ms": 0.04392774967864047, "mean_env_wait_ms": 0.046998100638099234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015625766679352405, "StateBufferConnector_ms": 0.0012269207075530407, "ViewRequirementAgentConnector_ms": 0.028741125966988357}}, "episode_reward_max": 0.9972979730695336, "episode_reward_min": -1.0, "episode_reward_mean": 0.6008364215114735, "episode_len_mean": 19.529411764705884, "episodes_this_iter": 204, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.8450114913432282, 0.8213180136086453, 0.7189366774932539, 0.9837963487054271, 0.9022300795835754, 0.5, 0.9962877726128093, 0.8266716703078603, 0.5, 0.7590988652499391, 0.6061149479569994, 0.9192126284556331, 0.6996988265029471, 0.7718516260685097, 0.8657619637897231, 0.5, 0.9204664456974104, 0.5, 0.5678577465603581, 0.5, 0.54511857467024, 0.9926702564293465, 0.5, 0.6937022505278052, 0.5, 0.6122202363355405, 0.8298195869896666, 0.5, 0.9898359696849546, 0.9220570993064126, 0.9394751668855658, 0.7915277533957741, 0.5814832939412887, 0.5692236587028108, 0.7212514752503025, 0.8083065326417155, 0.8237313595240496, 0.5, 0.6426830361571222, 0.9503881215223614, 0.8929486199425284, 0.8406988196076772, 0.5, 0.6419581528204219, 0.6831551579727706, 0.8778727983880275, 0.5, 0.5, 0.6722591990882032, 0.9090224646665918, 0.6904059264945301, 0.8349922578370724, 0.5, 0.8962588458050128, 0.5035747701962944, 0.7417765637300183, -1.0, 0.5710625479827269, 0.5725228477726447, 0.7666133989836244, 0.8920931765684015, 0.5, 0.5, 0.8604159971715871, 0.5, 0.5, 0.5, 0.8321016736686873, 0.6356654909335415, 0.5, 0.5, 0.5029723972652914, 0.821873155702967, 0.8541517904713694, 0.7135610003097905, 0.8267366041036621, 0.5, 0.7659688850670113, 0.5, 0.7655704095343203, 0.8933278386223648, 0.8823644696335103, 0.8632235607716487, 0.8374225315198911, 0.5806462611126838, 0.5, 0.9006304212107148, 0.5, 0.8788521356515921, 0.6722006654286743, 0.5, 0.5, 0.9357228189509809, 0.5, 0.5152770276319982, 0.5, 0.627063035767593, 0.5, 0.9948167679750554, 0.5, 0.5, 0.5, 0.7996811403231286, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5548730637344517, 0.5, 0.5, 0.7070491896966944, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6638103185686751, -1.0, 0.5, 0.6586074183663252, 0.8309230341546574, 0.8187658238834512, 0.5, 0.5, 0.5, 0.7294846210140622, 0.7810210290388284, 0.7406874379438338, 0.5, 0.7409604197247721, 0.7192926835889211, 0.5, 0.5772515887039491, 0.6410018391864507, 0.5, 0.5, 0.5082057249459164, 0.5156819613709005, 0.5, 0.7222225945891145, 0.8966149884678293, 0.9039379962235858, 0.5939365567042949, 0.6613334426591029, 0.5, 0.5, -1.0, 0.9698427802810905, 0.5571171857275135, 0.7132467591059106, -1.0, 0.9302328327464995, 0.8454180218899938, 0.9479540047756995, 0.8140997499335363, 0.8982395334813065, 0.9888054824998723, 0.8867232102993119, 0.9972979730695336, 0.9527929658213959, 0.559890050539161, 0.7008685340964328, 0.7081769785331113, 0.7179875373401673, 0.6977387829829319, 0.8352539453519866, 0.7197492960000265, 0.543465797840113, 0.5, 0.5, 0.5, -1.0, 0.7640960846902417, 0.888865076479993, 0.5, -1.0, 0.844498953098792, 0.5, 0.7591187692654235, 0.5405464714650361, 0.9935170847238457, 0.7206163437996612, 0.7756746138726647, 0.6965937788227721, 0.9879510719411474, -1.0, 0.9193728257770861, 0.7550070856289894, -1.0, 0.8086634243448372, 0.5, 0.5, 0.5, 0.543453418184461, 0.5212885440262676, 0.9238322258402547, 0.926118628714696, -1.0, 0.9910044604028976, 0.7926586467415865, 0.9019182230526542, 0.5], "episode_lengths": [42, 17, 16, 16, 17, 17, 21, 15, 18, 20, 19, 19, 16, 16, 19, 17, 19, 15, 19, 28, 27, 18, 15, 30, 16, 23, 20, 17, 19, 14, 17, 16, 19, 16, 23, 15, 15, 18, 33, 15, 15, 17, 15, 29, 15, 15, 17, 18, 29, 23, 16, 19, 17, 29, 14, 22, 19, 18, 16, 18, 18, 16, 39, 23, 15, 30, 18, 16, 15, 18, 27, 19, 22, 15, 19, 20, 17, 21, 18, 20, 18, 17, 14, 15, 16, 20, 28, 15, 23, 15, 15, 20, 23, 22, 21, 21, 22, 20, 25, 17, 20, 20, 31, 14, 18, 22, 31, 26, 23, 21, 22, 21, 16, 26, 34, 30, 25, 29, 17, 14, 17, 17, 19, 16, 18, 16, 17, 19, 18, 19, 34, 18, 17, 17, 16, 21, 22, 21, 18, 19, 18, 18, 17, 16, 18, 17, 38, 18, 14, 15, 19, 19, 17, 16, 15, 16, 14, 20, 14, 16, 14, 17, 23, 16, 16, 22, 17, 17, 15, 18, 24, 32, 22, 20, 19, 15, 38, 14, 16, 17, 20, 17, 15, 16, 19, 20, 15, 28, 15, 17, 27, 16, 18, 28, 21, 20, 19, 17, 16, 21, 16, 17, 15, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09527825981741035, "mean_inference_ms": 0.24366866185769617, "mean_action_processing_ms": 0.04392774967864047, "mean_env_wait_ms": 0.046998100638099234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015625766679352405, "StateBufferConnector_ms": 0.0012269207075530407, "ViewRequirementAgentConnector_ms": 0.028741125966988357}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1092.5356039790784, "num_env_steps_trained_throughput_per_sec": 1092.5356039790784, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 3681.585, "sample_time_ms": 1791.264, "load_time_ms": 0.237, "load_throughput": 16864913.55, "learn_time_ms": 1889.044, "learn_throughput": 2117.473, "synch_weights_time_ms": 0.682}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 7407, "training_iteration": 66, "trial_id": "default", "date": "2024-05-22_22-18-58", "timestamp": 1716409138, "time_this_iter_s": 3.664896011352539, "time_total_s": 237.73122096061707, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.73122096061707, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 19.119999999999997, "ram_util_percent": 61.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9286653957700217, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08715038094384801, "policy_loss": -0.00643512024794535, "vf_loss": 0.09319549226652711, "vf_explained_var": 0.29064143870466497, "kl": 0.015600387526992493, "entropy": 0.9821433737072893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 0.9966105508464772, "episode_reward_min": -1.0, "episode_reward_mean": 0.5951122581480129, "episode_len_mean": 20.43877551020408, "episode_media": {}, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.6688467540017861, 0.8635333519518813, 0.7879575149055096, 0.6387973230200422, 0.5, 0.9459153043629446, 0.9220659949741388, 0.8663057661453384, 0.929281877406216, 0.5, 0.5344947525695791, 0.5, 0.5209370982612102, 0.6491887985400235, 0.7911941201803953, 0.5, 0.5, 0.7296122893866894, 0.9436037914885219, 0.5, 0.664813988450905, 0.6706328133885306, 0.994077245272371, 0.5, 0.9129673329537566, 0.565469068266951, 0.5, 0.8628514763857523, 0.9575329879204356, 0.6140662932992429, 0.6506515794178354, 0.7319782003306369, 0.9560935556657187, 0.9702255594188854, 0.5, 0.5095360859056461, 0.5, 0.5, -1.0, 0.5982490263789342, 0.8144219194644705, 0.5, 0.8448713883107417, 0.8222415785199241, 0.7702998288740058, 0.5, 0.5, 0.5, 0.6095727069785284, 0.5, 0.8707967735466928, 0.9659928962997447, 0.9779421007801453, 0.624779148182952, 0.9897924814784171, 0.808216305831985, 0.5, 0.7209434501933636, 0.9667047171564656, 0.5, 0.5196524055172473, 0.6131170574010689, 0.800011736147739, 0.5, 0.8271939274840281, 0.5753728490749084, 0.8246014328581128, 0.7334134466439033, 0.5629573571072117, 0.6118750810109395, 0.9077468374282512, 0.9966105508464772, 0.5, 0.7056418655265582, -1.0, 0.7559148171797196, 0.7065278798861663, 0.5250231401624899, 0.5, 0.8659985008742147, 0.8256237400641853, 0.7444176875022428, 0.734039652813569, 0.9220657533963605, -1.0, 0.8108609650184105, 0.9617077164968939, 0.8570308900815256, 0.7319653221068536, 0.704003629876749, 0.5, -1.0, 0.779839131750863, 0.9912227244072347, 0.8058450240104675, -1.0, 0.9562456431415358, 0.5, -1.0, 0.7988628052600434, 0.9728562119533803, 0.5, 0.7636659682389502, 0.5, 0.7451708804254351, 0.6244269950292352, 0.8671801169064881, 0.5, 0.7028487835505035, 0.789526607427808, 0.9876084312897099, 0.9804355030065383, 0.9145123692683281, 0.5, 0.9171510661652533, 0.6843321044743715, 0.5, 0.7133193865313767, 0.9079649487844461, 0.8926721303943624, 0.6567740736126909, 0.5, -1.0, 0.74356883209742, 0.9705892906277077, 0.9032827802480651, 0.5, 0.907659248068945, 0.6711505346963053, 0.5, -1.0, 0.8102295682261673, 0.5704353123121917, 0.9785377559173525, 0.5710023380900456, 0.6696589854737532, 0.5, 0.9057788526275159, -1.0, 0.5, 0.9918812253729786, 0.9008854150700805, 0.5, 0.6051498908122509, 0.5928798714536226, 0.5407373780476114, 0.9351017128279788, 0.5314774679457592, 0.6925051820230904, 0.5, 0.5, 0.7755957165442557, 0.6236673072295573, 0.5164223666185364, -1.0, 0.9265863537552839, 0.7356012162219621, -1.0, 0.5, 0.5, 0.8065036023568033, 0.9298812824966131, 0.5739215666251766, 0.5853615219279587, 0.646589204657378, 0.9867943135077818, 0.6022682466193361, 0.7067611361808559, 0.5, 0.5, 0.9358263971114684, 0.522907110272586, 0.5, 0.61712640495128, 0.8641829031298708, 0.5354861948185128, 0.8608841396098217, 0.9492280153142314, 0.5, 0.5, 0.5, 0.587489981491103, 0.5951174773252081, 0.7773520008648487, 0.6550695132393407, 0.5, 0.6450707841621086, 0.5, 0.5, 0.7387479707866483, 0.7175336150990641, 0.8004890249643928, 0.8903446651335518, 0.5273905280539957], "episode_lengths": [47, 23, 18, 15, 18, 16, 28, 15, 17, 14, 17, 17, 18, 33, 21, 16, 15, 22, 66, 17, 15, 22, 18, 17, 13, 30, 19, 17, 20, 15, 19, 19, 17, 14, 17, 15, 17, 31, 22, 20, 22, 20, 19, 16, 17, 15, 15, 25, 22, 18, 26, 19, 15, 14, 16, 16, 16, 16, 19, 16, 15, 16, 23, 23, 14, 23, 17, 16, 16, 16, 15, 22, 15, 17, 59, 21, 20, 19, 19, 22, 45, 17, 14, 15, 17, 18, 17, 16, 16, 17, 18, 18, 38, 44, 15, 16, 15, 20, 15, 63, 80, 16, 16, 23, 18, 19, 19, 20, 15, 21, 20, 15, 15, 15, 18, 21, 17, 25, 16, 20, 16, 17, 22, 21, 20, 16, 17, 16, 17, 14, 15, 19, 59, 19, 19, 14, 17, 17, 18, 23, 38, 30, 15, 14, 21, 23, 17, 17, 15, 20, 19, 28, 41, 16, 20, 24, 29, 14, 16, 12, 17, 19, 17, 16, 16, 20, 17, 15, 23, 17, 19, 22, 17, 20, 24, 18, 16, 15, 15, 15, 21, 47, 24, 18, 21, 17, 20, 22, 23, 19, 24, 21, 18, 15, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0953810000980877, "mean_inference_ms": 0.2436709457101908, "mean_action_processing_ms": 0.04392929552845105, "mean_env_wait_ms": 0.04701015560050182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015339072869748486, "StateBufferConnector_ms": 0.0012351542103047274, "ViewRequirementAgentConnector_ms": 0.028641004951632753}}, "episode_reward_max": 0.9966105508464772, "episode_reward_min": -1.0, "episode_reward_mean": 0.5951122581480129, "episode_len_mean": 20.43877551020408, "episodes_this_iter": 196, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.6688467540017861, 0.8635333519518813, 0.7879575149055096, 0.6387973230200422, 0.5, 0.9459153043629446, 0.9220659949741388, 0.8663057661453384, 0.929281877406216, 0.5, 0.5344947525695791, 0.5, 0.5209370982612102, 0.6491887985400235, 0.7911941201803953, 0.5, 0.5, 0.7296122893866894, 0.9436037914885219, 0.5, 0.664813988450905, 0.6706328133885306, 0.994077245272371, 0.5, 0.9129673329537566, 0.565469068266951, 0.5, 0.8628514763857523, 0.9575329879204356, 0.6140662932992429, 0.6506515794178354, 0.7319782003306369, 0.9560935556657187, 0.9702255594188854, 0.5, 0.5095360859056461, 0.5, 0.5, -1.0, 0.5982490263789342, 0.8144219194644705, 0.5, 0.8448713883107417, 0.8222415785199241, 0.7702998288740058, 0.5, 0.5, 0.5, 0.6095727069785284, 0.5, 0.8707967735466928, 0.9659928962997447, 0.9779421007801453, 0.624779148182952, 0.9897924814784171, 0.808216305831985, 0.5, 0.7209434501933636, 0.9667047171564656, 0.5, 0.5196524055172473, 0.6131170574010689, 0.800011736147739, 0.5, 0.8271939274840281, 0.5753728490749084, 0.8246014328581128, 0.7334134466439033, 0.5629573571072117, 0.6118750810109395, 0.9077468374282512, 0.9966105508464772, 0.5, 0.7056418655265582, -1.0, 0.7559148171797196, 0.7065278798861663, 0.5250231401624899, 0.5, 0.8659985008742147, 0.8256237400641853, 0.7444176875022428, 0.734039652813569, 0.9220657533963605, -1.0, 0.8108609650184105, 0.9617077164968939, 0.8570308900815256, 0.7319653221068536, 0.704003629876749, 0.5, -1.0, 0.779839131750863, 0.9912227244072347, 0.8058450240104675, -1.0, 0.9562456431415358, 0.5, -1.0, 0.7988628052600434, 0.9728562119533803, 0.5, 0.7636659682389502, 0.5, 0.7451708804254351, 0.6244269950292352, 0.8671801169064881, 0.5, 0.7028487835505035, 0.789526607427808, 0.9876084312897099, 0.9804355030065383, 0.9145123692683281, 0.5, 0.9171510661652533, 0.6843321044743715, 0.5, 0.7133193865313767, 0.9079649487844461, 0.8926721303943624, 0.6567740736126909, 0.5, -1.0, 0.74356883209742, 0.9705892906277077, 0.9032827802480651, 0.5, 0.907659248068945, 0.6711505346963053, 0.5, -1.0, 0.8102295682261673, 0.5704353123121917, 0.9785377559173525, 0.5710023380900456, 0.6696589854737532, 0.5, 0.9057788526275159, -1.0, 0.5, 0.9918812253729786, 0.9008854150700805, 0.5, 0.6051498908122509, 0.5928798714536226, 0.5407373780476114, 0.9351017128279788, 0.5314774679457592, 0.6925051820230904, 0.5, 0.5, 0.7755957165442557, 0.6236673072295573, 0.5164223666185364, -1.0, 0.9265863537552839, 0.7356012162219621, -1.0, 0.5, 0.5, 0.8065036023568033, 0.9298812824966131, 0.5739215666251766, 0.5853615219279587, 0.646589204657378, 0.9867943135077818, 0.6022682466193361, 0.7067611361808559, 0.5, 0.5, 0.9358263971114684, 0.522907110272586, 0.5, 0.61712640495128, 0.8641829031298708, 0.5354861948185128, 0.8608841396098217, 0.9492280153142314, 0.5, 0.5, 0.5, 0.587489981491103, 0.5951174773252081, 0.7773520008648487, 0.6550695132393407, 0.5, 0.6450707841621086, 0.5, 0.5, 0.7387479707866483, 0.7175336150990641, 0.8004890249643928, 0.8903446651335518, 0.5273905280539957], "episode_lengths": [47, 23, 18, 15, 18, 16, 28, 15, 17, 14, 17, 17, 18, 33, 21, 16, 15, 22, 66, 17, 15, 22, 18, 17, 13, 30, 19, 17, 20, 15, 19, 19, 17, 14, 17, 15, 17, 31, 22, 20, 22, 20, 19, 16, 17, 15, 15, 25, 22, 18, 26, 19, 15, 14, 16, 16, 16, 16, 19, 16, 15, 16, 23, 23, 14, 23, 17, 16, 16, 16, 15, 22, 15, 17, 59, 21, 20, 19, 19, 22, 45, 17, 14, 15, 17, 18, 17, 16, 16, 17, 18, 18, 38, 44, 15, 16, 15, 20, 15, 63, 80, 16, 16, 23, 18, 19, 19, 20, 15, 21, 20, 15, 15, 15, 18, 21, 17, 25, 16, 20, 16, 17, 22, 21, 20, 16, 17, 16, 17, 14, 15, 19, 59, 19, 19, 14, 17, 17, 18, 23, 38, 30, 15, 14, 21, 23, 17, 17, 15, 20, 19, 28, 41, 16, 20, 24, 29, 14, 16, 12, 17, 19, 17, 16, 16, 20, 17, 15, 23, 17, 19, 22, 17, 20, 24, 18, 16, 15, 15, 15, 21, 47, 24, 18, 21, 17, 20, 22, 23, 19, 24, 21, 18, 15, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0953810000980877, "mean_inference_ms": 0.2436709457101908, "mean_action_processing_ms": 0.04392929552845105, "mean_env_wait_ms": 0.04701015560050182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015339072869748486, "StateBufferConnector_ms": 0.0012351542103047274, "ViewRequirementAgentConnector_ms": 0.028641004951632753}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1096.2123889549578, "num_env_steps_trained_throughput_per_sec": 1096.2123889549578, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 3674.92, "sample_time_ms": 1789.732, "load_time_ms": 0.241, "load_throughput": 16627567.889, "learn_time_ms": 1883.928, "learn_throughput": 2123.223, "synch_weights_time_ms": 0.666}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 7603, "training_iteration": 67, "trial_id": "default", "date": "2024-05-22_22-19-01", "timestamp": 1716409141, "time_this_iter_s": 3.652489185333252, "time_total_s": 241.38371014595032, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 241.38371014595032, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 14.780000000000001, "ram_util_percent": 60.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.556703776377504, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03161961760225465, "policy_loss": 0.0061029866377833066, "vf_loss": 0.025277169880592414, "vf_explained_var": 0.5797968365812814, "kl": 0.009578489409880065, "entropy": 0.9511705602369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 0.9988362581540116, "episode_reward_min": -1.0, "episode_reward_mean": 0.7028222789027302, "episode_len_mean": 18.85308056872038, "episode_media": {}, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.7545238413177393, 0.9318981026245949, 0.9188267067527345, 0.8907223387541868, 0.8563038817158184, 0.7788333919826482, 0.5927814598195915, 0.9379470679530673, 0.5311221048735992, 0.7927273951302797, 0.9785556575574733, 0.5826779127705592, 0.7396049760340813, 0.5434696912209063, 0.9574808990097861, 0.5, 0.9297114792653229, 0.5, 0.5, 0.8145944554753596, 0.5, 0.8599273370462874, 0.8593862926183247, 0.5, 0.5, 0.926638689909689, 0.9947093128117964, 0.7073360610232438, 0.9736418894818815, 0.9988362581540116, 0.894168579705827, 0.6624260195178702, 0.909154301615453, 0.5, 0.7537757441507161, 0.5765189553003268, 0.5, 0.8627908834445358, 0.5, 0.5, 0.7886497964227418, 0.9450216142218789, 0.6055340372250728, 0.5, 0.6240857560049669, 0.7854597199630795, 0.5, 0.6498538274754825, 0.981710636011881, 0.6420941725153599, 0.9352525003608877, 0.5040773667604701, 0.9470241191851798, 0.5, 0.8440768029782348, 0.920836443448293, 0.5204430180434151, 0.5611184031289835, 0.7730616639882792, 0.6184886108676473, 0.5, 0.5, 0.877056019698637, 0.9585904435230983, 0.5, 0.7337271211611316, 0.996850834921441, 0.5466169778599436, 0.8423372422572283, 0.951754708560032, 0.7728868478188016, 0.5, 0.9726122663311291, 0.5, 0.9143181974057646, 0.7722621762072068, 0.8215296011648379, 0.5494116585052184, 0.9728772910860243, 0.8715147220432842, 0.8210308393338109, 0.7291183148495466, 0.5, 0.7839926934737196, 0.8788869267263639, 0.6183847375177034, 0.8257237001386439, 0.8614078547235318, 0.8577285652876799, 0.5, 0.8393276111108051, 0.8579990637518613, 0.5, 0.5381614041016893, 0.9344759294456668, 0.9592096404992929, 0.5, -1.0, 0.9218824947274804, 0.9569181559871983, 0.7969041801875749, 0.6819559854438613, 0.7863275328883301, 0.6265746416029216, 0.788409922919516, 0.5893841516969256, 0.9270942043065457, 0.9502355841406408, 0.8051057123363615, 0.7617746859591717, 0.8389614650737237, 0.5, 0.6953436067615821, 0.5, 0.5518151494172316, 0.5071813484434167, 0.9683259823614266, 0.5, 0.5, 0.5, 0.9641822225586498, 0.5, 0.5085343612198181, 0.8735647185383082, 0.5439463367360614, 0.9949318930215483, 0.8180315586144504, 0.7942795249067457, 0.5, 0.8849883203712398, 0.9561154544978246, 0.5, 0.9983479681755437, 0.5891593288000487, 0.5, 0.8095660243951226, 0.5, 0.734960830506368, 0.7396164375724431, 0.8418196100312656, 0.8266474313876273, 0.678513463688734, 0.9303404419371872, 0.9049318852789112, 0.7927742200901751, 0.6526551091436321, 0.7553509687997282, 0.9808417027017051, 0.8446057616277325, 0.5, 0.7126604704079553, 0.9319135695889514, 0.58655355897463, 0.5884048684001078, 0.5, 0.986273366820463, -1.0, 0.5263014841087663, 0.5279778256825263, 0.5981195525198393, 0.5, 0.5326627163240487, -1.0, 0.823806499427667, 0.6796249157960312, 0.9099411449217167, 0.7220048035936678, 0.9885169483679738, 0.7972244029646226, 0.5, 0.5, 0.9886031799608058, 0.5, 0.5, 0.7932038648655869, 0.525782142604208, 0.9775980358676087, 0.7913017284180541, 0.6879096575684027, 0.5744648364350822, 0.5, 0.8183354172126691, 0.7861378079312891, 0.8207267600298616, 0.7549638262575574, 0.8365643522834236, 0.7469440033379845, 0.5705135501386396, 0.8029631204229488, 0.8702076368444117, 0.9390983101579857, 0.6304918452361488, 0.9686183853731072, 0.7536956937677806, 0.5, 0.6355214588038455, 0.7302239253438112, 0.5708671380877037, 0.5, 0.8599366912361178, 0.5, 0.6275240199167265, 0.921778650044218, 0.7736093949052294, 0.9300753307303906, 0.7014809453114677, 0.9816023350265847, 0.7563538828033461, 0.9658428496556926], "episode_lengths": [30, 19, 17, 16, 14, 14, 14, 16, 16, 17, 39, 21, 15, 18, 16, 20, 18, 25, 14, 20, 26, 15, 21, 14, 18, 26, 23, 16, 15, 17, 15, 15, 17, 18, 14, 22, 18, 17, 32, 16, 25, 21, 16, 16, 19, 39, 19, 16, 34, 19, 14, 17, 16, 24, 15, 24, 15, 15, 14, 24, 17, 20, 21, 24, 17, 15, 18, 16, 15, 20, 17, 17, 18, 20, 16, 19, 17, 15, 17, 19, 15, 16, 17, 15, 26, 22, 20, 17, 15, 15, 15, 22, 16, 14, 25, 20, 17, 16, 32, 18, 13, 17, 19, 15, 15, 15, 16, 20, 14, 15, 15, 24, 17, 20, 16, 18, 19, 22, 15, 18, 19, 20, 16, 31, 28, 15, 18, 16, 17, 16, 38, 16, 16, 21, 15, 18, 28, 15, 22, 18, 16, 14, 16, 19, 16, 15, 17, 21, 14, 14, 18, 18, 17, 16, 15, 28, 61, 14, 32, 16, 15, 17, 17, 24, 15, 16, 18, 15, 16, 18, 16, 35, 22, 15, 16, 25, 16, 22, 14, 16, 21, 19, 29, 16, 16, 16, 17, 17, 18, 20, 15, 15, 16, 19, 14, 20, 23, 20, 20, 20, 30, 15, 25, 17, 17, 18, 19, 22, 15, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09550310796756277, "mean_inference_ms": 0.24369531332374722, "mean_action_processing_ms": 0.04393466055803219, "mean_env_wait_ms": 0.04702880781089845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001556161455633516, "StateBufferConnector_ms": 0.0012368387520595749, "ViewRequirementAgentConnector_ms": 0.028744693051017293}}, "episode_reward_max": 0.9988362581540116, "episode_reward_min": -1.0, "episode_reward_mean": 0.7028222789027302, "episode_len_mean": 18.85308056872038, "episodes_this_iter": 211, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.7545238413177393, 0.9318981026245949, 0.9188267067527345, 0.8907223387541868, 0.8563038817158184, 0.7788333919826482, 0.5927814598195915, 0.9379470679530673, 0.5311221048735992, 0.7927273951302797, 0.9785556575574733, 0.5826779127705592, 0.7396049760340813, 0.5434696912209063, 0.9574808990097861, 0.5, 0.9297114792653229, 0.5, 0.5, 0.8145944554753596, 0.5, 0.8599273370462874, 0.8593862926183247, 0.5, 0.5, 0.926638689909689, 0.9947093128117964, 0.7073360610232438, 0.9736418894818815, 0.9988362581540116, 0.894168579705827, 0.6624260195178702, 0.909154301615453, 0.5, 0.7537757441507161, 0.5765189553003268, 0.5, 0.8627908834445358, 0.5, 0.5, 0.7886497964227418, 0.9450216142218789, 0.6055340372250728, 0.5, 0.6240857560049669, 0.7854597199630795, 0.5, 0.6498538274754825, 0.981710636011881, 0.6420941725153599, 0.9352525003608877, 0.5040773667604701, 0.9470241191851798, 0.5, 0.8440768029782348, 0.920836443448293, 0.5204430180434151, 0.5611184031289835, 0.7730616639882792, 0.6184886108676473, 0.5, 0.5, 0.877056019698637, 0.9585904435230983, 0.5, 0.7337271211611316, 0.996850834921441, 0.5466169778599436, 0.8423372422572283, 0.951754708560032, 0.7728868478188016, 0.5, 0.9726122663311291, 0.5, 0.9143181974057646, 0.7722621762072068, 0.8215296011648379, 0.5494116585052184, 0.9728772910860243, 0.8715147220432842, 0.8210308393338109, 0.7291183148495466, 0.5, 0.7839926934737196, 0.8788869267263639, 0.6183847375177034, 0.8257237001386439, 0.8614078547235318, 0.8577285652876799, 0.5, 0.8393276111108051, 0.8579990637518613, 0.5, 0.5381614041016893, 0.9344759294456668, 0.9592096404992929, 0.5, -1.0, 0.9218824947274804, 0.9569181559871983, 0.7969041801875749, 0.6819559854438613, 0.7863275328883301, 0.6265746416029216, 0.788409922919516, 0.5893841516969256, 0.9270942043065457, 0.9502355841406408, 0.8051057123363615, 0.7617746859591717, 0.8389614650737237, 0.5, 0.6953436067615821, 0.5, 0.5518151494172316, 0.5071813484434167, 0.9683259823614266, 0.5, 0.5, 0.5, 0.9641822225586498, 0.5, 0.5085343612198181, 0.8735647185383082, 0.5439463367360614, 0.9949318930215483, 0.8180315586144504, 0.7942795249067457, 0.5, 0.8849883203712398, 0.9561154544978246, 0.5, 0.9983479681755437, 0.5891593288000487, 0.5, 0.8095660243951226, 0.5, 0.734960830506368, 0.7396164375724431, 0.8418196100312656, 0.8266474313876273, 0.678513463688734, 0.9303404419371872, 0.9049318852789112, 0.7927742200901751, 0.6526551091436321, 0.7553509687997282, 0.9808417027017051, 0.8446057616277325, 0.5, 0.7126604704079553, 0.9319135695889514, 0.58655355897463, 0.5884048684001078, 0.5, 0.986273366820463, -1.0, 0.5263014841087663, 0.5279778256825263, 0.5981195525198393, 0.5, 0.5326627163240487, -1.0, 0.823806499427667, 0.6796249157960312, 0.9099411449217167, 0.7220048035936678, 0.9885169483679738, 0.7972244029646226, 0.5, 0.5, 0.9886031799608058, 0.5, 0.5, 0.7932038648655869, 0.525782142604208, 0.9775980358676087, 0.7913017284180541, 0.6879096575684027, 0.5744648364350822, 0.5, 0.8183354172126691, 0.7861378079312891, 0.8207267600298616, 0.7549638262575574, 0.8365643522834236, 0.7469440033379845, 0.5705135501386396, 0.8029631204229488, 0.8702076368444117, 0.9390983101579857, 0.6304918452361488, 0.9686183853731072, 0.7536956937677806, 0.5, 0.6355214588038455, 0.7302239253438112, 0.5708671380877037, 0.5, 0.8599366912361178, 0.5, 0.6275240199167265, 0.921778650044218, 0.7736093949052294, 0.9300753307303906, 0.7014809453114677, 0.9816023350265847, 0.7563538828033461, 0.9658428496556926], "episode_lengths": [30, 19, 17, 16, 14, 14, 14, 16, 16, 17, 39, 21, 15, 18, 16, 20, 18, 25, 14, 20, 26, 15, 21, 14, 18, 26, 23, 16, 15, 17, 15, 15, 17, 18, 14, 22, 18, 17, 32, 16, 25, 21, 16, 16, 19, 39, 19, 16, 34, 19, 14, 17, 16, 24, 15, 24, 15, 15, 14, 24, 17, 20, 21, 24, 17, 15, 18, 16, 15, 20, 17, 17, 18, 20, 16, 19, 17, 15, 17, 19, 15, 16, 17, 15, 26, 22, 20, 17, 15, 15, 15, 22, 16, 14, 25, 20, 17, 16, 32, 18, 13, 17, 19, 15, 15, 15, 16, 20, 14, 15, 15, 24, 17, 20, 16, 18, 19, 22, 15, 18, 19, 20, 16, 31, 28, 15, 18, 16, 17, 16, 38, 16, 16, 21, 15, 18, 28, 15, 22, 18, 16, 14, 16, 19, 16, 15, 17, 21, 14, 14, 18, 18, 17, 16, 15, 28, 61, 14, 32, 16, 15, 17, 17, 24, 15, 16, 18, 15, 16, 18, 16, 35, 22, 15, 16, 25, 16, 22, 14, 16, 21, 19, 29, 16, 16, 16, 17, 17, 18, 20, 15, 15, 16, 19, 14, 20, 23, 20, 20, 20, 30, 15, 25, 17, 17, 18, 19, 22, 15, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09550310796756277, "mean_inference_ms": 0.24369531332374722, "mean_action_processing_ms": 0.04393466055803219, "mean_env_wait_ms": 0.04702880781089845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001556161455633516, "StateBufferConnector_ms": 0.0012368387520595749, "ViewRequirementAgentConnector_ms": 0.028744693051017293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1089.4994373990073, "num_env_steps_trained_throughput_per_sec": 1089.4994373990073, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 3670.353, "sample_time_ms": 1782.095, "load_time_ms": 0.241, "load_throughput": 16620978.799, "learn_time_ms": 1887.008, "learn_throughput": 2119.758, "synch_weights_time_ms": 0.658}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 7814, "training_iteration": 68, "trial_id": "default", "date": "2024-05-22_22-19-05", "timestamp": 1716409145, "time_this_iter_s": 3.6753132343292236, "time_total_s": 245.05902338027954, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 245.05902338027954, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 19.766666666666666, "ram_util_percent": 60.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9068346374778335, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04747402878097629, "policy_loss": -0.006172070021350538, "vf_loss": 0.0530806176166641, "vf_explained_var": 0.5086378432089282, "kl": 0.022619282088584693, "entropy": 0.9274284353179316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 0.9981956531026652, "episode_reward_min": -1.0, "episode_reward_mean": 0.6541864373116743, "episode_len_mean": 20.331658291457288, "episode_media": {}, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.8021685553359015, -1.0, 0.759477294276316, 0.5, 0.8526657212232989, 0.8892614304481677, 0.668310570249387, 0.792756815251394, 0.7688733075966512, 0.9784599403131287, 0.8205396899732516, 0.9325273671961035, 0.8250039648809946, 0.6696083884713439, 0.9342396699951265, 0.927487052298633, 0.6536731708098711, 0.9129566487322468, 0.9866940287871389, 0.5568272486059982, 0.8076461454577277, 0.9701404707449576, 0.8716395589612858, 0.8956962191476329, 0.883243083675038, 0.754950489253274, 0.6805611144478383, -1.0, 0.7966693369614317, 0.9363150422880878, 0.9384102586604847, 0.8363332859130416, 0.7592025476318764, 0.5, 0.9928735345009382, 0.6210312092244666, 0.9531722481062227, 0.5, 0.5, 0.7123631743864896, 0.7046560815658192, 0.9790986457173275, 0.5, 0.8207383125300611, 0.7520208814675564, 0.7257710563502795, 0.7376180006346613, -1.0, 0.6977921102484583, 0.5, 0.8487653264279824, 0.9472087476066662, 0.7204050746034902, -1.0, 0.7342839120385976, 0.9841609466896057, 0.9322089802075217, 0.7355484433717663, 0.5, 0.8390571499974939, 0.5, 0.9063405839333023, 0.5, 0.9669471271711167, -1.0, 0.9261321787225953, 0.8842909949929381, 0.5722209368036759, 0.858287186306237, 0.5, 0.9062970156725878, 0.749254430128788, 0.5, 0.5, 0.6227904206925072, 0.5, 0.7677660584413942, 0.5, 0.8683439203302742, 0.9485477664487498, 0.6280160563875874, 0.7431552586299517, 0.5, 0.9063903141899811, 0.652005473910092, 0.8839723117781825, 0.9704060667038035, 0.5716018543250045, 0.9971856976257587, 0.9059893486367186, 0.918399262381216, 0.5, 0.7476858791676291, 0.5, 0.9981956531026652, 0.7251625227124239, 0.5, 0.8619259569670974, 0.9500722479494179, 0.6569448836173964, 0.7383366978621091, 0.7735958885437779, 0.5, 0.5, 0.5, 0.5, 0.7990188470519071, 0.9896488019873717, -1.0, 0.9912410978307028, 0.9668467245787005, 0.7279461177751623, 0.7194552126083613, 0.5, 0.750729337203805, 0.9759455957738538, 0.8499500166872982, 0.5259190123273432, -1.0, 0.908860705744009, 0.9518185415307491, -1.0, 0.5, 0.6805313374707358, 0.7539126799333166, 0.5, 0.5, 0.9026306379127631, 0.8687584956894114, 0.6943055025291869, 0.5, 0.9371917875781429, 0.8689669441933882, 0.5, 0.6323602416353379, 0.5903608346088021, 0.6046858841689435, 0.5, 0.765940855004735, 0.9224970886270241, 0.843136140776325, 0.929680072701548, 0.968556211690855, 0.8680054870846807, 0.8544669448752189, 0.7173771871526622, 0.768745592653068, 0.933441498719935, 0.6931340370962199, 0.640729483055705, 0.5309579329243159, 0.9479873894897519, 0.5, 0.8958166133987856, 0.9724921701083691, -1.0, 0.9081472054550669, 0.7746062437515152, 0.5052617521740109, 0.8450704481850634, 0.891655560718435, 0.7583559870516522, 0.7604607527699736, 0.8753400645968974, 0.5360663729061099, 0.7644854693945563, 0.5, 0.5311470524400358, 0.8493809953877218, 0.6891697100907355, 0.8575541389900934, 0.7116547190170006, 0.8516559029546565, 0.5281994735080419, 0.6576292304979252, 0.8917727099714853, -1.0, 0.6425103989350368, 0.7155490917972696, 0.6136669093508433, 0.8950490238306826, 0.736824860383912, 0.9096617755702909, 0.9557737728033968, -1.0, 0.5, 0.9034746707270268, 0.9181092190006079, 0.5, 0.6240890723035716, 0.5, 0.664497479421181, 0.8747524422723247, 0.9751409353315807, 0.8091716574171762, 0.5, 0.9262887293166439, 0.9795058871241448], "episode_lengths": [58, 18, 80, 16, 20, 17, 16, 18, 18, 14, 14, 19, 16, 15, 18, 16, 14, 17, 14, 15, 24, 22, 14, 14, 15, 16, 24, 17, 21, 16, 15, 15, 15, 17, 20, 14, 25, 19, 21, 21, 19, 17, 15, 40, 14, 15, 19, 16, 80, 17, 20, 15, 13, 19, 21, 15, 16, 15, 17, 31, 16, 23, 15, 24, 15, 80, 16, 15, 19, 15, 31, 17, 17, 27, 30, 19, 19, 15, 21, 17, 15, 18, 21, 16, 16, 17, 15, 14, 17, 15, 14, 15, 22, 17, 31, 17, 17, 23, 14, 15, 21, 14, 15, 17, 24, 41, 35, 16, 16, 18, 16, 15, 15, 18, 31, 15, 16, 18, 19, 15, 14, 15, 66, 38, 15, 22, 23, 42, 14, 18, 18, 49, 14, 15, 56, 22, 18, 26, 26, 17, 16, 15, 17, 14, 14, 16, 27, 19, 17, 15, 19, 19, 16, 23, 14, 18, 13, 15, 16, 21, 21, 20, 17, 15, 16, 22, 22, 23, 22, 17, 16, 20, 15, 20, 19, 17, 14, 17, 14, 16, 20, 17, 17, 17, 16, 65, 18, 15, 15, 23, 19, 19, 16, 15, 14, 23, 21, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09560414847009226, "mean_inference_ms": 0.2437087563599265, "mean_action_processing_ms": 0.04393884730262775, "mean_env_wait_ms": 0.04704396680066714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015309108561606863, "StateBufferConnector_ms": 0.0012270769282202026, "ViewRequirementAgentConnector_ms": 0.02867492599103918}}, "episode_reward_max": 0.9981956531026652, "episode_reward_min": -1.0, "episode_reward_mean": 0.6541864373116743, "episode_len_mean": 20.331658291457288, "episodes_this_iter": 199, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.8021685553359015, -1.0, 0.759477294276316, 0.5, 0.8526657212232989, 0.8892614304481677, 0.668310570249387, 0.792756815251394, 0.7688733075966512, 0.9784599403131287, 0.8205396899732516, 0.9325273671961035, 0.8250039648809946, 0.6696083884713439, 0.9342396699951265, 0.927487052298633, 0.6536731708098711, 0.9129566487322468, 0.9866940287871389, 0.5568272486059982, 0.8076461454577277, 0.9701404707449576, 0.8716395589612858, 0.8956962191476329, 0.883243083675038, 0.754950489253274, 0.6805611144478383, -1.0, 0.7966693369614317, 0.9363150422880878, 0.9384102586604847, 0.8363332859130416, 0.7592025476318764, 0.5, 0.9928735345009382, 0.6210312092244666, 0.9531722481062227, 0.5, 0.5, 0.7123631743864896, 0.7046560815658192, 0.9790986457173275, 0.5, 0.8207383125300611, 0.7520208814675564, 0.7257710563502795, 0.7376180006346613, -1.0, 0.6977921102484583, 0.5, 0.8487653264279824, 0.9472087476066662, 0.7204050746034902, -1.0, 0.7342839120385976, 0.9841609466896057, 0.9322089802075217, 0.7355484433717663, 0.5, 0.8390571499974939, 0.5, 0.9063405839333023, 0.5, 0.9669471271711167, -1.0, 0.9261321787225953, 0.8842909949929381, 0.5722209368036759, 0.858287186306237, 0.5, 0.9062970156725878, 0.749254430128788, 0.5, 0.5, 0.6227904206925072, 0.5, 0.7677660584413942, 0.5, 0.8683439203302742, 0.9485477664487498, 0.6280160563875874, 0.7431552586299517, 0.5, 0.9063903141899811, 0.652005473910092, 0.8839723117781825, 0.9704060667038035, 0.5716018543250045, 0.9971856976257587, 0.9059893486367186, 0.918399262381216, 0.5, 0.7476858791676291, 0.5, 0.9981956531026652, 0.7251625227124239, 0.5, 0.8619259569670974, 0.9500722479494179, 0.6569448836173964, 0.7383366978621091, 0.7735958885437779, 0.5, 0.5, 0.5, 0.5, 0.7990188470519071, 0.9896488019873717, -1.0, 0.9912410978307028, 0.9668467245787005, 0.7279461177751623, 0.7194552126083613, 0.5, 0.750729337203805, 0.9759455957738538, 0.8499500166872982, 0.5259190123273432, -1.0, 0.908860705744009, 0.9518185415307491, -1.0, 0.5, 0.6805313374707358, 0.7539126799333166, 0.5, 0.5, 0.9026306379127631, 0.8687584956894114, 0.6943055025291869, 0.5, 0.9371917875781429, 0.8689669441933882, 0.5, 0.6323602416353379, 0.5903608346088021, 0.6046858841689435, 0.5, 0.765940855004735, 0.9224970886270241, 0.843136140776325, 0.929680072701548, 0.968556211690855, 0.8680054870846807, 0.8544669448752189, 0.7173771871526622, 0.768745592653068, 0.933441498719935, 0.6931340370962199, 0.640729483055705, 0.5309579329243159, 0.9479873894897519, 0.5, 0.8958166133987856, 0.9724921701083691, -1.0, 0.9081472054550669, 0.7746062437515152, 0.5052617521740109, 0.8450704481850634, 0.891655560718435, 0.7583559870516522, 0.7604607527699736, 0.8753400645968974, 0.5360663729061099, 0.7644854693945563, 0.5, 0.5311470524400358, 0.8493809953877218, 0.6891697100907355, 0.8575541389900934, 0.7116547190170006, 0.8516559029546565, 0.5281994735080419, 0.6576292304979252, 0.8917727099714853, -1.0, 0.6425103989350368, 0.7155490917972696, 0.6136669093508433, 0.8950490238306826, 0.736824860383912, 0.9096617755702909, 0.9557737728033968, -1.0, 0.5, 0.9034746707270268, 0.9181092190006079, 0.5, 0.6240890723035716, 0.5, 0.664497479421181, 0.8747524422723247, 0.9751409353315807, 0.8091716574171762, 0.5, 0.9262887293166439, 0.9795058871241448], "episode_lengths": [58, 18, 80, 16, 20, 17, 16, 18, 18, 14, 14, 19, 16, 15, 18, 16, 14, 17, 14, 15, 24, 22, 14, 14, 15, 16, 24, 17, 21, 16, 15, 15, 15, 17, 20, 14, 25, 19, 21, 21, 19, 17, 15, 40, 14, 15, 19, 16, 80, 17, 20, 15, 13, 19, 21, 15, 16, 15, 17, 31, 16, 23, 15, 24, 15, 80, 16, 15, 19, 15, 31, 17, 17, 27, 30, 19, 19, 15, 21, 17, 15, 18, 21, 16, 16, 17, 15, 14, 17, 15, 14, 15, 22, 17, 31, 17, 17, 23, 14, 15, 21, 14, 15, 17, 24, 41, 35, 16, 16, 18, 16, 15, 15, 18, 31, 15, 16, 18, 19, 15, 14, 15, 66, 38, 15, 22, 23, 42, 14, 18, 18, 49, 14, 15, 56, 22, 18, 26, 26, 17, 16, 15, 17, 14, 14, 16, 27, 19, 17, 15, 19, 19, 16, 23, 14, 18, 13, 15, 16, 21, 21, 20, 17, 15, 16, 22, 22, 23, 22, 17, 16, 20, 15, 20, 19, 17, 14, 17, 14, 16, 20, 17, 17, 17, 16, 65, 18, 15, 15, 23, 19, 19, 16, 15, 14, 23, 21, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09560414847009226, "mean_inference_ms": 0.2437087563599265, "mean_action_processing_ms": 0.04393884730262775, "mean_env_wait_ms": 0.04704396680066714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015309108561606863, "StateBufferConnector_ms": 0.0012270769282202026, "ViewRequirementAgentConnector_ms": 0.02867492599103918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.775433383832, "num_env_steps_trained_throughput_per_sec": 1101.775433383832, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 3668.36, "sample_time_ms": 1781.073, "load_time_ms": 0.231, "load_throughput": 17335416.408, "learn_time_ms": 1886.044, "learn_throughput": 2120.841, "synch_weights_time_ms": 0.661}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 8013, "training_iteration": 69, "trial_id": "default", "date": "2024-05-22_22-19-09", "timestamp": 1716409149, "time_this_iter_s": 3.6342990398406982, "time_total_s": 248.69332242012024, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 248.69332242012024, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 18.78, "ram_util_percent": 60.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0171262767366183, "cur_kl_coeff": 0.0375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.030068739856764178, "policy_loss": -0.006514730345037195, "vf_loss": 0.03607506898722501, "vf_explained_var": 0.4648426887168679, "kl": 0.013557318310858725, "entropy": 0.7755309125428559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 0.9999778636203249, "episode_reward_min": -1.0, "episode_reward_mean": 0.7206317185974848, "episode_len_mean": 18.00900900900901, "episode_media": {}, "episodes_this_iter": 222, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.77621642897373, 0.8761270715027395, 0.7841050325236094, 0.8066288910606033, 0.5, 0.8965247422592915, 0.8911663236589442, 0.856173918979666, 0.9999778636203249, 0.5, 0.7446387061169304, 0.9966512561489506, 0.9128810290523295, 0.918966830709929, 0.5, 0.9016760172321382, 0.5, 0.5, 0.7429095443463263, 0.5, 0.5518270463824015, 0.9696944486539538, 0.7413057516294922, -1.0, 0.9991313728429854, 0.5753272467391946, 0.9394054289237572, 0.9322642949777787, 0.7089885435771602, 0.7734183826492733, 0.7415900194494379, 0.8018286245464257, 0.5, 0.5, 0.924926064579699, 0.6333344510004757, 0.9681755286093264, -1.0, 0.7982499863382173, 0.5847304586130911, 0.8461530791660328, 0.547982849721613, 0.5, 0.9576160495079912, 0.7833508098135432, 0.7054672323519917, 0.6381278481180706, 0.793627397067574, 0.7888869122696082, 0.8706692381197445, 0.9014172781534977, 0.6458891289725321, 0.8032719748131035, 0.5, 0.9635514327173107, 0.8394762566979059, 0.69286183513023, 0.7169471769027258, 0.9186442237030958, 0.6106753977943055, 0.8105690264881921, 0.6821854943672365, 0.6395403515737941, -1.0, 0.8872256895384093, 0.9202868348293781, 0.7307927747909047, 0.5, 0.9035102490612057, 0.9658886393308691, 0.6474037111060278, 0.510162997849123, 0.8204689195991561, 0.9247761549033322, 0.5, 0.828452367225692, 0.79528616345269, 0.9089413361519241, 0.5064331542002838, 0.8453724140144632, 0.580474189953104, 0.848647666739959, 0.8776716267701172, 0.9303021100190836, 0.8341504424977042, 0.9522553147393555, 0.9026704141324025, 0.6554434183370359, 0.9571243137794102, 0.995655802515737, 0.5, 0.5451372393175, 0.5, 0.5, 0.758225409590603, 0.5, 0.886351773883337, 0.6761331601630978, 0.5, 0.8175185823345208, 0.9194094217184261, 0.6350288017408312, 0.7229510046697526, 0.8918678890921996, 0.5920576378501264, 0.8548704301884701, 0.8031870208566936, 0.9841374817414709, 0.5, 0.9424991683596062, 0.9800873964604497, 0.8951805129752133, 0.847138491995584, 0.5704093818359969, 0.9953635316423, 0.9380159769895516, 0.5, 0.9242934451980067, 0.8745426246306398, 0.8835996286583379, 0.8326816125031438, 0.5, 0.5, 0.5448953585847505, 0.6836021728966766, 0.909710533528751, 0.5763588691435665, 0.7640259877941697, 0.7976259952207477, 0.8119714004463421, 0.8534552592685537, 0.9912771072085961, 0.8825237866927543, 0.7934344359336543, 0.8379595367929399, 0.5201140397337588, 0.7799056502263171, 0.5523145703433161, 0.6216360443499108, 0.6713251223968403, 0.8441637782751916, 0.6251492318268489, 0.9623634036266732, 0.9338142033277237, 0.8179607451981281, 0.8895909424976186, 0.6705057997993482, 0.9666051311012375, 0.5, 0.8234997882237346, 0.5, 0.7458448181900681, 0.8828892233664869, 0.9746063134382726, 0.9685017164036546, 0.5074653990241365, 0.9190834412999527, 0.9704707046198329, 0.8840838450253529, 0.5344126579841204, 0.5, 0.9248957435544409, 0.9533469075005296, 0.7794435893659025, 0.568516411409567, 0.9690512652674319, 0.5, 0.6618322533307449, 0.891373349510706, 0.866490934754708, 0.7848795965214544, 0.7126528539237156, 0.6401008555428757, 0.9427182756157104, 0.7643252106144709, 0.8571574565067466, 0.5, 0.7261160384266159, 0.5633187868583257, 0.6334190083245805, 0.8325586730312109, 0.8389939938392217, 0.9831941045314212, 0.9345479619600894, 0.5, 0.9175179228642031, 0.8750004932447648, 0.5861665163264318, -1.0, 0.88970462493603, 0.8933534667245567, 0.8729966305400265, 0.6342893572806372, 0.7552342052098514, 0.9125472230219133, 0.5700696763807683, 0.5, 0.785883466832577, 0.9290747091569542, 0.8543585293438437, 0.9186921821193571, 0.5, 0.5, 0.9714171215725385, 0.6387938870133747, 0.9114892677199111, 0.5674496953822339, 0.6041979340289696, 0.6268538829074564, 0.8981899282700162, 0.6082936819400225, 0.9103821922780453, 0.6263816484831944, 0.7375594723043215, 0.5, 0.5, 0.5, 0.7539026356063542, 0.5, 0.5, 0.7085761828332742, 0.7739480810580107], "episode_lengths": [16, 14, 14, 21, 19, 13, 14, 17, 15, 23, 18, 15, 13, 13, 18, 15, 23, 23, 15, 22, 17, 16, 17, 26, 16, 18, 16, 14, 19, 20, 16, 16, 23, 21, 15, 19, 15, 29, 15, 18, 19, 20, 30, 13, 16, 20, 16, 17, 15, 15, 15, 14, 15, 26, 14, 16, 16, 16, 14, 21, 17, 17, 16, 28, 14, 17, 16, 22, 15, 16, 18, 18, 15, 14, 26, 14, 15, 17, 20, 22, 31, 15, 15, 14, 14, 14, 14, 16, 14, 18, 21, 17, 27, 24, 18, 20, 15, 22, 29, 18, 15, 17, 16, 15, 18, 14, 17, 14, 19, 15, 14, 16, 17, 16, 14, 16, 30, 17, 17, 16, 16, 20, 28, 54, 15, 15, 18, 18, 16, 23, 18, 16, 15, 20, 15, 19, 16, 20, 17, 20, 15, 21, 14, 19, 15, 14, 18, 15, 23, 18, 25, 14, 15, 14, 18, 18, 14, 15, 16, 24, 28, 18, 19, 17, 16, 14, 19, 15, 15, 14, 16, 14, 20, 18, 18, 15, 20, 16, 17, 19, 18, 17, 15, 15, 23, 15, 16, 17, 14, 15, 16, 14, 18, 18, 14, 20, 25, 17, 13, 18, 16, 16, 36, 15, 16, 15, 26, 16, 19, 14, 20, 17, 19, 16, 29, 19, 41, 14, 21, 28, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09572454648541706, "mean_inference_ms": 0.2437138496041517, "mean_action_processing_ms": 0.04394105902556041, "mean_env_wait_ms": 0.04705892428378177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015323226516311232, "StateBufferConnector_ms": 0.0012335476574597058, "ViewRequirementAgentConnector_ms": 0.028506485191551415}}, "episode_reward_max": 0.9999778636203249, "episode_reward_min": -1.0, "episode_reward_mean": 0.7206317185974848, "episode_len_mean": 18.00900900900901, "episodes_this_iter": 222, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.77621642897373, 0.8761270715027395, 0.7841050325236094, 0.8066288910606033, 0.5, 0.8965247422592915, 0.8911663236589442, 0.856173918979666, 0.9999778636203249, 0.5, 0.7446387061169304, 0.9966512561489506, 0.9128810290523295, 0.918966830709929, 0.5, 0.9016760172321382, 0.5, 0.5, 0.7429095443463263, 0.5, 0.5518270463824015, 0.9696944486539538, 0.7413057516294922, -1.0, 0.9991313728429854, 0.5753272467391946, 0.9394054289237572, 0.9322642949777787, 0.7089885435771602, 0.7734183826492733, 0.7415900194494379, 0.8018286245464257, 0.5, 0.5, 0.924926064579699, 0.6333344510004757, 0.9681755286093264, -1.0, 0.7982499863382173, 0.5847304586130911, 0.8461530791660328, 0.547982849721613, 0.5, 0.9576160495079912, 0.7833508098135432, 0.7054672323519917, 0.6381278481180706, 0.793627397067574, 0.7888869122696082, 0.8706692381197445, 0.9014172781534977, 0.6458891289725321, 0.8032719748131035, 0.5, 0.9635514327173107, 0.8394762566979059, 0.69286183513023, 0.7169471769027258, 0.9186442237030958, 0.6106753977943055, 0.8105690264881921, 0.6821854943672365, 0.6395403515737941, -1.0, 0.8872256895384093, 0.9202868348293781, 0.7307927747909047, 0.5, 0.9035102490612057, 0.9658886393308691, 0.6474037111060278, 0.510162997849123, 0.8204689195991561, 0.9247761549033322, 0.5, 0.828452367225692, 0.79528616345269, 0.9089413361519241, 0.5064331542002838, 0.8453724140144632, 0.580474189953104, 0.848647666739959, 0.8776716267701172, 0.9303021100190836, 0.8341504424977042, 0.9522553147393555, 0.9026704141324025, 0.6554434183370359, 0.9571243137794102, 0.995655802515737, 0.5, 0.5451372393175, 0.5, 0.5, 0.758225409590603, 0.5, 0.886351773883337, 0.6761331601630978, 0.5, 0.8175185823345208, 0.9194094217184261, 0.6350288017408312, 0.7229510046697526, 0.8918678890921996, 0.5920576378501264, 0.8548704301884701, 0.8031870208566936, 0.9841374817414709, 0.5, 0.9424991683596062, 0.9800873964604497, 0.8951805129752133, 0.847138491995584, 0.5704093818359969, 0.9953635316423, 0.9380159769895516, 0.5, 0.9242934451980067, 0.8745426246306398, 0.8835996286583379, 0.8326816125031438, 0.5, 0.5, 0.5448953585847505, 0.6836021728966766, 0.909710533528751, 0.5763588691435665, 0.7640259877941697, 0.7976259952207477, 0.8119714004463421, 0.8534552592685537, 0.9912771072085961, 0.8825237866927543, 0.7934344359336543, 0.8379595367929399, 0.5201140397337588, 0.7799056502263171, 0.5523145703433161, 0.6216360443499108, 0.6713251223968403, 0.8441637782751916, 0.6251492318268489, 0.9623634036266732, 0.9338142033277237, 0.8179607451981281, 0.8895909424976186, 0.6705057997993482, 0.9666051311012375, 0.5, 0.8234997882237346, 0.5, 0.7458448181900681, 0.8828892233664869, 0.9746063134382726, 0.9685017164036546, 0.5074653990241365, 0.9190834412999527, 0.9704707046198329, 0.8840838450253529, 0.5344126579841204, 0.5, 0.9248957435544409, 0.9533469075005296, 0.7794435893659025, 0.568516411409567, 0.9690512652674319, 0.5, 0.6618322533307449, 0.891373349510706, 0.866490934754708, 0.7848795965214544, 0.7126528539237156, 0.6401008555428757, 0.9427182756157104, 0.7643252106144709, 0.8571574565067466, 0.5, 0.7261160384266159, 0.5633187868583257, 0.6334190083245805, 0.8325586730312109, 0.8389939938392217, 0.9831941045314212, 0.9345479619600894, 0.5, 0.9175179228642031, 0.8750004932447648, 0.5861665163264318, -1.0, 0.88970462493603, 0.8933534667245567, 0.8729966305400265, 0.6342893572806372, 0.7552342052098514, 0.9125472230219133, 0.5700696763807683, 0.5, 0.785883466832577, 0.9290747091569542, 0.8543585293438437, 0.9186921821193571, 0.5, 0.5, 0.9714171215725385, 0.6387938870133747, 0.9114892677199111, 0.5674496953822339, 0.6041979340289696, 0.6268538829074564, 0.8981899282700162, 0.6082936819400225, 0.9103821922780453, 0.6263816484831944, 0.7375594723043215, 0.5, 0.5, 0.5, 0.7539026356063542, 0.5, 0.5, 0.7085761828332742, 0.7739480810580107], "episode_lengths": [16, 14, 14, 21, 19, 13, 14, 17, 15, 23, 18, 15, 13, 13, 18, 15, 23, 23, 15, 22, 17, 16, 17, 26, 16, 18, 16, 14, 19, 20, 16, 16, 23, 21, 15, 19, 15, 29, 15, 18, 19, 20, 30, 13, 16, 20, 16, 17, 15, 15, 15, 14, 15, 26, 14, 16, 16, 16, 14, 21, 17, 17, 16, 28, 14, 17, 16, 22, 15, 16, 18, 18, 15, 14, 26, 14, 15, 17, 20, 22, 31, 15, 15, 14, 14, 14, 14, 16, 14, 18, 21, 17, 27, 24, 18, 20, 15, 22, 29, 18, 15, 17, 16, 15, 18, 14, 17, 14, 19, 15, 14, 16, 17, 16, 14, 16, 30, 17, 17, 16, 16, 20, 28, 54, 15, 15, 18, 18, 16, 23, 18, 16, 15, 20, 15, 19, 16, 20, 17, 20, 15, 21, 14, 19, 15, 14, 18, 15, 23, 18, 25, 14, 15, 14, 18, 18, 14, 15, 16, 24, 28, 18, 19, 17, 16, 14, 19, 15, 15, 14, 16, 14, 20, 18, 18, 15, 20, 16, 17, 19, 18, 17, 15, 15, 23, 15, 16, 17, 14, 15, 16, 14, 18, 18, 14, 20, 25, 17, 13, 18, 16, 16, 36, 15, 16, 15, 26, 16, 19, 14, 20, 17, 19, 16, 29, 19, 41, 14, 21, 28, 19, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09572454648541706, "mean_inference_ms": 0.2437138496041517, "mean_action_processing_ms": 0.04394105902556041, "mean_env_wait_ms": 0.04705892428378177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015323226516311232, "StateBufferConnector_ms": 0.0012335476574597058, "ViewRequirementAgentConnector_ms": 0.028506485191551415}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.9741293409804, "num_env_steps_trained_throughput_per_sec": 1098.9741293409804, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 3664.136, "sample_time_ms": 1780.507, "load_time_ms": 0.231, "load_throughput": 17310375.567, "learn_time_ms": 1882.387, "learn_throughput": 2124.961, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 8235, "training_iteration": 70, "trial_id": "default", "date": "2024-05-22_22-19-12", "timestamp": 1716409152, "time_this_iter_s": 3.6438100337982178, "time_total_s": 252.33713245391846, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.33713245391846, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 18.320000000000004, "ram_util_percent": 60.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2894636711766645, "cur_kl_coeff": 0.0375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0391219932161602, "policy_loss": -0.011342021111418963, "vf_loss": 0.049735550244679294, "vf_explained_var": 0.39532422673317696, "kl": 0.019425704046412414, "entropy": 0.7839471943916813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 0.9995584756262168, "episode_reward_min": -1.0, "episode_reward_mean": 0.7264713571446506, "episode_len_mean": 17.25, "episode_media": {}, "episodes_this_iter": 232, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5442381491013428, 0.8685716206381571, 0.952504455602272, 0.6765004131932161, 0.8500496595392659, 0.527469547884841, 0.6819885047285948, 0.9689359239586035, 0.9073645234648586, 0.8107661381706789, 0.9423212456273627, 0.7201577339462608, 0.5121572951089775, 0.9864721347748329, 0.891475689870595, 0.5, 0.7528824500774084, -1.0, 0.5, 0.5101750447084468, 0.999039650980484, 0.9908113174922633, 0.8222841811788479, 0.8590899673831491, 0.6286882657753187, 0.9900319702271825, 0.8116433861638919, 0.8892645941454793, 0.6816685824963282, 0.5386167197303906, 0.6017918835222379, 0.9524737181743781, 0.8907654016089114, 0.9196871061532716, 0.7299338774996362, 0.8792873546027723, 0.5, 0.5, -1.0, 0.9828494055729278, 0.9526694018536419, 0.5526885303034879, 0.582901515737487, 0.8180119759717044, 0.6386095859987364, 0.813938799206837, 0.8330128474756393, 0.832552104062596, 0.9302525415726658, 0.995206282657963, 0.8967150180390391, 0.9846538767248655, 0.6711804894116346, 0.6836228458280609, 0.5982636938907289, 0.9562065245536165, 0.9349684998187986, 0.8491350959362014, 0.8355028290536737, 0.9096527916590204, 0.5, 0.9079958939273861, 0.947310292914708, 0.9562643885386671, 0.9552763350548692, 0.5, 0.574213152564982, 0.7955337530150168, 0.7226853517164075, 0.9653333476477127, 0.8798009203597802, 0.7454551599065539, 0.8377753579854175, 0.8576099939453381, -1.0, 0.9408252979902765, 0.7373923014950245, 0.5, 0.5893385620660796, 0.6576976333911277, 0.7610447042769931, 0.7871325636516977, 0.9847075242266277, 0.7354209953478676, 0.8164998752950695, 0.7984221411881777, 0.8794443219543149, 0.7449009626391798, 0.9462075655580251, 0.90116222932639, 0.5872841705682337, 0.7893693319526739, 0.6351998448304697, 0.9386439181289482, 0.602857374507555, 0.5, 0.8457210251324392, 0.7686968538716075, 0.8205460807095988, 0.8708416574752558, 0.883612829696071, 0.698224130434499, 0.5, 0.9401751187312061, 0.5, 0.9951998583230656, 0.7576444599603502, 0.6766895083368909, 0.6231605544892699, 0.9365047054121782, 0.8381594667405113, 0.8955659044954667, 0.8625200139560927, -1.0, 0.9736969317433066, 0.663471089368652, 0.7850609671104672, 0.9067340364944988, 0.6745132381421539, 0.8983858964379764, 0.9343850835814976, 0.5, 0.785371910233011, 0.5281377899839952, 0.9451942350169464, 0.5601522066626172, 0.9958015918165166, -1.0, 0.9682521500660812, 0.9933090329137492, 0.6298539223003798, 0.949674102424119, 0.5, 0.8975727783250583, 0.5581807153912777, -1.0, 0.9540500162057038, 0.9850712868899381, 0.5893332925707708, 0.8156800168893273, 0.9461130549260842, 0.5, 0.7467821540521169, 0.5431908951466948, 0.9470035897110466, 0.7661216546732273, 0.9245147570413111, 0.8794802322463611, 0.9418610618361166, 0.6994525036623567, 0.8160810082033656, 0.6556383456917548, 0.9780549332134835, 0.9760246237377395, 0.5571289258928319, 0.5, 0.9995584756262168, 0.8955147495220601, 0.5, 0.8899509269092793, 0.5, 0.7623201059637001, 0.8165010215833765, -1.0, 0.8697736804559199, 0.968324941307292, 0.8706997136035733, 0.5, 0.7652499506045395, 0.9646930842018341, 0.7936476353990785, 0.9299604997890087, 0.5815270392856682, 0.7244530530916444, 0.8811074532298233, 0.9551491731098324, 0.8283687770258454, 0.8216793669501714, 0.9301213894299745, 0.9046937632908262, 0.8878460876257239, 0.9731495156599956, 0.5564134544102063, 0.5, 0.8009908990322578, 0.9723150444700555, 0.8241196093441792, 0.8760938865336679, 0.800936194362011, 0.5, 0.8768127689645039, 0.8779169089987094, 0.8298547978913975, 0.6455137420068904, 0.9440472262712359, 0.5524508416322715, 0.6927394193738965, 0.5, 0.5, 0.8097887816206435, 0.9161018719450474, 0.565064294888699, 0.5, 0.9234028746507345, 0.9864663453067164, 0.8492699404024282, 0.867537091308355, 0.9049761343796449, 0.9874465597904282, 0.9288721232035322, 0.9935344477112635, 0.9378033042442929, 0.9872120058257099, 0.9169039789039601, 0.9227807363867896, 0.6889121697839982, 0.8907735135988628, 0.5, 0.9725594358437113, 0.6432054542506904, 0.9277682619267861, 0.5, 0.8633589305290186, 0.7753068437436768, -1.0, 0.5581997180151484, 0.8184743114670332, 0.8147819798242462, 0.8770253727215019, 0.952788286957907, 0.7275148244008168, 0.9659294397724405], "episode_lengths": [29, 17, 14, 19, 14, 19, 16, 16, 18, 16, 14, 22, 18, 16, 14, 29, 17, 22, 15, 17, 13, 14, 14, 15, 17, 16, 20, 15, 16, 20, 18, 15, 18, 13, 15, 14, 17, 24, 21, 16, 15, 19, 19, 15, 17, 15, 15, 17, 15, 16, 17, 15, 22, 15, 20, 13, 15, 16, 15, 13, 15, 18, 15, 14, 14, 16, 17, 19, 19, 15, 16, 15, 18, 18, 17, 13, 18, 19, 23, 15, 20, 18, 15, 15, 15, 14, 15, 16, 15, 14, 23, 15, 16, 16, 25, 20, 16, 15, 15, 14, 15, 16, 26, 15, 25, 14, 18, 17, 17, 14, 14, 16, 15, 71, 14, 16, 16, 14, 18, 16, 15, 21, 14, 22, 16, 17, 15, 25, 14, 13, 18, 15, 18, 17, 19, 26, 18, 16, 18, 17, 18, 22, 18, 21, 14, 16, 14, 15, 16, 17, 14, 16, 16, 15, 16, 24, 16, 14, 22, 15, 20, 15, 14, 23, 13, 17, 13, 23, 17, 15, 16, 16, 18, 19, 15, 13, 13, 13, 15, 15, 14, 16, 18, 29, 16, 16, 17, 15, 15, 21, 15, 14, 18, 15, 16, 18, 18, 44, 28, 14, 16, 16, 59, 15, 15, 15, 16, 15, 15, 15, 17, 15, 15, 20, 14, 14, 17, 18, 15, 16, 15, 19, 15, 17, 13, 14, 14, 14, 16, 17, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09585646588100659, "mean_inference_ms": 0.24373362409152233, "mean_action_processing_ms": 0.043945170356015244, "mean_env_wait_ms": 0.04707495054169998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015466377652924635, "StateBufferConnector_ms": 0.001231658047643201, "ViewRequirementAgentConnector_ms": 0.02867281436920166}}, "episode_reward_max": 0.9995584756262168, "episode_reward_min": -1.0, "episode_reward_mean": 0.7264713571446506, "episode_len_mean": 17.25, "episodes_this_iter": 232, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5442381491013428, 0.8685716206381571, 0.952504455602272, 0.6765004131932161, 0.8500496595392659, 0.527469547884841, 0.6819885047285948, 0.9689359239586035, 0.9073645234648586, 0.8107661381706789, 0.9423212456273627, 0.7201577339462608, 0.5121572951089775, 0.9864721347748329, 0.891475689870595, 0.5, 0.7528824500774084, -1.0, 0.5, 0.5101750447084468, 0.999039650980484, 0.9908113174922633, 0.8222841811788479, 0.8590899673831491, 0.6286882657753187, 0.9900319702271825, 0.8116433861638919, 0.8892645941454793, 0.6816685824963282, 0.5386167197303906, 0.6017918835222379, 0.9524737181743781, 0.8907654016089114, 0.9196871061532716, 0.7299338774996362, 0.8792873546027723, 0.5, 0.5, -1.0, 0.9828494055729278, 0.9526694018536419, 0.5526885303034879, 0.582901515737487, 0.8180119759717044, 0.6386095859987364, 0.813938799206837, 0.8330128474756393, 0.832552104062596, 0.9302525415726658, 0.995206282657963, 0.8967150180390391, 0.9846538767248655, 0.6711804894116346, 0.6836228458280609, 0.5982636938907289, 0.9562065245536165, 0.9349684998187986, 0.8491350959362014, 0.8355028290536737, 0.9096527916590204, 0.5, 0.9079958939273861, 0.947310292914708, 0.9562643885386671, 0.9552763350548692, 0.5, 0.574213152564982, 0.7955337530150168, 0.7226853517164075, 0.9653333476477127, 0.8798009203597802, 0.7454551599065539, 0.8377753579854175, 0.8576099939453381, -1.0, 0.9408252979902765, 0.7373923014950245, 0.5, 0.5893385620660796, 0.6576976333911277, 0.7610447042769931, 0.7871325636516977, 0.9847075242266277, 0.7354209953478676, 0.8164998752950695, 0.7984221411881777, 0.8794443219543149, 0.7449009626391798, 0.9462075655580251, 0.90116222932639, 0.5872841705682337, 0.7893693319526739, 0.6351998448304697, 0.9386439181289482, 0.602857374507555, 0.5, 0.8457210251324392, 0.7686968538716075, 0.8205460807095988, 0.8708416574752558, 0.883612829696071, 0.698224130434499, 0.5, 0.9401751187312061, 0.5, 0.9951998583230656, 0.7576444599603502, 0.6766895083368909, 0.6231605544892699, 0.9365047054121782, 0.8381594667405113, 0.8955659044954667, 0.8625200139560927, -1.0, 0.9736969317433066, 0.663471089368652, 0.7850609671104672, 0.9067340364944988, 0.6745132381421539, 0.8983858964379764, 0.9343850835814976, 0.5, 0.785371910233011, 0.5281377899839952, 0.9451942350169464, 0.5601522066626172, 0.9958015918165166, -1.0, 0.9682521500660812, 0.9933090329137492, 0.6298539223003798, 0.949674102424119, 0.5, 0.8975727783250583, 0.5581807153912777, -1.0, 0.9540500162057038, 0.9850712868899381, 0.5893332925707708, 0.8156800168893273, 0.9461130549260842, 0.5, 0.7467821540521169, 0.5431908951466948, 0.9470035897110466, 0.7661216546732273, 0.9245147570413111, 0.8794802322463611, 0.9418610618361166, 0.6994525036623567, 0.8160810082033656, 0.6556383456917548, 0.9780549332134835, 0.9760246237377395, 0.5571289258928319, 0.5, 0.9995584756262168, 0.8955147495220601, 0.5, 0.8899509269092793, 0.5, 0.7623201059637001, 0.8165010215833765, -1.0, 0.8697736804559199, 0.968324941307292, 0.8706997136035733, 0.5, 0.7652499506045395, 0.9646930842018341, 0.7936476353990785, 0.9299604997890087, 0.5815270392856682, 0.7244530530916444, 0.8811074532298233, 0.9551491731098324, 0.8283687770258454, 0.8216793669501714, 0.9301213894299745, 0.9046937632908262, 0.8878460876257239, 0.9731495156599956, 0.5564134544102063, 0.5, 0.8009908990322578, 0.9723150444700555, 0.8241196093441792, 0.8760938865336679, 0.800936194362011, 0.5, 0.8768127689645039, 0.8779169089987094, 0.8298547978913975, 0.6455137420068904, 0.9440472262712359, 0.5524508416322715, 0.6927394193738965, 0.5, 0.5, 0.8097887816206435, 0.9161018719450474, 0.565064294888699, 0.5, 0.9234028746507345, 0.9864663453067164, 0.8492699404024282, 0.867537091308355, 0.9049761343796449, 0.9874465597904282, 0.9288721232035322, 0.9935344477112635, 0.9378033042442929, 0.9872120058257099, 0.9169039789039601, 0.9227807363867896, 0.6889121697839982, 0.8907735135988628, 0.5, 0.9725594358437113, 0.6432054542506904, 0.9277682619267861, 0.5, 0.8633589305290186, 0.7753068437436768, -1.0, 0.5581997180151484, 0.8184743114670332, 0.8147819798242462, 0.8770253727215019, 0.952788286957907, 0.7275148244008168, 0.9659294397724405], "episode_lengths": [29, 17, 14, 19, 14, 19, 16, 16, 18, 16, 14, 22, 18, 16, 14, 29, 17, 22, 15, 17, 13, 14, 14, 15, 17, 16, 20, 15, 16, 20, 18, 15, 18, 13, 15, 14, 17, 24, 21, 16, 15, 19, 19, 15, 17, 15, 15, 17, 15, 16, 17, 15, 22, 15, 20, 13, 15, 16, 15, 13, 15, 18, 15, 14, 14, 16, 17, 19, 19, 15, 16, 15, 18, 18, 17, 13, 18, 19, 23, 15, 20, 18, 15, 15, 15, 14, 15, 16, 15, 14, 23, 15, 16, 16, 25, 20, 16, 15, 15, 14, 15, 16, 26, 15, 25, 14, 18, 17, 17, 14, 14, 16, 15, 71, 14, 16, 16, 14, 18, 16, 15, 21, 14, 22, 16, 17, 15, 25, 14, 13, 18, 15, 18, 17, 19, 26, 18, 16, 18, 17, 18, 22, 18, 21, 14, 16, 14, 15, 16, 17, 14, 16, 16, 15, 16, 24, 16, 14, 22, 15, 20, 15, 14, 23, 13, 17, 13, 23, 17, 15, 16, 16, 18, 19, 15, 13, 13, 13, 15, 15, 14, 16, 18, 29, 16, 16, 17, 15, 15, 21, 15, 14, 18, 15, 16, 18, 18, 44, 28, 14, 16, 16, 59, 15, 15, 15, 16, 15, 15, 15, 17, 15, 15, 20, 14, 14, 17, 18, 15, 16, 15, 19, 15, 17, 13, 14, 14, 14, 16, 17, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09585646588100659, "mean_inference_ms": 0.24373362409152233, "mean_action_processing_ms": 0.043945170356015244, "mean_env_wait_ms": 0.04707495054169998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015466377652924635, "StateBufferConnector_ms": 0.001231658047643201, "ViewRequirementAgentConnector_ms": 0.02867281436920166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1076.7461697768808, "num_env_steps_trained_throughput_per_sec": 1076.7461697768808, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 3669.747, "sample_time_ms": 1780.002, "load_time_ms": 0.228, "load_throughput": 17507269.122, "learn_time_ms": 1888.487, "learn_throughput": 2118.098, "synch_weights_time_ms": 0.674}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 8467, "training_iteration": 71, "trial_id": "default", "date": "2024-05-22_22-19-16", "timestamp": 1716409156, "time_this_iter_s": 3.719158172607422, "time_total_s": 256.0562906265259, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 256.0562906265259, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 19.639999999999997, "ram_util_percent": 60.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6818427770368514, "cur_kl_coeff": 0.0375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.048182010676671744, "policy_loss": -0.005158117966305825, "vf_loss": 0.052860546514381886, "vf_explained_var": 0.4518215920335503, "kl": 0.012788832398217386, "entropy": 0.8056065998410666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 0.9992423988008267, "episode_reward_min": -1.0, "episode_reward_mean": 0.6994554581316504, "episode_len_mean": 18.228310502283104, "episode_media": {}, "episodes_this_iter": 219, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8665396635356754, 0.7260146083660701, 0.9202721885520949, 0.9033577057094376, 0.8874752866518262, 0.6795246973955359, 0.9081036200280387, 0.9262572673998509, 0.9507031144718359, 0.7330640706917304, 0.5, 0.9090814986172548, 0.9761409443574749, 0.9843177179129032, 0.5604174511051502, 0.5, 0.5, 0.8578699357817969, 0.8427816323545176, -1.0, 0.9029738669984717, 0.5, 0.5190513351007426, 0.9853530079842403, 0.6458714602047352, 0.8629248053336316, 0.9341614824145704, 0.6875711034780272, 0.6706605654228931, 0.9742912364197166, -1.0, 0.8206255063491668, 0.792469963317759, 0.8046449467361072, 0.888188275440361, 0.9385514970281775, 0.5, 0.8496969515843087, 0.6884070659385203, 0.9797073990377341, 0.946482917829766, 0.9262377311605181, 0.5, 0.7916228122750681, 0.8121806238017579, 0.7765562312608771, 0.8123001761233307, 0.5138443383127325, 0.9295673196246466, 0.5497059027311944, 0.9402765424102085, 0.5280607178196424, 0.6737101163814811, 0.8149318047725623, 0.5185853796151405, 0.9560481564320706, 0.8251118858142312, 0.812906099591481, 0.9923190494900354, 0.9550691572554628, 0.9354962417940283, 0.9302653658776497, 0.9443620399222844, 0.5, -1.0, 0.8899683407844251, 0.6459713367357875, 0.8003369178218592, 0.5278288052745966, 0.8174487372116634, 0.5, 0.6815183611540399, 0.60736424153277, 0.9939478582972769, 0.9285873949109325, 0.5980416068262391, 0.5236829884375909, 0.5, 0.5584391585652153, 0.8351443982919431, 0.9716832950392881, 0.9794321363916556, 0.9073244364098756, 0.65013798937989, 0.942207671569623, 0.8465115400695747, 0.8223334962551333, 0.9611027719981172, 0.6119973639124108, 0.8315943623959194, 0.653919347406939, 0.9420379713977836, 0.6068825146478445, 0.9206113641560708, 0.9667100768404603, 0.8905618889817898, 0.9728203669795505, 0.9487963066508855, 0.7321365902054924, 0.5246132690282521, 0.5, 0.8676869266163774, 0.6412889576339096, 0.5, 0.6570247142717938, 0.5482335554416113, 0.7485611206464522, 0.9806630568832713, 0.5848296457357508, 0.5089884489874111, 0.9787187441710669, 0.7105842675120433, 0.5796513776241241, 0.5, 0.8727664560774268, 0.7300210230563936, 0.9539463770484736, 0.5775784326531099, 0.7384048498885547, 0.9545721374900533, 0.5, 0.9095673505549662, 0.679938239535387, 0.5, 0.5747498173975838, 0.5225633087808211, 0.5241598797167901, 0.9463366506042624, 0.7483891819892294, 0.6463914125342345, 0.511014444380133, 0.8542073261299675, 0.9264208981108897, 0.5390357118098068, 0.5, 0.7685494999763479, 0.9293960612269094, 0.6640444032206807, 0.5, 0.9377704260461727, 0.5568551269879652, 0.7371059826809591, 0.9025167047479057, 0.9169759876020076, -1.0, 0.8281709123746793, 0.8238700507192027, 0.8437272195634538, -1.0, 0.7966258320654909, 0.6695687865268574, 0.9700679078316781, 0.7096584271271983, 0.9315513864943124, 0.9992423988008267, 0.9858933941625097, 0.9422741504036898, 0.6382145281642748, 0.5, 0.9535674728033743, 0.5, 0.9793084332061734, 0.773963895987711, 0.7813998829273595, 0.8831479535568875, 0.7845283442462994, -1.0, 0.8932712254955206, 0.8073741469662303, 0.9032911189584674, 0.7511471052380263, 0.8703774480935464, 0.9726506210584768, 0.7421742670420512, 0.9234715396254458, -1.0, 0.8348363702461759, 0.9052871632489297, 0.7265781648672475, 0.8961507444706464, 0.8348513741329995, 0.6945214161202196, 0.9334002629899615, -1.0, 0.8541289846598723, 0.9855138728687913, 0.8754045064626487, 0.7615163110044999, -1.0, 0.5, 0.8948273710559983, 0.5, 0.9551741934717423, 0.566038654297353, 0.8118723904430819, 0.9563458461518292, 0.5, 0.835724796091857, 0.6346763136766584, 0.9125123557554079, 0.7735567187756819, 0.9934385845726608, 0.9164142515259126, 0.7824263121175985, 0.5, 0.9293499779060033, 0.5, 0.8761393387265403, 0.6239217924423791, 0.6703924303379987, 0.9371962990602671, 0.7236211522059823, 0.84636169698281, 0.6668193231106957, 0.7609879330915198, 0.7299174937605444, 0.9879254633666138, 0.8780196601710866, 0.572441467873235], "episode_lengths": [15, 13, 15, 16, 16, 19, 13, 15, 14, 17, 20, 17, 14, 14, 21, 27, 39, 15, 14, 18, 13, 18, 23, 18, 16, 15, 15, 23, 14, 13, 15, 18, 19, 15, 14, 16, 19, 16, 19, 15, 13, 15, 22, 20, 17, 20, 16, 24, 15, 18, 16, 16, 17, 15, 22, 14, 15, 21, 14, 15, 15, 13, 15, 26, 13, 16, 18, 15, 21, 14, 22, 22, 27, 16, 17, 21, 27, 27, 17, 16, 16, 16, 16, 18, 15, 15, 14, 15, 18, 18, 15, 14, 19, 15, 15, 16, 15, 15, 16, 20, 23, 15, 19, 19, 20, 19, 14, 16, 21, 23, 18, 15, 21, 42, 16, 18, 14, 26, 20, 16, 23, 15, 18, 35, 24, 20, 22, 13, 18, 20, 21, 18, 14, 23, 21, 15, 15, 17, 19, 14, 20, 24, 17, 19, 16, 18, 15, 15, 17, 15, 22, 14, 16, 16, 16, 15, 15, 22, 19, 16, 62, 15, 24, 14, 17, 18, 80, 14, 16, 16, 23, 15, 15, 23, 18, 16, 15, 17, 18, 16, 15, 16, 16, 14, 16, 14, 14, 22, 41, 20, 16, 20, 19, 17, 16, 15, 27, 18, 16, 17, 14, 14, 13, 15, 15, 14, 24, 16, 16, 23, 15, 15, 14, 20, 18, 16, 14, 14, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09597338774008544, "mean_inference_ms": 0.24375908209243327, "mean_action_processing_ms": 0.043951177477340335, "mean_env_wait_ms": 0.04709002664529026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001557776917061305, "StateBufferConnector_ms": 0.0012138662817271332, "ViewRequirementAgentConnector_ms": 0.028659546211974262}}, "episode_reward_max": 0.9992423988008267, "episode_reward_min": -1.0, "episode_reward_mean": 0.6994554581316504, "episode_len_mean": 18.228310502283104, "episodes_this_iter": 219, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8665396635356754, 0.7260146083660701, 0.9202721885520949, 0.9033577057094376, 0.8874752866518262, 0.6795246973955359, 0.9081036200280387, 0.9262572673998509, 0.9507031144718359, 0.7330640706917304, 0.5, 0.9090814986172548, 0.9761409443574749, 0.9843177179129032, 0.5604174511051502, 0.5, 0.5, 0.8578699357817969, 0.8427816323545176, -1.0, 0.9029738669984717, 0.5, 0.5190513351007426, 0.9853530079842403, 0.6458714602047352, 0.8629248053336316, 0.9341614824145704, 0.6875711034780272, 0.6706605654228931, 0.9742912364197166, -1.0, 0.8206255063491668, 0.792469963317759, 0.8046449467361072, 0.888188275440361, 0.9385514970281775, 0.5, 0.8496969515843087, 0.6884070659385203, 0.9797073990377341, 0.946482917829766, 0.9262377311605181, 0.5, 0.7916228122750681, 0.8121806238017579, 0.7765562312608771, 0.8123001761233307, 0.5138443383127325, 0.9295673196246466, 0.5497059027311944, 0.9402765424102085, 0.5280607178196424, 0.6737101163814811, 0.8149318047725623, 0.5185853796151405, 0.9560481564320706, 0.8251118858142312, 0.812906099591481, 0.9923190494900354, 0.9550691572554628, 0.9354962417940283, 0.9302653658776497, 0.9443620399222844, 0.5, -1.0, 0.8899683407844251, 0.6459713367357875, 0.8003369178218592, 0.5278288052745966, 0.8174487372116634, 0.5, 0.6815183611540399, 0.60736424153277, 0.9939478582972769, 0.9285873949109325, 0.5980416068262391, 0.5236829884375909, 0.5, 0.5584391585652153, 0.8351443982919431, 0.9716832950392881, 0.9794321363916556, 0.9073244364098756, 0.65013798937989, 0.942207671569623, 0.8465115400695747, 0.8223334962551333, 0.9611027719981172, 0.6119973639124108, 0.8315943623959194, 0.653919347406939, 0.9420379713977836, 0.6068825146478445, 0.9206113641560708, 0.9667100768404603, 0.8905618889817898, 0.9728203669795505, 0.9487963066508855, 0.7321365902054924, 0.5246132690282521, 0.5, 0.8676869266163774, 0.6412889576339096, 0.5, 0.6570247142717938, 0.5482335554416113, 0.7485611206464522, 0.9806630568832713, 0.5848296457357508, 0.5089884489874111, 0.9787187441710669, 0.7105842675120433, 0.5796513776241241, 0.5, 0.8727664560774268, 0.7300210230563936, 0.9539463770484736, 0.5775784326531099, 0.7384048498885547, 0.9545721374900533, 0.5, 0.9095673505549662, 0.679938239535387, 0.5, 0.5747498173975838, 0.5225633087808211, 0.5241598797167901, 0.9463366506042624, 0.7483891819892294, 0.6463914125342345, 0.511014444380133, 0.8542073261299675, 0.9264208981108897, 0.5390357118098068, 0.5, 0.7685494999763479, 0.9293960612269094, 0.6640444032206807, 0.5, 0.9377704260461727, 0.5568551269879652, 0.7371059826809591, 0.9025167047479057, 0.9169759876020076, -1.0, 0.8281709123746793, 0.8238700507192027, 0.8437272195634538, -1.0, 0.7966258320654909, 0.6695687865268574, 0.9700679078316781, 0.7096584271271983, 0.9315513864943124, 0.9992423988008267, 0.9858933941625097, 0.9422741504036898, 0.6382145281642748, 0.5, 0.9535674728033743, 0.5, 0.9793084332061734, 0.773963895987711, 0.7813998829273595, 0.8831479535568875, 0.7845283442462994, -1.0, 0.8932712254955206, 0.8073741469662303, 0.9032911189584674, 0.7511471052380263, 0.8703774480935464, 0.9726506210584768, 0.7421742670420512, 0.9234715396254458, -1.0, 0.8348363702461759, 0.9052871632489297, 0.7265781648672475, 0.8961507444706464, 0.8348513741329995, 0.6945214161202196, 0.9334002629899615, -1.0, 0.8541289846598723, 0.9855138728687913, 0.8754045064626487, 0.7615163110044999, -1.0, 0.5, 0.8948273710559983, 0.5, 0.9551741934717423, 0.566038654297353, 0.8118723904430819, 0.9563458461518292, 0.5, 0.835724796091857, 0.6346763136766584, 0.9125123557554079, 0.7735567187756819, 0.9934385845726608, 0.9164142515259126, 0.7824263121175985, 0.5, 0.9293499779060033, 0.5, 0.8761393387265403, 0.6239217924423791, 0.6703924303379987, 0.9371962990602671, 0.7236211522059823, 0.84636169698281, 0.6668193231106957, 0.7609879330915198, 0.7299174937605444, 0.9879254633666138, 0.8780196601710866, 0.572441467873235], "episode_lengths": [15, 13, 15, 16, 16, 19, 13, 15, 14, 17, 20, 17, 14, 14, 21, 27, 39, 15, 14, 18, 13, 18, 23, 18, 16, 15, 15, 23, 14, 13, 15, 18, 19, 15, 14, 16, 19, 16, 19, 15, 13, 15, 22, 20, 17, 20, 16, 24, 15, 18, 16, 16, 17, 15, 22, 14, 15, 21, 14, 15, 15, 13, 15, 26, 13, 16, 18, 15, 21, 14, 22, 22, 27, 16, 17, 21, 27, 27, 17, 16, 16, 16, 16, 18, 15, 15, 14, 15, 18, 18, 15, 14, 19, 15, 15, 16, 15, 15, 16, 20, 23, 15, 19, 19, 20, 19, 14, 16, 21, 23, 18, 15, 21, 42, 16, 18, 14, 26, 20, 16, 23, 15, 18, 35, 24, 20, 22, 13, 18, 20, 21, 18, 14, 23, 21, 15, 15, 17, 19, 14, 20, 24, 17, 19, 16, 18, 15, 15, 17, 15, 22, 14, 16, 16, 16, 15, 15, 22, 19, 16, 62, 15, 24, 14, 17, 18, 80, 14, 16, 16, 23, 15, 15, 23, 18, 16, 15, 17, 18, 16, 15, 16, 16, 14, 16, 14, 14, 22, 41, 20, 16, 20, 19, 17, 16, 15, 27, 18, 16, 17, 14, 14, 13, 15, 15, 14, 24, 16, 16, 23, 15, 15, 14, 20, 18, 16, 14, 14, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09597338774008544, "mean_inference_ms": 0.24375908209243327, "mean_action_processing_ms": 0.043951177477340335, "mean_env_wait_ms": 0.04709002664529026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001557776917061305, "StateBufferConnector_ms": 0.0012138662817271332, "ViewRequirementAgentConnector_ms": 0.028659546211974262}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1030.0323279990334, "num_env_steps_trained_throughput_per_sec": 1030.0323279990334, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3695.186, "sample_time_ms": 1781.204, "load_time_ms": 0.229, "load_throughput": 17474446.412, "learn_time_ms": 1912.728, "learn_throughput": 2091.254, "synch_weights_time_ms": 0.671}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 8686, "training_iteration": 72, "trial_id": "default", "date": "2024-05-22_22-19-20", "timestamp": 1716409160, "time_this_iter_s": 3.8874738216400146, "time_total_s": 259.9437644481659, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.9437644481659, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 23.150000000000002, "ram_util_percent": 61.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.156035791033058, "cur_kl_coeff": 0.0375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02982910567073412, "policy_loss": -0.012648144312283045, "vf_loss": 0.041791707092535595, "vf_explained_var": 0.5364186020307643, "kl": 0.01828115140493577, "entropy": 0.8220106156282527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 0.999818814150788, "episode_reward_min": -1.0, "episode_reward_mean": 0.7011036942256172, "episode_len_mean": 18.84433962264151, "episode_media": {}, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5764450836627459, 0.878171359866385, 0.5397875953327154, 0.9733033687376562, 0.5869840626560215, 0.9319511848766966, 0.8700373428055304, 0.7920237701968861, 0.5, 0.9310634006219474, 0.9994485616289944, 0.9129259312970227, 0.8324570973739766, 0.9876872580450836, -1.0, 0.5058184236946206, 0.6269186761140566, 0.927383887795775, 0.8602170552246684, 0.7372806917732552, 0.5, 0.8195780080961659, 0.7343327132616921, 0.9259846609313309, 0.7617874819259932, 0.822204598558416, 0.816393110250477, 0.8680655684251087, 0.6066892758967128, 0.9467704925567111, 0.5, 0.5, 0.8282814823992569, 0.9148788860740674, 0.6024952243843833, 0.7775561693311167, 0.5, 0.5, 0.9773536394626005, 0.863506661471279, 0.9485321176514533, -1.0, 0.8548836473582055, 0.6780331590588666, 0.7660264225254403, 0.5, -1.0, 0.8023778348042957, 0.5830021106027852, 0.9642301821098908, 0.9261877050130113, 0.5391103683504963, 0.9976554104872227, 0.5, 0.8101664398842457, 0.9064143837099277, 0.8954294056194914, 0.8361457028429695, 0.5, 0.8040232788835744, 0.8922372208199548, 0.611280766039767, 0.9175782802733577, 0.7751201635588243, 0.9791183749832929, 0.5, 0.8387937530511631, 0.7395579266633765, -1.0, 0.5657891720788413, 0.5937917078658914, 0.8545063274436036, 0.9310758462193477, 0.8755895574187019, 0.5196956667922803, 0.904778835865056, 0.7885528908928571, 0.9825488094909658, 0.9291693182690866, 0.7445204569111354, 0.990018792997798, 0.6683726096279413, 0.9720758537307721, 0.8959408678184723, 0.9618608200773365, 0.9425372710352387, 0.9198385206712552, 0.5, 0.5, 0.999818814150788, 0.9603653782915154, 0.9963710943035747, 0.7623763434126709, 0.7728711474152802, 0.980841617615617, 0.8825608590760239, 0.9486506417634702, 0.6738358303974761, -1.0, 0.5, 0.8968587229236883, 0.5510322506689544, 0.5015509130162756, 0.8962413996129244, 0.9458408195358327, 0.8091800665060376, 0.9805459160256826, 0.7820228498481959, 0.9113425384406556, 0.7028075489561573, 0.6313511319636076, 0.8625717848783461, 0.5952432038886631, 0.8431078797568322, 0.9034677705640168, 0.9787273553841371, 0.9351103858887575, 0.721033797478217, 0.5, 0.7857889952532389, 0.5, 0.8697508565055765, 0.5849223522331559, 0.9578276632506959, 0.8852848775077891, 0.8910659338464848, 0.9220712279793375, 0.8404645597308484, 0.7503625098083253, 0.8425131029010684, 0.7735463811289598, 0.9686638872454604, 0.9246272958095259, 0.9809243370748816, 0.9748236033906031, 0.9656133601747877, 0.9483997718571012, 0.7096817931620634, 0.8642167783243733, 0.5302869425705594, 0.6286901439062123, 0.6147496169626867, -1.0, 0.6542718348627439, 0.9806625706194416, 0.8607251630869333, 0.9695024948594156, 0.8576218243475924, 0.984836611530503, 0.6816056378147042, 0.9786634457915355, 0.8987846239663838, 0.7236551211036858, 0.9170119079011221, 0.8800801936380588, 0.8967899480611982, 0.9876216489094781, 0.6533008173726291, 0.9134215111588229, 0.7495597302872872, 0.5444453099696949, -1.0, 0.9021285393796754, 0.6962605560931281, 0.7209142451190408, 0.8846395142987465, 0.9846762683293422, 0.9798239342951951, 0.9288226975050827, 0.9071571050948319, 0.8826510439551076, 0.7537330255694704, 0.5700813011251916, 0.5547808258430367, -1.0, 0.640725981902875, 0.8183601388985553, 0.8648154758347403, 0.5162269788721806, 0.5427426649555849, 0.887047393475823, 0.992272461536263, 0.6034114187283748, 0.8413154060351271, -1.0, 0.9947766059993903, 0.8461617101559578, 0.9398802279483486, 0.8723626768557442, 0.9924149231471159, 0.5222629765915201, 0.9200839326169432, 0.6365649820231434, 0.5084362354860461, 0.6316865892796104, -1.0, 0.5240731772614531, 0.9995941003896869, 0.9898376714393043, 0.8125584455099132, 0.7851646858909276, 0.9602868801517459, 0.5, 0.6317312947398599, 0.7321178285891836, 0.5, 0.7633169700357023, 0.9609351652096135, 0.5222339677663733, 0.5], "episode_lengths": [23, 23, 20, 16, 19, 16, 17, 16, 14, 14, 20, 16, 13, 13, 16, 13, 23, 38, 21, 14, 16, 14, 42, 18, 17, 15, 17, 19, 17, 14, 17, 14, 24, 29, 17, 16, 20, 15, 27, 37, 16, 15, 13, 56, 15, 15, 16, 29, 22, 15, 20, 16, 15, 20, 14, 19, 19, 14, 16, 15, 22, 17, 13, 33, 14, 14, 13, 24, 15, 16, 12, 17, 19, 14, 14, 15, 23, 14, 17, 13, 14, 17, 13, 20, 14, 17, 15, 15, 15, 24, 18, 14, 15, 13, 17, 17, 14, 18, 17, 17, 20, 26, 15, 17, 19, 13, 14, 21, 15, 18, 16, 15, 17, 15, 15, 17, 16, 15, 15, 23, 21, 15, 26, 14, 21, 15, 16, 15, 15, 16, 14, 14, 19, 17, 14, 15, 13, 15, 15, 21, 15, 36, 23, 17, 80, 21, 15, 19, 14, 15, 15, 16, 16, 16, 15, 14, 17, 15, 16, 17, 15, 20, 25, 80, 14, 16, 19, 13, 14, 14, 15, 18, 17, 14, 17, 53, 80, 20, 21, 14, 22, 26, 17, 15, 20, 16, 31, 14, 15, 14, 13, 13, 24, 17, 19, 26, 22, 15, 26, 13, 15, 15, 15, 14, 24, 23, 18, 21, 14, 13, 19, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09607119596837196, "mean_inference_ms": 0.2437689937620412, "mean_action_processing_ms": 0.04395312613593981, "mean_env_wait_ms": 0.047097168932349685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015582678452977594, "StateBufferConnector_ms": 0.0012329164540992592, "ViewRequirementAgentConnector_ms": 0.028538029148893536}}, "episode_reward_max": 0.999818814150788, "episode_reward_min": -1.0, "episode_reward_mean": 0.7011036942256172, "episode_len_mean": 18.84433962264151, "episodes_this_iter": 212, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5764450836627459, 0.878171359866385, 0.5397875953327154, 0.9733033687376562, 0.5869840626560215, 0.9319511848766966, 0.8700373428055304, 0.7920237701968861, 0.5, 0.9310634006219474, 0.9994485616289944, 0.9129259312970227, 0.8324570973739766, 0.9876872580450836, -1.0, 0.5058184236946206, 0.6269186761140566, 0.927383887795775, 0.8602170552246684, 0.7372806917732552, 0.5, 0.8195780080961659, 0.7343327132616921, 0.9259846609313309, 0.7617874819259932, 0.822204598558416, 0.816393110250477, 0.8680655684251087, 0.6066892758967128, 0.9467704925567111, 0.5, 0.5, 0.8282814823992569, 0.9148788860740674, 0.6024952243843833, 0.7775561693311167, 0.5, 0.5, 0.9773536394626005, 0.863506661471279, 0.9485321176514533, -1.0, 0.8548836473582055, 0.6780331590588666, 0.7660264225254403, 0.5, -1.0, 0.8023778348042957, 0.5830021106027852, 0.9642301821098908, 0.9261877050130113, 0.5391103683504963, 0.9976554104872227, 0.5, 0.8101664398842457, 0.9064143837099277, 0.8954294056194914, 0.8361457028429695, 0.5, 0.8040232788835744, 0.8922372208199548, 0.611280766039767, 0.9175782802733577, 0.7751201635588243, 0.9791183749832929, 0.5, 0.8387937530511631, 0.7395579266633765, -1.0, 0.5657891720788413, 0.5937917078658914, 0.8545063274436036, 0.9310758462193477, 0.8755895574187019, 0.5196956667922803, 0.904778835865056, 0.7885528908928571, 0.9825488094909658, 0.9291693182690866, 0.7445204569111354, 0.990018792997798, 0.6683726096279413, 0.9720758537307721, 0.8959408678184723, 0.9618608200773365, 0.9425372710352387, 0.9198385206712552, 0.5, 0.5, 0.999818814150788, 0.9603653782915154, 0.9963710943035747, 0.7623763434126709, 0.7728711474152802, 0.980841617615617, 0.8825608590760239, 0.9486506417634702, 0.6738358303974761, -1.0, 0.5, 0.8968587229236883, 0.5510322506689544, 0.5015509130162756, 0.8962413996129244, 0.9458408195358327, 0.8091800665060376, 0.9805459160256826, 0.7820228498481959, 0.9113425384406556, 0.7028075489561573, 0.6313511319636076, 0.8625717848783461, 0.5952432038886631, 0.8431078797568322, 0.9034677705640168, 0.9787273553841371, 0.9351103858887575, 0.721033797478217, 0.5, 0.7857889952532389, 0.5, 0.8697508565055765, 0.5849223522331559, 0.9578276632506959, 0.8852848775077891, 0.8910659338464848, 0.9220712279793375, 0.8404645597308484, 0.7503625098083253, 0.8425131029010684, 0.7735463811289598, 0.9686638872454604, 0.9246272958095259, 0.9809243370748816, 0.9748236033906031, 0.9656133601747877, 0.9483997718571012, 0.7096817931620634, 0.8642167783243733, 0.5302869425705594, 0.6286901439062123, 0.6147496169626867, -1.0, 0.6542718348627439, 0.9806625706194416, 0.8607251630869333, 0.9695024948594156, 0.8576218243475924, 0.984836611530503, 0.6816056378147042, 0.9786634457915355, 0.8987846239663838, 0.7236551211036858, 0.9170119079011221, 0.8800801936380588, 0.8967899480611982, 0.9876216489094781, 0.6533008173726291, 0.9134215111588229, 0.7495597302872872, 0.5444453099696949, -1.0, 0.9021285393796754, 0.6962605560931281, 0.7209142451190408, 0.8846395142987465, 0.9846762683293422, 0.9798239342951951, 0.9288226975050827, 0.9071571050948319, 0.8826510439551076, 0.7537330255694704, 0.5700813011251916, 0.5547808258430367, -1.0, 0.640725981902875, 0.8183601388985553, 0.8648154758347403, 0.5162269788721806, 0.5427426649555849, 0.887047393475823, 0.992272461536263, 0.6034114187283748, 0.8413154060351271, -1.0, 0.9947766059993903, 0.8461617101559578, 0.9398802279483486, 0.8723626768557442, 0.9924149231471159, 0.5222629765915201, 0.9200839326169432, 0.6365649820231434, 0.5084362354860461, 0.6316865892796104, -1.0, 0.5240731772614531, 0.9995941003896869, 0.9898376714393043, 0.8125584455099132, 0.7851646858909276, 0.9602868801517459, 0.5, 0.6317312947398599, 0.7321178285891836, 0.5, 0.7633169700357023, 0.9609351652096135, 0.5222339677663733, 0.5], "episode_lengths": [23, 23, 20, 16, 19, 16, 17, 16, 14, 14, 20, 16, 13, 13, 16, 13, 23, 38, 21, 14, 16, 14, 42, 18, 17, 15, 17, 19, 17, 14, 17, 14, 24, 29, 17, 16, 20, 15, 27, 37, 16, 15, 13, 56, 15, 15, 16, 29, 22, 15, 20, 16, 15, 20, 14, 19, 19, 14, 16, 15, 22, 17, 13, 33, 14, 14, 13, 24, 15, 16, 12, 17, 19, 14, 14, 15, 23, 14, 17, 13, 14, 17, 13, 20, 14, 17, 15, 15, 15, 24, 18, 14, 15, 13, 17, 17, 14, 18, 17, 17, 20, 26, 15, 17, 19, 13, 14, 21, 15, 18, 16, 15, 17, 15, 15, 17, 16, 15, 15, 23, 21, 15, 26, 14, 21, 15, 16, 15, 15, 16, 14, 14, 19, 17, 14, 15, 13, 15, 15, 21, 15, 36, 23, 17, 80, 21, 15, 19, 14, 15, 15, 16, 16, 16, 15, 14, 17, 15, 16, 17, 15, 20, 25, 80, 14, 16, 19, 13, 14, 14, 15, 18, 17, 14, 17, 53, 80, 20, 21, 14, 22, 26, 17, 15, 20, 16, 31, 14, 15, 14, 13, 13, 24, 17, 19, 26, 22, 15, 26, 13, 15, 15, 15, 14, 24, 23, 18, 21, 14, 13, 19, 29]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09607119596837196, "mean_inference_ms": 0.2437689937620412, "mean_action_processing_ms": 0.04395312613593981, "mean_env_wait_ms": 0.047097168932349685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015582678452977594, "StateBufferConnector_ms": 0.0012329164540992592, "ViewRequirementAgentConnector_ms": 0.028538029148893536}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1109.339810801711, "num_env_steps_trained_throughput_per_sec": 1109.339810801711, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 3690.347, "sample_time_ms": 1780.728, "load_time_ms": 0.227, "load_throughput": 17612026.034, "learn_time_ms": 1908.358, "learn_throughput": 2096.043, "synch_weights_time_ms": 0.678}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 8898, "training_iteration": 73, "trial_id": "default", "date": "2024-05-22_22-19-24", "timestamp": 1716409164, "time_this_iter_s": 3.6096909046173096, "time_total_s": 263.5534553527832, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 263.5534553527832, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 27.919999999999998, "ram_util_percent": 61.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0996922411905823, "cur_kl_coeff": 0.0375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.023827555629810298, "policy_loss": -0.01436837139108809, "vf_loss": 0.03731645119904731, "vf_explained_var": 0.5522872504367623, "kl": 0.023452686017000058, "entropy": 0.6816689051607604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 0.999335717298866, "episode_reward_min": -1.0, "episode_reward_mean": 0.7597904743274628, "episode_len_mean": 17.080851063829787, "episode_media": {}, "episodes_this_iter": 235, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7728780766449354, 0.7363471322840456, 0.8250135501711359, 0.9312791447664626, 0.9160158180590383, 0.9647159278010348, 0.6530864076842677, 0.9417830453251536, 0.9480708110234377, 0.853094372293155, 0.8947610420966051, 0.8822189315937322, 0.8962187143062852, 0.9909616675429764, 0.9976680998666345, -1.0, 0.9594826497193445, 0.5968472302595459, 0.6934942823211669, 0.960153620604059, 0.5, 0.6737157886120688, 0.9230683631056501, 0.5893699679122121, 0.9487686749166928, 0.8952620900044017, 0.9677685869570974, -1.0, 0.9110486823021237, 0.9941967717451323, 0.9919467709856423, 0.754389866679109, 0.7021138098908727, 0.9719393487347675, 0.9706460719737238, 0.9583250694751775, 0.7194869017673422, -1.0, 0.9055998246931766, 0.5, 0.5, 0.8232770099592139, 0.8489445345802061, 0.5497121395902651, 0.5488587248121405, 0.7748808516256223, 0.947333423780362, 0.6261564919399909, 0.9632462311115672, 0.8952473868602814, 0.9454079938812829, 0.8098208788149431, 0.5367128440213635, 0.9671522634522101, 0.9653035069165055, 0.5, 0.7657091622274522, 0.7470016770335899, 0.7862993053649528, 0.8880886324875996, 0.5, 0.5300478127528527, 0.8219459536753986, 0.9002588411611602, 0.7122720525829547, 0.8119054356422772, 0.5268367279740729, 0.7135969351050022, 0.998063898319473, 0.5724776850795845, 0.987594979645468, 0.8517363233768225, 0.8073214073741669, 0.9097301444816092, 0.5101683036183737, 0.8921344042963759, 0.6018121632479397, 0.7128060530836142, 0.9386045277467945, 0.8023574903552064, 0.8215623371578372, 0.9415753252247543, 0.5464154050700084, 0.5, 0.8689359488425622, 0.9655626633043337, 0.6043157858074344, 0.7776112700441422, 0.5, 0.594789850929808, 0.6242264251335701, 0.869977110844671, 0.9881028178789878, 0.5, 0.998130667456439, 0.9927549746541566, 0.9330363315656508, 0.9982722236154753, 0.9161620140813833, 0.6121201522011479, 0.9555851901530447, 0.9220199358020037, 0.7399520139698661, 0.999335717298866, 0.7155103130939178, 0.5025353532279303, 0.9781335789298125, 0.5179054716170848, 0.8811971667617897, 0.9483541354083495, 0.7603840710053607, 0.8032571383428522, 0.9689388212019324, 0.7868584725212585, 0.7605551805234908, 0.8825097591673225, 0.7662105628799745, 0.7077564154801343, 0.5, 0.9292054934379175, 0.944027842681039, 0.8481734644828816, 0.5, 0.8301041876111868, 0.5, 0.945958397935264, 0.6712136544950348, 0.8771553834704567, 0.8850840047882907, 0.8804105184287466, 0.881792796473815, 0.6317839088411648, 0.7257610270993999, 0.8249299320506459, 0.9629425611164698, 0.9185730670241564, 0.6715142871971103, 0.882038323741894, 0.7889403369323071, 0.8484912217623628, 0.6977044903413433, 0.6735098915512683, 0.8512113489271371, 0.5, 0.9442778258173716, 0.9397217197745754, 0.9983090767123647, 0.8418935762949397, 0.9563731170330985, 0.8074447734823389, 0.5, 0.6975080702787134, 0.8421505869456127, 0.7977201088594804, 0.7808441621452419, 0.9655677272579916, 0.9794747882408694, 0.8823291584944873, 0.7284623752097086, 0.8379834966806543, 0.6993559872734627, 0.5, -1.0, 0.9609383565596675, -1.0, 0.8897827843402345, 0.934472983664512, 0.9618643627209477, 0.9324452887709413, 0.9476955576724597, 0.542387023593089, 0.8937244947962304, 0.861302391477666, 0.6219371087451038, 0.7819425047129336, 0.8262269575579438, 0.5503480546267072, 0.7034034963631548, 0.9906727163232659, 0.9362779898074755, 0.5134271618644966, 0.9767368308038754, 0.8745519612380611, 0.5, 0.9433885809423078, 0.5262246135983176, 0.97579271781021, 0.770199707434591, 0.9101441481274722, 0.8340745714059016, 0.9205096782641576, 0.5038722981224558, 0.9523146129642871, 0.9837325185443561, 0.5, 0.5, 0.7685796587817764, 0.9757515651186055, 0.7962627984657493, 0.6220614050175336, 0.9667944618734738, 0.5872723260795214, 0.9966525909711688, 0.9872842437452548, 0.8562649735727121, 0.739729192203863, 0.5585285484723435, 0.980257940914308, 0.8555059437315167, 0.5, 0.9232754308554316, 0.8566672276666248, 0.5, 0.9029808054916043, 0.9142709187980639, 0.8113194099096092, 0.8280648554914638, 0.5449661935531702, 0.7887175157599877, 0.9212807379063489, 0.7831160773442267, 0.8947847463240606, 0.8267074974187043, 0.903252327437213, 0.5, 0.6039967768058793, 0.893205205866791, 0.7330164827974632, 0.9332182976281955, 0.5, 0.8747024349411223, 0.9697594523984437, 0.8446548403010687, 0.8806129446055861, 0.9037995616670053], "episode_lengths": [18, 16, 15, 15, 15, 17, 19, 15, 14, 16, 14, 14, 15, 14, 13, 26, 15, 17, 18, 14, 21, 17, 14, 23, 14, 15, 14, 15, 17, 13, 13, 15, 18, 14, 14, 14, 14, 16, 20, 23, 20, 21, 17, 26, 32, 15, 16, 15, 13, 16, 14, 17, 21, 15, 15, 18, 20, 19, 13, 14, 20, 17, 17, 13, 15, 19, 23, 14, 14, 25, 14, 15, 19, 14, 18, 14, 20, 20, 14, 18, 14, 15, 23, 24, 14, 15, 17, 16, 34, 16, 21, 14, 15, 34, 13, 16, 16, 13, 15, 19, 13, 14, 14, 14, 21, 22, 16, 23, 14, 13, 20, 19, 16, 18, 17, 13, 18, 19, 35, 14, 14, 13, 27, 17, 25, 15, 20, 15, 15, 13, 15, 15, 18, 14, 14, 15, 19, 13, 16, 17, 20, 18, 17, 23, 21, 14, 15, 14, 16, 15, 23, 15, 14, 15, 18, 14, 16, 14, 17, 16, 17, 23, 14, 14, 18, 14, 15, 14, 14, 16, 20, 14, 17, 15, 19, 15, 22, 17, 17, 14, 24, 13, 14, 32, 13, 24, 14, 18, 14, 17, 14, 22, 14, 14, 33, 34, 13, 14, 17, 24, 15, 19, 14, 18, 18, 16, 25, 16, 15, 16, 14, 14, 21, 14, 15, 17, 14, 17, 24, 16, 15, 13, 17, 13, 25, 16, 16, 20, 15, 18, 14, 13, 14, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09619265435415755, "mean_inference_ms": 0.24378025975701076, "mean_action_processing_ms": 0.04395564475306257, "mean_env_wait_ms": 0.047110622318796494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015475902151554188, "StateBufferConnector_ms": 0.0012290224115899268, "ViewRequirementAgentConnector_ms": 0.028580604715550198}}, "episode_reward_max": 0.999335717298866, "episode_reward_min": -1.0, "episode_reward_mean": 0.7597904743274628, "episode_len_mean": 17.080851063829787, "episodes_this_iter": 235, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7728780766449354, 0.7363471322840456, 0.8250135501711359, 0.9312791447664626, 0.9160158180590383, 0.9647159278010348, 0.6530864076842677, 0.9417830453251536, 0.9480708110234377, 0.853094372293155, 0.8947610420966051, 0.8822189315937322, 0.8962187143062852, 0.9909616675429764, 0.9976680998666345, -1.0, 0.9594826497193445, 0.5968472302595459, 0.6934942823211669, 0.960153620604059, 0.5, 0.6737157886120688, 0.9230683631056501, 0.5893699679122121, 0.9487686749166928, 0.8952620900044017, 0.9677685869570974, -1.0, 0.9110486823021237, 0.9941967717451323, 0.9919467709856423, 0.754389866679109, 0.7021138098908727, 0.9719393487347675, 0.9706460719737238, 0.9583250694751775, 0.7194869017673422, -1.0, 0.9055998246931766, 0.5, 0.5, 0.8232770099592139, 0.8489445345802061, 0.5497121395902651, 0.5488587248121405, 0.7748808516256223, 0.947333423780362, 0.6261564919399909, 0.9632462311115672, 0.8952473868602814, 0.9454079938812829, 0.8098208788149431, 0.5367128440213635, 0.9671522634522101, 0.9653035069165055, 0.5, 0.7657091622274522, 0.7470016770335899, 0.7862993053649528, 0.8880886324875996, 0.5, 0.5300478127528527, 0.8219459536753986, 0.9002588411611602, 0.7122720525829547, 0.8119054356422772, 0.5268367279740729, 0.7135969351050022, 0.998063898319473, 0.5724776850795845, 0.987594979645468, 0.8517363233768225, 0.8073214073741669, 0.9097301444816092, 0.5101683036183737, 0.8921344042963759, 0.6018121632479397, 0.7128060530836142, 0.9386045277467945, 0.8023574903552064, 0.8215623371578372, 0.9415753252247543, 0.5464154050700084, 0.5, 0.8689359488425622, 0.9655626633043337, 0.6043157858074344, 0.7776112700441422, 0.5, 0.594789850929808, 0.6242264251335701, 0.869977110844671, 0.9881028178789878, 0.5, 0.998130667456439, 0.9927549746541566, 0.9330363315656508, 0.9982722236154753, 0.9161620140813833, 0.6121201522011479, 0.9555851901530447, 0.9220199358020037, 0.7399520139698661, 0.999335717298866, 0.7155103130939178, 0.5025353532279303, 0.9781335789298125, 0.5179054716170848, 0.8811971667617897, 0.9483541354083495, 0.7603840710053607, 0.8032571383428522, 0.9689388212019324, 0.7868584725212585, 0.7605551805234908, 0.8825097591673225, 0.7662105628799745, 0.7077564154801343, 0.5, 0.9292054934379175, 0.944027842681039, 0.8481734644828816, 0.5, 0.8301041876111868, 0.5, 0.945958397935264, 0.6712136544950348, 0.8771553834704567, 0.8850840047882907, 0.8804105184287466, 0.881792796473815, 0.6317839088411648, 0.7257610270993999, 0.8249299320506459, 0.9629425611164698, 0.9185730670241564, 0.6715142871971103, 0.882038323741894, 0.7889403369323071, 0.8484912217623628, 0.6977044903413433, 0.6735098915512683, 0.8512113489271371, 0.5, 0.9442778258173716, 0.9397217197745754, 0.9983090767123647, 0.8418935762949397, 0.9563731170330985, 0.8074447734823389, 0.5, 0.6975080702787134, 0.8421505869456127, 0.7977201088594804, 0.7808441621452419, 0.9655677272579916, 0.9794747882408694, 0.8823291584944873, 0.7284623752097086, 0.8379834966806543, 0.6993559872734627, 0.5, -1.0, 0.9609383565596675, -1.0, 0.8897827843402345, 0.934472983664512, 0.9618643627209477, 0.9324452887709413, 0.9476955576724597, 0.542387023593089, 0.8937244947962304, 0.861302391477666, 0.6219371087451038, 0.7819425047129336, 0.8262269575579438, 0.5503480546267072, 0.7034034963631548, 0.9906727163232659, 0.9362779898074755, 0.5134271618644966, 0.9767368308038754, 0.8745519612380611, 0.5, 0.9433885809423078, 0.5262246135983176, 0.97579271781021, 0.770199707434591, 0.9101441481274722, 0.8340745714059016, 0.9205096782641576, 0.5038722981224558, 0.9523146129642871, 0.9837325185443561, 0.5, 0.5, 0.7685796587817764, 0.9757515651186055, 0.7962627984657493, 0.6220614050175336, 0.9667944618734738, 0.5872723260795214, 0.9966525909711688, 0.9872842437452548, 0.8562649735727121, 0.739729192203863, 0.5585285484723435, 0.980257940914308, 0.8555059437315167, 0.5, 0.9232754308554316, 0.8566672276666248, 0.5, 0.9029808054916043, 0.9142709187980639, 0.8113194099096092, 0.8280648554914638, 0.5449661935531702, 0.7887175157599877, 0.9212807379063489, 0.7831160773442267, 0.8947847463240606, 0.8267074974187043, 0.903252327437213, 0.5, 0.6039967768058793, 0.893205205866791, 0.7330164827974632, 0.9332182976281955, 0.5, 0.8747024349411223, 0.9697594523984437, 0.8446548403010687, 0.8806129446055861, 0.9037995616670053], "episode_lengths": [18, 16, 15, 15, 15, 17, 19, 15, 14, 16, 14, 14, 15, 14, 13, 26, 15, 17, 18, 14, 21, 17, 14, 23, 14, 15, 14, 15, 17, 13, 13, 15, 18, 14, 14, 14, 14, 16, 20, 23, 20, 21, 17, 26, 32, 15, 16, 15, 13, 16, 14, 17, 21, 15, 15, 18, 20, 19, 13, 14, 20, 17, 17, 13, 15, 19, 23, 14, 14, 25, 14, 15, 19, 14, 18, 14, 20, 20, 14, 18, 14, 15, 23, 24, 14, 15, 17, 16, 34, 16, 21, 14, 15, 34, 13, 16, 16, 13, 15, 19, 13, 14, 14, 14, 21, 22, 16, 23, 14, 13, 20, 19, 16, 18, 17, 13, 18, 19, 35, 14, 14, 13, 27, 17, 25, 15, 20, 15, 15, 13, 15, 15, 18, 14, 14, 15, 19, 13, 16, 17, 20, 18, 17, 23, 21, 14, 15, 14, 16, 15, 23, 15, 14, 15, 18, 14, 16, 14, 17, 16, 17, 23, 14, 14, 18, 14, 15, 14, 14, 16, 20, 14, 17, 15, 19, 15, 22, 17, 17, 14, 24, 13, 14, 32, 13, 24, 14, 18, 14, 17, 14, 22, 14, 14, 33, 34, 13, 14, 17, 24, 15, 19, 14, 18, 18, 16, 25, 16, 15, 16, 14, 14, 21, 14, 15, 17, 14, 17, 24, 16, 15, 13, 17, 13, 25, 16, 16, 20, 15, 18, 14, 13, 14, 15, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09619265435415755, "mean_inference_ms": 0.24378025975701076, "mean_action_processing_ms": 0.04395564475306257, "mean_env_wait_ms": 0.047110622318796494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015475902151554188, "StateBufferConnector_ms": 0.0012290224115899268, "ViewRequirementAgentConnector_ms": 0.028580604715550198}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1104.462201572915, "num_env_steps_trained_throughput_per_sec": 1104.462201572915, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 3674.284, "sample_time_ms": 1779.505, "load_time_ms": 0.224, "load_throughput": 17823452.672, "learn_time_ms": 1893.533, "learn_throughput": 2112.454, "synch_weights_time_ms": 0.67}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 9133, "training_iteration": 74, "trial_id": "default", "date": "2024-05-22_22-19-27", "timestamp": 1716409167, "time_this_iter_s": 3.6261401176452637, "time_total_s": 267.17959547042847, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 267.17959547042847, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 26.02, "ram_util_percent": 61.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.901010932717272, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.028586462552669226, "policy_loss": -0.005200798607241082, "vf_loss": 0.03303980928600355, "vf_explained_var": 0.584849343633139, "kl": 0.013288035835152137, "entropy": 0.6757097469222161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 0.9974005954799419, "episode_reward_min": -1.0, "episode_reward_mean": 0.7536508216651557, "episode_len_mean": 17.145922746781117, "episode_media": {}, "episodes_this_iter": 233, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.868094707568811, 0.7228005441136541, 0.975170670435495, 0.516047637032734, 0.9417366433002282, 0.6380153327061517, 0.6679189394719527, 0.9496219553965886, 0.8167109336749455, 0.5293938654301872, 0.6250107442321664, 0.7509453476671983, 0.9904304346351521, 0.652334031725332, 0.7700428560591128, 0.971413785005767, 0.9422412765687711, 0.6680983057427363, 0.9270943445989794, 0.5, 0.9108467669240818, 0.5512262593899343, 0.7275272753771229, 0.8906606978826603, 0.5916549280114293, 0.929637762028618, 0.9815609872903251, 0.9145614748449209, 0.8109082088678105, 0.9868880789205331, 0.7290114239089572, 0.8565286995888588, 0.6546968182757393, 0.7656789366319081, 0.8954713793782159, 0.9893314024310106, 0.9581095824771674, 0.9750553774261502, -1.0, 0.5, 0.6821298518770684, 0.889911484867503, 0.8559625578207943, 0.9974005954799419, 0.9099813552365366, 0.8632838504937763, 0.9524308577725688, 0.5491245915754333, 0.9799816298822621, 0.9130062016457834, 0.9859459583641053, 0.9613120232340702, 0.5735289438715501, 0.5482726556061213, 0.9952717814846248, 0.6808393243228019, 0.7429997307981888, 0.7226339042590885, 0.8448414581145128, 0.7292186842008346, 0.7573804365992094, 0.9111293246476799, 0.99463786917172, 0.9967247977080534, 0.8826890772110273, 0.5104052323747468, 0.674108212235933, 0.9266200300265284, -1.0, 0.9512922074478458, 0.5, 0.9537345333178939, 0.8509999429199679, 0.8638184702365367, 0.7557753662764144, 0.6807710898124342, 0.6067393083649474, 0.6237082316223894, 0.9878941018411058, 0.8266869381138564, 0.9059595735342195, 0.5, 0.9413877974821463, 0.5166710755078707, 0.5, 0.9051909911607011, 0.8743740957565966, 0.5, 0.9552605311496717, 0.8497499147897694, 0.9609165267978984, 0.6278501340608416, 0.7936101916398356, 0.8520004828391461, 0.7776726895357977, 0.5, 0.9310096225638352, 0.9718344581300629, 0.978137225353729, 0.9048250713501864, 0.6334427564237608, 0.9867471422757542, 0.8898480992961483, 0.6195626166652619, 0.8226142421671458, 0.6588616439407732, 0.9648315827748084, 0.904749545513406, 0.9197198999395546, 0.9945642350529205, 0.9232659381159715, 0.5, 0.6107482223271101, 0.5527522044983688, 0.8703775587730835, 0.6453426512924925, 0.9112756492256291, 0.5, 0.5, 0.561484989063975, 0.9218200989638062, 0.8690290949883124, 0.8124961888563729, 0.9778807598264676, 0.5, 0.9405888741433676, 0.8554392217253595, 0.9716688174165533, 0.950066958320372, 0.8196140073812754, 0.8306932813469149, 0.9442825110652694, 0.7721819446206375, 0.8862996557988444, 0.8552801282628117, 0.5132505218592653, 0.9373337456010936, -1.0, -1.0, 0.8441061028998139, 0.9689156994607041, 0.8877210110641969, 0.745387176614603, 0.8985577592075918, 0.9179820680226854, 0.9633672239148711, 0.7058102822675605, 0.9720210123638249, 0.9566465937099371, 0.9063691703429362, 0.5, 0.8149924865766259, 0.9308461835041257, 0.8339854154052435, 0.7145135970768729, 0.992128714530128, 0.9082536609203804, 0.9005711291155449, 0.6668491806681514, 0.5090605576172633, 0.8625692978091726, 0.9625261185069776, 0.8803249315002433, -1.0, 0.8623849476484634, 0.5576756569095462, 0.9617536247579831, 0.9651798710313615, 0.7120996040385881, 0.9641137139882213, 0.8247821053459327, 0.5407158339538174, 0.9139003920874254, 0.9519311347818715, 0.5396460478322935, 0.7899909428100853, 0.6789065271179399, 0.5187370109541629, 0.5100928851148039, 0.9200779633022846, -1.0, 0.5863604416812336, 0.5, 0.9650540675931801, 0.8577586557530206, 0.8231171796619693, 0.9405435430646003, 0.661676733352709, 0.9106263982610456, 0.9605042029264071, 0.792194104953133, 0.9317960174201058, 0.7829145158498696, 0.8263894695785988, 0.8281589082513409, 0.8142058361129478, 0.6863793814189185, 0.8549167243336036, 0.8708078788988791, 0.9451596357361862, 0.9668882048448162, 0.8090730087712729, 0.556349247782282, 0.6242882861175553, 0.9909163136902706, 0.966497167094343, 0.6763722632580914, 0.5, 0.7520014089402489, 0.5822929326500028, 0.7820714690187557, 0.886087121988537, 0.5, 0.9965414981797192, 0.5250199564127733, 0.9905168780908385, 0.5739103706513655, 0.9333597222442679, 0.8814425583094436, 0.9838166723715372, 0.8633111024520808, 0.9132163529323446, 0.6394884455320129, 0.7835992872230141, 0.8049098944416204, 0.9310505639229326, 0.9725471940817617, 0.7581788445430676, 0.9041685133132185, 0.5111962131358142, 0.6371620583342954, 0.8494374811131251, 0.8106368918854191], "episode_lengths": [13, 15, 14, 18, 14, 16, 17, 15, 14, 22, 19, 14, 14, 21, 15, 14, 13, 18, 14, 22, 14, 19, 18, 15, 17, 14, 16, 14, 16, 15, 19, 14, 16, 15, 14, 15, 14, 13, 15, 19, 17, 13, 13, 14, 17, 14, 16, 23, 14, 14, 16, 14, 21, 16, 15, 23, 19, 24, 15, 16, 17, 15, 13, 14, 14, 23, 18, 14, 13, 14, 27, 14, 14, 15, 17, 16, 23, 26, 14, 14, 15, 32, 14, 17, 21, 14, 16, 22, 14, 18, 14, 14, 17, 16, 18, 42, 14, 16, 14, 14, 23, 15, 15, 25, 18, 15, 14, 16, 16, 13, 14, 27, 19, 15, 13, 16, 14, 17, 46, 21, 16, 14, 16, 15, 19, 14, 15, 15, 14, 17, 18, 20, 14, 15, 20, 42, 14, 21, 24, 15, 14, 17, 17, 14, 14, 15, 14, 13, 17, 15, 34, 19, 14, 16, 20, 15, 14, 14, 18, 25, 15, 16, 15, 16, 13, 19, 15, 14, 17, 14, 14, 19, 15, 15, 18, 15, 17, 35, 25, 16, 14, 21, 25, 13, 15, 15, 14, 30, 13, 16, 15, 16, 18, 19, 14, 16, 18, 14, 15, 14, 15, 18, 19, 20, 15, 14, 17, 26, 24, 17, 20, 14, 19, 14, 25, 14, 30, 15, 14, 13, 14, 14, 20, 18, 14, 16, 14, 16, 14, 24, 23, 14, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09633430079194458, "mean_inference_ms": 0.2438813146651796, "mean_action_processing_ms": 0.04397786104161065, "mean_env_wait_ms": 0.04714331489134294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015601579723440015, "StateBufferConnector_ms": 0.0012518510286388478, "ViewRequirementAgentConnector_ms": 0.02941021080180811}}, "episode_reward_max": 0.9974005954799419, "episode_reward_min": -1.0, "episode_reward_mean": 0.7536508216651557, "episode_len_mean": 17.145922746781117, "episodes_this_iter": 233, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.868094707568811, 0.7228005441136541, 0.975170670435495, 0.516047637032734, 0.9417366433002282, 0.6380153327061517, 0.6679189394719527, 0.9496219553965886, 0.8167109336749455, 0.5293938654301872, 0.6250107442321664, 0.7509453476671983, 0.9904304346351521, 0.652334031725332, 0.7700428560591128, 0.971413785005767, 0.9422412765687711, 0.6680983057427363, 0.9270943445989794, 0.5, 0.9108467669240818, 0.5512262593899343, 0.7275272753771229, 0.8906606978826603, 0.5916549280114293, 0.929637762028618, 0.9815609872903251, 0.9145614748449209, 0.8109082088678105, 0.9868880789205331, 0.7290114239089572, 0.8565286995888588, 0.6546968182757393, 0.7656789366319081, 0.8954713793782159, 0.9893314024310106, 0.9581095824771674, 0.9750553774261502, -1.0, 0.5, 0.6821298518770684, 0.889911484867503, 0.8559625578207943, 0.9974005954799419, 0.9099813552365366, 0.8632838504937763, 0.9524308577725688, 0.5491245915754333, 0.9799816298822621, 0.9130062016457834, 0.9859459583641053, 0.9613120232340702, 0.5735289438715501, 0.5482726556061213, 0.9952717814846248, 0.6808393243228019, 0.7429997307981888, 0.7226339042590885, 0.8448414581145128, 0.7292186842008346, 0.7573804365992094, 0.9111293246476799, 0.99463786917172, 0.9967247977080534, 0.8826890772110273, 0.5104052323747468, 0.674108212235933, 0.9266200300265284, -1.0, 0.9512922074478458, 0.5, 0.9537345333178939, 0.8509999429199679, 0.8638184702365367, 0.7557753662764144, 0.6807710898124342, 0.6067393083649474, 0.6237082316223894, 0.9878941018411058, 0.8266869381138564, 0.9059595735342195, 0.5, 0.9413877974821463, 0.5166710755078707, 0.5, 0.9051909911607011, 0.8743740957565966, 0.5, 0.9552605311496717, 0.8497499147897694, 0.9609165267978984, 0.6278501340608416, 0.7936101916398356, 0.8520004828391461, 0.7776726895357977, 0.5, 0.9310096225638352, 0.9718344581300629, 0.978137225353729, 0.9048250713501864, 0.6334427564237608, 0.9867471422757542, 0.8898480992961483, 0.6195626166652619, 0.8226142421671458, 0.6588616439407732, 0.9648315827748084, 0.904749545513406, 0.9197198999395546, 0.9945642350529205, 0.9232659381159715, 0.5, 0.6107482223271101, 0.5527522044983688, 0.8703775587730835, 0.6453426512924925, 0.9112756492256291, 0.5, 0.5, 0.561484989063975, 0.9218200989638062, 0.8690290949883124, 0.8124961888563729, 0.9778807598264676, 0.5, 0.9405888741433676, 0.8554392217253595, 0.9716688174165533, 0.950066958320372, 0.8196140073812754, 0.8306932813469149, 0.9442825110652694, 0.7721819446206375, 0.8862996557988444, 0.8552801282628117, 0.5132505218592653, 0.9373337456010936, -1.0, -1.0, 0.8441061028998139, 0.9689156994607041, 0.8877210110641969, 0.745387176614603, 0.8985577592075918, 0.9179820680226854, 0.9633672239148711, 0.7058102822675605, 0.9720210123638249, 0.9566465937099371, 0.9063691703429362, 0.5, 0.8149924865766259, 0.9308461835041257, 0.8339854154052435, 0.7145135970768729, 0.992128714530128, 0.9082536609203804, 0.9005711291155449, 0.6668491806681514, 0.5090605576172633, 0.8625692978091726, 0.9625261185069776, 0.8803249315002433, -1.0, 0.8623849476484634, 0.5576756569095462, 0.9617536247579831, 0.9651798710313615, 0.7120996040385881, 0.9641137139882213, 0.8247821053459327, 0.5407158339538174, 0.9139003920874254, 0.9519311347818715, 0.5396460478322935, 0.7899909428100853, 0.6789065271179399, 0.5187370109541629, 0.5100928851148039, 0.9200779633022846, -1.0, 0.5863604416812336, 0.5, 0.9650540675931801, 0.8577586557530206, 0.8231171796619693, 0.9405435430646003, 0.661676733352709, 0.9106263982610456, 0.9605042029264071, 0.792194104953133, 0.9317960174201058, 0.7829145158498696, 0.8263894695785988, 0.8281589082513409, 0.8142058361129478, 0.6863793814189185, 0.8549167243336036, 0.8708078788988791, 0.9451596357361862, 0.9668882048448162, 0.8090730087712729, 0.556349247782282, 0.6242882861175553, 0.9909163136902706, 0.966497167094343, 0.6763722632580914, 0.5, 0.7520014089402489, 0.5822929326500028, 0.7820714690187557, 0.886087121988537, 0.5, 0.9965414981797192, 0.5250199564127733, 0.9905168780908385, 0.5739103706513655, 0.9333597222442679, 0.8814425583094436, 0.9838166723715372, 0.8633111024520808, 0.9132163529323446, 0.6394884455320129, 0.7835992872230141, 0.8049098944416204, 0.9310505639229326, 0.9725471940817617, 0.7581788445430676, 0.9041685133132185, 0.5111962131358142, 0.6371620583342954, 0.8494374811131251, 0.8106368918854191], "episode_lengths": [13, 15, 14, 18, 14, 16, 17, 15, 14, 22, 19, 14, 14, 21, 15, 14, 13, 18, 14, 22, 14, 19, 18, 15, 17, 14, 16, 14, 16, 15, 19, 14, 16, 15, 14, 15, 14, 13, 15, 19, 17, 13, 13, 14, 17, 14, 16, 23, 14, 14, 16, 14, 21, 16, 15, 23, 19, 24, 15, 16, 17, 15, 13, 14, 14, 23, 18, 14, 13, 14, 27, 14, 14, 15, 17, 16, 23, 26, 14, 14, 15, 32, 14, 17, 21, 14, 16, 22, 14, 18, 14, 14, 17, 16, 18, 42, 14, 16, 14, 14, 23, 15, 15, 25, 18, 15, 14, 16, 16, 13, 14, 27, 19, 15, 13, 16, 14, 17, 46, 21, 16, 14, 16, 15, 19, 14, 15, 15, 14, 17, 18, 20, 14, 15, 20, 42, 14, 21, 24, 15, 14, 17, 17, 14, 14, 15, 14, 13, 17, 15, 34, 19, 14, 16, 20, 15, 14, 14, 18, 25, 15, 16, 15, 16, 13, 19, 15, 14, 17, 14, 14, 19, 15, 15, 18, 15, 17, 35, 25, 16, 14, 21, 25, 13, 15, 15, 14, 30, 13, 16, 15, 16, 18, 19, 14, 16, 18, 14, 15, 14, 15, 18, 19, 20, 15, 14, 17, 26, 24, 17, 20, 14, 19, 14, 25, 14, 30, 15, 14, 13, 14, 14, 20, 18, 14, 16, 14, 16, 14, 24, 23, 14, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09633430079194458, "mean_inference_ms": 0.2438813146651796, "mean_action_processing_ms": 0.04397786104161065, "mean_env_wait_ms": 0.04714331489134294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015601579723440015, "StateBufferConnector_ms": 0.0012518510286388478, "ViewRequirementAgentConnector_ms": 0.02941021080180811}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1090.466119679212, "num_env_steps_trained_throughput_per_sec": 1090.466119679212, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 3674.551, "sample_time_ms": 1785.207, "load_time_ms": 0.21, "load_throughput": 19080195.61, "learn_time_ms": 1888.153, "learn_throughput": 2118.472, "synch_weights_time_ms": 0.645}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 9366, "training_iteration": 75, "trial_id": "default", "date": "2024-05-22_22-19-31", "timestamp": 1716409171, "time_this_iter_s": 3.6724298000335693, "time_total_s": 270.85202527046204, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 270.85202527046204, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 25.419999999999998, "ram_util_percent": 61.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.86481522885702, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0431075300444268, "policy_loss": -0.00731997013953264, "vf_loss": 0.04950830607214362, "vf_explained_var": 0.48128399432346386, "kl": 0.016341228870283928, "entropy": 0.5851658726571709, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 0.9996471503427188, "episode_reward_min": -1.0, "episode_reward_mean": 0.7445988871541751, "episode_len_mean": 17.48471615720524, "episode_media": {}, "episodes_this_iter": 229, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9373548389556672, 0.8770452010856554, 0.8895843008434654, 0.657657463119236, 0.8926864139888321, 0.6044140840218666, 0.9574860925918158, 0.5301718056512557, 0.550218645868078, 0.9517350443908432, 0.5080316867268357, 0.994239693307565, 0.6112263535323883, 0.9458793696355122, 0.8818917163882726, 0.5, 0.5089037302770241, 0.7862840577785897, -1.0, 0.8022570474292394, 0.9504210813544052, 0.7980007940348163, 0.9518312518039015, 0.9176074202638272, 0.9996471503427188, 0.9682528009084931, 0.9497018299535764, 0.9625538665497702, 0.7470023866739777, 0.9512393601747958, 0.5, 0.7122988233038543, 0.9537133783103195, 0.6446141725065241, 0.8972914245816301, 0.9953193366379064, 0.8699931138974069, 0.7716589421956399, 0.5471869665432865, 0.6250183378664833, 0.5, 0.9129962356894279, 0.9790674917481231, 0.9633164815107768, 0.5095451886141062, 0.5694759900301299, 0.9237381234960043, 0.8112746392294686, 0.6944306950814052, 0.6661057283203083, 0.9066778441735266, 0.8011105346616139, 0.5651680054296687, 0.956640281668959, 0.9784902481960667, 0.6459583481437348, 0.7599922195841604, 0.937658674944292, 0.8590705569451272, 0.5386141695598583, 0.9173212604864976, 0.8516561190178011, 0.5, 0.8158637579558918, -1.0, 0.8926944606939683, -1.0, 0.8882860096020603, 0.6400821918256616, 0.7693391765555533, 0.9844080886183831, 0.9771749007037699, 0.8785457927295433, 0.9418159103584314, 0.8855109186358378, 0.9954870566110364, 0.931305519571356, 0.8718611561440082, 0.5113830249817259, 0.8845394746939728, 0.549927404994199, 0.723238299445929, 0.878344069591768, 0.846935426027426, 0.9247730316677281, 0.9552032561040038, 0.9924189853641568, -1.0, 0.8793253393736084, 0.8014331947718654, 0.7110588226104104, 0.6135257278044626, 0.9924863542553993, -1.0, 0.9579268479817842, 0.9727156979821646, 0.9116115314725002, 0.8343802158430567, 0.5, 0.8588421268737874, 0.8213562076851944, 0.970740269993547, 0.8924324260273795, 0.595747280282189, 0.917683178519379, 0.9618756663308032, 0.8623865149492642, 0.8682495499866328, 0.6198971221568093, 0.958332266672647, 0.9030283011343169, 0.5, 0.8865968110345482, 0.5, 0.8351117940303225, 0.8927282854997428, 0.5829962604298272, 0.9499030053766725, 0.9062952371515034, 0.9051120661245559, 0.9825303757844475, 0.9391083735813445, 0.7500165108757391, 0.9259035240641976, 0.986797925229793, 0.5474430689215835, 0.9975683328828339, 0.8980931155578135, 0.5, 0.5781469252967026, 0.9175004228556376, 0.9946485766824009, 0.9634781210815117, 0.9359888156504642, 0.9693612178341603, 0.8013141169711979, 0.9383391561424074, 0.5, 0.6836955879281534, 0.9320494609327288, 0.9946299948220548, 0.8664825043758857, 0.5, 0.6495177959561369, 0.8197439866486016, 0.7448888402649774, 0.9390198796866782, -1.0, 0.8816123719879806, 0.9763060060112906, 0.8311072697369074, 0.9539993108575083, 0.6636742065350265, 0.5181763602965153, 0.6989696591817085, 0.88809132469699, 0.9828338675974757, 0.8269424956004194, 0.5412636238400622, 0.9364320646061883, 0.8331369876250282, 0.6617322675067377, 0.5, 0.796371974641634, 0.6785127871770371, 0.7048292661007753, 0.7748251334602729, 0.9023688341466789, 0.9790046515670463, 0.680179137966441, 0.5344534910324086, 0.8797011821692937, 0.5493654448828702, -1.0, 0.5, 0.8566930815073113, 0.998878470680033, 0.8481859031486311, 0.9275938233036766, 0.6828631141046231, 0.8293602130352369, 0.7244669752046246, 0.9447800640569263, 0.8983666688099987, 0.8835935546739372, 0.9809065219315924, 0.966206511695278, 0.9358650044072419, 0.9212104545406845, 0.7538272496870997, 0.7487940611633668, 0.6308382829539624, 0.7532362820325239, 0.7209443453087263, 0.5804870102795295, 0.8353481876195682, 0.5, 0.8886104018016212, 0.9049685395125288, 0.5, 0.9189697399759861, 0.9619017203243275, 0.570652792337693, 0.8024013184884798, 0.5, 0.6545045805986125, 0.8879603310682036, 0.8508469908711483, 0.6146924581715365, 0.5, 0.9229943424392344, 0.7958594910934728, 0.9506328544943141, 0.5251560033581413, 0.7001159061038049, 0.5, 0.7906631021548832, 0.9079058954920125, 0.5936225323975273, 0.8455093772109985, 0.8150694083683638, 0.8899753286956458, 0.8753135752218253, 0.7430217348311292, 0.6954996084222848, 0.888299242785529, 0.8090976605849519, 0.9646010209460224, 0.9400522359021417], "episode_lengths": [14, 15, 15, 19, 15, 26, 13, 16, 22, 15, 34, 14, 21, 14, 16, 48, 17, 16, 29, 17, 15, 14, 15, 14, 14, 15, 15, 16, 19, 13, 20, 15, 14, 15, 15, 14, 16, 20, 33, 19, 20, 13, 13, 15, 22, 27, 14, 17, 18, 20, 16, 17, 28, 14, 13, 19, 16, 15, 18, 32, 17, 16, 29, 17, 38, 16, 13, 14, 17, 13, 14, 15, 15, 13, 16, 13, 14, 18, 16, 13, 19, 19, 17, 14, 17, 14, 15, 13, 15, 15, 15, 17, 15, 15, 14, 19, 16, 19, 25, 13, 20, 13, 14, 28, 15, 14, 14, 18, 21, 13, 14, 19, 13, 19, 17, 13, 21, 17, 14, 15, 14, 16, 15, 14, 15, 26, 15, 19, 29, 24, 14, 14, 19, 14, 15, 16, 16, 25, 19, 16, 15, 18, 23, 18, 14, 14, 13, 56, 14, 15, 15, 15, 19, 17, 17, 13, 15, 15, 18, 14, 16, 15, 23, 15, 18, 16, 18, 17, 13, 21, 21, 15, 45, 32, 20, 16, 15, 13, 15, 21, 15, 13, 13, 13, 14, 15, 15, 13, 13, 18, 17, 19, 17, 17, 16, 13, 18, 14, 14, 35, 13, 15, 27, 19, 18, 20, 13, 15, 17, 22, 16, 14, 16, 30, 14, 23, 15, 13, 19, 14, 19, 15, 13, 18, 20, 15, 13, 15, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0964444542265565, "mean_inference_ms": 0.24389392375533517, "mean_action_processing_ms": 0.0439828842269847, "mean_env_wait_ms": 0.04716098245233506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015431616504119473, "StateBufferConnector_ms": 0.0012537277421576488, "ViewRequirementAgentConnector_ms": 0.02873370741132045}}, "episode_reward_max": 0.9996471503427188, "episode_reward_min": -1.0, "episode_reward_mean": 0.7445988871541751, "episode_len_mean": 17.48471615720524, "episodes_this_iter": 229, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9373548389556672, 0.8770452010856554, 0.8895843008434654, 0.657657463119236, 0.8926864139888321, 0.6044140840218666, 0.9574860925918158, 0.5301718056512557, 0.550218645868078, 0.9517350443908432, 0.5080316867268357, 0.994239693307565, 0.6112263535323883, 0.9458793696355122, 0.8818917163882726, 0.5, 0.5089037302770241, 0.7862840577785897, -1.0, 0.8022570474292394, 0.9504210813544052, 0.7980007940348163, 0.9518312518039015, 0.9176074202638272, 0.9996471503427188, 0.9682528009084931, 0.9497018299535764, 0.9625538665497702, 0.7470023866739777, 0.9512393601747958, 0.5, 0.7122988233038543, 0.9537133783103195, 0.6446141725065241, 0.8972914245816301, 0.9953193366379064, 0.8699931138974069, 0.7716589421956399, 0.5471869665432865, 0.6250183378664833, 0.5, 0.9129962356894279, 0.9790674917481231, 0.9633164815107768, 0.5095451886141062, 0.5694759900301299, 0.9237381234960043, 0.8112746392294686, 0.6944306950814052, 0.6661057283203083, 0.9066778441735266, 0.8011105346616139, 0.5651680054296687, 0.956640281668959, 0.9784902481960667, 0.6459583481437348, 0.7599922195841604, 0.937658674944292, 0.8590705569451272, 0.5386141695598583, 0.9173212604864976, 0.8516561190178011, 0.5, 0.8158637579558918, -1.0, 0.8926944606939683, -1.0, 0.8882860096020603, 0.6400821918256616, 0.7693391765555533, 0.9844080886183831, 0.9771749007037699, 0.8785457927295433, 0.9418159103584314, 0.8855109186358378, 0.9954870566110364, 0.931305519571356, 0.8718611561440082, 0.5113830249817259, 0.8845394746939728, 0.549927404994199, 0.723238299445929, 0.878344069591768, 0.846935426027426, 0.9247730316677281, 0.9552032561040038, 0.9924189853641568, -1.0, 0.8793253393736084, 0.8014331947718654, 0.7110588226104104, 0.6135257278044626, 0.9924863542553993, -1.0, 0.9579268479817842, 0.9727156979821646, 0.9116115314725002, 0.8343802158430567, 0.5, 0.8588421268737874, 0.8213562076851944, 0.970740269993547, 0.8924324260273795, 0.595747280282189, 0.917683178519379, 0.9618756663308032, 0.8623865149492642, 0.8682495499866328, 0.6198971221568093, 0.958332266672647, 0.9030283011343169, 0.5, 0.8865968110345482, 0.5, 0.8351117940303225, 0.8927282854997428, 0.5829962604298272, 0.9499030053766725, 0.9062952371515034, 0.9051120661245559, 0.9825303757844475, 0.9391083735813445, 0.7500165108757391, 0.9259035240641976, 0.986797925229793, 0.5474430689215835, 0.9975683328828339, 0.8980931155578135, 0.5, 0.5781469252967026, 0.9175004228556376, 0.9946485766824009, 0.9634781210815117, 0.9359888156504642, 0.9693612178341603, 0.8013141169711979, 0.9383391561424074, 0.5, 0.6836955879281534, 0.9320494609327288, 0.9946299948220548, 0.8664825043758857, 0.5, 0.6495177959561369, 0.8197439866486016, 0.7448888402649774, 0.9390198796866782, -1.0, 0.8816123719879806, 0.9763060060112906, 0.8311072697369074, 0.9539993108575083, 0.6636742065350265, 0.5181763602965153, 0.6989696591817085, 0.88809132469699, 0.9828338675974757, 0.8269424956004194, 0.5412636238400622, 0.9364320646061883, 0.8331369876250282, 0.6617322675067377, 0.5, 0.796371974641634, 0.6785127871770371, 0.7048292661007753, 0.7748251334602729, 0.9023688341466789, 0.9790046515670463, 0.680179137966441, 0.5344534910324086, 0.8797011821692937, 0.5493654448828702, -1.0, 0.5, 0.8566930815073113, 0.998878470680033, 0.8481859031486311, 0.9275938233036766, 0.6828631141046231, 0.8293602130352369, 0.7244669752046246, 0.9447800640569263, 0.8983666688099987, 0.8835935546739372, 0.9809065219315924, 0.966206511695278, 0.9358650044072419, 0.9212104545406845, 0.7538272496870997, 0.7487940611633668, 0.6308382829539624, 0.7532362820325239, 0.7209443453087263, 0.5804870102795295, 0.8353481876195682, 0.5, 0.8886104018016212, 0.9049685395125288, 0.5, 0.9189697399759861, 0.9619017203243275, 0.570652792337693, 0.8024013184884798, 0.5, 0.6545045805986125, 0.8879603310682036, 0.8508469908711483, 0.6146924581715365, 0.5, 0.9229943424392344, 0.7958594910934728, 0.9506328544943141, 0.5251560033581413, 0.7001159061038049, 0.5, 0.7906631021548832, 0.9079058954920125, 0.5936225323975273, 0.8455093772109985, 0.8150694083683638, 0.8899753286956458, 0.8753135752218253, 0.7430217348311292, 0.6954996084222848, 0.888299242785529, 0.8090976605849519, 0.9646010209460224, 0.9400522359021417], "episode_lengths": [14, 15, 15, 19, 15, 26, 13, 16, 22, 15, 34, 14, 21, 14, 16, 48, 17, 16, 29, 17, 15, 14, 15, 14, 14, 15, 15, 16, 19, 13, 20, 15, 14, 15, 15, 14, 16, 20, 33, 19, 20, 13, 13, 15, 22, 27, 14, 17, 18, 20, 16, 17, 28, 14, 13, 19, 16, 15, 18, 32, 17, 16, 29, 17, 38, 16, 13, 14, 17, 13, 14, 15, 15, 13, 16, 13, 14, 18, 16, 13, 19, 19, 17, 14, 17, 14, 15, 13, 15, 15, 15, 17, 15, 15, 14, 19, 16, 19, 25, 13, 20, 13, 14, 28, 15, 14, 14, 18, 21, 13, 14, 19, 13, 19, 17, 13, 21, 17, 14, 15, 14, 16, 15, 14, 15, 26, 15, 19, 29, 24, 14, 14, 19, 14, 15, 16, 16, 25, 19, 16, 15, 18, 23, 18, 14, 14, 13, 56, 14, 15, 15, 15, 19, 17, 17, 13, 15, 15, 18, 14, 16, 15, 23, 15, 18, 16, 18, 17, 13, 21, 21, 15, 45, 32, 20, 16, 15, 13, 15, 21, 15, 13, 13, 13, 14, 15, 15, 13, 13, 18, 17, 19, 17, 17, 16, 13, 18, 14, 14, 35, 13, 15, 27, 19, 18, 20, 13, 15, 17, 22, 16, 14, 16, 30, 14, 23, 15, 13, 19, 14, 19, 15, 13, 18, 20, 15, 13, 15, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0964444542265565, "mean_inference_ms": 0.24389392375533517, "mean_action_processing_ms": 0.0439828842269847, "mean_env_wait_ms": 0.04716098245233506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015431616504119473, "StateBufferConnector_ms": 0.0012537277421576488, "ViewRequirementAgentConnector_ms": 0.02873370741132045}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 961.4497262594116, "num_env_steps_trained_throughput_per_sec": 961.4497262594116, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 3724.469, "sample_time_ms": 1785.583, "load_time_ms": 0.211, "load_throughput": 18938047.184, "learn_time_ms": 1937.701, "learn_throughput": 2064.302, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 9595, "training_iteration": 76, "trial_id": "default", "date": "2024-05-22_22-19-35", "timestamp": 1716409175, "time_this_iter_s": 4.164458990097046, "time_total_s": 275.0164842605591, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 275.0164842605591, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 19.233333333333334, "ram_util_percent": 61.53333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.770378444528067, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.058717271934735325, "policy_loss": -0.002706476181910764, "vf_loss": 0.06072650145468933, "vf_explained_var": 0.46240949400009645, "kl": 0.01239548752189077, "entropy": 0.6024123866391439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 0.9996394533779557, "episode_reward_min": -1.0, "episode_reward_mean": 0.7554777994471722, "episode_len_mean": 17.458515283842793, "episode_media": {}, "episodes_this_iter": 229, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.9760110766368073, -1.0, 0.8676623056216112, 0.717623691346239, 0.8674901250087991, 0.9624586354880674, 0.8093153779785747, 0.9983457510002539, 0.9514334759891934, 0.9515306007617117, 0.8253074637114032, 0.8218920910665407, -1.0, 0.9692481634305495, 0.9616334854104388, 0.5747259509825149, 0.963805282160628, 0.9960926138165513, 0.933798601385358, 0.9016457108917488, 0.8301795909155694, 0.8834947988824101, 0.9350375523963947, 0.8673183942422203, 0.9803254536951546, 0.8651206027249967, 0.9128261557410202, 0.9863897639262363, 0.8131351175844493, 0.8283853736842337, 0.8491383513963501, 0.9933545011069388, 0.979413771245039, 0.8367156064074561, 0.9148985076481209, 0.5186144272287185, 0.6801044158514868, 0.9384117688011981, 0.8898272338539168, 0.9354751094630617, 0.6548829550027789, 0.8645079598477742, 0.8406362726538509, 0.5097021240380828, 0.960900279636481, 0.5, 0.9279078604764402, 0.8609804578556877, 0.813129769880851, 0.9876817007980389, 0.96663612734312, 0.6848800106445385, 0.6865566445257014, 0.538686283503176, 0.9336438255554437, 0.5, 0.8817155649576661, 0.9265151693987175, 0.9754038831393111, 0.5202520769385507, 0.8135335165321885, 0.9192555279534876, 0.9725349913873634, 0.9189850581905074, 0.9853675814134019, 0.619683912601173, 0.9719947643338699, 0.7874815232356934, 0.6209398826776641, 0.8616640269083697, 0.9069892226261076, 0.8995994994211095, 0.9329705814469402, 0.9722954482570114, 0.8803498565952778, 0.597620540422011, 0.9905112049456938, 0.9493311294040819, 0.8534809106546035, 0.6230610834670718, -1.0, 0.7684645268459611, 0.5362768145902777, 0.5944502847056248, 0.9512375116938995, 0.9935371054474395, 0.7611320338706461, 0.9808658449083004, 0.9603078147741136, 0.5, 0.9755969622047771, 0.9495515091951238, 0.9388825947680733, 0.8674426520437281, 0.7709789081259817, 0.9363823258645823, 0.8968182598802907, 0.9773762235309954, 0.7264547249516888, 0.8487994246252855, 0.9612667033477689, 0.9440571510915108, 0.621842149401322, 0.8565555070202825, 0.9919198191967782, 0.7802915915439903, 0.8974008457481644, 0.7374517207299717, 0.7649896291623598, 0.9101850247640074, 0.8747793485148269, 0.9484830043070716, 0.679810005550515, 0.5587696850188094, 0.9294561996016015, 0.9916929266374341, 0.9876573185056988, 0.8434245142348851, 0.5259063810704071, 0.8571712385045431, 0.9939332789066266, 0.9386398258936244, 0.9245808160236041, -1.0, 0.9119648542840842, 0.954452448521418, 0.5926565865871034, 0.718784103993854, 0.5633806765791755, 0.6002193355760034, -1.0, 0.9057327278652372, 0.6731408542573112, 0.5148453586617832, 0.833201147749908, -1.0, 0.9560683378854609, 0.8751210081827616, 0.8783570363886513, 0.967420827819016, 0.9383663202459138, 0.5771362758181244, 0.7053986512222046, 0.9963717036652547, 0.8461153708311828, 0.9072103571670945, 0.9503861479102402, 0.8868970450726544, 0.9996394533779557, 0.5897386762570591, 0.9397455989583098, 0.6876771697082504, 0.837373102365947, 0.7999439364744341, 0.5, 0.7884962867644595, 0.7529919243850858, 0.7231852053765637, 0.9884807942377105, 0.893372405279169, 0.8205987750631093, 0.9669909106723419, 0.6457804880068688, 0.8008222122494357, 0.9996137674769133, 0.6117027017999577, 0.9820317804746445, 0.5, 0.9673815048566607, -1.0, 0.9579379456191446, 0.6195389413035381, 0.9353078655206348, 0.6644491092368523, 0.987986542509263, 0.5, 0.707133843525958, 0.5623952038341629, 0.8410658523811194, 0.9487598429844819, 0.9428557532932033, 0.954646789472114, 0.5458323938889059, 0.7701944166797767, 0.8869528150828008, 0.8503529888673268, 0.6641401332171692, 0.894609356939838, 0.5, 0.8805356258540541, 0.9911359421116476, 0.5, 0.9677041337511348, 0.9291014767156277, 0.9700688987471994, -1.0, 0.8294468349509772, 0.956704693048756, 0.9898631089241242, 0.5549700129665835, 0.9445647860116428, 0.9363174720851959, 0.5799560831342998, 0.951708833433442, 0.8116271397208591, -1.0, 0.9690430296105589, 0.9479046710535688, 0.9871262166800682, 0.9697523970205275, 0.8166968510757477, 0.6178284520610591, 0.5365105949002806, 0.5648599757138177, 0.5, 0.5561288679993197, 0.9578378224788369, 0.8498485968910894, 0.9935537503047358, 0.8649504807219771, 0.9918882286990955, 0.6248073499809517, 0.846104074205557, 0.6071742621136205, 0.9360213035330356, 0.8763453327034036, 0.9008168855792507, 0.9572818892404072], "episode_lengths": [26, 14, 31, 14, 22, 14, 16, 15, 15, 15, 14, 18, 15, 14, 17, 15, 18, 17, 13, 14, 15, 14, 13, 16, 15, 13, 17, 13, 15, 17, 14, 20, 16, 15, 15, 14, 18, 18, 14, 13, 16, 16, 16, 17, 32, 14, 22, 14, 13, 19, 13, 14, 17, 17, 30, 14, 18, 15, 14, 17, 24, 15, 15, 13, 14, 13, 19, 14, 14, 18, 15, 14, 14, 15, 15, 13, 20, 13, 14, 14, 15, 51, 17, 25, 29, 13, 13, 19, 14, 14, 20, 18, 15, 15, 15, 21, 14, 15, 16, 18, 15, 14, 16, 22, 14, 14, 19, 17, 16, 17, 15, 14, 14, 19, 20, 13, 15, 16, 14, 17, 14, 15, 15, 14, 31, 13, 15, 26, 18, 26, 15, 16, 14, 19, 26, 16, 80, 13, 15, 18, 15, 15, 26, 18, 16, 17, 15, 15, 13, 14, 24, 13, 18, 17, 19, 32, 17, 22, 18, 14, 17, 13, 14, 20, 14, 17, 25, 13, 66, 13, 18, 17, 22, 16, 17, 13, 18, 18, 22, 18, 13, 17, 13, 22, 14, 14, 14, 18, 14, 35, 16, 15, 17, 14, 16, 14, 17, 16, 14, 13, 23, 14, 14, 22, 16, 16, 26, 14, 16, 14, 16, 15, 23, 20, 24, 23, 31, 15, 14, 13, 14, 16, 18, 14, 18, 13, 17, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09654805338855957, "mean_inference_ms": 0.2439015623831913, "mean_action_processing_ms": 0.04398158581834231, "mean_env_wait_ms": 0.047171908653150005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015329585845814, "StateBufferConnector_ms": 0.0012027124130049127, "ViewRequirementAgentConnector_ms": 0.028584617714694494}}, "episode_reward_max": 0.9996394533779557, "episode_reward_min": -1.0, "episode_reward_mean": 0.7554777994471722, "episode_len_mean": 17.458515283842793, "episodes_this_iter": 229, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.9760110766368073, -1.0, 0.8676623056216112, 0.717623691346239, 0.8674901250087991, 0.9624586354880674, 0.8093153779785747, 0.9983457510002539, 0.9514334759891934, 0.9515306007617117, 0.8253074637114032, 0.8218920910665407, -1.0, 0.9692481634305495, 0.9616334854104388, 0.5747259509825149, 0.963805282160628, 0.9960926138165513, 0.933798601385358, 0.9016457108917488, 0.8301795909155694, 0.8834947988824101, 0.9350375523963947, 0.8673183942422203, 0.9803254536951546, 0.8651206027249967, 0.9128261557410202, 0.9863897639262363, 0.8131351175844493, 0.8283853736842337, 0.8491383513963501, 0.9933545011069388, 0.979413771245039, 0.8367156064074561, 0.9148985076481209, 0.5186144272287185, 0.6801044158514868, 0.9384117688011981, 0.8898272338539168, 0.9354751094630617, 0.6548829550027789, 0.8645079598477742, 0.8406362726538509, 0.5097021240380828, 0.960900279636481, 0.5, 0.9279078604764402, 0.8609804578556877, 0.813129769880851, 0.9876817007980389, 0.96663612734312, 0.6848800106445385, 0.6865566445257014, 0.538686283503176, 0.9336438255554437, 0.5, 0.8817155649576661, 0.9265151693987175, 0.9754038831393111, 0.5202520769385507, 0.8135335165321885, 0.9192555279534876, 0.9725349913873634, 0.9189850581905074, 0.9853675814134019, 0.619683912601173, 0.9719947643338699, 0.7874815232356934, 0.6209398826776641, 0.8616640269083697, 0.9069892226261076, 0.8995994994211095, 0.9329705814469402, 0.9722954482570114, 0.8803498565952778, 0.597620540422011, 0.9905112049456938, 0.9493311294040819, 0.8534809106546035, 0.6230610834670718, -1.0, 0.7684645268459611, 0.5362768145902777, 0.5944502847056248, 0.9512375116938995, 0.9935371054474395, 0.7611320338706461, 0.9808658449083004, 0.9603078147741136, 0.5, 0.9755969622047771, 0.9495515091951238, 0.9388825947680733, 0.8674426520437281, 0.7709789081259817, 0.9363823258645823, 0.8968182598802907, 0.9773762235309954, 0.7264547249516888, 0.8487994246252855, 0.9612667033477689, 0.9440571510915108, 0.621842149401322, 0.8565555070202825, 0.9919198191967782, 0.7802915915439903, 0.8974008457481644, 0.7374517207299717, 0.7649896291623598, 0.9101850247640074, 0.8747793485148269, 0.9484830043070716, 0.679810005550515, 0.5587696850188094, 0.9294561996016015, 0.9916929266374341, 0.9876573185056988, 0.8434245142348851, 0.5259063810704071, 0.8571712385045431, 0.9939332789066266, 0.9386398258936244, 0.9245808160236041, -1.0, 0.9119648542840842, 0.954452448521418, 0.5926565865871034, 0.718784103993854, 0.5633806765791755, 0.6002193355760034, -1.0, 0.9057327278652372, 0.6731408542573112, 0.5148453586617832, 0.833201147749908, -1.0, 0.9560683378854609, 0.8751210081827616, 0.8783570363886513, 0.967420827819016, 0.9383663202459138, 0.5771362758181244, 0.7053986512222046, 0.9963717036652547, 0.8461153708311828, 0.9072103571670945, 0.9503861479102402, 0.8868970450726544, 0.9996394533779557, 0.5897386762570591, 0.9397455989583098, 0.6876771697082504, 0.837373102365947, 0.7999439364744341, 0.5, 0.7884962867644595, 0.7529919243850858, 0.7231852053765637, 0.9884807942377105, 0.893372405279169, 0.8205987750631093, 0.9669909106723419, 0.6457804880068688, 0.8008222122494357, 0.9996137674769133, 0.6117027017999577, 0.9820317804746445, 0.5, 0.9673815048566607, -1.0, 0.9579379456191446, 0.6195389413035381, 0.9353078655206348, 0.6644491092368523, 0.987986542509263, 0.5, 0.707133843525958, 0.5623952038341629, 0.8410658523811194, 0.9487598429844819, 0.9428557532932033, 0.954646789472114, 0.5458323938889059, 0.7701944166797767, 0.8869528150828008, 0.8503529888673268, 0.6641401332171692, 0.894609356939838, 0.5, 0.8805356258540541, 0.9911359421116476, 0.5, 0.9677041337511348, 0.9291014767156277, 0.9700688987471994, -1.0, 0.8294468349509772, 0.956704693048756, 0.9898631089241242, 0.5549700129665835, 0.9445647860116428, 0.9363174720851959, 0.5799560831342998, 0.951708833433442, 0.8116271397208591, -1.0, 0.9690430296105589, 0.9479046710535688, 0.9871262166800682, 0.9697523970205275, 0.8166968510757477, 0.6178284520610591, 0.5365105949002806, 0.5648599757138177, 0.5, 0.5561288679993197, 0.9578378224788369, 0.8498485968910894, 0.9935537503047358, 0.8649504807219771, 0.9918882286990955, 0.6248073499809517, 0.846104074205557, 0.6071742621136205, 0.9360213035330356, 0.8763453327034036, 0.9008168855792507, 0.9572818892404072], "episode_lengths": [26, 14, 31, 14, 22, 14, 16, 15, 15, 15, 14, 18, 15, 14, 17, 15, 18, 17, 13, 14, 15, 14, 13, 16, 15, 13, 17, 13, 15, 17, 14, 20, 16, 15, 15, 14, 18, 18, 14, 13, 16, 16, 16, 17, 32, 14, 22, 14, 13, 19, 13, 14, 17, 17, 30, 14, 18, 15, 14, 17, 24, 15, 15, 13, 14, 13, 19, 14, 14, 18, 15, 14, 14, 15, 15, 13, 20, 13, 14, 14, 15, 51, 17, 25, 29, 13, 13, 19, 14, 14, 20, 18, 15, 15, 15, 21, 14, 15, 16, 18, 15, 14, 16, 22, 14, 14, 19, 17, 16, 17, 15, 14, 14, 19, 20, 13, 15, 16, 14, 17, 14, 15, 15, 14, 31, 13, 15, 26, 18, 26, 15, 16, 14, 19, 26, 16, 80, 13, 15, 18, 15, 15, 26, 18, 16, 17, 15, 15, 13, 14, 24, 13, 18, 17, 19, 32, 17, 22, 18, 14, 17, 13, 14, 20, 14, 17, 25, 13, 66, 13, 18, 17, 22, 16, 17, 13, 18, 18, 22, 18, 13, 17, 13, 22, 14, 14, 14, 18, 14, 35, 16, 15, 17, 14, 16, 14, 17, 16, 14, 13, 23, 14, 14, 22, 16, 16, 26, 14, 16, 14, 16, 15, 23, 20, 24, 23, 31, 15, 14, 13, 14, 16, 18, 14, 18, 13, 17, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09654805338855957, "mean_inference_ms": 0.2439015623831913, "mean_action_processing_ms": 0.04398158581834231, "mean_env_wait_ms": 0.047171908653150005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015329585845814, "StateBufferConnector_ms": 0.0012027124130049127, "ViewRequirementAgentConnector_ms": 0.028584617714694494}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1092.4037149712728, "num_env_steps_trained_throughput_per_sec": 1092.4037149712728, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 3725.741, "sample_time_ms": 1786.797, "load_time_ms": 0.207, "load_throughput": 19284156.322, "learn_time_ms": 1937.764, "learn_throughput": 2064.235, "synch_weights_time_ms": 0.638}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 9824, "training_iteration": 77, "trial_id": "default", "date": "2024-05-22_22-19-39", "timestamp": 1716409179, "time_this_iter_s": 3.665771007537842, "time_total_s": 278.6822552680969, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 278.6822552680969, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 22.683333333333337, "ram_util_percent": 61.41666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.416858588111016, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.014931800888640986, "policy_loss": -0.012011635846268106, "vf_loss": 0.02603197169555251, "vf_explained_var": 0.5792276936192666, "kl": 0.01620380183641499, "entropy": 0.5387070409713253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 0.9991885003105119, "episode_reward_min": -1.0, "episode_reward_mean": 0.7891588666613534, "episode_len_mean": 17.521929824561404, "episode_media": {}, "episodes_this_iter": 228, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9109789760735384, 0.9683324482808717, 0.9481111019914646, 0.9286031963228877, 0.6001857484478064, 0.7827707254158853, 0.9295930414559741, 0.686645911745029, 0.7895598954227978, 0.993484769158828, 0.7263536536364315, 0.8795444189102816, 0.9427620344706902, 0.9877749587577342, 0.9491226502258495, 0.569860762716933, 0.9621897949118466, 0.8571692509754736, 0.9551550283373473, 0.5006295208363967, 0.89068240420186, 0.9219072103323721, 0.7540364846432995, 0.994980232531821, 0.8213246664954911, 0.9428116978231917, 0.5904486755744038, 0.865877025048245, 0.9750012727362051, 0.9967950550606248, 0.7585722425522393, 0.9192999104783832, 0.7740084772261799, 0.5283335903996427, 0.9772896449964777, 0.7898576293601808, 0.9413485500241889, 0.652868721981211, 0.5849084514908414, 0.8696614388899626, 0.5, 0.9312431573274311, 0.8907024111130053, 0.9946795153422636, 0.747311117965679, 0.8538825218565431, 0.8652711649614471, 0.9873119107992512, 0.6673821101732245, 0.8561548102906247, 0.9469641029049308, 0.9050288371032675, 0.6798173828112526, 0.5318597649010169, 0.9897700502138411, 0.9418478660263536, 0.9592715802906079, 0.676935298367068, 0.9971629777738293, -1.0, 0.9556109472403552, 0.7328932504567263, 0.9517649371967943, 0.8986625891292508, 0.9777830485429609, 0.7910585214337144, 0.6877677976521959, 0.951565089360814, 0.8753754177009146, 0.9585038850064744, 0.5382647144722221, 0.9379073108027827, 0.9765655754819237, 0.9966200142789096, 0.8875173399412029, 0.9096009304335416, 0.6488155541792661, 0.5, 0.6826853963197184, 0.866032272445873, 0.9012038241552313, -1.0, 0.9703198830353692, 0.8495490461437718, 0.9486600494660005, 0.8731428829832741, 0.6787579440621949, 0.870965407224561, 0.7983902552935359, 0.7732398516320454, 0.754874640502122, 0.9872463366730496, 0.9454027934838054, 0.6615605536510805, 0.8965223552373696, 0.8449585931903089, 0.9635950513197837, 0.9559327644205834, 0.8581061035566007, 0.8872961123149615, 0.9375728227854729, 0.9504700631616535, 0.9380019176321592, 0.8645049675824821, 0.5302656989187001, 0.9851881939270362, 0.8563175024472135, -1.0, 0.9275354433159465, 0.7511181923283102, 0.9262503665760901, 0.9973625197496833, 0.9624268491807343, 0.5052858141372532, 0.9755686154079543, 0.9928252824559443, 0.9253785073997917, 0.9323267133199137, 0.8886820107867148, 0.9369397010759164, 0.8309458827028796, 0.6083712172025917, 0.6880966388385816, 0.932815751705843, 0.5373192746577897, 0.8130772954653565, 0.6561058534964102, 0.9573512746370445, 0.758383061083566, 0.5, 0.8612790120065845, 0.9197522080275963, 0.7773377976467459, 0.9074765551034124, 0.9813163300504302, 0.7263536816018801, 0.6999259212354424, 0.8026904232789828, 0.9676419900077441, 0.8825375856493198, 0.607846244791141, 0.9695091160103823, 0.5236366389391367, 0.5475445087568742, 0.9519979930004602, -1.0, 0.9380819826796939, 0.6092930903422962, 0.6855527066924394, 0.9016897932644317, 0.9612731873020888, 0.993586595401888, 0.7553989320957177, 0.8296418237586396, 0.5177779445069952, 0.5, 0.9372385445450533, 0.8684129897324808, 0.8558585853676914, 0.9061834812845784, 0.519842125070235, 0.9554132696283351, 0.9429644415013878, 0.6543621559909731, 0.8985765446162431, 0.8825949449513437, 0.6718356845320763, 0.8164538223033531, 0.8877290463625311, 0.8851636847234639, 0.9339250699296486, -1.0, 0.9101473815524536, 0.9915760527241766, 0.6284540472622124, 0.763882674189903, 0.7824818293269143, 0.9976803943971957, 0.8018377403213797, 0.9188350802567206, 0.6556192611228715, 0.9755464221994639, 0.8870264071332195, 0.9913535441850838, 0.649748742648526, 0.8718140095523051, 0.5662546934264332, 0.9017679077842419, 0.798369533718797, 0.84093995037317, 0.9103193691807717, 0.9021662390482601, 0.9666250731322352, 0.9566398591247567, 0.9116834448415493, 0.5429085148864381, 0.778360150950548, 0.9905018771677399, 0.9469281445020011, 0.9211398296706177, 0.8906386671830547, 0.9212524668350921, 0.5810290580355354, 0.8862168879958721, 0.9709150921568903, 0.5, 0.9991885003105119, 0.940598981812671, 0.6702269079720984, 0.8010320985651205, 0.8677326628188794, 0.997405388653731, 0.7881404203750637, 0.5, 0.5692339663326764, 0.9634831865800684, 0.8520662434567909, 0.5825801227659817, 0.8515767278905464, 0.9196335103371367, 0.9486076120144167, 0.7659896616460707, 0.9619199403134617, 0.59184458110583, 0.5245750162264873, 0.9323016955575382, 0.8916808229421109, 0.5094024289724071], "episode_lengths": [14, 13, 14, 13, 22, 15, 13, 29, 16, 14, 17, 14, 13, 14, 17, 30, 14, 16, 13, 21, 15, 16, 15, 14, 15, 16, 29, 15, 17, 14, 18, 14, 20, 28, 18, 18, 14, 16, 15, 14, 26, 19, 17, 15, 16, 13, 16, 14, 16, 16, 13, 21, 17, 24, 14, 13, 14, 15, 13, 20, 15, 15, 14, 15, 15, 15, 26, 14, 15, 13, 21, 16, 15, 19, 15, 13, 17, 26, 21, 13, 14, 48, 14, 15, 15, 16, 21, 16, 22, 15, 17, 14, 16, 19, 14, 15, 15, 15, 14, 14, 15, 13, 16, 16, 24, 16, 19, 68, 19, 17, 15, 15, 14, 28, 16, 17, 15, 17, 16, 15, 19, 26, 22, 14, 16, 15, 23, 17, 15, 30, 15, 13, 17, 14, 14, 18, 29, 17, 13, 15, 19, 14, 28, 21, 17, 29, 15, 19, 27, 15, 14, 14, 20, 14, 26, 28, 13, 17, 15, 15, 27, 13, 14, 21, 14, 20, 16, 14, 14, 15, 13, 29, 13, 16, 15, 18, 21, 14, 19, 14, 17, 15, 15, 13, 20, 15, 23, 13, 17, 16, 14, 16, 16, 17, 14, 25, 21, 17, 14, 14, 15, 14, 22, 14, 13, 44, 15, 15, 21, 15, 19, 14, 15, 22, 20, 14, 14, 27, 13, 15, 14, 18, 14, 30, 17, 13, 19, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09664900686854268, "mean_inference_ms": 0.24390631530740786, "mean_action_processing_ms": 0.043980078463509265, "mean_env_wait_ms": 0.04718363521763154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001562164540876422, "StateBufferConnector_ms": 0.0012298425038655598, "ViewRequirementAgentConnector_ms": 0.02863950896681401}}, "episode_reward_max": 0.9991885003105119, "episode_reward_min": -1.0, "episode_reward_mean": 0.7891588666613534, "episode_len_mean": 17.521929824561404, "episodes_this_iter": 228, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9109789760735384, 0.9683324482808717, 0.9481111019914646, 0.9286031963228877, 0.6001857484478064, 0.7827707254158853, 0.9295930414559741, 0.686645911745029, 0.7895598954227978, 0.993484769158828, 0.7263536536364315, 0.8795444189102816, 0.9427620344706902, 0.9877749587577342, 0.9491226502258495, 0.569860762716933, 0.9621897949118466, 0.8571692509754736, 0.9551550283373473, 0.5006295208363967, 0.89068240420186, 0.9219072103323721, 0.7540364846432995, 0.994980232531821, 0.8213246664954911, 0.9428116978231917, 0.5904486755744038, 0.865877025048245, 0.9750012727362051, 0.9967950550606248, 0.7585722425522393, 0.9192999104783832, 0.7740084772261799, 0.5283335903996427, 0.9772896449964777, 0.7898576293601808, 0.9413485500241889, 0.652868721981211, 0.5849084514908414, 0.8696614388899626, 0.5, 0.9312431573274311, 0.8907024111130053, 0.9946795153422636, 0.747311117965679, 0.8538825218565431, 0.8652711649614471, 0.9873119107992512, 0.6673821101732245, 0.8561548102906247, 0.9469641029049308, 0.9050288371032675, 0.6798173828112526, 0.5318597649010169, 0.9897700502138411, 0.9418478660263536, 0.9592715802906079, 0.676935298367068, 0.9971629777738293, -1.0, 0.9556109472403552, 0.7328932504567263, 0.9517649371967943, 0.8986625891292508, 0.9777830485429609, 0.7910585214337144, 0.6877677976521959, 0.951565089360814, 0.8753754177009146, 0.9585038850064744, 0.5382647144722221, 0.9379073108027827, 0.9765655754819237, 0.9966200142789096, 0.8875173399412029, 0.9096009304335416, 0.6488155541792661, 0.5, 0.6826853963197184, 0.866032272445873, 0.9012038241552313, -1.0, 0.9703198830353692, 0.8495490461437718, 0.9486600494660005, 0.8731428829832741, 0.6787579440621949, 0.870965407224561, 0.7983902552935359, 0.7732398516320454, 0.754874640502122, 0.9872463366730496, 0.9454027934838054, 0.6615605536510805, 0.8965223552373696, 0.8449585931903089, 0.9635950513197837, 0.9559327644205834, 0.8581061035566007, 0.8872961123149615, 0.9375728227854729, 0.9504700631616535, 0.9380019176321592, 0.8645049675824821, 0.5302656989187001, 0.9851881939270362, 0.8563175024472135, -1.0, 0.9275354433159465, 0.7511181923283102, 0.9262503665760901, 0.9973625197496833, 0.9624268491807343, 0.5052858141372532, 0.9755686154079543, 0.9928252824559443, 0.9253785073997917, 0.9323267133199137, 0.8886820107867148, 0.9369397010759164, 0.8309458827028796, 0.6083712172025917, 0.6880966388385816, 0.932815751705843, 0.5373192746577897, 0.8130772954653565, 0.6561058534964102, 0.9573512746370445, 0.758383061083566, 0.5, 0.8612790120065845, 0.9197522080275963, 0.7773377976467459, 0.9074765551034124, 0.9813163300504302, 0.7263536816018801, 0.6999259212354424, 0.8026904232789828, 0.9676419900077441, 0.8825375856493198, 0.607846244791141, 0.9695091160103823, 0.5236366389391367, 0.5475445087568742, 0.9519979930004602, -1.0, 0.9380819826796939, 0.6092930903422962, 0.6855527066924394, 0.9016897932644317, 0.9612731873020888, 0.993586595401888, 0.7553989320957177, 0.8296418237586396, 0.5177779445069952, 0.5, 0.9372385445450533, 0.8684129897324808, 0.8558585853676914, 0.9061834812845784, 0.519842125070235, 0.9554132696283351, 0.9429644415013878, 0.6543621559909731, 0.8985765446162431, 0.8825949449513437, 0.6718356845320763, 0.8164538223033531, 0.8877290463625311, 0.8851636847234639, 0.9339250699296486, -1.0, 0.9101473815524536, 0.9915760527241766, 0.6284540472622124, 0.763882674189903, 0.7824818293269143, 0.9976803943971957, 0.8018377403213797, 0.9188350802567206, 0.6556192611228715, 0.9755464221994639, 0.8870264071332195, 0.9913535441850838, 0.649748742648526, 0.8718140095523051, 0.5662546934264332, 0.9017679077842419, 0.798369533718797, 0.84093995037317, 0.9103193691807717, 0.9021662390482601, 0.9666250731322352, 0.9566398591247567, 0.9116834448415493, 0.5429085148864381, 0.778360150950548, 0.9905018771677399, 0.9469281445020011, 0.9211398296706177, 0.8906386671830547, 0.9212524668350921, 0.5810290580355354, 0.8862168879958721, 0.9709150921568903, 0.5, 0.9991885003105119, 0.940598981812671, 0.6702269079720984, 0.8010320985651205, 0.8677326628188794, 0.997405388653731, 0.7881404203750637, 0.5, 0.5692339663326764, 0.9634831865800684, 0.8520662434567909, 0.5825801227659817, 0.8515767278905464, 0.9196335103371367, 0.9486076120144167, 0.7659896616460707, 0.9619199403134617, 0.59184458110583, 0.5245750162264873, 0.9323016955575382, 0.8916808229421109, 0.5094024289724071], "episode_lengths": [14, 13, 14, 13, 22, 15, 13, 29, 16, 14, 17, 14, 13, 14, 17, 30, 14, 16, 13, 21, 15, 16, 15, 14, 15, 16, 29, 15, 17, 14, 18, 14, 20, 28, 18, 18, 14, 16, 15, 14, 26, 19, 17, 15, 16, 13, 16, 14, 16, 16, 13, 21, 17, 24, 14, 13, 14, 15, 13, 20, 15, 15, 14, 15, 15, 15, 26, 14, 15, 13, 21, 16, 15, 19, 15, 13, 17, 26, 21, 13, 14, 48, 14, 15, 15, 16, 21, 16, 22, 15, 17, 14, 16, 19, 14, 15, 15, 15, 14, 14, 15, 13, 16, 16, 24, 16, 19, 68, 19, 17, 15, 15, 14, 28, 16, 17, 15, 17, 16, 15, 19, 26, 22, 14, 16, 15, 23, 17, 15, 30, 15, 13, 17, 14, 14, 18, 29, 17, 13, 15, 19, 14, 28, 21, 17, 29, 15, 19, 27, 15, 14, 14, 20, 14, 26, 28, 13, 17, 15, 15, 27, 13, 14, 21, 14, 20, 16, 14, 14, 15, 13, 29, 13, 16, 15, 18, 21, 14, 19, 14, 17, 15, 15, 13, 20, 15, 23, 13, 17, 16, 14, 16, 16, 17, 14, 25, 21, 17, 14, 14, 15, 14, 22, 14, 13, 44, 15, 15, 21, 15, 19, 14, 15, 22, 20, 14, 14, 27, 13, 15, 14, 18, 14, 30, 17, 13, 19, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09664900686854268, "mean_inference_ms": 0.24390631530740786, "mean_action_processing_ms": 0.043980078463509265, "mean_env_wait_ms": 0.04718363521763154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001562164540876422, "StateBufferConnector_ms": 0.0012298425038655598, "ViewRequirementAgentConnector_ms": 0.02863950896681401}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1079.278019454802, "num_env_steps_trained_throughput_per_sec": 1079.278019454802, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 3729.218, "sample_time_ms": 1786.417, "load_time_ms": 0.217, "load_throughput": 18416263.447, "learn_time_ms": 1941.601, "learn_throughput": 2060.156, "synch_weights_time_ms": 0.644}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 10052, "training_iteration": 78, "trial_id": "default", "date": "2024-05-22_22-19-42", "timestamp": 1716409182, "time_this_iter_s": 3.710391044616699, "time_total_s": 282.3926463127136, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 282.3926463127136, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 15.559999999999999, "ram_util_percent": 61.06}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3488938105362718, "cur_kl_coeff": 0.056250000000000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.054739882984143555, "policy_loss": -0.011172232929597138, "vf_loss": 0.06467420356410745, "vf_explained_var": 0.36480590188375084, "kl": 0.022007349677348048, "entropy": 0.5740348156421415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 0.9989704754044467, "episode_reward_min": -1.0, "episode_reward_mean": 0.7684105427575372, "episode_len_mean": 16.897872340425533, "episode_media": {}, "episodes_this_iter": 235, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8946490204949379, 0.930783101707518, 0.8397910158388857, 0.9733557786124882, 0.8387318301527515, 0.944566328867401, 0.9023918372313744, 0.8250655313351548, 0.5978878627404023, 0.7150692961494105, 0.562142466402574, 0.7851342433137808, 0.8887233472187851, 0.837046942780999, 0.9428134208151938, 0.8469350352831858, 0.9455077571234562, 0.5484794520856451, 0.9267757887613922, 0.829952476202592, 0.9602510825758499, 0.9424270697964141, 0.9708117624379183, 0.7743789339590758, 0.689340270458374, 0.9623233131436701, 0.8458099347326613, 0.7339772235857027, 0.8951635979334773, 0.8836679877947764, 0.9337429515031327, 0.5076355121467582, 0.9969391228724622, 0.9936679864595405, 0.8028347678288512, 0.8779179911577354, 0.6754986082958354, 0.9038721472112655, 0.9409013827743531, 0.9565333680410507, 0.9299838043823617, 0.8113123886733843, 0.8410338488275466, 0.816322348781201, 0.5880292222112274, 0.5765121801560248, 0.7792366731272142, 0.9666252371118232, 0.9859321172343427, 0.761980872612107, 0.8287406243543419, 0.9865492643984118, 0.5515316574222937, 0.5967559304435748, 0.9955031319375549, 0.9719355656720463, 0.928964701146741, 0.8525414292962481, 0.8007541108380719, 0.8167238488878491, 0.9938284822599448, 0.8592131337908027, 0.8707623097268204, 0.9974313434589668, -1.0, 0.9895227387029893, 0.8369861398105031, 0.9168777335637832, 0.9825307568796285, 0.7659370133774468, 0.9448560231605827, 0.9081025485426774, 0.6031800562653382, 0.9673162636807372, 0.9155104314915427, 0.9680932498797068, 0.9369468055522541, 0.9187983275073216, 0.7198579775221727, 0.8984085204589127, 0.9582116057907426, 0.9786538892728436, 0.9408285769103419, 0.9855787052077579, 0.9447712481320926, 0.9790742435079677, 0.8775288351490657, 0.8133213068696411, 0.5921866510428916, 0.9089026068190169, 0.9865133074657949, 0.9949368835276047, 0.8884688716306746, 0.5, 0.8625644956100579, 0.7620349489945392, 0.8394113614430305, 0.8069786244756786, 0.6112171726982497, 0.9910522957535223, 0.985886405961353, 0.932658725861184, 0.7797146962298164, 0.9893472672040818, 0.9909188896689066, 0.9309021308409737, -1.0, 0.81030602675184, 0.9542772536372708, 0.9588259808662528, 0.9223071180909992, 0.9210815753319836, 0.8590939511676048, 0.9014042807171342, 0.920169755017209, 0.6469024561148573, 0.9481176787255599, 0.9865361247863631, 0.5, 0.5, 0.686257824274539, 0.8535158909409489, 0.9648099180517155, 0.5141727605609017, 0.915346446944664, 0.9813044245269996, 0.6822344067355361, 0.8850112300233685, 0.853479717969673, 0.7261682353366463, 0.951675117712184, 0.8700878839933881, 0.8683229588504513, 0.6133298986916634, 0.8787249355721974, 0.9166279735414828, -1.0, 0.8038635147560397, 0.9218177722372705, 0.9248872181572397, 0.8960381356410662, 0.7097518532306988, 0.9866930021139508, 0.9943361659385619, 0.9167585972361355, 0.683554322393575, 0.8599078098207971, 0.8608108674879389, 0.8555527529179112, 0.9722310378835842, 0.866709407368863, 0.9563983861039984, 0.9478392668064325, 0.5, 0.9820749471734095, -1.0, 0.7070072078933577, 0.7544194567650457, 0.8086062763837633, 0.5, 0.6240023369098369, 0.5, 0.9872612974154504, 0.6640399732745527, 0.5232617855522442, 0.8595795261884187, 0.731445559611438, 0.9648254291633431, 0.5, 0.656812830763327, 0.8900511756540059, 0.885243337525239, 0.9287472125053937, 0.9462720366617106, 0.7999455736064851, 0.9876676021216405, 0.9177874119142457, 0.8063808096685808, 0.929948360982948, 0.9348631871667812, 0.5669945265296453, 0.9799700278075671, 0.65809351964326, 0.872723124757927, 0.8481937145360451, 0.9975953114703888, 0.5393946640089635, 0.8360606617716644, -1.0, 0.9514523535630617, 0.7055916679772981, -1.0, 0.9804768616856904, 0.5506540583074011, 0.84004499817298, 0.5, -1.0, 0.7340251845616392, 0.9989704754044467, -1.0, 0.956046054949999, 0.941719832087115, 0.8638380734601423, 0.9084793478196992, 0.561072452198764, 0.785386233091209, 0.7800962036765712, 0.7413673185413397, 0.6014159289613299, 0.9791969852473058, 0.973691017003637, 0.9549088867276306, 0.7518651161070466, 0.7046877267750231, 0.9851853191788138, 0.7426315950302721, 0.9925425934669199, 0.8116042070074491, 0.9946210263239579, 0.972655002494401, 0.9361403731414821, 0.8945755600425704, 0.9147567208356194, -1.0, 0.8290883355876654, 0.7986879388630803, 0.8285410472098982, 0.9583764233002469, 0.9019820591313598, 0.8484013540006219, 0.6608920522596043, 0.7607400039434271, 0.9001349324022382, 0.8071332999869284, 0.5], "episode_lengths": [17, 14, 15, 14, 16, 16, 15, 18, 21, 19, 17, 14, 16, 14, 14, 19, 14, 27, 13, 16, 14, 17, 15, 14, 18, 15, 15, 15, 14, 22, 14, 22, 13, 14, 20, 15, 23, 17, 15, 13, 14, 18, 15, 16, 23, 17, 15, 17, 17, 18, 13, 13, 19, 34, 14, 14, 15, 17, 15, 17, 13, 15, 15, 15, 17, 17, 15, 18, 13, 15, 15, 15, 20, 14, 13, 15, 14, 14, 18, 15, 13, 15, 13, 14, 14, 14, 15, 17, 18, 17, 14, 14, 15, 58, 15, 14, 15, 14, 19, 16, 14, 13, 21, 14, 17, 13, 56, 16, 15, 15, 14, 17, 18, 19, 16, 16, 15, 14, 18, 18, 16, 15, 16, 20, 14, 14, 14, 13, 15, 14, 15, 13, 15, 30, 15, 14, 28, 16, 13, 15, 14, 17, 18, 14, 15, 20, 16, 14, 15, 16, 14, 17, 14, 18, 14, 16, 19, 17, 17, 17, 25, 19, 14, 20, 17, 14, 16, 15, 18, 19, 14, 16, 14, 15, 13, 15, 14, 14, 15, 15, 19, 14, 20, 15, 16, 14, 18, 13, 14, 14, 17, 15, 14, 17, 14, 27, 30, 25, 15, 59, 15, 13, 24, 15, 20, 14, 14, 18, 24, 15, 14, 14, 15, 19, 15, 17, 16, 19, 16, 13, 14, 15, 13, 47, 16, 17, 15, 15, 17, 15, 21, 17, 14, 16, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0967525735612864, "mean_inference_ms": 0.24390782734745986, "mean_action_processing_ms": 0.043979556904841496, "mean_env_wait_ms": 0.047194960788825784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001533893828696393, "StateBufferConnector_ms": 0.0012289209568754156, "ViewRequirementAgentConnector_ms": 0.028676175056619846}}, "episode_reward_max": 0.9989704754044467, "episode_reward_min": -1.0, "episode_reward_mean": 0.7684105427575372, "episode_len_mean": 16.897872340425533, "episodes_this_iter": 235, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8946490204949379, 0.930783101707518, 0.8397910158388857, 0.9733557786124882, 0.8387318301527515, 0.944566328867401, 0.9023918372313744, 0.8250655313351548, 0.5978878627404023, 0.7150692961494105, 0.562142466402574, 0.7851342433137808, 0.8887233472187851, 0.837046942780999, 0.9428134208151938, 0.8469350352831858, 0.9455077571234562, 0.5484794520856451, 0.9267757887613922, 0.829952476202592, 0.9602510825758499, 0.9424270697964141, 0.9708117624379183, 0.7743789339590758, 0.689340270458374, 0.9623233131436701, 0.8458099347326613, 0.7339772235857027, 0.8951635979334773, 0.8836679877947764, 0.9337429515031327, 0.5076355121467582, 0.9969391228724622, 0.9936679864595405, 0.8028347678288512, 0.8779179911577354, 0.6754986082958354, 0.9038721472112655, 0.9409013827743531, 0.9565333680410507, 0.9299838043823617, 0.8113123886733843, 0.8410338488275466, 0.816322348781201, 0.5880292222112274, 0.5765121801560248, 0.7792366731272142, 0.9666252371118232, 0.9859321172343427, 0.761980872612107, 0.8287406243543419, 0.9865492643984118, 0.5515316574222937, 0.5967559304435748, 0.9955031319375549, 0.9719355656720463, 0.928964701146741, 0.8525414292962481, 0.8007541108380719, 0.8167238488878491, 0.9938284822599448, 0.8592131337908027, 0.8707623097268204, 0.9974313434589668, -1.0, 0.9895227387029893, 0.8369861398105031, 0.9168777335637832, 0.9825307568796285, 0.7659370133774468, 0.9448560231605827, 0.9081025485426774, 0.6031800562653382, 0.9673162636807372, 0.9155104314915427, 0.9680932498797068, 0.9369468055522541, 0.9187983275073216, 0.7198579775221727, 0.8984085204589127, 0.9582116057907426, 0.9786538892728436, 0.9408285769103419, 0.9855787052077579, 0.9447712481320926, 0.9790742435079677, 0.8775288351490657, 0.8133213068696411, 0.5921866510428916, 0.9089026068190169, 0.9865133074657949, 0.9949368835276047, 0.8884688716306746, 0.5, 0.8625644956100579, 0.7620349489945392, 0.8394113614430305, 0.8069786244756786, 0.6112171726982497, 0.9910522957535223, 0.985886405961353, 0.932658725861184, 0.7797146962298164, 0.9893472672040818, 0.9909188896689066, 0.9309021308409737, -1.0, 0.81030602675184, 0.9542772536372708, 0.9588259808662528, 0.9223071180909992, 0.9210815753319836, 0.8590939511676048, 0.9014042807171342, 0.920169755017209, 0.6469024561148573, 0.9481176787255599, 0.9865361247863631, 0.5, 0.5, 0.686257824274539, 0.8535158909409489, 0.9648099180517155, 0.5141727605609017, 0.915346446944664, 0.9813044245269996, 0.6822344067355361, 0.8850112300233685, 0.853479717969673, 0.7261682353366463, 0.951675117712184, 0.8700878839933881, 0.8683229588504513, 0.6133298986916634, 0.8787249355721974, 0.9166279735414828, -1.0, 0.8038635147560397, 0.9218177722372705, 0.9248872181572397, 0.8960381356410662, 0.7097518532306988, 0.9866930021139508, 0.9943361659385619, 0.9167585972361355, 0.683554322393575, 0.8599078098207971, 0.8608108674879389, 0.8555527529179112, 0.9722310378835842, 0.866709407368863, 0.9563983861039984, 0.9478392668064325, 0.5, 0.9820749471734095, -1.0, 0.7070072078933577, 0.7544194567650457, 0.8086062763837633, 0.5, 0.6240023369098369, 0.5, 0.9872612974154504, 0.6640399732745527, 0.5232617855522442, 0.8595795261884187, 0.731445559611438, 0.9648254291633431, 0.5, 0.656812830763327, 0.8900511756540059, 0.885243337525239, 0.9287472125053937, 0.9462720366617106, 0.7999455736064851, 0.9876676021216405, 0.9177874119142457, 0.8063808096685808, 0.929948360982948, 0.9348631871667812, 0.5669945265296453, 0.9799700278075671, 0.65809351964326, 0.872723124757927, 0.8481937145360451, 0.9975953114703888, 0.5393946640089635, 0.8360606617716644, -1.0, 0.9514523535630617, 0.7055916679772981, -1.0, 0.9804768616856904, 0.5506540583074011, 0.84004499817298, 0.5, -1.0, 0.7340251845616392, 0.9989704754044467, -1.0, 0.956046054949999, 0.941719832087115, 0.8638380734601423, 0.9084793478196992, 0.561072452198764, 0.785386233091209, 0.7800962036765712, 0.7413673185413397, 0.6014159289613299, 0.9791969852473058, 0.973691017003637, 0.9549088867276306, 0.7518651161070466, 0.7046877267750231, 0.9851853191788138, 0.7426315950302721, 0.9925425934669199, 0.8116042070074491, 0.9946210263239579, 0.972655002494401, 0.9361403731414821, 0.8945755600425704, 0.9147567208356194, -1.0, 0.8290883355876654, 0.7986879388630803, 0.8285410472098982, 0.9583764233002469, 0.9019820591313598, 0.8484013540006219, 0.6608920522596043, 0.7607400039434271, 0.9001349324022382, 0.8071332999869284, 0.5], "episode_lengths": [17, 14, 15, 14, 16, 16, 15, 18, 21, 19, 17, 14, 16, 14, 14, 19, 14, 27, 13, 16, 14, 17, 15, 14, 18, 15, 15, 15, 14, 22, 14, 22, 13, 14, 20, 15, 23, 17, 15, 13, 14, 18, 15, 16, 23, 17, 15, 17, 17, 18, 13, 13, 19, 34, 14, 14, 15, 17, 15, 17, 13, 15, 15, 15, 17, 17, 15, 18, 13, 15, 15, 15, 20, 14, 13, 15, 14, 14, 18, 15, 13, 15, 13, 14, 14, 14, 15, 17, 18, 17, 14, 14, 15, 58, 15, 14, 15, 14, 19, 16, 14, 13, 21, 14, 17, 13, 56, 16, 15, 15, 14, 17, 18, 19, 16, 16, 15, 14, 18, 18, 16, 15, 16, 20, 14, 14, 14, 13, 15, 14, 15, 13, 15, 30, 15, 14, 28, 16, 13, 15, 14, 17, 18, 14, 15, 20, 16, 14, 15, 16, 14, 17, 14, 18, 14, 16, 19, 17, 17, 17, 25, 19, 14, 20, 17, 14, 16, 15, 18, 19, 14, 16, 14, 15, 13, 15, 14, 14, 15, 15, 19, 14, 20, 15, 16, 14, 18, 13, 14, 14, 17, 15, 14, 17, 14, 27, 30, 25, 15, 59, 15, 13, 24, 15, 20, 14, 14, 18, 24, 15, 14, 14, 15, 19, 15, 17, 16, 19, 16, 13, 14, 15, 13, 47, 16, 17, 15, 15, 17, 15, 21, 17, 14, 16, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0967525735612864, "mean_inference_ms": 0.24390782734745986, "mean_action_processing_ms": 0.043979556904841496, "mean_env_wait_ms": 0.047194960788825784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001533893828696393, "StateBufferConnector_ms": 0.0012289209568754156, "ViewRequirementAgentConnector_ms": 0.028676175056619846}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1088.6116671687785, "num_env_steps_trained_throughput_per_sec": 1088.6116671687785, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 3733.608, "sample_time_ms": 1787.041, "load_time_ms": 0.215, "load_throughput": 18620661.487, "learn_time_ms": 1945.375, "learn_throughput": 2056.159, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 10287, "training_iteration": 79, "trial_id": "default", "date": "2024-05-22_22-19-46", "timestamp": 1716409186, "time_this_iter_s": 3.6787071228027344, "time_total_s": 286.07135343551636, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 286.07135343551636, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 19.919999999999998, "ram_util_percent": 60.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.221237898770199, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.046699931823037645, "policy_loss": -0.006982454098761082, "vf_loss": 0.05249339471926652, "vf_explained_var": 0.30461791946041966, "kl": 0.014091765764672321, "entropy": 0.6166666023513322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 0.99998028227633, "episode_reward_min": -1.0, "episode_reward_mean": 0.7679377815093574, "episode_len_mean": 17.41991341991342, "episode_media": {}, "episodes_this_iter": 231, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.9593076633356432, 0.7110034100862276, 0.9334840899640915, 0.8536749705393825, 0.7850868584296935, -1.0, 0.8179577818696467, -1.0, 0.9647516965299402, 0.9983413344744989, 0.8422580229945845, 0.8949025334898669, 0.9041690739569384, 0.9811630678029177, 0.7976662446824856, 0.9759425798150946, 0.9813765984012662, 0.7709464522364062, 0.6554229383411323, 0.8168465879162163, 0.8125098887877915, 0.9136348468647517, 0.9385468949865325, 0.9033328177455704, 0.9178245697912619, 0.9321466972950955, 0.8382012211921133, 0.9960184440852525, 0.7767316889684667, 0.8967730924042441, 0.9807511212860204, 0.8859122763664873, 0.8384508241052284, 0.5946173093950511, 0.9510167654281805, 0.9853424401969653, 0.9108266971219289, 0.9338230083081607, 0.9994442665295875, 0.80261756748135, 0.9721459934825682, 0.9741717494524269, 0.5784690260241049, 0.7534536720629587, 0.6695346724030772, 0.9447976965108691, 0.8562443001088254, 0.9260486412807364, 0.8977328787639786, 0.7322084253686543, 0.5533096489040655, 0.978688788692334, 0.8429555640403672, 0.892615735973591, 0.7898628610883593, 0.888572030720361, 0.8320399572302787, 0.9121290991902247, -1.0, 0.8634019216291252, 0.9297633057854477, 0.9859777516739054, 0.9554464974887937, 0.9977333727612745, 0.9938508392231308, 0.6079568394453374, 0.9620354249674058, -1.0, 0.8856606787553664, 0.9468508292325207, 0.8953381677773666, 0.9777094423049313, 0.7772666122108531, 0.8179824620412005, 0.8704833872985503, 0.8212857851779269, 0.9727056430108764, 0.6464808288682091, -1.0, 0.9550628153953156, 0.7637154877344436, 0.7390629524926509, 0.985149967538501, 0.6078180695425586, 0.9932599210532433, 0.5, 0.8460884868396861, 0.7616130900190469, 0.9355481235789925, 0.7647383757153566, 0.9918179952965691, 0.8069394581034531, 0.8015310852325459, 0.7951769660968763, 0.9738627493317324, 0.9969530459433342, 0.5851015603752919, 0.8462874465177238, 0.9945542881331321, 0.7776440906602007, 0.7521883437141644, -1.0, 0.6813970022777175, 0.8817276798344239, 0.8816535231643909, 0.9376364341296286, 0.7537952901283705, 0.6065864200180691, 0.6090123159473262, 0.81795575723675, 0.8821807276361158, 0.9030955057017522, 0.9976330300801681, 0.9610481288420876, 0.9513963977676421, 0.867974206639691, 0.5993968944164966, 0.7229621157015318, 0.9476490415392748, 0.845682434704528, 0.5239087545992835, 0.9779715734092399, 0.7536751809891036, 0.7777909588923005, 0.9626760104701844, 0.9188264927960611, 0.8731395449959687, 0.9266396532623649, 0.5945248590523896, 0.9344703109333542, 0.7944564963263591, 0.5525731505809018, 0.618163053676094, 0.5837262892681262, 0.9933520014881171, 0.7602556803306378, 0.8983953253005147, 0.7697107932499105, 0.596243032037779, 0.5, 0.9293475051375366, 0.9255044211057626, 0.9192225158474099, 0.8636476968046681, 0.7973421338111794, 0.8566655311259573, 0.9464461968054297, 0.6720124836297281, 0.7944685187614926, 0.9910443735218867, 0.9635481269838471, 0.6982770392249505, 0.9338065947000299, 0.825323018267742, 0.8879661617533292, 0.9330623978892226, 0.99998028227633, 0.5, 0.8735042297084666, 0.7016796612487711, 0.9218086376964938, 0.978750674316925, 0.9069753046736971, 0.8687652466596192, 0.9461999276074796, 0.7860984849840034, 0.9237315523926334, 0.764985350891696, 0.9992123551161639, 0.7434253723991202, 0.6061450963664188, 0.9099055579542706, 0.7217013486602766, 0.8400389867294096, 0.9047033495652314, 0.8117653282236533, 0.9288928766822666, 0.9823942540974638, 0.8902371945991763, 0.9514455229091957, 0.7823728168542795, 0.9867067006998167, 0.9669377042766879, -1.0, 0.9296749851663344, 0.9102376436252966, 0.8910868163889268, 0.8756434005897276, 0.5, 0.9293484861781498, 0.9793984594640641, 0.6859253518540318, 0.9865781032408076, 0.9685831020497557, 0.9921500927547989, 0.9712582567660174, 0.9212698189931899, 0.7884146904517385, 0.5939771607711886, 0.9661938378304512, -1.0, 0.9121641168816476, 0.5986139720665795, 0.7465804390395558, 0.9598969883487867, 0.9518723008728482, 0.5688027054180107, 0.9045574019701769, 0.812816589610642, -1.0, 0.7730337640874786, 0.9195716228922516, 0.8444610056091326, 0.9980035889303627, 0.947629769981706, 0.9611882202802181, 0.9540886247531968, 0.8045385139003367, 0.8463169604124968, 0.9930946274356915, 0.5162153553402746, 0.9721356591175159, 0.5883598633207412, 0.6681677426398562, 0.8548086473654308, 0.9217937162800007, 0.9320386790421746, 0.9027533956876602, 0.9577087218272426, 0.8674945355698224], "episode_lengths": [63, 15, 22, 15, 13, 20, 37, 15, 12, 14, 14, 18, 18, 27, 15, 17, 16, 14, 29, 22, 13, 16, 13, 13, 16, 15, 15, 16, 14, 14, 15, 13, 13, 16, 36, 17, 15, 16, 16, 15, 15, 13, 13, 15, 17, 15, 14, 13, 14, 16, 14, 27, 15, 16, 15, 14, 14, 18, 17, 80, 15, 18, 13, 15, 14, 13, 23, 14, 12, 14, 14, 14, 14, 19, 14, 15, 18, 16, 20, 22, 15, 17, 17, 13, 17, 16, 17, 14, 18, 14, 13, 16, 18, 16, 18, 15, 14, 19, 16, 15, 14, 17, 13, 29, 14, 14, 15, 15, 24, 20, 19, 14, 14, 16, 15, 15, 16, 42, 19, 14, 21, 17, 14, 34, 15, 13, 14, 15, 14, 23, 13, 24, 22, 15, 22, 16, 16, 13, 21, 20, 22, 15, 13, 14, 16, 17, 14, 14, 23, 16, 15, 14, 19, 17, 18, 18, 13, 16, 17, 15, 16, 16, 14, 16, 16, 17, 14, 14, 16, 13, 37, 17, 14, 17, 13, 17, 13, 15, 15, 15, 15, 19, 14, 15, 16, 14, 18, 17, 13, 17, 15, 16, 25, 14, 14, 14, 18, 14, 22, 19, 15, 39, 15, 22, 23, 13, 13, 21, 13, 14, 66, 15, 14, 17, 13, 13, 17, 13, 15, 18, 14, 26, 14, 26, 20, 15, 16, 19, 14, 13, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09685565960252247, "mean_inference_ms": 0.24392189824387916, "mean_action_processing_ms": 0.043982606771272796, "mean_env_wait_ms": 0.04720745086491107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015296977319758692, "StateBufferConnector_ms": 0.001234203189998478, "ViewRequirementAgentConnector_ms": 0.02864934665300113}}, "episode_reward_max": 0.99998028227633, "episode_reward_min": -1.0, "episode_reward_mean": 0.7679377815093574, "episode_len_mean": 17.41991341991342, "episodes_this_iter": 231, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.9593076633356432, 0.7110034100862276, 0.9334840899640915, 0.8536749705393825, 0.7850868584296935, -1.0, 0.8179577818696467, -1.0, 0.9647516965299402, 0.9983413344744989, 0.8422580229945845, 0.8949025334898669, 0.9041690739569384, 0.9811630678029177, 0.7976662446824856, 0.9759425798150946, 0.9813765984012662, 0.7709464522364062, 0.6554229383411323, 0.8168465879162163, 0.8125098887877915, 0.9136348468647517, 0.9385468949865325, 0.9033328177455704, 0.9178245697912619, 0.9321466972950955, 0.8382012211921133, 0.9960184440852525, 0.7767316889684667, 0.8967730924042441, 0.9807511212860204, 0.8859122763664873, 0.8384508241052284, 0.5946173093950511, 0.9510167654281805, 0.9853424401969653, 0.9108266971219289, 0.9338230083081607, 0.9994442665295875, 0.80261756748135, 0.9721459934825682, 0.9741717494524269, 0.5784690260241049, 0.7534536720629587, 0.6695346724030772, 0.9447976965108691, 0.8562443001088254, 0.9260486412807364, 0.8977328787639786, 0.7322084253686543, 0.5533096489040655, 0.978688788692334, 0.8429555640403672, 0.892615735973591, 0.7898628610883593, 0.888572030720361, 0.8320399572302787, 0.9121290991902247, -1.0, 0.8634019216291252, 0.9297633057854477, 0.9859777516739054, 0.9554464974887937, 0.9977333727612745, 0.9938508392231308, 0.6079568394453374, 0.9620354249674058, -1.0, 0.8856606787553664, 0.9468508292325207, 0.8953381677773666, 0.9777094423049313, 0.7772666122108531, 0.8179824620412005, 0.8704833872985503, 0.8212857851779269, 0.9727056430108764, 0.6464808288682091, -1.0, 0.9550628153953156, 0.7637154877344436, 0.7390629524926509, 0.985149967538501, 0.6078180695425586, 0.9932599210532433, 0.5, 0.8460884868396861, 0.7616130900190469, 0.9355481235789925, 0.7647383757153566, 0.9918179952965691, 0.8069394581034531, 0.8015310852325459, 0.7951769660968763, 0.9738627493317324, 0.9969530459433342, 0.5851015603752919, 0.8462874465177238, 0.9945542881331321, 0.7776440906602007, 0.7521883437141644, -1.0, 0.6813970022777175, 0.8817276798344239, 0.8816535231643909, 0.9376364341296286, 0.7537952901283705, 0.6065864200180691, 0.6090123159473262, 0.81795575723675, 0.8821807276361158, 0.9030955057017522, 0.9976330300801681, 0.9610481288420876, 0.9513963977676421, 0.867974206639691, 0.5993968944164966, 0.7229621157015318, 0.9476490415392748, 0.845682434704528, 0.5239087545992835, 0.9779715734092399, 0.7536751809891036, 0.7777909588923005, 0.9626760104701844, 0.9188264927960611, 0.8731395449959687, 0.9266396532623649, 0.5945248590523896, 0.9344703109333542, 0.7944564963263591, 0.5525731505809018, 0.618163053676094, 0.5837262892681262, 0.9933520014881171, 0.7602556803306378, 0.8983953253005147, 0.7697107932499105, 0.596243032037779, 0.5, 0.9293475051375366, 0.9255044211057626, 0.9192225158474099, 0.8636476968046681, 0.7973421338111794, 0.8566655311259573, 0.9464461968054297, 0.6720124836297281, 0.7944685187614926, 0.9910443735218867, 0.9635481269838471, 0.6982770392249505, 0.9338065947000299, 0.825323018267742, 0.8879661617533292, 0.9330623978892226, 0.99998028227633, 0.5, 0.8735042297084666, 0.7016796612487711, 0.9218086376964938, 0.978750674316925, 0.9069753046736971, 0.8687652466596192, 0.9461999276074796, 0.7860984849840034, 0.9237315523926334, 0.764985350891696, 0.9992123551161639, 0.7434253723991202, 0.6061450963664188, 0.9099055579542706, 0.7217013486602766, 0.8400389867294096, 0.9047033495652314, 0.8117653282236533, 0.9288928766822666, 0.9823942540974638, 0.8902371945991763, 0.9514455229091957, 0.7823728168542795, 0.9867067006998167, 0.9669377042766879, -1.0, 0.9296749851663344, 0.9102376436252966, 0.8910868163889268, 0.8756434005897276, 0.5, 0.9293484861781498, 0.9793984594640641, 0.6859253518540318, 0.9865781032408076, 0.9685831020497557, 0.9921500927547989, 0.9712582567660174, 0.9212698189931899, 0.7884146904517385, 0.5939771607711886, 0.9661938378304512, -1.0, 0.9121641168816476, 0.5986139720665795, 0.7465804390395558, 0.9598969883487867, 0.9518723008728482, 0.5688027054180107, 0.9045574019701769, 0.812816589610642, -1.0, 0.7730337640874786, 0.9195716228922516, 0.8444610056091326, 0.9980035889303627, 0.947629769981706, 0.9611882202802181, 0.9540886247531968, 0.8045385139003367, 0.8463169604124968, 0.9930946274356915, 0.5162153553402746, 0.9721356591175159, 0.5883598633207412, 0.6681677426398562, 0.8548086473654308, 0.9217937162800007, 0.9320386790421746, 0.9027533956876602, 0.9577087218272426, 0.8674945355698224], "episode_lengths": [63, 15, 22, 15, 13, 20, 37, 15, 12, 14, 14, 18, 18, 27, 15, 17, 16, 14, 29, 22, 13, 16, 13, 13, 16, 15, 15, 16, 14, 14, 15, 13, 13, 16, 36, 17, 15, 16, 16, 15, 15, 13, 13, 15, 17, 15, 14, 13, 14, 16, 14, 27, 15, 16, 15, 14, 14, 18, 17, 80, 15, 18, 13, 15, 14, 13, 23, 14, 12, 14, 14, 14, 14, 19, 14, 15, 18, 16, 20, 22, 15, 17, 17, 13, 17, 16, 17, 14, 18, 14, 13, 16, 18, 16, 18, 15, 14, 19, 16, 15, 14, 17, 13, 29, 14, 14, 15, 15, 24, 20, 19, 14, 14, 16, 15, 15, 16, 42, 19, 14, 21, 17, 14, 34, 15, 13, 14, 15, 14, 23, 13, 24, 22, 15, 22, 16, 16, 13, 21, 20, 22, 15, 13, 14, 16, 17, 14, 14, 23, 16, 15, 14, 19, 17, 18, 18, 13, 16, 17, 15, 16, 16, 14, 16, 16, 17, 14, 14, 16, 13, 37, 17, 14, 17, 13, 17, 13, 15, 15, 15, 15, 19, 14, 15, 16, 14, 18, 17, 13, 17, 15, 16, 25, 14, 14, 14, 18, 14, 22, 19, 15, 39, 15, 22, 23, 13, 13, 21, 13, 14, 66, 15, 14, 17, 13, 13, 17, 13, 15, 18, 14, 26, 14, 26, 20, 15, 16, 19, 14, 13, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09685565960252247, "mean_inference_ms": 0.24392189824387916, "mean_action_processing_ms": 0.043982606771272796, "mean_env_wait_ms": 0.04720745086491107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015296977319758692, "StateBufferConnector_ms": 0.001234203189998478, "ViewRequirementAgentConnector_ms": 0.02864934665300113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1026.968392465943, "num_env_steps_trained_throughput_per_sec": 1026.968392465943, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 3759.129, "sample_time_ms": 1787.935, "load_time_ms": 0.214, "load_throughput": 18666239.43, "learn_time_ms": 1970.005, "learn_throughput": 2030.451, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 10518, "training_iteration": 80, "trial_id": "default", "date": "2024-05-22_22-19-50", "timestamp": 1716409190, "time_this_iter_s": 3.8992247581481934, "time_total_s": 289.97057819366455, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 289.97057819366455, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 23.383333333333336, "ram_util_percent": 60.83333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.795976807096953, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02817610323989904, "policy_loss": -0.010838258963438773, "vf_loss": 0.037895062014270293, "vf_explained_var": 0.17556656605453902, "kl": 0.013265764351493499, "entropy": 0.5463874401584748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 0.9968350277415392, "episode_reward_min": -1.0, "episode_reward_mean": 0.8150414210936962, "episode_len_mean": 16.177419354838708, "episode_media": {}, "episodes_this_iter": 248, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.784592694354004, 0.9717224613765572, 0.9902354818962307, 0.9427533348365484, 0.8151113817900941, 0.9071851972949092, 0.8585821360957229, 0.9345261555638149, 0.9406401164509237, 0.8279392822157543, 0.852966543118352, 0.9205293004426733, 0.9930643202203927, 0.5792392766286938, 0.7972723140480158, 0.862123795404622, 0.98481872451455, 0.7308091842893896, 0.9488323534002747, 0.7195797206203927, 0.9734274981877716, 0.9770168970441663, 0.9326829770769516, 0.953492605144397, 0.9084181776711282, 0.9174792422747468, 0.9520115786116663, 0.898238018632981, 0.9116633649002511, 0.9084079934052847, 0.9769885480496672, 0.9233722184072531, 0.8528785283233766, 0.9773020306369441, 0.8084760425928773, 0.8158511966767625, 0.9654393326852132, 0.8961012467210416, 0.8569873786116435, 0.8149052890457464, 0.8189926644417759, 0.9965019773425181, 0.9337609526679438, -1.0, 0.9481086459166511, 0.5246403084539337, 0.9654676114945517, 0.9959931981629724, 0.8707309730591908, 0.9519327083361832, 0.8597372948042955, 0.6275746678153371, 0.9625326231575552, 0.9205185736630324, -1.0, 0.9557967351147519, 0.7450513461664647, 0.9615660708118652, 0.7232824190664201, 0.9409028511073724, 0.9218478310675637, 0.8045264800687062, 0.6545550866522283, 0.9947899593095986, 0.8587739923051643, 0.9247176512527999, 0.9866796852783966, 0.8295312413148044, 0.7439761891839003, 0.7173981797950502, 0.8166422431454896, 0.8679424012044049, 0.924938519759421, 0.9276226342490269, 0.8926446897134814, 0.9355269180512552, 0.9812077570725026, 0.8954354243104671, 0.6361594245318394, 0.9182918063949164, 0.8985359311869581, 0.9327948222593433, 0.9850037707156711, 0.7807612227030977, 0.5917888036931238, 0.8970876762291525, 0.9765782663725477, 0.9039609406504368, 0.9862464655505321, 0.8163769359476608, 0.7811031129567848, 0.9169017888210668, 0.5553945439214558, 0.9625911285560249, 0.9419112065628776, 0.672481638957137, 0.6810006692992576, 0.8288178316029485, 0.6262901906955458, 0.9115354027472172, 0.7890586222367333, 0.881723427298265, 0.8436382404275613, 0.9385606747629317, 0.7889005010983106, 0.7208989400499712, 0.8652148532232632, 0.9878653864229643, 0.8316659698596476, 0.9662953423103644, 0.9258823995630648, 0.8821295347820497, 0.6011868086638179, 0.8213489547267894, 0.7774096842616162, 0.6567668262088897, 0.9355338969283524, 0.9301082940809615, 0.9751836029702965, 0.9085841956168728, 0.9968350277415392, 0.7145552757376604, 0.8784184187863283, -1.0, 0.7372583487686942, 0.7972712190370063, 0.8862410836747665, 0.7861510294491316, 0.9414627021334702, 0.8202974492451296, 0.8857678263669292, 0.9144399982763319, 0.7650056840238196, 0.7447222105542786, 0.8930686698608884, 0.6770107550200275, 0.596688109384688, 0.9659068464715264, 0.8573085056308958, 0.9808246564649484, 0.9858935531138366, 0.9573465425938212, 0.7741921994774947, 0.8506981090634765, 0.8578986476759725, 0.9420451141100873, 0.8503292446037055, -1.0, 0.7704309161282464, 0.8778031764981792, 0.8331883198377183, 0.9647184328637354, 0.5378021142168595, 0.9530278859724074, 0.6131521878683182, 0.9914319063050139, 0.8804769632081713, 0.992386064183608, 0.5895087974588218, 0.9236480082965364, 0.9195030903788627, 0.829554583322924, 0.9723958035912705, 0.7926496900528229, 0.7493929120630691, 0.8278084814241284, 0.8407936509970005, 0.686961129955827, 0.7768566817398124, 0.9563814844934845, 0.7576132654486336, 0.9383473900272873, 0.8160851235740751, 0.9351387506828601, 0.9342798157443972, -1.0, 0.553214933125894, 0.9073231628293867, 0.9872937360893738, 0.9941011257358885, 0.9950335524962577, 0.9909998675288307, 0.659878812686909, 0.9500393617519635, 0.9304616168452151, 0.8649901922289968, 0.9070187488936943, 0.9631787572318159, 0.9449436670375417, 0.871948214121301, 0.6701490980253029, 0.9587426701411218, 0.7224305036924903, 0.8616942129609885, 0.8124859598298191, 0.5529274588012716, 0.9414901089164684, 0.8682368537927528, 0.8813610977051298, 0.8637229829001054, 0.8909893265624708, 0.9900361484976813, 0.9047037123737008, 0.9457887636647593, 0.9147675547396664, 0.7694354587884323, 0.8909469650204287, 0.8871126293501618, 0.9291694325862411, 0.7644308548930339, 0.990801279546122, 0.9557271747673879, 0.6995049801304514, 0.7392189347322768, 0.8948717700124591, 0.8757981456199683, 0.8992347364900917, 0.9895045003903284, 0.8485758596135312, 0.9079789057716044, 0.9431252995444656, 0.7741636208160508, 0.9571956661941595, 0.5, 0.9793509137658367, 0.9711959727486736, 0.7594715377448377, 0.7401070443027602, 0.8911688447878369, 0.9557993268463069, 0.9727872317258972, 0.6911528698558905, 0.7797244984653223, 0.9289531897990587, 0.5, 0.7963060619847759, 0.9392949005412895, 0.8417561736576546, 0.8838147578651703, 0.9334833052073975, -1.0, 0.8895208175781714, 0.8645714632648036, 0.9254884796613027, 0.8134734534788126, 0.8367512427990857, 0.9081587586848348, 0.8971371369692374], "episode_lengths": [20, 14, 14, 14, 19, 16, 15, 16, 14, 13, 14, 14, 14, 24, 13, 15, 16, 22, 15, 15, 18, 14, 16, 19, 14, 14, 15, 14, 13, 14, 13, 13, 14, 15, 14, 14, 15, 13, 15, 14, 14, 14, 15, 13, 14, 29, 15, 15, 17, 15, 14, 25, 14, 13, 14, 15, 14, 13, 14, 16, 14, 14, 26, 15, 14, 14, 14, 18, 28, 15, 14, 13, 13, 17, 14, 13, 13, 13, 16, 14, 15, 14, 16, 14, 22, 17, 16, 15, 14, 13, 16, 13, 29, 14, 14, 21, 18, 15, 38, 14, 22, 15, 17, 14, 14, 15, 14, 15, 18, 16, 15, 16, 31, 16, 15, 23, 13, 14, 15, 15, 15, 21, 14, 13, 23, 14, 13, 22, 15, 18, 14, 15, 14, 14, 13, 22, 41, 16, 20, 15, 14, 14, 17, 14, 15, 15, 14, 16, 21, 19, 15, 13, 37, 14, 19, 14, 19, 13, 23, 13, 15, 16, 13, 16, 17, 17, 15, 18, 16, 15, 17, 13, 13, 14, 13, 30, 29, 15, 14, 13, 18, 14, 19, 13, 14, 14, 14, 14, 17, 16, 19, 14, 24, 14, 30, 17, 15, 14, 14, 13, 14, 21, 14, 14, 14, 21, 17, 14, 14, 23, 14, 15, 17, 15, 15, 14, 14, 15, 13, 14, 15, 15, 15, 19, 14, 13, 17, 14, 13, 13, 14, 26, 15, 14, 28, 16, 17, 16, 14, 15, 13, 14, 17, 14, 14, 14, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0970430197333658, "mean_inference_ms": 0.24400770484481882, "mean_action_processing_ms": 0.0439967891787976, "mean_env_wait_ms": 0.04723332611798602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015871178719305222, "StateBufferConnector_ms": 0.0012730398485737463, "ViewRequirementAgentConnector_ms": 0.029276936284957394}}, "episode_reward_max": 0.9968350277415392, "episode_reward_min": -1.0, "episode_reward_mean": 0.8150414210936962, "episode_len_mean": 16.177419354838708, "episodes_this_iter": 248, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.784592694354004, 0.9717224613765572, 0.9902354818962307, 0.9427533348365484, 0.8151113817900941, 0.9071851972949092, 0.8585821360957229, 0.9345261555638149, 0.9406401164509237, 0.8279392822157543, 0.852966543118352, 0.9205293004426733, 0.9930643202203927, 0.5792392766286938, 0.7972723140480158, 0.862123795404622, 0.98481872451455, 0.7308091842893896, 0.9488323534002747, 0.7195797206203927, 0.9734274981877716, 0.9770168970441663, 0.9326829770769516, 0.953492605144397, 0.9084181776711282, 0.9174792422747468, 0.9520115786116663, 0.898238018632981, 0.9116633649002511, 0.9084079934052847, 0.9769885480496672, 0.9233722184072531, 0.8528785283233766, 0.9773020306369441, 0.8084760425928773, 0.8158511966767625, 0.9654393326852132, 0.8961012467210416, 0.8569873786116435, 0.8149052890457464, 0.8189926644417759, 0.9965019773425181, 0.9337609526679438, -1.0, 0.9481086459166511, 0.5246403084539337, 0.9654676114945517, 0.9959931981629724, 0.8707309730591908, 0.9519327083361832, 0.8597372948042955, 0.6275746678153371, 0.9625326231575552, 0.9205185736630324, -1.0, 0.9557967351147519, 0.7450513461664647, 0.9615660708118652, 0.7232824190664201, 0.9409028511073724, 0.9218478310675637, 0.8045264800687062, 0.6545550866522283, 0.9947899593095986, 0.8587739923051643, 0.9247176512527999, 0.9866796852783966, 0.8295312413148044, 0.7439761891839003, 0.7173981797950502, 0.8166422431454896, 0.8679424012044049, 0.924938519759421, 0.9276226342490269, 0.8926446897134814, 0.9355269180512552, 0.9812077570725026, 0.8954354243104671, 0.6361594245318394, 0.9182918063949164, 0.8985359311869581, 0.9327948222593433, 0.9850037707156711, 0.7807612227030977, 0.5917888036931238, 0.8970876762291525, 0.9765782663725477, 0.9039609406504368, 0.9862464655505321, 0.8163769359476608, 0.7811031129567848, 0.9169017888210668, 0.5553945439214558, 0.9625911285560249, 0.9419112065628776, 0.672481638957137, 0.6810006692992576, 0.8288178316029485, 0.6262901906955458, 0.9115354027472172, 0.7890586222367333, 0.881723427298265, 0.8436382404275613, 0.9385606747629317, 0.7889005010983106, 0.7208989400499712, 0.8652148532232632, 0.9878653864229643, 0.8316659698596476, 0.9662953423103644, 0.9258823995630648, 0.8821295347820497, 0.6011868086638179, 0.8213489547267894, 0.7774096842616162, 0.6567668262088897, 0.9355338969283524, 0.9301082940809615, 0.9751836029702965, 0.9085841956168728, 0.9968350277415392, 0.7145552757376604, 0.8784184187863283, -1.0, 0.7372583487686942, 0.7972712190370063, 0.8862410836747665, 0.7861510294491316, 0.9414627021334702, 0.8202974492451296, 0.8857678263669292, 0.9144399982763319, 0.7650056840238196, 0.7447222105542786, 0.8930686698608884, 0.6770107550200275, 0.596688109384688, 0.9659068464715264, 0.8573085056308958, 0.9808246564649484, 0.9858935531138366, 0.9573465425938212, 0.7741921994774947, 0.8506981090634765, 0.8578986476759725, 0.9420451141100873, 0.8503292446037055, -1.0, 0.7704309161282464, 0.8778031764981792, 0.8331883198377183, 0.9647184328637354, 0.5378021142168595, 0.9530278859724074, 0.6131521878683182, 0.9914319063050139, 0.8804769632081713, 0.992386064183608, 0.5895087974588218, 0.9236480082965364, 0.9195030903788627, 0.829554583322924, 0.9723958035912705, 0.7926496900528229, 0.7493929120630691, 0.8278084814241284, 0.8407936509970005, 0.686961129955827, 0.7768566817398124, 0.9563814844934845, 0.7576132654486336, 0.9383473900272873, 0.8160851235740751, 0.9351387506828601, 0.9342798157443972, -1.0, 0.553214933125894, 0.9073231628293867, 0.9872937360893738, 0.9941011257358885, 0.9950335524962577, 0.9909998675288307, 0.659878812686909, 0.9500393617519635, 0.9304616168452151, 0.8649901922289968, 0.9070187488936943, 0.9631787572318159, 0.9449436670375417, 0.871948214121301, 0.6701490980253029, 0.9587426701411218, 0.7224305036924903, 0.8616942129609885, 0.8124859598298191, 0.5529274588012716, 0.9414901089164684, 0.8682368537927528, 0.8813610977051298, 0.8637229829001054, 0.8909893265624708, 0.9900361484976813, 0.9047037123737008, 0.9457887636647593, 0.9147675547396664, 0.7694354587884323, 0.8909469650204287, 0.8871126293501618, 0.9291694325862411, 0.7644308548930339, 0.990801279546122, 0.9557271747673879, 0.6995049801304514, 0.7392189347322768, 0.8948717700124591, 0.8757981456199683, 0.8992347364900917, 0.9895045003903284, 0.8485758596135312, 0.9079789057716044, 0.9431252995444656, 0.7741636208160508, 0.9571956661941595, 0.5, 0.9793509137658367, 0.9711959727486736, 0.7594715377448377, 0.7401070443027602, 0.8911688447878369, 0.9557993268463069, 0.9727872317258972, 0.6911528698558905, 0.7797244984653223, 0.9289531897990587, 0.5, 0.7963060619847759, 0.9392949005412895, 0.8417561736576546, 0.8838147578651703, 0.9334833052073975, -1.0, 0.8895208175781714, 0.8645714632648036, 0.9254884796613027, 0.8134734534788126, 0.8367512427990857, 0.9081587586848348, 0.8971371369692374], "episode_lengths": [20, 14, 14, 14, 19, 16, 15, 16, 14, 13, 14, 14, 14, 24, 13, 15, 16, 22, 15, 15, 18, 14, 16, 19, 14, 14, 15, 14, 13, 14, 13, 13, 14, 15, 14, 14, 15, 13, 15, 14, 14, 14, 15, 13, 14, 29, 15, 15, 17, 15, 14, 25, 14, 13, 14, 15, 14, 13, 14, 16, 14, 14, 26, 15, 14, 14, 14, 18, 28, 15, 14, 13, 13, 17, 14, 13, 13, 13, 16, 14, 15, 14, 16, 14, 22, 17, 16, 15, 14, 13, 16, 13, 29, 14, 14, 21, 18, 15, 38, 14, 22, 15, 17, 14, 14, 15, 14, 15, 18, 16, 15, 16, 31, 16, 15, 23, 13, 14, 15, 15, 15, 21, 14, 13, 23, 14, 13, 22, 15, 18, 14, 15, 14, 14, 13, 22, 41, 16, 20, 15, 14, 14, 17, 14, 15, 15, 14, 16, 21, 19, 15, 13, 37, 14, 19, 14, 19, 13, 23, 13, 15, 16, 13, 16, 17, 17, 15, 18, 16, 15, 17, 13, 13, 14, 13, 30, 29, 15, 14, 13, 18, 14, 19, 13, 14, 14, 14, 14, 17, 16, 19, 14, 24, 14, 30, 17, 15, 14, 14, 13, 14, 21, 14, 14, 14, 21, 17, 14, 14, 23, 14, 15, 17, 15, 15, 14, 14, 15, 13, 14, 15, 15, 15, 19, 14, 13, 17, 14, 13, 13, 14, 26, 15, 14, 28, 16, 17, 16, 14, 15, 13, 14, 17, 14, 14, 14, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0970430197333658, "mean_inference_ms": 0.24400770484481882, "mean_action_processing_ms": 0.0439967891787976, "mean_env_wait_ms": 0.04723332611798602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015871178719305222, "StateBufferConnector_ms": 0.0012730398485737463, "ViewRequirementAgentConnector_ms": 0.029276936284957394}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1071.4295247996308, "num_env_steps_trained_throughput_per_sec": 1071.4295247996308, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3760.972, "sample_time_ms": 1793.833, "load_time_ms": 0.216, "load_throughput": 18517898.455, "learn_time_ms": 1965.955, "learn_throughput": 2034.634, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 10766, "training_iteration": 81, "trial_id": "default", "date": "2024-05-22_22-19-54", "timestamp": 1716409194, "time_this_iter_s": 3.7382142543792725, "time_total_s": 293.7087924480438, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 293.7087924480438, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.080000000000002, "ram_util_percent": 61.35999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.511012579901244, "cur_kl_coeff": 0.08437500000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.028516619590922228, "policy_loss": -0.01204102104604845, "vf_loss": 0.03806162159188941, "vf_explained_var": 0.28104301755146316, "kl": 0.029582457971804473, "entropy": 0.6501646032897375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 0.9986164203559954, "episode_reward_min": -1.0, "episode_reward_mean": 0.8176384676762678, "episode_len_mean": 16.0, "episode_media": {}, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9125147847269246, 0.9505760459602394, 0.5796579537793387, 0.8056918259055936, 0.7289973799776319, 0.9055899438611743, 0.6010662200631809, 0.7281275406464425, 0.7669962068976298, 0.9930134001960048, 0.9720505512862546, 0.9083243642457658, 0.8980433094615847, 0.9986164203559954, 0.973909822065059, 0.668376552936139, 0.8179101804896249, 0.9130965348940489, 0.8714401924751707, 0.8567480022671325, -1.0, 0.867438890172792, 0.990101632685418, 0.9574461679801209, 0.843749563180922, 0.8202955030808319, 0.7507016962523376, 0.9218239448441211, 0.504841331810105, 0.798548523762147, 0.6819395513613876, 0.9949964101964792, 0.9449796191676272, 0.9672822839483749, 0.8729658444740128, 0.9118827921275806, 0.9305529616536214, 0.6611873280584386, 0.7014148274621823, 0.9734713045761487, 0.9175591726080017, 0.5, 0.9904716048180037, 0.947323144095027, 0.5, 0.819033831386464, 0.9249460825381384, 0.9263732232900703, 0.8509736343726881, 0.9712856857734197, 0.869781311950832, 0.8338155008235919, 0.7423809870532541, 0.9244102993892409, 0.8280681829986456, 0.896952863873491, 0.8960114161262598, 0.859712238916869, 0.8373311495388126, 0.932747297917371, 0.9518028049806093, 0.8055322565628584, 0.9395017889359341, 0.9091571733566444, 0.9770881226239919, 0.882145229792726, 0.8813834010789553, 0.6639090630982987, 0.8868679737258198, 0.5, 0.9083291352259361, 0.9948258920762771, 0.8197556226438113, 0.8599834112687272, 0.9223733662983667, 0.9642319746257008, -1.0, 0.998152243167389, 0.8358648043663747, 0.9603224386061282, 0.6573805544827456, 0.921350649509731, 0.8444102965764095, 0.9428819438784732, 0.853733309931987, 0.9110140117896757, 0.8836525692615437, 0.9737810999237578, 0.7064731704932692, 0.8557488926661642, 0.8468617464520805, 0.9407584654149601, 0.9442232735244175, 0.8829603499748611, 0.6745792669281323, 0.8077821562117153, 0.8791365618631526, 0.9762953074683562, 0.8521362681418785, 0.7695739057777307, -1.0, 0.7052272087240188, 0.9184816580521733, 0.648459745358291, 0.8022456584000863, 0.8556367558240121, 0.9666159616898471, 0.9058462208404903, 0.8809828874789276, 0.7090516260380064, 0.9206336961165686, 0.7618573118885916, 0.9889705802835029, 0.6980573638495282, 0.6422765906317964, 0.9949386133390365, 0.9639373750670469, 0.6494116549150666, 0.9762466295522153, 0.6334926854768247, 0.8107255117964378, 0.5677910664028822, 0.8009433852767227, 0.9624491444178129, 0.845600004267592, 0.5, 0.8616772828905621, 0.7051570739816344, 0.6029148129154819, 0.9426446997026621, 0.9599070055088915, -1.0, 0.9643817960870048, 0.758659896544391, -1.0, 0.8725904577433979, 0.8698628121757133, 0.8912868924609811, 0.6171191155708929, 0.6367866181604814, 0.9505950673531354, 0.7545393878897693, 0.8261242249748063, 0.8860317031579906, 0.9276776948374748, 0.5424567644831768, 0.9542744446537266, 0.960129208012094, 0.8569175285344073, 0.9518793070162619, 0.9292829456701356, 0.9725773330231656, 0.8333364508403672, 0.9666859255337933, 0.8242816187045459, 0.9435608894004228, 0.7917165243393, 0.9595933970469779, 0.6553739242702727, 0.9592636793956394, 0.8745024271264906, 0.9764710431842938, 0.9856762979985634, 0.9596848933928492, 0.9100076247209575, 0.9771730544225973, 0.9733376631301449, 0.9564163214513554, 0.8956442669696542, 0.9290501017985408, 0.8551703672742695, 0.9534133369376663, 0.5270527815478235, 0.9984015830921139, 0.9025185421411993, 0.8810081315485873, 0.9572845578188035, 0.7620263095541187, 0.7265512323303398, 0.9043081719949355, 0.9940274498151928, 0.5939107363128142, 0.8395958285402807, 0.967459901974747, 0.962734857483559, 0.5340021310852775, 0.9950153279343769, 0.9173623204550025, 0.9000025401331736, 0.879743430188407, 0.9031983445399573, 0.8899841403804137, 0.8392195982575794, 0.6898255454313431, 0.8368656832656768, 0.8660663803213071, 0.9754860633765146, 0.9763749499152422, 0.6896410900011325, 0.8709764903590504, 0.5973117628707917, 0.8534355404845724, 0.8623364526330342, 0.9107950055184857, 0.985536986749247, 0.9567280816087819, 0.9947072691209936, 0.9652158573097473, 0.9472050790605083, 0.8199523750994334, 0.9903945706373094, 0.8899814634413609, 0.9094683936767362, 0.9614871096756686, 0.9738975973961791, 0.5, 0.6558041171570603, 0.8999381530272409, 0.8851484286773651, 0.8606292752672553, 0.9028897035934398, 0.7944209792562933, 0.8555869783420971, 0.8079271684874423, 0.9137616068028264, 0.8113959649745376, 0.9766422622236705, 0.952939907497831, 0.8042236060761442, 0.9201609391846618, 0.8841446751059033, 0.7345467189787397, 0.7390927443213461, 0.5702462600242636, 0.97656018831873, 0.9098918839003347, 0.834357610477364, 0.9904643377018472, 0.7985370889375069, 0.7770786456699637, 0.9852093237044881, 0.951004683417162, 0.8679224327239476, 0.708463696853401, 0.9501572471952594, 0.9920196973398344, 0.8013548004894591, 0.8720339985187787, 0.9622892960593915, 0.9764560772437958], "episode_lengths": [14, 14, 19, 14, 20, 15, 24, 16, 16, 13, 13, 13, 15, 14, 16, 19, 21, 14, 16, 14, 13, 15, 14, 14, 15, 15, 18, 15, 16, 16, 27, 14, 14, 14, 15, 15, 15, 17, 17, 15, 14, 19, 14, 15, 18, 15, 14, 15, 15, 14, 15, 14, 15, 13, 15, 13, 15, 14, 14, 14, 15, 18, 15, 13, 14, 14, 17, 24, 15, 16, 13, 13, 17, 15, 14, 14, 20, 14, 15, 16, 19, 13, 16, 14, 16, 13, 13, 14, 19, 14, 17, 13, 14, 13, 15, 20, 13, 16, 21, 14, 12, 22, 13, 29, 14, 14, 16, 13, 14, 24, 16, 15, 15, 14, 17, 13, 16, 23, 14, 23, 18, 24, 15, 14, 13, 15, 13, 17, 17, 15, 15, 80, 15, 13, 39, 14, 13, 16, 20, 24, 16, 16, 21, 13, 15, 16, 15, 16, 16, 14, 20, 13, 14, 14, 15, 15, 14, 13, 15, 14, 15, 15, 15, 15, 14, 13, 13, 16, 14, 16, 14, 15, 15, 13, 14, 15, 17, 18, 16, 15, 13, 43, 19, 16, 14, 15, 15, 14, 15, 16, 15, 14, 15, 17, 15, 13, 15, 14, 19, 15, 18, 14, 15, 13, 14, 14, 15, 13, 14, 14, 13, 13, 13, 15, 15, 16, 25, 13, 13, 16, 16, 16, 15, 14, 13, 19, 14, 16, 15, 15, 14, 20, 17, 19, 16, 14, 14, 14, 15, 16, 13, 15, 19, 23, 18, 14, 18, 14, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09714918349340997, "mean_inference_ms": 0.24400222125613646, "mean_action_processing_ms": 0.04399554211142713, "mean_env_wait_ms": 0.04724116649292331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001549530029296875, "StateBufferConnector_ms": 0.0012189865112304688, "ViewRequirementAgentConnector_ms": 0.028478050231933595}}, "episode_reward_max": 0.9986164203559954, "episode_reward_min": -1.0, "episode_reward_mean": 0.8176384676762678, "episode_len_mean": 16.0, "episodes_this_iter": 250, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9125147847269246, 0.9505760459602394, 0.5796579537793387, 0.8056918259055936, 0.7289973799776319, 0.9055899438611743, 0.6010662200631809, 0.7281275406464425, 0.7669962068976298, 0.9930134001960048, 0.9720505512862546, 0.9083243642457658, 0.8980433094615847, 0.9986164203559954, 0.973909822065059, 0.668376552936139, 0.8179101804896249, 0.9130965348940489, 0.8714401924751707, 0.8567480022671325, -1.0, 0.867438890172792, 0.990101632685418, 0.9574461679801209, 0.843749563180922, 0.8202955030808319, 0.7507016962523376, 0.9218239448441211, 0.504841331810105, 0.798548523762147, 0.6819395513613876, 0.9949964101964792, 0.9449796191676272, 0.9672822839483749, 0.8729658444740128, 0.9118827921275806, 0.9305529616536214, 0.6611873280584386, 0.7014148274621823, 0.9734713045761487, 0.9175591726080017, 0.5, 0.9904716048180037, 0.947323144095027, 0.5, 0.819033831386464, 0.9249460825381384, 0.9263732232900703, 0.8509736343726881, 0.9712856857734197, 0.869781311950832, 0.8338155008235919, 0.7423809870532541, 0.9244102993892409, 0.8280681829986456, 0.896952863873491, 0.8960114161262598, 0.859712238916869, 0.8373311495388126, 0.932747297917371, 0.9518028049806093, 0.8055322565628584, 0.9395017889359341, 0.9091571733566444, 0.9770881226239919, 0.882145229792726, 0.8813834010789553, 0.6639090630982987, 0.8868679737258198, 0.5, 0.9083291352259361, 0.9948258920762771, 0.8197556226438113, 0.8599834112687272, 0.9223733662983667, 0.9642319746257008, -1.0, 0.998152243167389, 0.8358648043663747, 0.9603224386061282, 0.6573805544827456, 0.921350649509731, 0.8444102965764095, 0.9428819438784732, 0.853733309931987, 0.9110140117896757, 0.8836525692615437, 0.9737810999237578, 0.7064731704932692, 0.8557488926661642, 0.8468617464520805, 0.9407584654149601, 0.9442232735244175, 0.8829603499748611, 0.6745792669281323, 0.8077821562117153, 0.8791365618631526, 0.9762953074683562, 0.8521362681418785, 0.7695739057777307, -1.0, 0.7052272087240188, 0.9184816580521733, 0.648459745358291, 0.8022456584000863, 0.8556367558240121, 0.9666159616898471, 0.9058462208404903, 0.8809828874789276, 0.7090516260380064, 0.9206336961165686, 0.7618573118885916, 0.9889705802835029, 0.6980573638495282, 0.6422765906317964, 0.9949386133390365, 0.9639373750670469, 0.6494116549150666, 0.9762466295522153, 0.6334926854768247, 0.8107255117964378, 0.5677910664028822, 0.8009433852767227, 0.9624491444178129, 0.845600004267592, 0.5, 0.8616772828905621, 0.7051570739816344, 0.6029148129154819, 0.9426446997026621, 0.9599070055088915, -1.0, 0.9643817960870048, 0.758659896544391, -1.0, 0.8725904577433979, 0.8698628121757133, 0.8912868924609811, 0.6171191155708929, 0.6367866181604814, 0.9505950673531354, 0.7545393878897693, 0.8261242249748063, 0.8860317031579906, 0.9276776948374748, 0.5424567644831768, 0.9542744446537266, 0.960129208012094, 0.8569175285344073, 0.9518793070162619, 0.9292829456701356, 0.9725773330231656, 0.8333364508403672, 0.9666859255337933, 0.8242816187045459, 0.9435608894004228, 0.7917165243393, 0.9595933970469779, 0.6553739242702727, 0.9592636793956394, 0.8745024271264906, 0.9764710431842938, 0.9856762979985634, 0.9596848933928492, 0.9100076247209575, 0.9771730544225973, 0.9733376631301449, 0.9564163214513554, 0.8956442669696542, 0.9290501017985408, 0.8551703672742695, 0.9534133369376663, 0.5270527815478235, 0.9984015830921139, 0.9025185421411993, 0.8810081315485873, 0.9572845578188035, 0.7620263095541187, 0.7265512323303398, 0.9043081719949355, 0.9940274498151928, 0.5939107363128142, 0.8395958285402807, 0.967459901974747, 0.962734857483559, 0.5340021310852775, 0.9950153279343769, 0.9173623204550025, 0.9000025401331736, 0.879743430188407, 0.9031983445399573, 0.8899841403804137, 0.8392195982575794, 0.6898255454313431, 0.8368656832656768, 0.8660663803213071, 0.9754860633765146, 0.9763749499152422, 0.6896410900011325, 0.8709764903590504, 0.5973117628707917, 0.8534355404845724, 0.8623364526330342, 0.9107950055184857, 0.985536986749247, 0.9567280816087819, 0.9947072691209936, 0.9652158573097473, 0.9472050790605083, 0.8199523750994334, 0.9903945706373094, 0.8899814634413609, 0.9094683936767362, 0.9614871096756686, 0.9738975973961791, 0.5, 0.6558041171570603, 0.8999381530272409, 0.8851484286773651, 0.8606292752672553, 0.9028897035934398, 0.7944209792562933, 0.8555869783420971, 0.8079271684874423, 0.9137616068028264, 0.8113959649745376, 0.9766422622236705, 0.952939907497831, 0.8042236060761442, 0.9201609391846618, 0.8841446751059033, 0.7345467189787397, 0.7390927443213461, 0.5702462600242636, 0.97656018831873, 0.9098918839003347, 0.834357610477364, 0.9904643377018472, 0.7985370889375069, 0.7770786456699637, 0.9852093237044881, 0.951004683417162, 0.8679224327239476, 0.708463696853401, 0.9501572471952594, 0.9920196973398344, 0.8013548004894591, 0.8720339985187787, 0.9622892960593915, 0.9764560772437958], "episode_lengths": [14, 14, 19, 14, 20, 15, 24, 16, 16, 13, 13, 13, 15, 14, 16, 19, 21, 14, 16, 14, 13, 15, 14, 14, 15, 15, 18, 15, 16, 16, 27, 14, 14, 14, 15, 15, 15, 17, 17, 15, 14, 19, 14, 15, 18, 15, 14, 15, 15, 14, 15, 14, 15, 13, 15, 13, 15, 14, 14, 14, 15, 18, 15, 13, 14, 14, 17, 24, 15, 16, 13, 13, 17, 15, 14, 14, 20, 14, 15, 16, 19, 13, 16, 14, 16, 13, 13, 14, 19, 14, 17, 13, 14, 13, 15, 20, 13, 16, 21, 14, 12, 22, 13, 29, 14, 14, 16, 13, 14, 24, 16, 15, 15, 14, 17, 13, 16, 23, 14, 23, 18, 24, 15, 14, 13, 15, 13, 17, 17, 15, 15, 80, 15, 13, 39, 14, 13, 16, 20, 24, 16, 16, 21, 13, 15, 16, 15, 16, 16, 14, 20, 13, 14, 14, 15, 15, 14, 13, 15, 14, 15, 15, 15, 15, 14, 13, 13, 16, 14, 16, 14, 15, 15, 13, 14, 15, 17, 18, 16, 15, 13, 43, 19, 16, 14, 15, 15, 14, 15, 16, 15, 14, 15, 17, 15, 13, 15, 14, 19, 15, 18, 14, 15, 13, 14, 14, 15, 13, 14, 14, 13, 13, 13, 15, 15, 16, 25, 13, 13, 16, 16, 16, 15, 14, 13, 19, 14, 16, 15, 15, 14, 20, 17, 19, 16, 14, 14, 14, 15, 16, 13, 15, 19, 23, 18, 14, 18, 14, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09714918349340997, "mean_inference_ms": 0.24400222125613646, "mean_action_processing_ms": 0.04399554211142713, "mean_env_wait_ms": 0.04724116649292331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001549530029296875, "StateBufferConnector_ms": 0.0012189865112304688, "ViewRequirementAgentConnector_ms": 0.028478050231933595}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1081.268699771955, "num_env_steps_trained_throughput_per_sec": 1081.268699771955, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 3742.571, "sample_time_ms": 1793.261, "load_time_ms": 0.214, "load_throughput": 18709954.277, "learn_time_ms": 1948.129, "learn_throughput": 2053.252, "synch_weights_time_ms": 0.636}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 11016, "training_iteration": 82, "trial_id": "default", "date": "2024-05-22_22-19-58", "timestamp": 1716409198, "time_this_iter_s": 3.7038369178771973, "time_total_s": 297.412629365921, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 297.412629365921, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 22.580000000000002, "ram_util_percent": 61.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.736236474719099, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.037887299180491475, "policy_loss": -0.014047951591751909, "vf_loss": 0.04950193450022589, "vf_explained_var": 0.3001420244093864, "kl": 0.019226201175823687, "entropy": 0.6670071370499109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 0.9999453037947058, "episode_reward_min": -1.0, "episode_reward_mean": 0.8048890087639899, "episode_len_mean": 16.129032258064516, "episode_media": {}, "episodes_this_iter": 248, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9653669667223589, -1.0, 0.7770295337674994, 0.8691723107606399, 0.9789515314739723, 0.9430238347989917, 0.8305839163017592, 0.6482608525572757, 0.9123095871550999, 0.9994179539045253, 0.874230484708641, 0.6609216676028745, 0.9427390062827353, 0.9387991832661883, 0.703265705779192, 0.8313978093239949, 0.8297361722333142, 0.9821170115972725, 0.9265941809997307, 0.8669877914910123, 0.922510835882146, 0.6311160324134084, 0.9171289422812566, 0.7799174582742314, 0.8286442894380287, 0.6848538812646865, 0.7134276731051499, 0.9448867865534794, 0.9337228246638756, 0.8872484626526986, 0.7638802108367726, 0.9969264203820352, 0.9290792019533062, 0.9408634407962718, 0.9201212931098002, 0.7391580311989605, 0.7375272381466658, 0.8309186035346839, 0.5067949787971837, 0.9971488504882496, 0.9441774264446079, 0.7206439743065343, 0.9239913042293723, 0.9581960570606461, 0.9442760065500571, 0.9818159841725633, 0.8440121347892487, 0.9227000957384516, 0.9480136717843327, 0.9596647120894068, 0.934141034766729, 0.8638863178862584, 0.7976066585332819, 0.9362894590258981, 0.9367734928843008, 0.8598550414662329, 0.7752025817486821, 0.6563151166472422, 0.9064693107154653, 0.8849353124164425, 0.9530392170172506, 0.9207731071340783, 0.9612631024209902, 0.9497711222336294, 0.8464292016733561, 0.6365972339434315, 0.5366335426837667, 0.8270976621401559, 0.987081758967753, 0.9705802475701811, 0.9812867828098245, 0.9393782243125269, 0.9652993257227583, 0.8578527750346534, 0.9580842999109793, 0.8939895910739821, 0.8740235304218883, 0.8459935180963065, 0.6244154299964542, 0.9477614714932125, 0.7788875497798695, 0.6325756977945087, -1.0, 0.9025527489199434, 0.6526834089617857, 0.8615817775508168, 0.9985726945735721, 0.6678664335074094, 0.9256760135288604, 0.7113226910698265, 0.9641596535212336, 0.8208891796522493, 0.9706042048534017, 0.9519571886994693, 0.8060217577989458, 0.8049136277407911, 0.8492022972894916, 0.6110857033781342, 0.8940223872149045, 0.9807626809290096, 0.9973328171788299, 0.9515519897044902, 0.8835382231261842, 0.9729831281176887, -1.0, 0.6837191236082651, 0.9617086918587072, 0.6476169155026654, 0.8152152484010835, 0.7393594549924504, 0.9021767022025281, 0.9666900709787299, 0.9807275894162099, 0.7544229533053476, 0.8541563532143284, 0.9783682987210465, 0.7715557276660425, 0.8385528233760744, 0.901160654058859, 0.9618670753653747, 0.9433690771848668, 0.8906180898952014, 0.7745433030216171, 0.9664313144779164, 0.9451558661886346, 0.9432507085782638, 0.9283288558759343, 0.9388033838994898, 0.9846581696176795, 0.8837177673192832, 0.8952859729296333, -1.0, 0.9838318997546261, 0.8155145486475899, 0.9442221516205479, 0.7360955193319936, 0.9353615779418453, 0.9464351468769057, 0.8177594818795914, 0.8430517518419824, 0.9828787206212241, 0.9584506749528836, 0.8984211120995663, 0.8484633835465403, 0.7784861466635253, 0.9874277939901646, 0.9118957058556537, 0.8424996214137592, 0.9590935467633888, 0.9771746765422406, 0.6632770051763366, 0.8272301022476907, 0.8376087154539973, 0.8341397261323956, 0.8965592771309434, 0.8137340131872599, 0.8344402206014033, 0.8461411660428287, 0.9650030435913968, 0.838195121716025, 0.9807933168971469, 0.5509088762735177, 0.935623692958326, 0.8669747911709509, 0.9030486475089424, 0.88555789640597, 0.8612368587024894, 0.6874208660544892, -1.0, 0.9623966437865689, 0.8603094805406749, 0.7475311768942503, 0.8884948032719078, 0.9912888433384942, 0.5, 0.5551286299412228, 0.7605246451786014, 0.7618406139372867, 0.8645967211465164, 0.5564786296116296, 0.5, 0.9519045250818872, 0.6506850135308921, 0.9030219156800152, 0.8616558969739792, 0.768950082761052, 0.9856161873450693, 0.9251566782982731, 0.9626959955368282, -1.0, 0.9972637889666296, 0.9752321761999151, 0.9360877960202296, 0.9876845177761435, 0.969901769100237, 0.9833134706949445, 0.9125521183625197, 0.9549471741606281, 0.9154866421913739, 0.9633376994445582, -1.0, 0.7596961512510081, 0.6805246444183672, 0.7949598450231108, 0.9844587283322845, 0.8598135324673646, 0.9665888738382566, 0.8827427766776303, 0.9700859334440347, 0.9108417410328224, 0.9441064092168087, 0.7447881361846778, 0.9431682361281783, 0.7001476624625386, 0.7434363471397166, 0.9855523259019551, 0.9850317635769802, 0.9709227667426833, 0.7205673775919459, 0.7604549316293855, 0.7839485262713568, 0.9891438458718036, 0.938426845059116, 0.8838656154981088, 0.9362026987784166, 0.887806713826705, 0.9470694751217826, 0.8550407565716451, -1.0, 0.774596924601787, 0.8226390033671414, 0.8543858638415089, 0.8420734337507123, 0.5689102321743457, 0.8744444968018636, 0.9293247794580529, 0.9869548933889085, 0.91230557043325, 0.9313389689514714, 0.927284006999648, 0.5705959799325231, 0.8788440749450525, 0.9928055573475572, 0.8632538342200566, 0.9999453037947058, 0.9883252793862932, 0.9346101651230806, 0.9761008705638449], "episode_lengths": [14, 11, 15, 14, 14, 14, 15, 19, 14, 15, 15, 22, 13, 16, 20, 15, 17, 14, 13, 14, 15, 15, 15, 18, 19, 29, 15, 14, 13, 14, 17, 14, 13, 14, 13, 14, 17, 14, 16, 15, 13, 15, 14, 16, 13, 13, 15, 14, 13, 13, 15, 22, 17, 14, 14, 16, 23, 24, 14, 15, 13, 15, 14, 13, 15, 17, 18, 14, 14, 16, 15, 13, 15, 16, 18, 13, 13, 19, 18, 15, 23, 20, 12, 13, 30, 13, 14, 20, 13, 39, 14, 15, 16, 13, 17, 14, 17, 26, 17, 13, 14, 15, 14, 15, 17, 16, 13, 16, 18, 19, 15, 13, 13, 16, 16, 14, 24, 15, 14, 14, 14, 15, 13, 13, 14, 14, 14, 14, 16, 14, 13, 32, 14, 18, 14, 18, 16, 13, 18, 14, 18, 14, 14, 15, 18, 14, 20, 15, 14, 13, 15, 18, 14, 15, 15, 14, 14, 19, 15, 15, 13, 38, 16, 14, 14, 13, 17, 28, 37, 14, 14, 23, 13, 15, 16, 16, 16, 15, 15, 23, 71, 15, 15, 16, 14, 22, 15, 15, 14, 27, 14, 14, 18, 14, 13, 13, 13, 13, 14, 14, 12, 15, 28, 15, 17, 14, 13, 15, 14, 14, 14, 24, 16, 13, 17, 14, 13, 15, 18, 18, 16, 15, 19, 14, 14, 14, 13, 15, 13, 13, 14, 14, 22, 16, 17, 15, 14, 14, 22, 14, 19, 14, 13, 14, 13, 14, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09723851490603011, "mean_inference_ms": 0.243970621575107, "mean_action_processing_ms": 0.04398736501574441, "mean_env_wait_ms": 0.047241495212020396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014960765838623047, "StateBufferConnector_ms": 0.0012056481453680222, "ViewRequirementAgentConnector_ms": 0.028179826274994883}}, "episode_reward_max": 0.9999453037947058, "episode_reward_min": -1.0, "episode_reward_mean": 0.8048890087639899, "episode_len_mean": 16.129032258064516, "episodes_this_iter": 248, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9653669667223589, -1.0, 0.7770295337674994, 0.8691723107606399, 0.9789515314739723, 0.9430238347989917, 0.8305839163017592, 0.6482608525572757, 0.9123095871550999, 0.9994179539045253, 0.874230484708641, 0.6609216676028745, 0.9427390062827353, 0.9387991832661883, 0.703265705779192, 0.8313978093239949, 0.8297361722333142, 0.9821170115972725, 0.9265941809997307, 0.8669877914910123, 0.922510835882146, 0.6311160324134084, 0.9171289422812566, 0.7799174582742314, 0.8286442894380287, 0.6848538812646865, 0.7134276731051499, 0.9448867865534794, 0.9337228246638756, 0.8872484626526986, 0.7638802108367726, 0.9969264203820352, 0.9290792019533062, 0.9408634407962718, 0.9201212931098002, 0.7391580311989605, 0.7375272381466658, 0.8309186035346839, 0.5067949787971837, 0.9971488504882496, 0.9441774264446079, 0.7206439743065343, 0.9239913042293723, 0.9581960570606461, 0.9442760065500571, 0.9818159841725633, 0.8440121347892487, 0.9227000957384516, 0.9480136717843327, 0.9596647120894068, 0.934141034766729, 0.8638863178862584, 0.7976066585332819, 0.9362894590258981, 0.9367734928843008, 0.8598550414662329, 0.7752025817486821, 0.6563151166472422, 0.9064693107154653, 0.8849353124164425, 0.9530392170172506, 0.9207731071340783, 0.9612631024209902, 0.9497711222336294, 0.8464292016733561, 0.6365972339434315, 0.5366335426837667, 0.8270976621401559, 0.987081758967753, 0.9705802475701811, 0.9812867828098245, 0.9393782243125269, 0.9652993257227583, 0.8578527750346534, 0.9580842999109793, 0.8939895910739821, 0.8740235304218883, 0.8459935180963065, 0.6244154299964542, 0.9477614714932125, 0.7788875497798695, 0.6325756977945087, -1.0, 0.9025527489199434, 0.6526834089617857, 0.8615817775508168, 0.9985726945735721, 0.6678664335074094, 0.9256760135288604, 0.7113226910698265, 0.9641596535212336, 0.8208891796522493, 0.9706042048534017, 0.9519571886994693, 0.8060217577989458, 0.8049136277407911, 0.8492022972894916, 0.6110857033781342, 0.8940223872149045, 0.9807626809290096, 0.9973328171788299, 0.9515519897044902, 0.8835382231261842, 0.9729831281176887, -1.0, 0.6837191236082651, 0.9617086918587072, 0.6476169155026654, 0.8152152484010835, 0.7393594549924504, 0.9021767022025281, 0.9666900709787299, 0.9807275894162099, 0.7544229533053476, 0.8541563532143284, 0.9783682987210465, 0.7715557276660425, 0.8385528233760744, 0.901160654058859, 0.9618670753653747, 0.9433690771848668, 0.8906180898952014, 0.7745433030216171, 0.9664313144779164, 0.9451558661886346, 0.9432507085782638, 0.9283288558759343, 0.9388033838994898, 0.9846581696176795, 0.8837177673192832, 0.8952859729296333, -1.0, 0.9838318997546261, 0.8155145486475899, 0.9442221516205479, 0.7360955193319936, 0.9353615779418453, 0.9464351468769057, 0.8177594818795914, 0.8430517518419824, 0.9828787206212241, 0.9584506749528836, 0.8984211120995663, 0.8484633835465403, 0.7784861466635253, 0.9874277939901646, 0.9118957058556537, 0.8424996214137592, 0.9590935467633888, 0.9771746765422406, 0.6632770051763366, 0.8272301022476907, 0.8376087154539973, 0.8341397261323956, 0.8965592771309434, 0.8137340131872599, 0.8344402206014033, 0.8461411660428287, 0.9650030435913968, 0.838195121716025, 0.9807933168971469, 0.5509088762735177, 0.935623692958326, 0.8669747911709509, 0.9030486475089424, 0.88555789640597, 0.8612368587024894, 0.6874208660544892, -1.0, 0.9623966437865689, 0.8603094805406749, 0.7475311768942503, 0.8884948032719078, 0.9912888433384942, 0.5, 0.5551286299412228, 0.7605246451786014, 0.7618406139372867, 0.8645967211465164, 0.5564786296116296, 0.5, 0.9519045250818872, 0.6506850135308921, 0.9030219156800152, 0.8616558969739792, 0.768950082761052, 0.9856161873450693, 0.9251566782982731, 0.9626959955368282, -1.0, 0.9972637889666296, 0.9752321761999151, 0.9360877960202296, 0.9876845177761435, 0.969901769100237, 0.9833134706949445, 0.9125521183625197, 0.9549471741606281, 0.9154866421913739, 0.9633376994445582, -1.0, 0.7596961512510081, 0.6805246444183672, 0.7949598450231108, 0.9844587283322845, 0.8598135324673646, 0.9665888738382566, 0.8827427766776303, 0.9700859334440347, 0.9108417410328224, 0.9441064092168087, 0.7447881361846778, 0.9431682361281783, 0.7001476624625386, 0.7434363471397166, 0.9855523259019551, 0.9850317635769802, 0.9709227667426833, 0.7205673775919459, 0.7604549316293855, 0.7839485262713568, 0.9891438458718036, 0.938426845059116, 0.8838656154981088, 0.9362026987784166, 0.887806713826705, 0.9470694751217826, 0.8550407565716451, -1.0, 0.774596924601787, 0.8226390033671414, 0.8543858638415089, 0.8420734337507123, 0.5689102321743457, 0.8744444968018636, 0.9293247794580529, 0.9869548933889085, 0.91230557043325, 0.9313389689514714, 0.927284006999648, 0.5705959799325231, 0.8788440749450525, 0.9928055573475572, 0.8632538342200566, 0.9999453037947058, 0.9883252793862932, 0.9346101651230806, 0.9761008705638449], "episode_lengths": [14, 11, 15, 14, 14, 14, 15, 19, 14, 15, 15, 22, 13, 16, 20, 15, 17, 14, 13, 14, 15, 15, 15, 18, 19, 29, 15, 14, 13, 14, 17, 14, 13, 14, 13, 14, 17, 14, 16, 15, 13, 15, 14, 16, 13, 13, 15, 14, 13, 13, 15, 22, 17, 14, 14, 16, 23, 24, 14, 15, 13, 15, 14, 13, 15, 17, 18, 14, 14, 16, 15, 13, 15, 16, 18, 13, 13, 19, 18, 15, 23, 20, 12, 13, 30, 13, 14, 20, 13, 39, 14, 15, 16, 13, 17, 14, 17, 26, 17, 13, 14, 15, 14, 15, 17, 16, 13, 16, 18, 19, 15, 13, 13, 16, 16, 14, 24, 15, 14, 14, 14, 15, 13, 13, 14, 14, 14, 14, 16, 14, 13, 32, 14, 18, 14, 18, 16, 13, 18, 14, 18, 14, 14, 15, 18, 14, 20, 15, 14, 13, 15, 18, 14, 15, 15, 14, 14, 19, 15, 15, 13, 38, 16, 14, 14, 13, 17, 28, 37, 14, 14, 23, 13, 15, 16, 16, 16, 15, 15, 23, 71, 15, 15, 16, 14, 22, 15, 15, 14, 27, 14, 14, 18, 14, 13, 13, 13, 13, 14, 14, 12, 15, 28, 15, 17, 14, 13, 15, 14, 14, 14, 24, 16, 13, 17, 14, 13, 15, 18, 18, 16, 15, 19, 14, 14, 14, 13, 15, 13, 13, 14, 14, 22, 16, 17, 15, 14, 14, 22, 14, 19, 14, 13, 14, 13, 14, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09723851490603011, "mean_inference_ms": 0.243970621575107, "mean_action_processing_ms": 0.04398736501574441, "mean_env_wait_ms": 0.047241495212020396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014960765838623047, "StateBufferConnector_ms": 0.0012056481453680222, "ViewRequirementAgentConnector_ms": 0.028179826274994883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1109.8360358598707, "num_env_steps_trained_throughput_per_sec": 1109.8360358598707, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 3742.409, "sample_time_ms": 1792.142, "load_time_ms": 0.214, "load_throughput": 18712041.044, "learn_time_ms": 1949.099, "learn_throughput": 2052.23, "synch_weights_time_ms": 0.625}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 11264, "training_iteration": 83, "trial_id": "default", "date": "2024-05-22_22-20-01", "timestamp": 1716409201, "time_this_iter_s": 3.608513593673706, "time_total_s": 301.0211429595947, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 301.0211429595947, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.5, "ram_util_percent": 61.28000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.701216806839871, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.029785159694892104, "policy_loss": -0.005048735181410467, "vf_loss": 0.03305808670658578, "vf_explained_var": 0.3434068417036405, "kl": 0.014031066427349246, "entropy": 0.6083366846205086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77655.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 0.9994374243549327, "episode_reward_min": -1.0, "episode_reward_mean": 0.8394686430498813, "episode_len_mean": 15.80952380952381, "episode_media": {}, "episodes_this_iter": 252, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.868809118523425, 0.7027424256280066, 0.8240666953662943, 0.8881880757625437, 0.9325810419547698, 0.9923451995692807, 0.7016454050909546, 0.7603855291996308, 0.9917183781678655, 0.962771775401235, 0.7165147218548102, 0.9410920490697102, 0.9654586704599644, 0.7290238394630759, 0.8787911569075594, 0.9176410408696148, 0.884324477115914, 0.8757406461509928, 0.7188705420626341, 0.957749557545852, 0.9368240484433779, 0.6911657138600288, 0.9679577323999133, 0.9583423683201575, 0.7898951851561018, 0.8802559210819605, 0.843353278309654, 0.7865241359865658, 0.9566194559965597, 0.7292601239828873, 0.9834739249787898, 0.9860753043781515, 0.7194617008139879, 0.9892230258711292, 0.8432697090105711, 0.893707948376486, 0.9974537259263418, 0.773303786231849, 0.9292842213270996, 0.9449379216808435, 0.6238605022403706, 0.8411819203413576, 0.5848694734249569, 0.5, 0.9420274579735689, 0.9099644649515334, 0.906903492213438, 0.9731083370691112, 0.9690907753867641, 0.9931928554209035, 0.9596886271585993, 0.5, 0.9086855811086455, 0.9398941848602355, 0.8050749764001867, 0.9679996169378629, 0.8922583647833838, 0.9314244442016238, 0.8657966589986953, 0.954543889789283, 0.9290187048622758, 0.9008924281177052, 0.8535430287137501, 0.8845516572417322, 0.9950244272661164, 0.976215413696314, 0.7640319250700552, 0.5676499061933559, 0.994268047601992, 0.9738022769106502, -1.0, 0.721579496484298, 0.8757873262593079, 0.6330447524975154, 0.7717501167804056, 0.8003161107416994, 0.8697333623593186, 0.9799586453905783, 0.979110263118601, 0.7478014223981553, 0.9351875995064346, 0.8790879403129332, 0.8005595535606388, 0.9986374376719473, 0.7425953960616027, 0.957800932344088, 0.918616050751694, 0.8772759751189246, -1.0, 0.9740386853929933, 0.8302545089653118, 0.9506504399710746, 0.9051598085070461, 0.9994374243549327, 0.9711401024114993, 0.9894774538534652, 0.8202936221409144, 0.5, 0.7956429894124611, 0.9025232212588371, 0.6549161311676557, 0.8900165991931683, 0.9159292864573128, 0.9595487849084673, 0.5899905279896638, 0.8095134474820228, 0.9883319716764101, 0.9482675168270331, 0.727797728781415, -1.0, 0.9380441841139716, 0.6534741750847896, 0.8560504613826143, 0.9792216784563026, 0.9341635340793089, 0.7779904646125951, 0.5, 0.9228210264951792, 0.894969969463714, 0.9022621122138207, 0.8617035595954579, 0.9099012109770831, 0.9590927836326253, 0.6025378102881618, 0.9553659713429271, 0.9480100523213555, 0.8742116674595255, 0.8567412999143943, 0.8753108816350706, 0.9830429023336105, 0.9896147573688878, 0.6725320959966377, 0.9086244946439854, 0.9154247036222996, 0.9190047264665666, 0.9226801343297802, 0.8040040320419414, 0.9761196900996366, 0.7667203069253619, 0.8381100354262192, 0.5946257563066756, 0.8755354418808458, 0.9427268846760078, 0.7216892053372548, 0.9883348192026118, 0.6612638136974469, 0.9881161855032278, 0.5827875668595823, 0.7600342232677175, 0.9740094632688606, 0.9325190042660182, 0.5113558447706561, 0.8401723315161206, 0.9190091095355157, 0.9573419070314656, 0.7808743365099455, 0.9992783813670367, 0.9597909067077637, 0.7623959225395335, 0.9132282917036586, 0.7693759188386979, 0.8508932807250779, 0.8640943369350695, 0.9959148624659426, 0.9770517244911274, 0.8597300677901352, 0.726117904164155, 0.9909915618778551, 0.5, 0.95193340592549, 0.9939528815645542, 0.9626048309139782, 0.7950480219562835, 0.706019730057452, 0.9874477254428337, 0.7729800084111167, 0.7767080807703041, 0.9962441997966177, 0.8704759406096496, 0.7145592709052713, 0.7089880899147349, 0.8220207419562965, 0.8353166919008842, 0.6803438515173866, 0.8143110515947659, 0.7406662617015928, 0.9349959242405587, 0.8900416318015949, 0.9764641703873602, 0.9096723867496271, 0.7588993442557596, 0.6542472203931367, 0.9423525282172625, 0.8994146343527667, 0.9562127841558873, 0.7657181746007569, 0.9540700820407793, 0.9281996536833601, 0.9516334871243513, 0.9062735427159299, 0.9737133302108395, 0.9098683573245535, 0.6616164457090001, 0.902365879596533, 0.7618352020199857, 0.9875533675942777, 0.842092383998097, 0.9070421704343139, 0.8594376480457261, 0.8713357911677251, 0.9967630493181383, 0.8782425200280177, 0.9689568164124682, 0.8189788256214632, 0.848377614391236, 0.9829445539708642, 0.9618253204398108, 0.5431840229895681, 0.8681764805563316, 0.9324318210984567, 0.9318865989345633, 0.9827915698156957, 0.9192188447212246, 0.9311114304993497, 0.960683672365225, 0.7876310994071665, 0.9531798855427625, 0.9146656224096474, 0.8808374583766336, 0.9677284016990363, 0.8616773516360123, 0.9083941719671966, 0.7873703021718608, 0.8857998813262344, 0.9860691354253087, 0.8704041906096807, 0.7390236272546689, 0.6033780778480331, 0.9464413171005434, 0.9320377325793641, 0.8910255631500378, 0.5484046875512503, 0.9688072577806067, 0.9656613942136262, 0.9684709335666802, 0.8298331500530199, 0.9710835221212852, 0.7969517220099936, 0.9152759098542184, 0.8187712967223689, 0.7963847091937473, 0.9623441551765963], "episode_lengths": [16, 17, 15, 13, 14, 14, 23, 23, 15, 13, 21, 15, 15, 21, 14, 13, 14, 14, 21, 14, 16, 15, 15, 14, 16, 13, 14, 16, 14, 14, 13, 14, 22, 16, 14, 13, 16, 20, 17, 14, 28, 16, 33, 15, 14, 14, 17, 13, 15, 16, 14, 19, 13, 15, 14, 14, 15, 13, 17, 15, 14, 15, 15, 13, 14, 15, 15, 19, 14, 15, 33, 18, 14, 20, 17, 16, 16, 15, 13, 20, 14, 13, 16, 13, 19, 15, 13, 14, 12, 17, 23, 15, 17, 14, 14, 14, 13, 17, 14, 14, 30, 14, 20, 14, 19, 17, 13, 14, 17, 10, 14, 23, 14, 20, 13, 21, 17, 14, 19, 13, 14, 14, 14, 32, 14, 15, 17, 19, 14, 14, 16, 21, 14, 14, 13, 13, 16, 14, 21, 15, 28, 15, 13, 13, 14, 19, 15, 21, 15, 13, 14, 17, 14, 14, 15, 20, 13, 17, 18, 14, 15, 14, 15, 14, 13, 16, 19, 14, 41, 16, 14, 13, 15, 16, 13, 17, 22, 15, 16, 15, 15, 14, 14, 17, 13, 14, 16, 14, 14, 13, 14, 14, 17, 13, 14, 13, 13, 13, 14, 14, 14, 13, 22, 16, 19, 13, 13, 13, 14, 14, 14, 13, 14, 14, 19, 14, 18, 15, 14, 14, 16, 14, 16, 13, 14, 13, 16, 14, 13, 17, 18, 14, 18, 14, 14, 14, 18, 30, 14, 16, 15, 16, 14, 14, 13, 19, 13, 13, 14, 14, 19, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09732662338767323, "mean_inference_ms": 0.24393863326539214, "mean_action_processing_ms": 0.04397917470617778, "mean_env_wait_ms": 0.04724181539491864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014850071498325893, "StateBufferConnector_ms": 0.0012026892768012153, "ViewRequirementAgentConnector_ms": 0.02814370488363599}}, "episode_reward_max": 0.9994374243549327, "episode_reward_min": -1.0, "episode_reward_mean": 0.8394686430498813, "episode_len_mean": 15.80952380952381, "episodes_this_iter": 252, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.868809118523425, 0.7027424256280066, 0.8240666953662943, 0.8881880757625437, 0.9325810419547698, 0.9923451995692807, 0.7016454050909546, 0.7603855291996308, 0.9917183781678655, 0.962771775401235, 0.7165147218548102, 0.9410920490697102, 0.9654586704599644, 0.7290238394630759, 0.8787911569075594, 0.9176410408696148, 0.884324477115914, 0.8757406461509928, 0.7188705420626341, 0.957749557545852, 0.9368240484433779, 0.6911657138600288, 0.9679577323999133, 0.9583423683201575, 0.7898951851561018, 0.8802559210819605, 0.843353278309654, 0.7865241359865658, 0.9566194559965597, 0.7292601239828873, 0.9834739249787898, 0.9860753043781515, 0.7194617008139879, 0.9892230258711292, 0.8432697090105711, 0.893707948376486, 0.9974537259263418, 0.773303786231849, 0.9292842213270996, 0.9449379216808435, 0.6238605022403706, 0.8411819203413576, 0.5848694734249569, 0.5, 0.9420274579735689, 0.9099644649515334, 0.906903492213438, 0.9731083370691112, 0.9690907753867641, 0.9931928554209035, 0.9596886271585993, 0.5, 0.9086855811086455, 0.9398941848602355, 0.8050749764001867, 0.9679996169378629, 0.8922583647833838, 0.9314244442016238, 0.8657966589986953, 0.954543889789283, 0.9290187048622758, 0.9008924281177052, 0.8535430287137501, 0.8845516572417322, 0.9950244272661164, 0.976215413696314, 0.7640319250700552, 0.5676499061933559, 0.994268047601992, 0.9738022769106502, -1.0, 0.721579496484298, 0.8757873262593079, 0.6330447524975154, 0.7717501167804056, 0.8003161107416994, 0.8697333623593186, 0.9799586453905783, 0.979110263118601, 0.7478014223981553, 0.9351875995064346, 0.8790879403129332, 0.8005595535606388, 0.9986374376719473, 0.7425953960616027, 0.957800932344088, 0.918616050751694, 0.8772759751189246, -1.0, 0.9740386853929933, 0.8302545089653118, 0.9506504399710746, 0.9051598085070461, 0.9994374243549327, 0.9711401024114993, 0.9894774538534652, 0.8202936221409144, 0.5, 0.7956429894124611, 0.9025232212588371, 0.6549161311676557, 0.8900165991931683, 0.9159292864573128, 0.9595487849084673, 0.5899905279896638, 0.8095134474820228, 0.9883319716764101, 0.9482675168270331, 0.727797728781415, -1.0, 0.9380441841139716, 0.6534741750847896, 0.8560504613826143, 0.9792216784563026, 0.9341635340793089, 0.7779904646125951, 0.5, 0.9228210264951792, 0.894969969463714, 0.9022621122138207, 0.8617035595954579, 0.9099012109770831, 0.9590927836326253, 0.6025378102881618, 0.9553659713429271, 0.9480100523213555, 0.8742116674595255, 0.8567412999143943, 0.8753108816350706, 0.9830429023336105, 0.9896147573688878, 0.6725320959966377, 0.9086244946439854, 0.9154247036222996, 0.9190047264665666, 0.9226801343297802, 0.8040040320419414, 0.9761196900996366, 0.7667203069253619, 0.8381100354262192, 0.5946257563066756, 0.8755354418808458, 0.9427268846760078, 0.7216892053372548, 0.9883348192026118, 0.6612638136974469, 0.9881161855032278, 0.5827875668595823, 0.7600342232677175, 0.9740094632688606, 0.9325190042660182, 0.5113558447706561, 0.8401723315161206, 0.9190091095355157, 0.9573419070314656, 0.7808743365099455, 0.9992783813670367, 0.9597909067077637, 0.7623959225395335, 0.9132282917036586, 0.7693759188386979, 0.8508932807250779, 0.8640943369350695, 0.9959148624659426, 0.9770517244911274, 0.8597300677901352, 0.726117904164155, 0.9909915618778551, 0.5, 0.95193340592549, 0.9939528815645542, 0.9626048309139782, 0.7950480219562835, 0.706019730057452, 0.9874477254428337, 0.7729800084111167, 0.7767080807703041, 0.9962441997966177, 0.8704759406096496, 0.7145592709052713, 0.7089880899147349, 0.8220207419562965, 0.8353166919008842, 0.6803438515173866, 0.8143110515947659, 0.7406662617015928, 0.9349959242405587, 0.8900416318015949, 0.9764641703873602, 0.9096723867496271, 0.7588993442557596, 0.6542472203931367, 0.9423525282172625, 0.8994146343527667, 0.9562127841558873, 0.7657181746007569, 0.9540700820407793, 0.9281996536833601, 0.9516334871243513, 0.9062735427159299, 0.9737133302108395, 0.9098683573245535, 0.6616164457090001, 0.902365879596533, 0.7618352020199857, 0.9875533675942777, 0.842092383998097, 0.9070421704343139, 0.8594376480457261, 0.8713357911677251, 0.9967630493181383, 0.8782425200280177, 0.9689568164124682, 0.8189788256214632, 0.848377614391236, 0.9829445539708642, 0.9618253204398108, 0.5431840229895681, 0.8681764805563316, 0.9324318210984567, 0.9318865989345633, 0.9827915698156957, 0.9192188447212246, 0.9311114304993497, 0.960683672365225, 0.7876310994071665, 0.9531798855427625, 0.9146656224096474, 0.8808374583766336, 0.9677284016990363, 0.8616773516360123, 0.9083941719671966, 0.7873703021718608, 0.8857998813262344, 0.9860691354253087, 0.8704041906096807, 0.7390236272546689, 0.6033780778480331, 0.9464413171005434, 0.9320377325793641, 0.8910255631500378, 0.5484046875512503, 0.9688072577806067, 0.9656613942136262, 0.9684709335666802, 0.8298331500530199, 0.9710835221212852, 0.7969517220099936, 0.9152759098542184, 0.8187712967223689, 0.7963847091937473, 0.9623441551765963], "episode_lengths": [16, 17, 15, 13, 14, 14, 23, 23, 15, 13, 21, 15, 15, 21, 14, 13, 14, 14, 21, 14, 16, 15, 15, 14, 16, 13, 14, 16, 14, 14, 13, 14, 22, 16, 14, 13, 16, 20, 17, 14, 28, 16, 33, 15, 14, 14, 17, 13, 15, 16, 14, 19, 13, 15, 14, 14, 15, 13, 17, 15, 14, 15, 15, 13, 14, 15, 15, 19, 14, 15, 33, 18, 14, 20, 17, 16, 16, 15, 13, 20, 14, 13, 16, 13, 19, 15, 13, 14, 12, 17, 23, 15, 17, 14, 14, 14, 13, 17, 14, 14, 30, 14, 20, 14, 19, 17, 13, 14, 17, 10, 14, 23, 14, 20, 13, 21, 17, 14, 19, 13, 14, 14, 14, 32, 14, 15, 17, 19, 14, 14, 16, 21, 14, 14, 13, 13, 16, 14, 21, 15, 28, 15, 13, 13, 14, 19, 15, 21, 15, 13, 14, 17, 14, 14, 15, 20, 13, 17, 18, 14, 15, 14, 15, 14, 13, 16, 19, 14, 41, 16, 14, 13, 15, 16, 13, 17, 22, 15, 16, 15, 15, 14, 14, 17, 13, 14, 16, 14, 14, 13, 14, 14, 17, 13, 14, 13, 13, 13, 14, 14, 14, 13, 22, 16, 19, 13, 13, 13, 14, 14, 14, 13, 14, 14, 19, 14, 18, 15, 14, 14, 16, 14, 16, 13, 14, 13, 16, 14, 13, 17, 18, 14, 18, 14, 14, 14, 18, 30, 14, 16, 15, 16, 14, 14, 13, 19, 13, 13, 14, 14, 19, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09732662338767323, "mean_inference_ms": 0.24393863326539214, "mean_action_processing_ms": 0.04397917470617778, "mean_env_wait_ms": 0.04724181539491864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014850071498325893, "StateBufferConnector_ms": 0.0012026892768012153, "ViewRequirementAgentConnector_ms": 0.02814370488363599}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1108.2754750124982, "num_env_steps_trained_throughput_per_sec": 1108.2754750124982, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 3741.163, "sample_time_ms": 1789.914, "load_time_ms": 0.212, "load_throughput": 18891133.881, "learn_time_ms": 1950.085, "learn_throughput": 2051.192, "synch_weights_time_ms": 0.624}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 11516, "training_iteration": 84, "trial_id": "default", "date": "2024-05-22_22-20-05", "timestamp": 1716409205, "time_this_iter_s": 3.6136629581451416, "time_total_s": 304.63480591773987, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 304.63480591773987, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 12.283333333333331, "ram_util_percent": 60.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.293676120491438, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.02005200652650968, "policy_loss": -0.008870686210131132, "vf_loss": 0.027615373022603973, "vf_explained_var": 0.47435575005828695, "kl": 0.010329437551255632, "entropy": 0.5980369511150545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78585.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 0.9987465815307075, "episode_reward_min": -1.0, "episode_reward_mean": 0.8411330899306665, "episode_len_mean": 15.9800796812749, "episode_media": {}, "episodes_this_iter": 251, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7034706124581722, 0.5156129997747241, 0.9309415073956754, 0.7457879998131991, 0.9202050909265056, 0.9116021808826713, 0.8967457308668426, 0.6887480005442734, 0.945635279965551, 0.8523160528514518, 0.971519933461944, 0.8699214731852495, 0.8620043952869426, 0.9637589249202563, 0.9300925331893726, 0.9004734073779431, 0.9573068059891735, 0.8396396023233189, 0.8618510948910936, 0.9423386093234083, 0.8539148766878493, 0.6563205516170627, 0.9231409677154921, 0.9619407739483025, 0.9475864864451741, 0.9921083432158999, 0.9066786939976911, 0.9150619818064412, 0.9657388536916695, 0.9605993561350115, 0.9346808686132382, 0.8432512206507288, 0.7886110532628452, 0.9605043930678487, 0.9817748700574995, 0.9931823498598751, 0.9955049953233307, 0.8932599641452326, 0.9183975269684075, 0.870048003200089, 0.9736520025197266, 0.9631494259535686, 0.9283415338111094, 0.9936644191314281, 0.776341078898775, 0.8859572349232213, 0.6887676818459658, 0.8941880535891278, 0.6464122059907347, 0.9116994689273582, 0.9328945826398913, 0.773055845171968, 0.964336708489499, 0.9720327346702384, 0.9987465815307075, 0.8717412999441998, 0.9404050770407678, 0.9450347932917889, 0.6955571084281382, 0.9505842161785013, 0.810569290197787, 0.9618392775177892, -1.0, 0.8840421042030807, 0.5629210715466757, 0.9699251086860448, 0.9527840652959072, 0.9291794236358468, 0.9562279320813286, 0.9869118650078463, 0.6998784011242244, 0.7467818231019987, 0.9270972466492434, 0.9364670021244781, 0.8316944739308075, 0.9250968572993119, 0.6071465480247127, 0.9723292571936976, 0.8731686390501577, 0.9302507346341191, 0.9983060994637578, 0.989078647853846, 0.7318575121710751, 0.7402184646790838, 0.9786596154273082, 0.9691090645063171, 0.9626767078184506, 0.5683999801020465, 0.9869006498741835, 0.6206891870427509, 0.927056727195981, 0.8371144050037519, 0.98328741062855, 0.6060768838276066, 0.9313456991180086, 0.9350087773627132, 0.7686541789157959, 0.9006743965748071, 0.6182634458918206, 0.9376597640185066, 0.8820924174925711, 0.976918564644549, 0.5990148251747192, 0.5, 0.6094652061572052, 0.9633179791954976, 0.9840377160985077, 0.9892665211676073, 0.9668939607959942, 0.7978269303585186, 0.9400164717244336, 0.9110571905429024, 0.9744724757209628, 0.8661692862256933, 0.9410096473977108, 0.9725598203735822, 0.6572215931719981, 0.8817484257343456, 0.8727674446425165, 0.9171686015578502, 0.8636864790266952, 0.881239069343755, 0.9275080661056146, 0.975332195724419, 0.9803280165277695, 0.607220232210816, 0.951472277636017, 0.9188664351615372, 0.9428614310686221, 0.9682569655998784, 0.9200255627255134, 0.5, 0.9740718898819725, 0.8937374338892661, -1.0, 0.9073330209107775, 0.9652853357949688, 0.75489465283619, 0.9974751039117105, 0.9443018045457052, 0.8767143250931886, 0.7286288628093507, 0.8840743178326096, 0.7363215693006103, 0.9454443412007427, 0.8377036731701227, 0.7470790682464143, 0.9836875406184388, -1.0, 0.9552870674029121, 0.9333286048792905, 0.9362852385039068, 0.9760727966958966, 0.8289826638617098, 0.6360900198481576, 0.8049569931278178, 0.8143216064588977, 0.92140026512725, 0.8225655768255701, 0.9194594165879358, 0.9816053450646077, 0.6200450238376121, 0.6936882873620933, 0.7097941624850249, 0.8177982676521109, 0.8246054036272625, 0.8122159409698942, 0.9224093599953562, 0.8256328245615544, 0.8972172847048699, 0.6670179220707406, 0.9820339951355667, 0.9705208712778658, 0.7194799617202677, 0.7466716236024828, 0.9730810205220368, 0.6151281560805422, 0.6852359592106769, 0.7526929450207973, 0.9645852398996982, 0.988269894158649, 0.7697292233096787, 0.8866521029689604, 0.9302125155570762, 0.9625717098093294, 0.7378141777010947, 0.9527252377005385, 0.8490139929202458, -1.0, 0.9035979881284528, 0.9230628230996515, 0.7682162851675154, 0.7228966455877988, 0.8950143523066796, 0.9854739071607562, 0.9193840697830712, 0.9819366192818237, 0.900064846380098, 0.8668282116548549, 0.8098849185344401, 0.8744580211497407, 0.9930923185396974, 0.7247271286164678, 0.8963509890870389, 0.9430831240221201, 0.95959587982495, 0.9671876887072048, 0.8388449704088394, 0.993098625030209, 0.816764145390665, 0.6496098283217242, 0.6697098683163119, 0.998707411811567, 0.9551661553494524, 0.9951438616519104, 0.8398019996439176, 0.8821801641166633, 0.9970208575530005, 0.852773207765152, 0.8153254142068962, 0.9065996743407756, 0.8940239933565088, 0.9237163626807267, 0.9173741921974752, 0.8852521191992099, 0.8679129700001389, 0.8761322483458314, 0.9421644592027725, 0.9070712516103758, 0.9540397209082213, 0.752514274095013, 0.9888954496977103, 0.9941571367037311, 0.7936543651434204, 0.849884279720121, 0.9001924521036121, 0.9827487991127505, 0.9715921379984659, 0.9149930657900989, 0.9773724975419446, 0.6256261149040142, 0.9821387600808632, 0.7580620059456236, 0.7548615807762675, 0.9081959439170533, 0.994314242008844, 0.9629368665595501, 0.957637889877059, 0.7912768649991117, 0.6273750061725174, 0.9647239158173665], "episode_lengths": [26, 16, 15, 16, 14, 15, 19, 17, 14, 16, 14, 18, 13, 17, 15, 15, 14, 15, 14, 17, 18, 29, 15, 16, 13, 14, 15, 18, 16, 14, 13, 13, 17, 13, 14, 14, 13, 16, 15, 14, 14, 21, 17, 14, 17, 13, 22, 21, 19, 14, 13, 16, 13, 15, 14, 14, 14, 14, 30, 14, 17, 14, 15, 15, 16, 14, 13, 16, 15, 15, 16, 20, 16, 17, 15, 13, 20, 14, 15, 13, 15, 14, 17, 17, 14, 14, 14, 20, 14, 17, 19, 20, 13, 36, 16, 17, 24, 15, 29, 16, 15, 13, 16, 17, 18, 14, 15, 15, 16, 19, 13, 15, 14, 14, 14, 14, 19, 14, 19, 15, 13, 16, 13, 13, 13, 16, 15, 14, 13, 17, 15, 17, 13, 18, 60, 16, 13, 15, 15, 16, 14, 21, 18, 32, 13, 13, 17, 18, 16, 13, 14, 22, 14, 14, 18, 17, 14, 14, 13, 16, 15, 19, 20, 17, 16, 16, 19, 14, 19, 14, 19, 13, 15, 17, 23, 14, 18, 18, 17, 14, 14, 13, 15, 18, 15, 19, 13, 14, 13, 16, 16, 16, 18, 16, 14, 16, 14, 14, 15, 14, 17, 14, 19, 13, 13, 13, 14, 14, 14, 15, 16, 16, 15, 14, 13, 16, 14, 13, 16, 14, 14, 16, 15, 14, 14, 13, 14, 14, 13, 14, 18, 14, 15, 14, 15, 15, 15, 15, 13, 13, 24, 14, 22, 18, 14, 16, 13, 15, 14, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09741516422607412, "mean_inference_ms": 0.24391564617691988, "mean_action_processing_ms": 0.043971770348989074, "mean_env_wait_ms": 0.04724199270691663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015180899327494708, "StateBufferConnector_ms": 0.0012042512931671751, "ViewRequirementAgentConnector_ms": 0.028165878052730485}}, "episode_reward_max": 0.9987465815307075, "episode_reward_min": -1.0, "episode_reward_mean": 0.8411330899306665, "episode_len_mean": 15.9800796812749, "episodes_this_iter": 251, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7034706124581722, 0.5156129997747241, 0.9309415073956754, 0.7457879998131991, 0.9202050909265056, 0.9116021808826713, 0.8967457308668426, 0.6887480005442734, 0.945635279965551, 0.8523160528514518, 0.971519933461944, 0.8699214731852495, 0.8620043952869426, 0.9637589249202563, 0.9300925331893726, 0.9004734073779431, 0.9573068059891735, 0.8396396023233189, 0.8618510948910936, 0.9423386093234083, 0.8539148766878493, 0.6563205516170627, 0.9231409677154921, 0.9619407739483025, 0.9475864864451741, 0.9921083432158999, 0.9066786939976911, 0.9150619818064412, 0.9657388536916695, 0.9605993561350115, 0.9346808686132382, 0.8432512206507288, 0.7886110532628452, 0.9605043930678487, 0.9817748700574995, 0.9931823498598751, 0.9955049953233307, 0.8932599641452326, 0.9183975269684075, 0.870048003200089, 0.9736520025197266, 0.9631494259535686, 0.9283415338111094, 0.9936644191314281, 0.776341078898775, 0.8859572349232213, 0.6887676818459658, 0.8941880535891278, 0.6464122059907347, 0.9116994689273582, 0.9328945826398913, 0.773055845171968, 0.964336708489499, 0.9720327346702384, 0.9987465815307075, 0.8717412999441998, 0.9404050770407678, 0.9450347932917889, 0.6955571084281382, 0.9505842161785013, 0.810569290197787, 0.9618392775177892, -1.0, 0.8840421042030807, 0.5629210715466757, 0.9699251086860448, 0.9527840652959072, 0.9291794236358468, 0.9562279320813286, 0.9869118650078463, 0.6998784011242244, 0.7467818231019987, 0.9270972466492434, 0.9364670021244781, 0.8316944739308075, 0.9250968572993119, 0.6071465480247127, 0.9723292571936976, 0.8731686390501577, 0.9302507346341191, 0.9983060994637578, 0.989078647853846, 0.7318575121710751, 0.7402184646790838, 0.9786596154273082, 0.9691090645063171, 0.9626767078184506, 0.5683999801020465, 0.9869006498741835, 0.6206891870427509, 0.927056727195981, 0.8371144050037519, 0.98328741062855, 0.6060768838276066, 0.9313456991180086, 0.9350087773627132, 0.7686541789157959, 0.9006743965748071, 0.6182634458918206, 0.9376597640185066, 0.8820924174925711, 0.976918564644549, 0.5990148251747192, 0.5, 0.6094652061572052, 0.9633179791954976, 0.9840377160985077, 0.9892665211676073, 0.9668939607959942, 0.7978269303585186, 0.9400164717244336, 0.9110571905429024, 0.9744724757209628, 0.8661692862256933, 0.9410096473977108, 0.9725598203735822, 0.6572215931719981, 0.8817484257343456, 0.8727674446425165, 0.9171686015578502, 0.8636864790266952, 0.881239069343755, 0.9275080661056146, 0.975332195724419, 0.9803280165277695, 0.607220232210816, 0.951472277636017, 0.9188664351615372, 0.9428614310686221, 0.9682569655998784, 0.9200255627255134, 0.5, 0.9740718898819725, 0.8937374338892661, -1.0, 0.9073330209107775, 0.9652853357949688, 0.75489465283619, 0.9974751039117105, 0.9443018045457052, 0.8767143250931886, 0.7286288628093507, 0.8840743178326096, 0.7363215693006103, 0.9454443412007427, 0.8377036731701227, 0.7470790682464143, 0.9836875406184388, -1.0, 0.9552870674029121, 0.9333286048792905, 0.9362852385039068, 0.9760727966958966, 0.8289826638617098, 0.6360900198481576, 0.8049569931278178, 0.8143216064588977, 0.92140026512725, 0.8225655768255701, 0.9194594165879358, 0.9816053450646077, 0.6200450238376121, 0.6936882873620933, 0.7097941624850249, 0.8177982676521109, 0.8246054036272625, 0.8122159409698942, 0.9224093599953562, 0.8256328245615544, 0.8972172847048699, 0.6670179220707406, 0.9820339951355667, 0.9705208712778658, 0.7194799617202677, 0.7466716236024828, 0.9730810205220368, 0.6151281560805422, 0.6852359592106769, 0.7526929450207973, 0.9645852398996982, 0.988269894158649, 0.7697292233096787, 0.8866521029689604, 0.9302125155570762, 0.9625717098093294, 0.7378141777010947, 0.9527252377005385, 0.8490139929202458, -1.0, 0.9035979881284528, 0.9230628230996515, 0.7682162851675154, 0.7228966455877988, 0.8950143523066796, 0.9854739071607562, 0.9193840697830712, 0.9819366192818237, 0.900064846380098, 0.8668282116548549, 0.8098849185344401, 0.8744580211497407, 0.9930923185396974, 0.7247271286164678, 0.8963509890870389, 0.9430831240221201, 0.95959587982495, 0.9671876887072048, 0.8388449704088394, 0.993098625030209, 0.816764145390665, 0.6496098283217242, 0.6697098683163119, 0.998707411811567, 0.9551661553494524, 0.9951438616519104, 0.8398019996439176, 0.8821801641166633, 0.9970208575530005, 0.852773207765152, 0.8153254142068962, 0.9065996743407756, 0.8940239933565088, 0.9237163626807267, 0.9173741921974752, 0.8852521191992099, 0.8679129700001389, 0.8761322483458314, 0.9421644592027725, 0.9070712516103758, 0.9540397209082213, 0.752514274095013, 0.9888954496977103, 0.9941571367037311, 0.7936543651434204, 0.849884279720121, 0.9001924521036121, 0.9827487991127505, 0.9715921379984659, 0.9149930657900989, 0.9773724975419446, 0.6256261149040142, 0.9821387600808632, 0.7580620059456236, 0.7548615807762675, 0.9081959439170533, 0.994314242008844, 0.9629368665595501, 0.957637889877059, 0.7912768649991117, 0.6273750061725174, 0.9647239158173665], "episode_lengths": [26, 16, 15, 16, 14, 15, 19, 17, 14, 16, 14, 18, 13, 17, 15, 15, 14, 15, 14, 17, 18, 29, 15, 16, 13, 14, 15, 18, 16, 14, 13, 13, 17, 13, 14, 14, 13, 16, 15, 14, 14, 21, 17, 14, 17, 13, 22, 21, 19, 14, 13, 16, 13, 15, 14, 14, 14, 14, 30, 14, 17, 14, 15, 15, 16, 14, 13, 16, 15, 15, 16, 20, 16, 17, 15, 13, 20, 14, 15, 13, 15, 14, 17, 17, 14, 14, 14, 20, 14, 17, 19, 20, 13, 36, 16, 17, 24, 15, 29, 16, 15, 13, 16, 17, 18, 14, 15, 15, 16, 19, 13, 15, 14, 14, 14, 14, 19, 14, 19, 15, 13, 16, 13, 13, 13, 16, 15, 14, 13, 17, 15, 17, 13, 18, 60, 16, 13, 15, 15, 16, 14, 21, 18, 32, 13, 13, 17, 18, 16, 13, 14, 22, 14, 14, 18, 17, 14, 14, 13, 16, 15, 19, 20, 17, 16, 16, 19, 14, 19, 14, 19, 13, 15, 17, 23, 14, 18, 18, 17, 14, 14, 13, 15, 18, 15, 19, 13, 14, 13, 16, 16, 16, 18, 16, 14, 16, 14, 14, 15, 14, 17, 14, 19, 13, 13, 13, 14, 14, 14, 15, 16, 16, 15, 14, 13, 16, 14, 13, 16, 14, 14, 16, 15, 14, 14, 13, 14, 14, 13, 14, 18, 14, 15, 14, 15, 15, 15, 15, 13, 13, 24, 14, 22, 18, 14, 16, 13, 15, 14, 17, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09741516422607412, "mean_inference_ms": 0.24391564617691988, "mean_action_processing_ms": 0.043971770348989074, "mean_env_wait_ms": 0.04724199270691663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015180899327494708, "StateBufferConnector_ms": 0.0012042512931671751, "ViewRequirementAgentConnector_ms": 0.028165878052730485}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1070.2126223628884, "num_env_steps_trained_throughput_per_sec": 1070.2126223628884, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 3748.105, "sample_time_ms": 1783.47, "load_time_ms": 0.211, "load_throughput": 18933772.712, "learn_time_ms": 1963.453, "learn_throughput": 2037.227, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 11767, "training_iteration": 85, "trial_id": "default", "date": "2024-05-22_22-20-09", "timestamp": 1716409209, "time_this_iter_s": 3.7422921657562256, "time_total_s": 308.3770980834961, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 308.3770980834961, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 19.24, "ram_util_percent": 60.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8541237434392333, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.057855917462297984, "policy_loss": -0.008494751999575284, "vf_loss": 0.06465959268902499, "vf_explained_var": 0.1558377993363206, "kl": 0.01336160030450655, "entropy": 0.598685476920938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 0.999879581089847, "episode_reward_min": -1.0, "episode_reward_mean": 0.7994659594281341, "episode_len_mean": 16.789915966386555, "episode_media": {}, "episodes_this_iter": 238, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9748600950090622, 0.9491704547668935, 0.7331610132200274, 0.9827419605688574, 0.904987894598623, 0.9941734089120082, 0.9827259773772928, 0.9657462661494733, 0.9684763152921713, 0.8955490529660146, 0.970455723029682, -1.0, 0.987191295546812, 0.7596797289377394, 0.9006653717631381, 0.8795908814154902, 0.7245806381301921, 0.9605078698301553, 0.9905076154609427, 0.9098164151700845, 0.9885955829318315, 0.9808601608922564, 0.9301681923934348, 0.8755460199881709, -1.0, 0.8264692778124256, -1.0, 0.989158349291009, 0.9393367546123368, 0.8964499567689097, 0.9916661717688563, 0.8930294882061155, 0.8975031072768174, 0.9133311962569443, 0.7134495963962046, 0.9871098768274351, 0.9368174403576808, 0.9488413874618072, 0.8441965103090818, 0.997604419019465, 0.9872320527630982, 0.8036717612232196, 0.9255424539361432, 0.923943185360354, 0.5744965724359898, 0.90893039199114, 0.9043875209167254, 0.9933439338713296, -1.0, 0.9762390852843414, 0.8716906082552641, 0.9955725531852102, 0.9975716906703745, 0.9977580942138975, 0.6681264904734636, 0.9163178114312436, -1.0, 0.7453189384858137, 0.9711888595870459, 0.8729408734135028, 0.7728489264199396, 0.9149462405957675, 0.9112501523121913, 0.9390105231575316, 0.7082681467342314, 0.5658176100385841, 0.9961490714130672, 0.9522415309821274, 0.9183134305933925, 0.9621596023793784, 0.9888127296320267, 0.8671146838952033, 0.9780866424131698, -1.0, 0.9852090839714682, 0.9564107815716846, 0.5, 0.9576814620174965, 0.7485246392426689, 0.9126223970179133, 0.8585904602555006, 0.9794563496756288, 0.9409861947437822, 0.8914863512046591, 0.8201531069976506, 0.8950440489363038, 0.8760643835997851, 0.8054588873075739, 0.873190994839169, 0.6857702087213516, 0.858797604515019, 0.8691341846359368, 0.9734419161056276, 0.9920168653598083, 0.6854101970367543, 0.9806104271264107, -1.0, 0.9489404337966558, 0.9023102818418662, 0.9271667248202791, 0.7057030362269915, 0.6273499188996469, -1.0, 0.7515774610648569, 0.8888083106896284, 0.8266596642130087, 0.7582321998157333, 0.9754060333110158, 0.9891711953384632, 0.8528533274339379, 0.9272597386210879, 0.9360287006867687, 0.8472145849843593, 0.9404546845356365, 0.6588541167436899, 0.840515532372364, 0.9891395552275354, 0.8619546423965361, 0.9022441850185863, 0.8807957298962813, 0.9110139851913949, 0.7497877262349397, 0.9926599084634365, 0.9970447431634031, 0.6296730846722745, 0.9471129292093569, 0.8485296843204541, 0.5398039292813865, 0.932911681288529, 0.9116870659096463, 0.9900156641047568, 0.919707688942158, 0.8777919574929903, 0.9258851272769588, 0.8976542967066407, 0.5162052217815207, 0.8917848812086864, 0.8950201225402428, 0.9113832156909959, 0.8763828755019095, 0.931594298890844, -1.0, 0.9921664363775244, 0.9503286005281524, 0.6953229187422519, 0.5542517133441283, 0.9669031290839017, 0.8568168300586072, 0.9509295404485612, 0.9504204450270033, 0.68639911873938, 0.9643254918913167, 0.9788919245499532, 0.5008099081404336, 0.7886446335926208, 0.663586249848082, 0.8935411606831932, 0.9751996185594719, 0.6408144699934767, 0.8751550569388431, 0.8686112948394589, 0.9417697730635309, 0.9858029535566539, 0.5, 0.9500938436330156, 0.9336745009596551, 0.8331919699714005, 0.7196276263257173, 0.5593154518561334, 0.9177356729147287, 0.9915779821044092, 0.9683106337196112, 0.8973988663748377, 0.848632792570654, 0.5054141155474636, 0.9156928344845382, 0.9313026642051375, 0.835343892897473, 0.7559735554669401, 0.9167489405971982, 0.8882377751137196, 0.6773845687609685, 0.6936709014962014, 0.9735552309181024, 0.8921142242395355, 0.979047512674032, 0.8664174883977047, 0.8924343090553993, 0.9465441314329317, 0.9431407918835629, 0.7757162113608398, 0.9738092449147728, 0.9524325128812806, 0.8973750583576054, 0.924446508746115, 0.916944903633814, 0.7991365315032258, 0.6543096166098346, 0.9492576904523087, 0.9796476953266775, 0.7392270431609518, 0.9399345153887534, 0.83554537857118, 0.9724028803823195, 0.9049066427369038, 0.9674145255630808, 0.8523194926261204, 0.9582345600583447, 0.9709417544818109, 0.9518590463604022, 0.9780705493291023, 0.999879581089847, 0.9962816540368901, 0.8947468234980612, 0.9612175956952823, 0.5, 0.8586008848554774, -1.0, 0.9386208749974799, 0.951553030366555, 0.9771709988641237, 0.9293169352478416, 0.9671965316195348, 0.6974051749836039, 0.768095028486297, 0.9254393096579234, 0.9460044298053456, 0.9930827187601511, 0.9953143376255917, 0.8895099569432009, 0.9868661199099095, 0.9169744918393694, 0.820801717411926, 0.8678795189482549, 0.978694087288506, 0.8318800319414845, 0.9533667465265665, 0.8474295299737853], "episode_lengths": [14, 15, 17, 14, 15, 15, 15, 15, 17, 14, 13, 12, 13, 14, 15, 19, 24, 15, 15, 15, 23, 16, 15, 15, 47, 14, 12, 15, 14, 16, 14, 17, 14, 14, 15, 15, 16, 13, 15, 15, 17, 17, 14, 15, 17, 13, 16, 13, 13, 15, 13, 13, 15, 13, 37, 17, 19, 14, 15, 15, 19, 15, 15, 20, 17, 26, 14, 14, 15, 18, 13, 16, 15, 49, 13, 15, 47, 16, 17, 15, 20, 14, 13, 19, 21, 15, 14, 18, 15, 27, 14, 14, 14, 14, 16, 15, 17, 13, 15, 14, 15, 28, 11, 21, 17, 16, 19, 15, 14, 14, 16, 14, 20, 17, 18, 13, 15, 23, 15, 14, 15, 16, 13, 15, 27, 17, 14, 15, 14, 14, 16, 13, 13, 13, 14, 24, 23, 14, 14, 14, 14, 12, 14, 14, 15, 24, 14, 16, 16, 13, 27, 14, 13, 28, 18, 25, 22, 14, 24, 15, 17, 13, 13, 54, 14, 13, 21, 43, 15, 15, 17, 13, 14, 19, 22, 13, 13, 15, 14, 14, 17, 51, 44, 15, 15, 15, 15, 15, 14, 17, 15, 15, 15, 14, 13, 14, 14, 22, 14, 14, 14, 15, 16, 15, 13, 15, 13, 15, 15, 14, 15, 16, 14, 15, 13, 30, 14, 12, 14, 15, 14, 14, 15, 24, 18, 16, 14, 15, 15, 13, 14, 13, 19, 13, 16, 15, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09750957822743266, "mean_inference_ms": 0.24392280392425553, "mean_action_processing_ms": 0.04397510273168997, "mean_env_wait_ms": 0.04725086537593072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001528182951342158, "StateBufferConnector_ms": 0.0012375727421095391, "ViewRequirementAgentConnector_ms": 0.02862034725541828}}, "episode_reward_max": 0.999879581089847, "episode_reward_min": -1.0, "episode_reward_mean": 0.7994659594281341, "episode_len_mean": 16.789915966386555, "episodes_this_iter": 238, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9748600950090622, 0.9491704547668935, 0.7331610132200274, 0.9827419605688574, 0.904987894598623, 0.9941734089120082, 0.9827259773772928, 0.9657462661494733, 0.9684763152921713, 0.8955490529660146, 0.970455723029682, -1.0, 0.987191295546812, 0.7596797289377394, 0.9006653717631381, 0.8795908814154902, 0.7245806381301921, 0.9605078698301553, 0.9905076154609427, 0.9098164151700845, 0.9885955829318315, 0.9808601608922564, 0.9301681923934348, 0.8755460199881709, -1.0, 0.8264692778124256, -1.0, 0.989158349291009, 0.9393367546123368, 0.8964499567689097, 0.9916661717688563, 0.8930294882061155, 0.8975031072768174, 0.9133311962569443, 0.7134495963962046, 0.9871098768274351, 0.9368174403576808, 0.9488413874618072, 0.8441965103090818, 0.997604419019465, 0.9872320527630982, 0.8036717612232196, 0.9255424539361432, 0.923943185360354, 0.5744965724359898, 0.90893039199114, 0.9043875209167254, 0.9933439338713296, -1.0, 0.9762390852843414, 0.8716906082552641, 0.9955725531852102, 0.9975716906703745, 0.9977580942138975, 0.6681264904734636, 0.9163178114312436, -1.0, 0.7453189384858137, 0.9711888595870459, 0.8729408734135028, 0.7728489264199396, 0.9149462405957675, 0.9112501523121913, 0.9390105231575316, 0.7082681467342314, 0.5658176100385841, 0.9961490714130672, 0.9522415309821274, 0.9183134305933925, 0.9621596023793784, 0.9888127296320267, 0.8671146838952033, 0.9780866424131698, -1.0, 0.9852090839714682, 0.9564107815716846, 0.5, 0.9576814620174965, 0.7485246392426689, 0.9126223970179133, 0.8585904602555006, 0.9794563496756288, 0.9409861947437822, 0.8914863512046591, 0.8201531069976506, 0.8950440489363038, 0.8760643835997851, 0.8054588873075739, 0.873190994839169, 0.6857702087213516, 0.858797604515019, 0.8691341846359368, 0.9734419161056276, 0.9920168653598083, 0.6854101970367543, 0.9806104271264107, -1.0, 0.9489404337966558, 0.9023102818418662, 0.9271667248202791, 0.7057030362269915, 0.6273499188996469, -1.0, 0.7515774610648569, 0.8888083106896284, 0.8266596642130087, 0.7582321998157333, 0.9754060333110158, 0.9891711953384632, 0.8528533274339379, 0.9272597386210879, 0.9360287006867687, 0.8472145849843593, 0.9404546845356365, 0.6588541167436899, 0.840515532372364, 0.9891395552275354, 0.8619546423965361, 0.9022441850185863, 0.8807957298962813, 0.9110139851913949, 0.7497877262349397, 0.9926599084634365, 0.9970447431634031, 0.6296730846722745, 0.9471129292093569, 0.8485296843204541, 0.5398039292813865, 0.932911681288529, 0.9116870659096463, 0.9900156641047568, 0.919707688942158, 0.8777919574929903, 0.9258851272769588, 0.8976542967066407, 0.5162052217815207, 0.8917848812086864, 0.8950201225402428, 0.9113832156909959, 0.8763828755019095, 0.931594298890844, -1.0, 0.9921664363775244, 0.9503286005281524, 0.6953229187422519, 0.5542517133441283, 0.9669031290839017, 0.8568168300586072, 0.9509295404485612, 0.9504204450270033, 0.68639911873938, 0.9643254918913167, 0.9788919245499532, 0.5008099081404336, 0.7886446335926208, 0.663586249848082, 0.8935411606831932, 0.9751996185594719, 0.6408144699934767, 0.8751550569388431, 0.8686112948394589, 0.9417697730635309, 0.9858029535566539, 0.5, 0.9500938436330156, 0.9336745009596551, 0.8331919699714005, 0.7196276263257173, 0.5593154518561334, 0.9177356729147287, 0.9915779821044092, 0.9683106337196112, 0.8973988663748377, 0.848632792570654, 0.5054141155474636, 0.9156928344845382, 0.9313026642051375, 0.835343892897473, 0.7559735554669401, 0.9167489405971982, 0.8882377751137196, 0.6773845687609685, 0.6936709014962014, 0.9735552309181024, 0.8921142242395355, 0.979047512674032, 0.8664174883977047, 0.8924343090553993, 0.9465441314329317, 0.9431407918835629, 0.7757162113608398, 0.9738092449147728, 0.9524325128812806, 0.8973750583576054, 0.924446508746115, 0.916944903633814, 0.7991365315032258, 0.6543096166098346, 0.9492576904523087, 0.9796476953266775, 0.7392270431609518, 0.9399345153887534, 0.83554537857118, 0.9724028803823195, 0.9049066427369038, 0.9674145255630808, 0.8523194926261204, 0.9582345600583447, 0.9709417544818109, 0.9518590463604022, 0.9780705493291023, 0.999879581089847, 0.9962816540368901, 0.8947468234980612, 0.9612175956952823, 0.5, 0.8586008848554774, -1.0, 0.9386208749974799, 0.951553030366555, 0.9771709988641237, 0.9293169352478416, 0.9671965316195348, 0.6974051749836039, 0.768095028486297, 0.9254393096579234, 0.9460044298053456, 0.9930827187601511, 0.9953143376255917, 0.8895099569432009, 0.9868661199099095, 0.9169744918393694, 0.820801717411926, 0.8678795189482549, 0.978694087288506, 0.8318800319414845, 0.9533667465265665, 0.8474295299737853], "episode_lengths": [14, 15, 17, 14, 15, 15, 15, 15, 17, 14, 13, 12, 13, 14, 15, 19, 24, 15, 15, 15, 23, 16, 15, 15, 47, 14, 12, 15, 14, 16, 14, 17, 14, 14, 15, 15, 16, 13, 15, 15, 17, 17, 14, 15, 17, 13, 16, 13, 13, 15, 13, 13, 15, 13, 37, 17, 19, 14, 15, 15, 19, 15, 15, 20, 17, 26, 14, 14, 15, 18, 13, 16, 15, 49, 13, 15, 47, 16, 17, 15, 20, 14, 13, 19, 21, 15, 14, 18, 15, 27, 14, 14, 14, 14, 16, 15, 17, 13, 15, 14, 15, 28, 11, 21, 17, 16, 19, 15, 14, 14, 16, 14, 20, 17, 18, 13, 15, 23, 15, 14, 15, 16, 13, 15, 27, 17, 14, 15, 14, 14, 16, 13, 13, 13, 14, 24, 23, 14, 14, 14, 14, 12, 14, 14, 15, 24, 14, 16, 16, 13, 27, 14, 13, 28, 18, 25, 22, 14, 24, 15, 17, 13, 13, 54, 14, 13, 21, 43, 15, 15, 17, 13, 14, 19, 22, 13, 13, 15, 14, 14, 17, 51, 44, 15, 15, 15, 15, 15, 14, 17, 15, 15, 15, 14, 13, 14, 14, 22, 14, 14, 14, 15, 16, 15, 13, 15, 13, 15, 15, 14, 15, 16, 14, 15, 13, 30, 14, 12, 14, 15, 14, 14, 15, 24, 18, 16, 14, 15, 15, 13, 14, 13, 19, 13, 16, 15, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09750957822743266, "mean_inference_ms": 0.24392280392425553, "mean_action_processing_ms": 0.04397510273168997, "mean_env_wait_ms": 0.04725086537593072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001528182951342158, "StateBufferConnector_ms": 0.0012375727421095391, "ViewRequirementAgentConnector_ms": 0.02862034725541828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1081.2719750376784, "num_env_steps_trained_throughput_per_sec": 1081.2719750376784, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 3702.002, "sample_time_ms": 1783.434, "load_time_ms": 0.214, "load_throughput": 18701611.86, "learn_time_ms": 1917.372, "learn_throughput": 2086.188, "synch_weights_time_ms": 0.645}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 12005, "training_iteration": 86, "trial_id": "default", "date": "2024-05-22_22-20-12", "timestamp": 1716409212, "time_this_iter_s": 3.703947067260742, "time_total_s": 312.08104515075684, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 312.08104515075684, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 20.919999999999998, "ram_util_percent": 60.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.564489390709067, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01623799398150896, "policy_loss": -0.013215978810143086, "vf_loss": 0.027553373979034044, "vf_explained_var": 0.2988031262992531, "kl": 0.015017075698000832, "entropy": 0.5318623555924302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80445.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 0.9993236189100148, "episode_reward_min": -1.0, "episode_reward_mean": 0.8408810193702649, "episode_len_mean": 15.531007751937985, "episode_media": {}, "episodes_this_iter": 258, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8620989267197803, 0.7217281909940416, 0.7481447032307337, 0.9058881066974511, 0.9050793006407102, 0.9739935640187039, 0.7639860185195473, 0.9053610110052798, 0.9405395205693693, 0.6114804158431237, 0.951474862990347, 0.9729965886992922, 0.8807272449844711, 0.8352832320059458, 0.9338481357930088, 0.8917666600347853, 0.8949175376194847, 0.9514343397401328, 0.8696134193391445, 0.9481170085616556, 0.9901807049751892, 0.9828920120447124, 0.822871522623793, 0.9229503848238734, 0.8759127174628296, 0.7765411021376308, 0.9958581671743019, 0.7017372657421537, 0.9860364278087339, 0.8224887848639335, 0.7634516750930755, 0.9898356250569864, 0.8087220916855822, 0.7107413240311958, 0.9747110265360641, 0.9863817429499436, 0.6696981035983288, 0.9423832584788681, 0.9911634682956855, 0.7795519097949898, 0.8125908210265236, 0.7588756895967264, 0.9961020676157804, 0.8256910970801496, 0.7693306829269027, 0.9078680077708469, 0.8417842879585065, -1.0, 0.5778916397133099, 0.9719853829979294, 0.9912196983214308, 0.8197321941466723, 0.9896518479900881, 0.9594556315175005, 0.9539062167687792, 0.8177313218666168, 0.9522143988060983, 0.8502041881459175, 0.9796184995978362, 0.7837217892419106, 0.884483071661763, 0.6335853919222074, 0.8844243093601727, 0.9534430988850465, 0.8813745533969846, 0.918972353714482, 0.8726296670833145, 0.9820513627050032, 0.5198369723588576, 0.8366776641358135, 0.7132197026428049, 0.9802440748967923, 0.8414855629761154, 0.8698551434666986, 0.9146277307920886, 0.9206771905433814, 0.7614277489509692, 0.8254874452365331, 0.6719487472167222, 0.9935343391146162, 0.9906680484331711, 0.9993236189100148, 0.7826253943407347, 0.8813998442348683, 0.8082560931320425, 0.99310318319686, 0.9105111270014248, 0.9891556846128027, 0.9828609129797006, 0.859143050507799, 0.7521459201609325, 0.7778235469740056, 0.8613102729967568, 0.9933534090072109, 0.9377427573432385, 0.9291766726924513, 0.9028516946785239, 0.8904742028304942, 0.8446924477248874, 0.7421579389802531, 0.900555151194177, 0.9497307850240607, 0.8775838527679315, 0.87064155933078, 0.9769370175745357, 0.8651292456600759, 0.9187579935960339, 0.8905252911951747, 0.9850507277451221, 0.9903755338561647, 0.6519144826310044, 0.9720816021418941, 0.888779100763687, 0.6834490111188429, 0.762362682227168, 0.9555863748671976, 0.9627544331752613, 0.9595659235121468, 0.9458493728162053, 0.9900109046092264, 0.9753282287199108, 0.8763274895375687, 0.9683328608122206, 0.9720887428469993, 0.7862423012723285, 0.9944190631514329, 0.7876305573454289, 0.9227710059999689, 0.9505405656937632, 0.8528355914472224, 0.9262036248384053, 0.9286804645128188, -1.0, 0.6890118996926221, 0.9437074086205097, 0.7587544988213133, 0.9179012883122782, 0.8542480069694586, 0.8820322239581229, 0.8264705404595322, 0.9956171955237731, 0.9722903664164967, 0.873427484480404, 0.9389141217728764, 0.9599194785144589, 0.7576430883758117, 0.9770292025312867, 0.9546444805546807, -1.0, 0.9395931635644221, 0.8695585845442038, 0.9510291335581184, 0.8956322867797267, 0.6762801652064836, 0.8693791524286899, 0.993847081415377, 0.9959493316244922, 0.9306328416798114, 0.920548019783683, 0.8329438782237546, 0.8448556582094386, -1.0, 0.840632245634543, 0.9805774445879483, 0.8971952150654869, 0.8709253431790659, 0.8035632801996277, 0.8092190300888398, 0.6051916299542389, 0.9054726644509353, 0.8948264898713755, 0.9370005271186695, 0.911762992673055, 0.9244966039484463, 0.9772311009032979, 0.9133117895083726, 0.8118730501500928, 0.838944516337546, 0.9375194207393861, 0.9589852895609322, 0.9447053467218467, 0.7290591349344318, 0.9008228367914897, 0.9753457914431989, 0.9368474623925915, 0.9643620199044894, 0.8468540488931965, 0.8327759455973416, 0.9268942373928074, 0.9210206803944943, 0.6413213237239963, 0.8605097945469088, 0.9700860526339911, 0.9949367510409781, 0.9855343874399624, 0.9903652021561444, 0.9518343235070017, 0.8425588570606205, 0.9409605690164478, 0.9390949931908029, 0.8978435509222502, 0.8953713481092034, 0.8632765319412438, 0.9955939564214054, 0.963585510379684, 0.9850033410699593, 0.9789647053519898, 0.8209861890786917, 0.9255277349423829, 0.712072338279424, 0.9052232279024146, 0.8844834268038104, 0.9853288124666705, 0.9654016318971276, 0.6485581455086513, 0.9492319388545701, 0.9989967307983803, 0.731841365451594, 0.9569100043093068, 0.8162518454720598, 0.9388108592993771, 0.648654079742331, 0.8104130082369796, 0.9867067675452702, 0.9532209988343303, 0.9671148173090206, 0.9797519046292662, 0.928324014058294, 0.9701677645064863, 0.8692635333437433, 0.9505503256260552, 0.9912538543993963, 0.8631935098961616, 0.8872901107465814, 0.9922692829432874, 0.9943198835483166, 0.9080290820823866, 0.9198574491749075, 0.9399725530567772, 0.9207622080959562, 0.8262001379091751, 0.8504080549120463, 0.6890826590860251, 0.86981559516932, 0.695933805466693, 0.94243861860797, 0.9174360269117441, -1.0, 0.930540705283173, -1.0, 0.8723460412645652, 0.9393659062476342, 0.9308446828818964, 0.755948594178924, 0.9403142690126727, 0.7083205806449228, 0.9036205874760276, 0.7878623546056843], "episode_lengths": [13, 28, 13, 13, 14, 14, 20, 15, 15, 21, 13, 14, 13, 29, 14, 14, 14, 14, 13, 14, 14, 16, 14, 13, 14, 20, 14, 20, 15, 14, 15, 15, 15, 46, 14, 15, 16, 13, 13, 22, 14, 14, 14, 19, 16, 16, 15, 11, 23, 13, 15, 18, 16, 13, 14, 14, 14, 15, 15, 26, 15, 22, 14, 15, 14, 13, 18, 13, 15, 13, 18, 13, 16, 13, 13, 14, 18, 13, 14, 14, 15, 13, 15, 13, 19, 13, 14, 15, 13, 15, 18, 16, 15, 13, 14, 14, 13, 19, 17, 24, 14, 13, 14, 13, 14, 14, 14, 17, 13, 15, 21, 14, 14, 26, 25, 14, 13, 13, 15, 13, 15, 14, 14, 13, 25, 14, 14, 14, 15, 16, 14, 13, 11, 25, 15, 23, 15, 14, 14, 18, 15, 13, 16, 15, 14, 21, 14, 14, 13, 13, 16, 14, 16, 16, 14, 14, 13, 15, 14, 15, 14, 11, 14, 14, 17, 15, 20, 16, 26, 13, 16, 14, 17, 15, 13, 13, 14, 14, 13, 14, 14, 14, 17, 14, 14, 14, 15, 19, 13, 15, 19, 13, 16, 14, 15, 14, 14, 16, 14, 14, 13, 14, 14, 16, 15, 13, 14, 14, 16, 18, 13, 13, 16, 14, 16, 14, 13, 14, 13, 16, 14, 14, 15, 15, 14, 14, 14, 13, 14, 14, 14, 13, 14, 13, 14, 13, 14, 14, 15, 13, 18, 14, 24, 14, 22, 13, 15, 80, 15, 10, 14, 17, 14, 14, 13, 18, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09762723522740999, "mean_inference_ms": 0.24394741196083908, "mean_action_processing_ms": 0.043979544431602055, "mean_env_wait_ms": 0.04726480667415179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015994375066239704, "StateBufferConnector_ms": 0.0012497569239416787, "ViewRequirementAgentConnector_ms": 0.02872629683147105}}, "episode_reward_max": 0.9993236189100148, "episode_reward_min": -1.0, "episode_reward_mean": 0.8408810193702649, "episode_len_mean": 15.531007751937985, "episodes_this_iter": 258, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8620989267197803, 0.7217281909940416, 0.7481447032307337, 0.9058881066974511, 0.9050793006407102, 0.9739935640187039, 0.7639860185195473, 0.9053610110052798, 0.9405395205693693, 0.6114804158431237, 0.951474862990347, 0.9729965886992922, 0.8807272449844711, 0.8352832320059458, 0.9338481357930088, 0.8917666600347853, 0.8949175376194847, 0.9514343397401328, 0.8696134193391445, 0.9481170085616556, 0.9901807049751892, 0.9828920120447124, 0.822871522623793, 0.9229503848238734, 0.8759127174628296, 0.7765411021376308, 0.9958581671743019, 0.7017372657421537, 0.9860364278087339, 0.8224887848639335, 0.7634516750930755, 0.9898356250569864, 0.8087220916855822, 0.7107413240311958, 0.9747110265360641, 0.9863817429499436, 0.6696981035983288, 0.9423832584788681, 0.9911634682956855, 0.7795519097949898, 0.8125908210265236, 0.7588756895967264, 0.9961020676157804, 0.8256910970801496, 0.7693306829269027, 0.9078680077708469, 0.8417842879585065, -1.0, 0.5778916397133099, 0.9719853829979294, 0.9912196983214308, 0.8197321941466723, 0.9896518479900881, 0.9594556315175005, 0.9539062167687792, 0.8177313218666168, 0.9522143988060983, 0.8502041881459175, 0.9796184995978362, 0.7837217892419106, 0.884483071661763, 0.6335853919222074, 0.8844243093601727, 0.9534430988850465, 0.8813745533969846, 0.918972353714482, 0.8726296670833145, 0.9820513627050032, 0.5198369723588576, 0.8366776641358135, 0.7132197026428049, 0.9802440748967923, 0.8414855629761154, 0.8698551434666986, 0.9146277307920886, 0.9206771905433814, 0.7614277489509692, 0.8254874452365331, 0.6719487472167222, 0.9935343391146162, 0.9906680484331711, 0.9993236189100148, 0.7826253943407347, 0.8813998442348683, 0.8082560931320425, 0.99310318319686, 0.9105111270014248, 0.9891556846128027, 0.9828609129797006, 0.859143050507799, 0.7521459201609325, 0.7778235469740056, 0.8613102729967568, 0.9933534090072109, 0.9377427573432385, 0.9291766726924513, 0.9028516946785239, 0.8904742028304942, 0.8446924477248874, 0.7421579389802531, 0.900555151194177, 0.9497307850240607, 0.8775838527679315, 0.87064155933078, 0.9769370175745357, 0.8651292456600759, 0.9187579935960339, 0.8905252911951747, 0.9850507277451221, 0.9903755338561647, 0.6519144826310044, 0.9720816021418941, 0.888779100763687, 0.6834490111188429, 0.762362682227168, 0.9555863748671976, 0.9627544331752613, 0.9595659235121468, 0.9458493728162053, 0.9900109046092264, 0.9753282287199108, 0.8763274895375687, 0.9683328608122206, 0.9720887428469993, 0.7862423012723285, 0.9944190631514329, 0.7876305573454289, 0.9227710059999689, 0.9505405656937632, 0.8528355914472224, 0.9262036248384053, 0.9286804645128188, -1.0, 0.6890118996926221, 0.9437074086205097, 0.7587544988213133, 0.9179012883122782, 0.8542480069694586, 0.8820322239581229, 0.8264705404595322, 0.9956171955237731, 0.9722903664164967, 0.873427484480404, 0.9389141217728764, 0.9599194785144589, 0.7576430883758117, 0.9770292025312867, 0.9546444805546807, -1.0, 0.9395931635644221, 0.8695585845442038, 0.9510291335581184, 0.8956322867797267, 0.6762801652064836, 0.8693791524286899, 0.993847081415377, 0.9959493316244922, 0.9306328416798114, 0.920548019783683, 0.8329438782237546, 0.8448556582094386, -1.0, 0.840632245634543, 0.9805774445879483, 0.8971952150654869, 0.8709253431790659, 0.8035632801996277, 0.8092190300888398, 0.6051916299542389, 0.9054726644509353, 0.8948264898713755, 0.9370005271186695, 0.911762992673055, 0.9244966039484463, 0.9772311009032979, 0.9133117895083726, 0.8118730501500928, 0.838944516337546, 0.9375194207393861, 0.9589852895609322, 0.9447053467218467, 0.7290591349344318, 0.9008228367914897, 0.9753457914431989, 0.9368474623925915, 0.9643620199044894, 0.8468540488931965, 0.8327759455973416, 0.9268942373928074, 0.9210206803944943, 0.6413213237239963, 0.8605097945469088, 0.9700860526339911, 0.9949367510409781, 0.9855343874399624, 0.9903652021561444, 0.9518343235070017, 0.8425588570606205, 0.9409605690164478, 0.9390949931908029, 0.8978435509222502, 0.8953713481092034, 0.8632765319412438, 0.9955939564214054, 0.963585510379684, 0.9850033410699593, 0.9789647053519898, 0.8209861890786917, 0.9255277349423829, 0.712072338279424, 0.9052232279024146, 0.8844834268038104, 0.9853288124666705, 0.9654016318971276, 0.6485581455086513, 0.9492319388545701, 0.9989967307983803, 0.731841365451594, 0.9569100043093068, 0.8162518454720598, 0.9388108592993771, 0.648654079742331, 0.8104130082369796, 0.9867067675452702, 0.9532209988343303, 0.9671148173090206, 0.9797519046292662, 0.928324014058294, 0.9701677645064863, 0.8692635333437433, 0.9505503256260552, 0.9912538543993963, 0.8631935098961616, 0.8872901107465814, 0.9922692829432874, 0.9943198835483166, 0.9080290820823866, 0.9198574491749075, 0.9399725530567772, 0.9207622080959562, 0.8262001379091751, 0.8504080549120463, 0.6890826590860251, 0.86981559516932, 0.695933805466693, 0.94243861860797, 0.9174360269117441, -1.0, 0.930540705283173, -1.0, 0.8723460412645652, 0.9393659062476342, 0.9308446828818964, 0.755948594178924, 0.9403142690126727, 0.7083205806449228, 0.9036205874760276, 0.7878623546056843], "episode_lengths": [13, 28, 13, 13, 14, 14, 20, 15, 15, 21, 13, 14, 13, 29, 14, 14, 14, 14, 13, 14, 14, 16, 14, 13, 14, 20, 14, 20, 15, 14, 15, 15, 15, 46, 14, 15, 16, 13, 13, 22, 14, 14, 14, 19, 16, 16, 15, 11, 23, 13, 15, 18, 16, 13, 14, 14, 14, 15, 15, 26, 15, 22, 14, 15, 14, 13, 18, 13, 15, 13, 18, 13, 16, 13, 13, 14, 18, 13, 14, 14, 15, 13, 15, 13, 19, 13, 14, 15, 13, 15, 18, 16, 15, 13, 14, 14, 13, 19, 17, 24, 14, 13, 14, 13, 14, 14, 14, 17, 13, 15, 21, 14, 14, 26, 25, 14, 13, 13, 15, 13, 15, 14, 14, 13, 25, 14, 14, 14, 15, 16, 14, 13, 11, 25, 15, 23, 15, 14, 14, 18, 15, 13, 16, 15, 14, 21, 14, 14, 13, 13, 16, 14, 16, 16, 14, 14, 13, 15, 14, 15, 14, 11, 14, 14, 17, 15, 20, 16, 26, 13, 16, 14, 17, 15, 13, 13, 14, 14, 13, 14, 14, 14, 17, 14, 14, 14, 15, 19, 13, 15, 19, 13, 16, 14, 15, 14, 14, 16, 14, 14, 13, 14, 14, 16, 15, 13, 14, 14, 16, 18, 13, 13, 16, 14, 16, 14, 13, 14, 13, 16, 14, 14, 15, 15, 14, 14, 14, 13, 14, 14, 14, 13, 14, 13, 14, 13, 14, 14, 15, 13, 18, 14, 24, 14, 22, 13, 15, 80, 15, 10, 14, 17, 14, 14, 13, 18, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09762723522740999, "mean_inference_ms": 0.24394741196083908, "mean_action_processing_ms": 0.043979544431602055, "mean_env_wait_ms": 0.04726480667415179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015994375066239704, "StateBufferConnector_ms": 0.0012497569239416787, "ViewRequirementAgentConnector_ms": 0.02872629683147105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1080.6701472853867, "num_env_steps_trained_throughput_per_sec": 1080.6701472853867, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 3705.977, "sample_time_ms": 1785.827, "load_time_ms": 0.225, "load_throughput": 17804537.833, "learn_time_ms": 1918.916, "learn_throughput": 2084.511, "synch_weights_time_ms": 0.67}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 12263, "training_iteration": 87, "trial_id": "default", "date": "2024-05-22_22-20-16", "timestamp": 1716409216, "time_this_iter_s": 3.706033945083618, "time_total_s": 315.78707909584045, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 315.78707909584045, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 21.259999999999998, "ram_util_percent": 60.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.618686439080905, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03896780511156546, "policy_loss": -0.008352854572516936, "vf_loss": 0.045737435783119375, "vf_explained_var": 0.2496018547524688, "kl": 0.012509421989530384, "entropy": 0.5519645546713183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81375.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 0.9996225113998697, "episode_reward_min": -1.0, "episode_reward_mean": 0.8298569299111418, "episode_len_mean": 15.869047619047619, "episode_media": {}, "episodes_this_iter": 252, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9292331248947672, -1.0, 0.9416727556528016, 0.9289915440032659, 0.9114711560225635, 0.794222912791002, 0.8976904217397126, 0.7566624384485067, 0.8121196371810119, 0.9785395761041417, 0.9344993675792177, -1.0, 0.992455064314697, 0.8640359645198369, 0.9857394022904702, 0.7227503681947985, 0.6789396282663142, 0.6959945933500785, 0.9386880417179486, 0.984549994169482, 0.9517969116145186, 0.7531735408496241, 0.9090617579535665, 0.563069134764844, 0.9275073475658172, 0.9105579861855423, 0.9046606458169043, 0.9246216007630786, 0.9512347582264118, 0.6937419168869826, 0.8332681360760748, 0.863948253563174, 0.8513751894762562, 0.9711789474827418, 0.7509360679548517, 0.685385876606428, 0.9982961031984154, 0.9695349726811089, 0.8636161726584382, 0.9995587618168894, 0.9556755549116879, 0.9673756234890727, 0.9960693424817303, 0.8639061761340512, 0.9516640228432116, 0.9990302910735586, 0.8753860380934773, 0.8332793554072466, 0.6665091753158401, 0.9841671920235863, 0.9482078647454397, 0.9724668536367497, 0.9945215453353814, 0.9109344456467628, 0.7803300692810413, 0.9396237392413631, 0.9743584688462202, 0.9972663828669174, 0.9832996215187576, 0.7829792248848476, 0.9973396265894252, 0.9651461686959267, 0.9119397982130896, 0.9804671539423919, 0.8913649070793979, 0.851214874225001, -1.0, 0.7676825174254913, 0.9191574026584906, 0.9042507180296038, 0.9492684979577429, 0.8215272310241799, 0.7878899483180201, 0.9335388193272255, 0.928147244906657, 0.8287724253066452, 0.9697699632441581, 0.951805479226905, 0.9738707293436004, 0.9996225113998697, 0.9872740448943116, 0.9046926849297651, 0.9841258267905615, 0.7698065181760603, 0.9795676667013665, 0.9181070157060724, 0.9921690408808788, 0.8079822265929643, 0.9593228783985495, 0.726116206951689, 0.8655807054211393, 0.9992939921170022, 0.9872037001126367, 0.9384146073126447, 0.9704194097719824, 0.9722933877537074, 0.9214392056264545, 0.5, 0.6605670589041723, 0.970473267153842, 0.9460258032611926, 0.8979872841405642, 0.7632207234834318, 0.8997513694896059, 0.9188246843986153, 0.9843162864157939, 0.9551467118379598, 0.9854877944772591, 0.7883013564442363, 0.9705886992681643, 0.9267720957761457, 0.9968052401011349, 0.9627339775514522, 0.6564623392882134, 0.8785318544232333, 0.9801454762822656, 0.9275429677885744, 0.9419683831515666, 0.706407343531008, 0.7056884390059706, 0.9833590394754513, 0.8797378523927684, 0.9381005270180127, 0.6670987998094406, 0.9649132407144331, 0.826001701239581, 0.8974439470045834, 0.9985429036466392, 0.946467969721573, 0.5106484714076753, 0.8130262475109586, -1.0, 0.9662882046269459, 0.9596787953039776, 0.5, 0.9835004993163962, 0.8214381650970309, 0.9005766177784876, 0.9502043470346665, 0.9959795582028889, 0.9976286570648232, 0.8011686509705758, 0.9263834756736748, 0.9188822033542466, 0.9954162430324118, 0.9272054466472905, 0.5286917219127205, 0.8389524391692127, 0.8606877759645939, 0.713784137817689, 0.9403551725652722, 0.8677014229168507, 0.9730952670096671, 0.9881721149245062, 0.9472455191271115, 0.8994386422937029, 0.8705918510845608, 0.8706094641634754, 0.8947814871707375, 0.9899427458531681, 0.950309372998436, 0.6843203755869494, 0.9724217612778137, 0.9411173483313482, 0.8667962209766963, 0.5, 0.6346120176804557, 0.5, 0.689209144632952, -1.0, 0.9396964701405363, 0.6178203656822634, 0.8401306411973746, 0.9368288108376659, 0.8399118050863028, 0.9751697455207551, 0.8619347111597027, 0.946090764916511, 0.954631370274471, 0.8836044589719465, 0.8031089604176939, 0.9191495005493208, 0.5877818346750432, 0.9976818367839806, 0.9929727283430535, 0.823830204237628, 0.5, 0.9679554996625122, 0.7048369385900628, 0.875449860208457, 0.8482592404984073, 0.7890313276611067, 0.9538078828699446, 0.9820517041466841, 0.7471445054711925, 0.8826506324774976, 0.9888543218463663, 0.9512036860100624, 0.9759215201270889, 0.8630030677305875, 0.891988861571787, 0.9674155175928633, 0.9895661092174085, 0.9840968084491833, 0.8173548681334857, 0.8164685885219952, 0.9590081791012929, 0.7257952890941777, 0.9811188201484821, 0.7338363191606252, 0.889986665312132, 0.8473880325373174, 0.743581660658911, 0.865859548031562, 0.9322542424336562, 0.9742489405579704, 0.9302462014443313, 0.9266279714335595, 0.9829420364246374, 0.9982864157983946, 0.9667344760969762, 0.7612153770645127, 0.9517270831037903, 0.8821689672045615, 0.866824349988309, 0.8983438994616963, 0.9645640431038269, 0.8826769871735636, 0.7218060740069626, 0.8394354603633789, 0.7507952849179241, -1.0, 0.8417557222821606, 0.6891008843551731, 0.663008381653549, 0.6812617790569879, 0.5288695481529491, 0.6694654421349544, 0.9359823800180885, 0.9213102523565571, 0.9238882725340417, 0.9455285627414103, 0.7358924328186436, 0.9471455982871073, 0.9440483481730495, 0.9014334119468391, 0.937842926562512, 0.9370624944729274, 0.6489488146085438, 0.8762818081526732, 0.7255623864015817, 0.9399864968067757], "episode_lengths": [14, 20, 14, 14, 15, 13, 14, 15, 15, 13, 16, 11, 14, 15, 13, 15, 16, 16, 14, 13, 13, 15, 14, 18, 13, 13, 14, 13, 14, 18, 18, 14, 13, 14, 18, 27, 15, 15, 18, 15, 13, 16, 14, 14, 14, 14, 13, 14, 22, 14, 14, 13, 15, 13, 18, 14, 14, 13, 15, 14, 13, 16, 14, 13, 15, 14, 11, 13, 15, 16, 16, 14, 18, 15, 15, 18, 13, 15, 14, 13, 13, 14, 17, 15, 16, 14, 14, 20, 13, 19, 17, 15, 13, 16, 15, 13, 16, 16, 20, 15, 13, 15, 16, 14, 14, 13, 16, 16, 15, 15, 15, 13, 13, 27, 14, 15, 16, 15, 19, 21, 17, 13, 13, 23, 13, 15, 14, 16, 14, 15, 16, 18, 14, 14, 17, 16, 16, 13, 15, 14, 17, 24, 14, 13, 13, 17, 18, 16, 15, 17, 15, 18, 17, 14, 14, 13, 16, 14, 14, 14, 14, 18, 14, 13, 16, 16, 19, 16, 24, 57, 14, 20, 13, 15, 14, 14, 14, 15, 15, 22, 18, 14, 33, 14, 14, 16, 56, 17, 23, 14, 16, 15, 13, 13, 20, 14, 14, 16, 15, 13, 15, 14, 14, 13, 15, 16, 14, 20, 15, 18, 16, 16, 35, 14, 16, 13, 14, 15, 13, 15, 14, 28, 16, 16, 14, 14, 14, 14, 17, 14, 19, 12, 15, 20, 14, 20, 16, 16, 15, 14, 17, 14, 18, 14, 17, 14, 15, 14, 20, 14, 24, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09772063258693967, "mean_inference_ms": 0.24394241979943948, "mean_action_processing_ms": 0.04397855261549412, "mean_env_wait_ms": 0.04727013052505692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015606955876426092, "StateBufferConnector_ms": 0.0012196245647612073, "ViewRequirementAgentConnector_ms": 0.028550057184128536}}, "episode_reward_max": 0.9996225113998697, "episode_reward_min": -1.0, "episode_reward_mean": 0.8298569299111418, "episode_len_mean": 15.869047619047619, "episodes_this_iter": 252, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9292331248947672, -1.0, 0.9416727556528016, 0.9289915440032659, 0.9114711560225635, 0.794222912791002, 0.8976904217397126, 0.7566624384485067, 0.8121196371810119, 0.9785395761041417, 0.9344993675792177, -1.0, 0.992455064314697, 0.8640359645198369, 0.9857394022904702, 0.7227503681947985, 0.6789396282663142, 0.6959945933500785, 0.9386880417179486, 0.984549994169482, 0.9517969116145186, 0.7531735408496241, 0.9090617579535665, 0.563069134764844, 0.9275073475658172, 0.9105579861855423, 0.9046606458169043, 0.9246216007630786, 0.9512347582264118, 0.6937419168869826, 0.8332681360760748, 0.863948253563174, 0.8513751894762562, 0.9711789474827418, 0.7509360679548517, 0.685385876606428, 0.9982961031984154, 0.9695349726811089, 0.8636161726584382, 0.9995587618168894, 0.9556755549116879, 0.9673756234890727, 0.9960693424817303, 0.8639061761340512, 0.9516640228432116, 0.9990302910735586, 0.8753860380934773, 0.8332793554072466, 0.6665091753158401, 0.9841671920235863, 0.9482078647454397, 0.9724668536367497, 0.9945215453353814, 0.9109344456467628, 0.7803300692810413, 0.9396237392413631, 0.9743584688462202, 0.9972663828669174, 0.9832996215187576, 0.7829792248848476, 0.9973396265894252, 0.9651461686959267, 0.9119397982130896, 0.9804671539423919, 0.8913649070793979, 0.851214874225001, -1.0, 0.7676825174254913, 0.9191574026584906, 0.9042507180296038, 0.9492684979577429, 0.8215272310241799, 0.7878899483180201, 0.9335388193272255, 0.928147244906657, 0.8287724253066452, 0.9697699632441581, 0.951805479226905, 0.9738707293436004, 0.9996225113998697, 0.9872740448943116, 0.9046926849297651, 0.9841258267905615, 0.7698065181760603, 0.9795676667013665, 0.9181070157060724, 0.9921690408808788, 0.8079822265929643, 0.9593228783985495, 0.726116206951689, 0.8655807054211393, 0.9992939921170022, 0.9872037001126367, 0.9384146073126447, 0.9704194097719824, 0.9722933877537074, 0.9214392056264545, 0.5, 0.6605670589041723, 0.970473267153842, 0.9460258032611926, 0.8979872841405642, 0.7632207234834318, 0.8997513694896059, 0.9188246843986153, 0.9843162864157939, 0.9551467118379598, 0.9854877944772591, 0.7883013564442363, 0.9705886992681643, 0.9267720957761457, 0.9968052401011349, 0.9627339775514522, 0.6564623392882134, 0.8785318544232333, 0.9801454762822656, 0.9275429677885744, 0.9419683831515666, 0.706407343531008, 0.7056884390059706, 0.9833590394754513, 0.8797378523927684, 0.9381005270180127, 0.6670987998094406, 0.9649132407144331, 0.826001701239581, 0.8974439470045834, 0.9985429036466392, 0.946467969721573, 0.5106484714076753, 0.8130262475109586, -1.0, 0.9662882046269459, 0.9596787953039776, 0.5, 0.9835004993163962, 0.8214381650970309, 0.9005766177784876, 0.9502043470346665, 0.9959795582028889, 0.9976286570648232, 0.8011686509705758, 0.9263834756736748, 0.9188822033542466, 0.9954162430324118, 0.9272054466472905, 0.5286917219127205, 0.8389524391692127, 0.8606877759645939, 0.713784137817689, 0.9403551725652722, 0.8677014229168507, 0.9730952670096671, 0.9881721149245062, 0.9472455191271115, 0.8994386422937029, 0.8705918510845608, 0.8706094641634754, 0.8947814871707375, 0.9899427458531681, 0.950309372998436, 0.6843203755869494, 0.9724217612778137, 0.9411173483313482, 0.8667962209766963, 0.5, 0.6346120176804557, 0.5, 0.689209144632952, -1.0, 0.9396964701405363, 0.6178203656822634, 0.8401306411973746, 0.9368288108376659, 0.8399118050863028, 0.9751697455207551, 0.8619347111597027, 0.946090764916511, 0.954631370274471, 0.8836044589719465, 0.8031089604176939, 0.9191495005493208, 0.5877818346750432, 0.9976818367839806, 0.9929727283430535, 0.823830204237628, 0.5, 0.9679554996625122, 0.7048369385900628, 0.875449860208457, 0.8482592404984073, 0.7890313276611067, 0.9538078828699446, 0.9820517041466841, 0.7471445054711925, 0.8826506324774976, 0.9888543218463663, 0.9512036860100624, 0.9759215201270889, 0.8630030677305875, 0.891988861571787, 0.9674155175928633, 0.9895661092174085, 0.9840968084491833, 0.8173548681334857, 0.8164685885219952, 0.9590081791012929, 0.7257952890941777, 0.9811188201484821, 0.7338363191606252, 0.889986665312132, 0.8473880325373174, 0.743581660658911, 0.865859548031562, 0.9322542424336562, 0.9742489405579704, 0.9302462014443313, 0.9266279714335595, 0.9829420364246374, 0.9982864157983946, 0.9667344760969762, 0.7612153770645127, 0.9517270831037903, 0.8821689672045615, 0.866824349988309, 0.8983438994616963, 0.9645640431038269, 0.8826769871735636, 0.7218060740069626, 0.8394354603633789, 0.7507952849179241, -1.0, 0.8417557222821606, 0.6891008843551731, 0.663008381653549, 0.6812617790569879, 0.5288695481529491, 0.6694654421349544, 0.9359823800180885, 0.9213102523565571, 0.9238882725340417, 0.9455285627414103, 0.7358924328186436, 0.9471455982871073, 0.9440483481730495, 0.9014334119468391, 0.937842926562512, 0.9370624944729274, 0.6489488146085438, 0.8762818081526732, 0.7255623864015817, 0.9399864968067757], "episode_lengths": [14, 20, 14, 14, 15, 13, 14, 15, 15, 13, 16, 11, 14, 15, 13, 15, 16, 16, 14, 13, 13, 15, 14, 18, 13, 13, 14, 13, 14, 18, 18, 14, 13, 14, 18, 27, 15, 15, 18, 15, 13, 16, 14, 14, 14, 14, 13, 14, 22, 14, 14, 13, 15, 13, 18, 14, 14, 13, 15, 14, 13, 16, 14, 13, 15, 14, 11, 13, 15, 16, 16, 14, 18, 15, 15, 18, 13, 15, 14, 13, 13, 14, 17, 15, 16, 14, 14, 20, 13, 19, 17, 15, 13, 16, 15, 13, 16, 16, 20, 15, 13, 15, 16, 14, 14, 13, 16, 16, 15, 15, 15, 13, 13, 27, 14, 15, 16, 15, 19, 21, 17, 13, 13, 23, 13, 15, 14, 16, 14, 15, 16, 18, 14, 14, 17, 16, 16, 13, 15, 14, 17, 24, 14, 13, 13, 17, 18, 16, 15, 17, 15, 18, 17, 14, 14, 13, 16, 14, 14, 14, 14, 18, 14, 13, 16, 16, 19, 16, 24, 57, 14, 20, 13, 15, 14, 14, 14, 15, 15, 22, 18, 14, 33, 14, 14, 16, 56, 17, 23, 14, 16, 15, 13, 13, 20, 14, 14, 16, 15, 13, 15, 14, 14, 13, 15, 16, 14, 20, 15, 18, 16, 16, 35, 14, 16, 13, 14, 15, 13, 15, 14, 28, 16, 16, 14, 14, 14, 14, 17, 14, 19, 12, 15, 20, 14, 20, 16, 16, 15, 14, 17, 14, 18, 14, 17, 14, 15, 14, 20, 14, 24, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09772063258693967, "mean_inference_ms": 0.24394241979943948, "mean_action_processing_ms": 0.04397855261549412, "mean_env_wait_ms": 0.04727013052505692, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015606955876426092, "StateBufferConnector_ms": 0.0012196245647612073, "ViewRequirementAgentConnector_ms": 0.028550057184128536}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.0832910684376, "num_env_steps_trained_throughput_per_sec": 1098.0832910684376, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 3699.63, "sample_time_ms": 1785.922, "load_time_ms": 0.215, "load_throughput": 18633069.747, "learn_time_ms": 1912.491, "learn_throughput": 2091.513, "synch_weights_time_ms": 0.666}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 12515, "training_iteration": 88, "trial_id": "default", "date": "2024-05-22_22-20-20", "timestamp": 1716409220, "time_this_iter_s": 3.6474339962005615, "time_total_s": 319.434513092041, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 319.434513092041, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 19.466666666666665, "ram_util_percent": 60.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.008213960515556, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.041328027278625515, "policy_loss": -0.003988295748970041, "vf_loss": 0.043470078209910785, "vf_explained_var": 0.28095641751443184, "kl": 0.014587620663642626, "entropy": 0.42792990625865995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82305.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 0.9988013025022601, "episode_reward_min": -1.0, "episode_reward_mean": 0.8395049337990499, "episode_len_mean": 15.544747081712062, "episode_media": {}, "episodes_this_iter": 257, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.897957651579913, 0.7411495107364262, 0.9122511621010673, 0.9641225250124441, 0.7203583404545224, 0.9753721403939372, 0.924987622377201, 0.9398530780976561, 0.9904267735266149, 0.8665257656023372, 0.9217648585298078, 0.9161222662608454, 0.9528499042022902, 0.9336244555407489, 0.9268361821175677, 0.8703932648077346, 0.8923513517492503, 0.9877429877245599, 0.9648201535075587, 0.9262831532557616, 0.9322089497602724, 0.9771181492848621, 0.6988058657369125, 0.8810657272285017, 0.9691890423907376, -1.0, 0.8363108154755685, 0.9904501784305676, 0.7601040352362372, 0.8301143635019584, 0.9604943841465106, 0.9004818983541477, 0.948250883140567, 0.9374052829934877, 0.9250771566940118, 0.842686818010783, 0.9795832692024412, 0.7356023238762911, 0.9574109280539085, 0.9240176675174556, 0.6182788067108272, 0.8737844794870996, 0.9267358399277744, 0.8253622365405988, 0.9958931170072876, 0.9931397498418654, 0.9404172232176882, 0.8289561032974031, 0.9049281235635318, 0.6017221281652507, 0.7228256630132166, 0.944857321835763, 0.9545745924718935, 0.9639062606496981, 0.9243018256296998, 0.8990963940262082, 0.9600583803101271, 0.8530087455304136, 0.9257218223278912, 0.9572298938281124, 0.9789338961486056, 0.7498473253154689, 0.8358789545684844, 0.9708244368365563, 0.995367400323846, 0.9942086263944105, 0.6255238664396718, 0.6156279581406129, 0.8726842297821026, 0.7977169145760996, 0.9689497375764243, 0.9161252387821104, 0.80030223837923, 0.9208410962687688, 0.9666502296890761, 0.9155217395260739, 0.8309416032863685, 0.9778519551928941, 0.9953270101500824, 0.9393314809115316, 0.5, 0.942967800924631, 0.8784331484239756, 0.8016562793789545, 0.9484769837765135, 0.9828357660948954, -1.0, 0.9213719004068304, 0.8997460118255586, 0.9759146092339892, 0.8347961730710383, 0.7479259821149573, 0.8522266973661222, 0.6892840007883859, 0.9408034975640253, 0.7363689748115327, 0.9564595760163284, 0.6201289280242228, 0.9779613334433677, 0.9934221881457884, 0.9988013025022601, 0.8365117959299184, 0.961960648535231, 0.9398248392109677, 0.964792974485889, 0.98764170871003, 0.9026657340246513, 0.9129579621967036, 0.9964078507745988, 0.9148464701115742, 0.8273875408681359, 0.8088562600503937, 0.8934722661261582, 0.9840097558179398, 0.9531163498025532, 0.9806273131379782, 0.9137609383404159, 0.875637589546658, 0.996923024243288, 0.966220093928289, 0.7986070749378704, 0.9798105799085722, 0.9885743912370051, 0.8284276121360314, -1.0, 0.8841486595445486, 0.9827939134867608, 0.9800727008940483, 0.8162913983624371, 0.9914281708137442, 0.5, 0.9270897196587664, 0.8728352169429348, -1.0, 0.879492263220172, 0.7820692491984327, 0.9262784617224207, 0.9059231526953679, 0.951824812324807, -1.0, 0.9965640305995683, 0.7453050920576826, 0.8621331442407566, 0.8954556917023841, 0.9885870817922692, 0.9786602540894831, 0.9231113958291767, 0.936361122921683, 0.9245546667129877, 0.9680001307633476, 0.9892879443288655, 0.9155134010047937, 0.9432254842964157, 0.8569560584303554, 0.6825794932168208, 0.9407347003924673, 0.8462418882752775, 0.6420429732647333, 0.9695206004220623, 0.8595222206167293, 0.9939132828697236, -1.0, 0.923914196222423, 0.8826533909858032, 0.9625838433606423, 0.9426600126446781, 0.9335921710465043, 0.7050132645855449, 0.9862401315830995, 0.7696801526440886, 0.8238242753829748, 0.7988956124662112, 0.9350143428237664, 0.8432503969568892, 0.9041654167665536, 0.9757365490432438, 0.9893743217213571, 0.9766892869979007, 0.7980010132179247, 0.8754973650044806, 0.6015332917493939, 0.9858757146463674, 0.9761711644879852, 0.9496328075945601, 0.7761614118777114, 0.8892594894416843, 0.9776132266926104, 0.8425043762617869, 0.8056999733736656, 0.919397681954768, 0.9887229099207971, 0.8590179954238228, 0.8240347649436346, 0.6832856764762856, 0.9358885208290165, 0.9162304128576444, 0.9201765459877052, 0.9128263105279244, 0.9792939647898434, 0.9185902740345826, 0.9760852296355048, 0.9931107582536389, 0.8842933148525889, 0.939962262777766, 0.9984833295244515, 0.7765995742716465, 0.949714281024043, 0.5941671419309035, 0.8639717937235366, 0.994652914716545, 0.9227939388177524, 0.8798624696211056, 0.9353808262144073, 0.9191638844492929, 0.8843354557032951, 0.9974395108279484, 0.8466986759725973, 0.9600164708169463, 0.9151370135334832, 0.9070658783472528, 0.9167049921309535, 0.8542383911282567, 0.9002291761173059, 0.9641523418438711, 0.9761481441285366, 0.7010180071695147, 0.9772284373495118, 0.698683977488203, 0.9196569848877745, 0.7093375628102179, 0.715741438315517, 0.9968254756377549, 0.9104505711553772, 0.8021352447423901, 0.8358400622881641, 0.9168335043992439, 0.9853610719265691, 0.863295262704799, 0.9761045087819156, 0.9769103371173382, 0.9214232702657137, -1.0, 0.9875293802139745, 0.5883250402478079, 0.9369390813626122, 0.5915850894851808, 0.9761639871528633, 0.9897740066483229, 0.9851971195920234, 0.9889106729507955, 0.9271007881511355, 0.8872939486300856, 0.7623073120952844, 0.9653799052694956, 0.9198878909689955, 0.7502307266407194, 0.9836214552665133], "episode_lengths": [14, 15, 13, 14, 17, 14, 17, 15, 18, 14, 15, 17, 15, 16, 14, 15, 17, 13, 15, 14, 14, 13, 25, 15, 15, 11, 18, 15, 17, 14, 14, 14, 14, 16, 15, 15, 13, 15, 13, 13, 16, 15, 13, 13, 16, 13, 22, 16, 16, 16, 23, 13, 15, 14, 15, 15, 14, 16, 14, 14, 13, 16, 16, 14, 14, 15, 23, 16, 17, 14, 17, 13, 15, 17, 13, 14, 13, 17, 13, 14, 16, 14, 14, 16, 13, 13, 17, 14, 14, 14, 15, 15, 15, 30, 13, 13, 17, 19, 13, 15, 13, 14, 16, 16, 14, 15, 15, 14, 15, 15, 17, 15, 14, 15, 13, 14, 14, 14, 18, 13, 16, 13, 13, 18, 28, 13, 14, 13, 13, 13, 16, 14, 13, 34, 13, 34, 15, 13, 14, 22, 13, 21, 13, 13, 15, 13, 14, 13, 15, 14, 16, 13, 17, 16, 24, 14, 14, 20, 16, 17, 14, 14, 15, 16, 14, 14, 14, 17, 14, 53, 15, 13, 14, 17, 14, 15, 14, 14, 14, 14, 15, 15, 14, 14, 20, 14, 16, 15, 16, 15, 14, 15, 14, 29, 16, 17, 15, 14, 14, 13, 15, 17, 13, 15, 14, 15, 13, 17, 15, 14, 14, 13, 14, 14, 14, 13, 18, 13, 13, 16, 14, 14, 16, 15, 13, 16, 15, 16, 15, 23, 20, 15, 15, 19, 19, 14, 14, 19, 13, 15, 13, 12, 14, 21, 13, 23, 13, 14, 13, 13, 15, 14, 19, 15, 14, 31, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09781276492826645, "mean_inference_ms": 0.24392725168650917, "mean_action_processing_ms": 0.043976912704384155, "mean_env_wait_ms": 0.04727259829094698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015253222869991792, "StateBufferConnector_ms": 0.0012269743685592474, "ViewRequirementAgentConnector_ms": 0.02839398291324363}}, "episode_reward_max": 0.9988013025022601, "episode_reward_min": -1.0, "episode_reward_mean": 0.8395049337990499, "episode_len_mean": 15.544747081712062, "episodes_this_iter": 257, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.897957651579913, 0.7411495107364262, 0.9122511621010673, 0.9641225250124441, 0.7203583404545224, 0.9753721403939372, 0.924987622377201, 0.9398530780976561, 0.9904267735266149, 0.8665257656023372, 0.9217648585298078, 0.9161222662608454, 0.9528499042022902, 0.9336244555407489, 0.9268361821175677, 0.8703932648077346, 0.8923513517492503, 0.9877429877245599, 0.9648201535075587, 0.9262831532557616, 0.9322089497602724, 0.9771181492848621, 0.6988058657369125, 0.8810657272285017, 0.9691890423907376, -1.0, 0.8363108154755685, 0.9904501784305676, 0.7601040352362372, 0.8301143635019584, 0.9604943841465106, 0.9004818983541477, 0.948250883140567, 0.9374052829934877, 0.9250771566940118, 0.842686818010783, 0.9795832692024412, 0.7356023238762911, 0.9574109280539085, 0.9240176675174556, 0.6182788067108272, 0.8737844794870996, 0.9267358399277744, 0.8253622365405988, 0.9958931170072876, 0.9931397498418654, 0.9404172232176882, 0.8289561032974031, 0.9049281235635318, 0.6017221281652507, 0.7228256630132166, 0.944857321835763, 0.9545745924718935, 0.9639062606496981, 0.9243018256296998, 0.8990963940262082, 0.9600583803101271, 0.8530087455304136, 0.9257218223278912, 0.9572298938281124, 0.9789338961486056, 0.7498473253154689, 0.8358789545684844, 0.9708244368365563, 0.995367400323846, 0.9942086263944105, 0.6255238664396718, 0.6156279581406129, 0.8726842297821026, 0.7977169145760996, 0.9689497375764243, 0.9161252387821104, 0.80030223837923, 0.9208410962687688, 0.9666502296890761, 0.9155217395260739, 0.8309416032863685, 0.9778519551928941, 0.9953270101500824, 0.9393314809115316, 0.5, 0.942967800924631, 0.8784331484239756, 0.8016562793789545, 0.9484769837765135, 0.9828357660948954, -1.0, 0.9213719004068304, 0.8997460118255586, 0.9759146092339892, 0.8347961730710383, 0.7479259821149573, 0.8522266973661222, 0.6892840007883859, 0.9408034975640253, 0.7363689748115327, 0.9564595760163284, 0.6201289280242228, 0.9779613334433677, 0.9934221881457884, 0.9988013025022601, 0.8365117959299184, 0.961960648535231, 0.9398248392109677, 0.964792974485889, 0.98764170871003, 0.9026657340246513, 0.9129579621967036, 0.9964078507745988, 0.9148464701115742, 0.8273875408681359, 0.8088562600503937, 0.8934722661261582, 0.9840097558179398, 0.9531163498025532, 0.9806273131379782, 0.9137609383404159, 0.875637589546658, 0.996923024243288, 0.966220093928289, 0.7986070749378704, 0.9798105799085722, 0.9885743912370051, 0.8284276121360314, -1.0, 0.8841486595445486, 0.9827939134867608, 0.9800727008940483, 0.8162913983624371, 0.9914281708137442, 0.5, 0.9270897196587664, 0.8728352169429348, -1.0, 0.879492263220172, 0.7820692491984327, 0.9262784617224207, 0.9059231526953679, 0.951824812324807, -1.0, 0.9965640305995683, 0.7453050920576826, 0.8621331442407566, 0.8954556917023841, 0.9885870817922692, 0.9786602540894831, 0.9231113958291767, 0.936361122921683, 0.9245546667129877, 0.9680001307633476, 0.9892879443288655, 0.9155134010047937, 0.9432254842964157, 0.8569560584303554, 0.6825794932168208, 0.9407347003924673, 0.8462418882752775, 0.6420429732647333, 0.9695206004220623, 0.8595222206167293, 0.9939132828697236, -1.0, 0.923914196222423, 0.8826533909858032, 0.9625838433606423, 0.9426600126446781, 0.9335921710465043, 0.7050132645855449, 0.9862401315830995, 0.7696801526440886, 0.8238242753829748, 0.7988956124662112, 0.9350143428237664, 0.8432503969568892, 0.9041654167665536, 0.9757365490432438, 0.9893743217213571, 0.9766892869979007, 0.7980010132179247, 0.8754973650044806, 0.6015332917493939, 0.9858757146463674, 0.9761711644879852, 0.9496328075945601, 0.7761614118777114, 0.8892594894416843, 0.9776132266926104, 0.8425043762617869, 0.8056999733736656, 0.919397681954768, 0.9887229099207971, 0.8590179954238228, 0.8240347649436346, 0.6832856764762856, 0.9358885208290165, 0.9162304128576444, 0.9201765459877052, 0.9128263105279244, 0.9792939647898434, 0.9185902740345826, 0.9760852296355048, 0.9931107582536389, 0.8842933148525889, 0.939962262777766, 0.9984833295244515, 0.7765995742716465, 0.949714281024043, 0.5941671419309035, 0.8639717937235366, 0.994652914716545, 0.9227939388177524, 0.8798624696211056, 0.9353808262144073, 0.9191638844492929, 0.8843354557032951, 0.9974395108279484, 0.8466986759725973, 0.9600164708169463, 0.9151370135334832, 0.9070658783472528, 0.9167049921309535, 0.8542383911282567, 0.9002291761173059, 0.9641523418438711, 0.9761481441285366, 0.7010180071695147, 0.9772284373495118, 0.698683977488203, 0.9196569848877745, 0.7093375628102179, 0.715741438315517, 0.9968254756377549, 0.9104505711553772, 0.8021352447423901, 0.8358400622881641, 0.9168335043992439, 0.9853610719265691, 0.863295262704799, 0.9761045087819156, 0.9769103371173382, 0.9214232702657137, -1.0, 0.9875293802139745, 0.5883250402478079, 0.9369390813626122, 0.5915850894851808, 0.9761639871528633, 0.9897740066483229, 0.9851971195920234, 0.9889106729507955, 0.9271007881511355, 0.8872939486300856, 0.7623073120952844, 0.9653799052694956, 0.9198878909689955, 0.7502307266407194, 0.9836214552665133], "episode_lengths": [14, 15, 13, 14, 17, 14, 17, 15, 18, 14, 15, 17, 15, 16, 14, 15, 17, 13, 15, 14, 14, 13, 25, 15, 15, 11, 18, 15, 17, 14, 14, 14, 14, 16, 15, 15, 13, 15, 13, 13, 16, 15, 13, 13, 16, 13, 22, 16, 16, 16, 23, 13, 15, 14, 15, 15, 14, 16, 14, 14, 13, 16, 16, 14, 14, 15, 23, 16, 17, 14, 17, 13, 15, 17, 13, 14, 13, 17, 13, 14, 16, 14, 14, 16, 13, 13, 17, 14, 14, 14, 15, 15, 15, 30, 13, 13, 17, 19, 13, 15, 13, 14, 16, 16, 14, 15, 15, 14, 15, 15, 17, 15, 14, 15, 13, 14, 14, 14, 18, 13, 16, 13, 13, 18, 28, 13, 14, 13, 13, 13, 16, 14, 13, 34, 13, 34, 15, 13, 14, 22, 13, 21, 13, 13, 15, 13, 14, 13, 15, 14, 16, 13, 17, 16, 24, 14, 14, 20, 16, 17, 14, 14, 15, 16, 14, 14, 14, 17, 14, 53, 15, 13, 14, 17, 14, 15, 14, 14, 14, 14, 15, 15, 14, 14, 20, 14, 16, 15, 16, 15, 14, 15, 14, 29, 16, 17, 15, 14, 14, 13, 15, 17, 13, 15, 14, 15, 13, 17, 15, 14, 14, 13, 14, 14, 14, 13, 18, 13, 13, 16, 14, 14, 16, 15, 13, 16, 15, 16, 15, 23, 20, 15, 15, 19, 19, 14, 14, 19, 13, 15, 13, 12, 14, 21, 13, 23, 13, 14, 13, 13, 15, 14, 19, 15, 14, 31, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09781276492826645, "mean_inference_ms": 0.24392725168650917, "mean_action_processing_ms": 0.043976912704384155, "mean_env_wait_ms": 0.04727259829094698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015253222869991792, "StateBufferConnector_ms": 0.0012269743685592474, "ViewRequirementAgentConnector_ms": 0.02839398291324363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1097.4783311819494, "num_env_steps_trained_throughput_per_sec": 1097.4783311819494, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 3696.661, "sample_time_ms": 1785.495, "load_time_ms": 0.215, "load_throughput": 18624795.737, "learn_time_ms": 1909.938, "learn_throughput": 2094.308, "synch_weights_time_ms": 0.678}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 12772, "training_iteration": 89, "trial_id": "default", "date": "2024-05-22_22-20-23", "timestamp": 1716409223, "time_this_iter_s": 3.649393320083618, "time_total_s": 323.08390641212463, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 323.08390641212463, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 19.68, "ram_util_percent": 60.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.183604171872139, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03508147622310927, "policy_loss": -0.010281811228963315, "vf_loss": 0.0436314514934546, "vf_explained_var": 0.1827929526247004, "kl": 0.013683631430483274, "entropy": 0.4127502983776472, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83235.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 0.9999167614548647, "episode_reward_min": -1.0, "episode_reward_mean": 0.8314956249366443, "episode_len_mean": 15.640625, "episode_media": {}, "episodes_this_iter": 256, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9188751600695881, 0.8233877367884912, 0.8222579825399836, 0.9637953335308318, 0.9729157768213332, 0.9874690980771536, 0.9339338611968467, 0.8218398804892594, -1.0, 0.8105933097222431, 0.7037126232325588, 0.8652125356681426, 0.7550229083871517, 0.8935920022237164, 0.7863666536881254, 0.962218495287897, 0.8725699195888126, 0.9168799878771434, 0.9279286466567389, 0.9527847253314025, 0.8538594913555019, 0.9638088663863343, 0.9970967928385553, 0.8997455761090382, 0.7777083749547826, 0.9452274240369887, 0.77632696065195, 0.7923508875851875, 0.9516166057265913, 0.9153700052348726, 0.9173885835431254, 0.9674718069897913, 0.7412282394741613, 0.9680107308037109, 0.9231055079543018, 0.9711069228620463, 0.9632011931958344, -1.0, 0.9721021621060085, 0.8902683615498871, 0.8685854507865287, 0.9964188112472765, 0.7179489028448076, 0.8785257132975486, 0.8363758751126765, 0.9933578374205172, 0.5, 0.9913602239478371, 0.8824064972694041, 0.8249728174737121, 0.9628268575377106, 0.9767053019910987, 0.8982877758987533, 0.9876143364318907, 0.9834105742797185, 0.9551037982218029, 0.9524096382777505, 0.9216874847326869, 0.9122684679099705, 0.7069057159677389, 0.7398435401465713, 0.991861193515251, 0.9217164923720431, 0.6085639812179535, 0.9273484740086836, 0.9047942805286341, 0.8767082952106369, 0.8334323157486583, 0.9540998030397864, 0.9470840412849708, 0.9918609014615811, 0.9329491954418004, 0.994845277125274, 0.9441358499332799, 0.7652584109289651, 0.5494482292531555, 0.6647978385151525, 0.6243678335337044, 0.9997127652742224, 0.8346520316825821, 0.9079357752742635, 0.8964214945374687, 0.9856524184004173, 0.7994336454048163, 0.9503036520400618, 0.8645939740426194, 0.8977470824660727, 0.9229044086946505, 0.9834945878269261, 0.9075779104841781, 0.7795119141756763, 0.9878653295394791, 0.9369166886273528, 0.9973432855312087, 0.9855370525341025, -1.0, 0.8047237195955663, 0.8734739236348597, 0.8976508282579688, 0.9106500493412681, 0.9474935171966714, 0.911010503335831, 0.9545527579893267, 0.9848285728746611, 0.9291267822956433, 0.9702467563793908, 0.9019889443330744, 0.9143602735562764, 0.9088805544387527, 0.9229560751749832, 0.9807149559625019, 0.771449382623005, 0.9906640687016628, 0.536051266403784, 0.89784155716524, 0.9354840939660808, 0.9233289402536415, 0.9066323063356447, 0.9228834930659485, 0.5, 0.7485199600423558, 0.831335062873219, 0.9651892043630375, 0.943307239931885, 0.968683855417789, -1.0, 0.9491794154069645, 0.8766184183323372, 0.9069853332699338, 0.8992806029321296, 0.8556908627337776, 0.8929313444875739, 0.9314977179423001, 0.904052696331484, 0.9227652545340272, 0.9988748954051403, 0.6429509936747488, 0.8506811635986566, 0.728162957182656, 0.9323460498053702, 0.8751808004247784, 0.754083388914414, 0.9600743550394218, 0.7334039807937485, 0.9536253108737724, 0.9204265569587011, 0.889359070726861, 0.9598998477258225, -1.0, 0.7460973363554174, 0.9212437666381335, 0.992601635699626, 0.8822635337652189, 0.9973314640704235, 0.9557363610668237, 0.9054210826169596, 0.7305624283187112, 0.5, 0.8913547243146002, 0.9140579788870002, 0.9068567641751711, 0.9176088935137131, 0.935152620737924, 0.6889056803859728, 0.8468107909906184, 0.9731432602507262, 0.8510189906050452, 0.9854719254252902, -1.0, 0.9762270777018702, 0.8425243536980768, 0.6827076385025678, 0.7125706847901669, 0.7059477361250752, 0.9064559478522117, 0.9735057053451766, 0.8564857134556519, 0.963315430583096, 0.9752499271525983, 0.9959387322536658, -1.0, 0.5, 0.8147045760334687, 0.9029288527483792, 0.816770684569871, 0.9148763584775766, 0.9156487478346853, 0.8831722682894652, 0.9749049981824525, 0.9427815745110276, 0.7942556171999408, 0.7687409226362885, 0.8858629617626699, 0.969928395699538, 0.8499381693432185, 0.9081930198111009, 0.7927770290443474, 0.7284559728422896, 0.9916351502979096, 0.987287809945573, 0.9888342631522221, 0.8261839651272646, 0.9529300443906821, 0.977991585130615, 0.7965131224287513, 0.9409485339201935, 0.7505317452033256, 0.7674833318546683, 0.8765173672659036, 0.8786832137201241, 0.8657149208151145, 0.9048716510172203, 0.7757797873262176, 0.6608103040624156, 0.7238926727426787, 0.9010882191751782, 0.8556774528134672, 0.8988293382911584, 0.9187219752400717, 0.8841787495580317, 0.9752829545296582, 0.8755235798350277, 0.9275288086927096, 0.9211945797357701, 0.9589232439543921, 0.9969764398253012, 0.9378622041323998, 0.9777854293126588, 0.9422974839582632, 0.8758955433661917, 0.9408411105110721, 0.9448084861144669, 0.8838511524342796, 0.8878015561198914, 0.9438386701310783, 0.9856081011748974, 0.9734310158825479, 0.9611033502324007, 0.9162697326780607, 0.8947062659352962, 0.9085000057743162, 0.9860472872807982, 0.8670713082670687, 0.9744064367864689, 0.9177916464641643, 0.9999167614548647, 0.8451336508284004, 0.8178895015579071, 0.9984307510516202, 0.9339249773397923, 0.6487152870347211, 0.9371162073884263, 0.9016871292294684, 0.7766564530035757, 0.6783077537462713, 0.8997987366816598], "episode_lengths": [14, 20, 18, 14, 14, 14, 16, 15, 44, 17, 16, 14, 14, 17, 17, 15, 17, 13, 14, 14, 20, 16, 14, 15, 17, 15, 15, 20, 13, 13, 13, 17, 17, 15, 13, 13, 16, 12, 14, 14, 14, 14, 21, 17, 18, 14, 17, 14, 14, 13, 13, 13, 13, 15, 15, 13, 14, 31, 15, 26, 14, 13, 14, 15, 15, 14, 19, 15, 13, 16, 15, 13, 15, 13, 16, 21, 19, 17, 13, 17, 14, 15, 14, 17, 15, 14, 16, 16, 14, 13, 15, 14, 14, 15, 14, 50, 19, 19, 14, 13, 14, 13, 14, 14, 17, 13, 14, 13, 13, 14, 15, 16, 14, 44, 16, 14, 13, 16, 13, 16, 15, 15, 14, 13, 15, 10, 13, 13, 14, 13, 16, 16, 20, 13, 14, 13, 21, 16, 20, 13, 13, 20, 13, 16, 14, 14, 14, 14, 13, 16, 14, 13, 16, 14, 14, 14, 17, 58, 16, 14, 14, 14, 13, 17, 14, 14, 13, 14, 12, 14, 17, 16, 19, 42, 14, 14, 14, 15, 13, 15, 11, 17, 15, 14, 14, 13, 13, 16, 16, 16, 19, 16, 14, 13, 18, 15, 18, 18, 13, 13, 13, 13, 13, 13, 14, 14, 19, 17, 14, 17, 13, 15, 17, 17, 22, 14, 14, 14, 13, 13, 14, 13, 16, 13, 15, 14, 13, 14, 14, 17, 14, 14, 14, 14, 15, 16, 14, 15, 13, 14, 15, 14, 15, 14, 14, 16, 16, 13, 14, 14, 20, 14, 14, 17, 21, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09791943119376106, "mean_inference_ms": 0.24396030356905388, "mean_action_processing_ms": 0.043984035331398046, "mean_env_wait_ms": 0.0472883036788826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015945173799991608, "StateBufferConnector_ms": 0.0012452714145183563, "ViewRequirementAgentConnector_ms": 0.02892250195145607}}, "episode_reward_max": 0.9999167614548647, "episode_reward_min": -1.0, "episode_reward_mean": 0.8314956249366443, "episode_len_mean": 15.640625, "episodes_this_iter": 256, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9188751600695881, 0.8233877367884912, 0.8222579825399836, 0.9637953335308318, 0.9729157768213332, 0.9874690980771536, 0.9339338611968467, 0.8218398804892594, -1.0, 0.8105933097222431, 0.7037126232325588, 0.8652125356681426, 0.7550229083871517, 0.8935920022237164, 0.7863666536881254, 0.962218495287897, 0.8725699195888126, 0.9168799878771434, 0.9279286466567389, 0.9527847253314025, 0.8538594913555019, 0.9638088663863343, 0.9970967928385553, 0.8997455761090382, 0.7777083749547826, 0.9452274240369887, 0.77632696065195, 0.7923508875851875, 0.9516166057265913, 0.9153700052348726, 0.9173885835431254, 0.9674718069897913, 0.7412282394741613, 0.9680107308037109, 0.9231055079543018, 0.9711069228620463, 0.9632011931958344, -1.0, 0.9721021621060085, 0.8902683615498871, 0.8685854507865287, 0.9964188112472765, 0.7179489028448076, 0.8785257132975486, 0.8363758751126765, 0.9933578374205172, 0.5, 0.9913602239478371, 0.8824064972694041, 0.8249728174737121, 0.9628268575377106, 0.9767053019910987, 0.8982877758987533, 0.9876143364318907, 0.9834105742797185, 0.9551037982218029, 0.9524096382777505, 0.9216874847326869, 0.9122684679099705, 0.7069057159677389, 0.7398435401465713, 0.991861193515251, 0.9217164923720431, 0.6085639812179535, 0.9273484740086836, 0.9047942805286341, 0.8767082952106369, 0.8334323157486583, 0.9540998030397864, 0.9470840412849708, 0.9918609014615811, 0.9329491954418004, 0.994845277125274, 0.9441358499332799, 0.7652584109289651, 0.5494482292531555, 0.6647978385151525, 0.6243678335337044, 0.9997127652742224, 0.8346520316825821, 0.9079357752742635, 0.8964214945374687, 0.9856524184004173, 0.7994336454048163, 0.9503036520400618, 0.8645939740426194, 0.8977470824660727, 0.9229044086946505, 0.9834945878269261, 0.9075779104841781, 0.7795119141756763, 0.9878653295394791, 0.9369166886273528, 0.9973432855312087, 0.9855370525341025, -1.0, 0.8047237195955663, 0.8734739236348597, 0.8976508282579688, 0.9106500493412681, 0.9474935171966714, 0.911010503335831, 0.9545527579893267, 0.9848285728746611, 0.9291267822956433, 0.9702467563793908, 0.9019889443330744, 0.9143602735562764, 0.9088805544387527, 0.9229560751749832, 0.9807149559625019, 0.771449382623005, 0.9906640687016628, 0.536051266403784, 0.89784155716524, 0.9354840939660808, 0.9233289402536415, 0.9066323063356447, 0.9228834930659485, 0.5, 0.7485199600423558, 0.831335062873219, 0.9651892043630375, 0.943307239931885, 0.968683855417789, -1.0, 0.9491794154069645, 0.8766184183323372, 0.9069853332699338, 0.8992806029321296, 0.8556908627337776, 0.8929313444875739, 0.9314977179423001, 0.904052696331484, 0.9227652545340272, 0.9988748954051403, 0.6429509936747488, 0.8506811635986566, 0.728162957182656, 0.9323460498053702, 0.8751808004247784, 0.754083388914414, 0.9600743550394218, 0.7334039807937485, 0.9536253108737724, 0.9204265569587011, 0.889359070726861, 0.9598998477258225, -1.0, 0.7460973363554174, 0.9212437666381335, 0.992601635699626, 0.8822635337652189, 0.9973314640704235, 0.9557363610668237, 0.9054210826169596, 0.7305624283187112, 0.5, 0.8913547243146002, 0.9140579788870002, 0.9068567641751711, 0.9176088935137131, 0.935152620737924, 0.6889056803859728, 0.8468107909906184, 0.9731432602507262, 0.8510189906050452, 0.9854719254252902, -1.0, 0.9762270777018702, 0.8425243536980768, 0.6827076385025678, 0.7125706847901669, 0.7059477361250752, 0.9064559478522117, 0.9735057053451766, 0.8564857134556519, 0.963315430583096, 0.9752499271525983, 0.9959387322536658, -1.0, 0.5, 0.8147045760334687, 0.9029288527483792, 0.816770684569871, 0.9148763584775766, 0.9156487478346853, 0.8831722682894652, 0.9749049981824525, 0.9427815745110276, 0.7942556171999408, 0.7687409226362885, 0.8858629617626699, 0.969928395699538, 0.8499381693432185, 0.9081930198111009, 0.7927770290443474, 0.7284559728422896, 0.9916351502979096, 0.987287809945573, 0.9888342631522221, 0.8261839651272646, 0.9529300443906821, 0.977991585130615, 0.7965131224287513, 0.9409485339201935, 0.7505317452033256, 0.7674833318546683, 0.8765173672659036, 0.8786832137201241, 0.8657149208151145, 0.9048716510172203, 0.7757797873262176, 0.6608103040624156, 0.7238926727426787, 0.9010882191751782, 0.8556774528134672, 0.8988293382911584, 0.9187219752400717, 0.8841787495580317, 0.9752829545296582, 0.8755235798350277, 0.9275288086927096, 0.9211945797357701, 0.9589232439543921, 0.9969764398253012, 0.9378622041323998, 0.9777854293126588, 0.9422974839582632, 0.8758955433661917, 0.9408411105110721, 0.9448084861144669, 0.8838511524342796, 0.8878015561198914, 0.9438386701310783, 0.9856081011748974, 0.9734310158825479, 0.9611033502324007, 0.9162697326780607, 0.8947062659352962, 0.9085000057743162, 0.9860472872807982, 0.8670713082670687, 0.9744064367864689, 0.9177916464641643, 0.9999167614548647, 0.8451336508284004, 0.8178895015579071, 0.9984307510516202, 0.9339249773397923, 0.6487152870347211, 0.9371162073884263, 0.9016871292294684, 0.7766564530035757, 0.6783077537462713, 0.8997987366816598], "episode_lengths": [14, 20, 18, 14, 14, 14, 16, 15, 44, 17, 16, 14, 14, 17, 17, 15, 17, 13, 14, 14, 20, 16, 14, 15, 17, 15, 15, 20, 13, 13, 13, 17, 17, 15, 13, 13, 16, 12, 14, 14, 14, 14, 21, 17, 18, 14, 17, 14, 14, 13, 13, 13, 13, 15, 15, 13, 14, 31, 15, 26, 14, 13, 14, 15, 15, 14, 19, 15, 13, 16, 15, 13, 15, 13, 16, 21, 19, 17, 13, 17, 14, 15, 14, 17, 15, 14, 16, 16, 14, 13, 15, 14, 14, 15, 14, 50, 19, 19, 14, 13, 14, 13, 14, 14, 17, 13, 14, 13, 13, 14, 15, 16, 14, 44, 16, 14, 13, 16, 13, 16, 15, 15, 14, 13, 15, 10, 13, 13, 14, 13, 16, 16, 20, 13, 14, 13, 21, 16, 20, 13, 13, 20, 13, 16, 14, 14, 14, 14, 13, 16, 14, 13, 16, 14, 14, 14, 17, 58, 16, 14, 14, 14, 13, 17, 14, 14, 13, 14, 12, 14, 17, 16, 19, 42, 14, 14, 14, 15, 13, 15, 11, 17, 15, 14, 14, 13, 13, 16, 16, 16, 19, 16, 14, 13, 18, 15, 18, 18, 13, 13, 13, 13, 13, 13, 14, 14, 19, 17, 14, 17, 13, 15, 17, 17, 22, 14, 14, 14, 13, 13, 14, 13, 16, 13, 15, 14, 13, 14, 14, 17, 14, 14, 14, 14, 15, 16, 14, 15, 13, 14, 15, 14, 15, 14, 14, 16, 16, 13, 14, 14, 20, 14, 14, 17, 21, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09791943119376106, "mean_inference_ms": 0.24396030356905388, "mean_action_processing_ms": 0.043984035331398046, "mean_env_wait_ms": 0.0472883036788826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015945173799991608, "StateBufferConnector_ms": 0.0012452714145183563, "ViewRequirementAgentConnector_ms": 0.02892250195145607}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1033.48785246983, "num_env_steps_trained_throughput_per_sec": 1033.48785246983, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3694.203, "sample_time_ms": 1787.628, "load_time_ms": 0.216, "load_throughput": 18493403.88, "learn_time_ms": 1904.268, "learn_throughput": 2100.544, "synch_weights_time_ms": 1.706}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 13028, "training_iteration": 90, "trial_id": "default", "date": "2024-05-22_22-20-27", "timestamp": 1716409227, "time_this_iter_s": 3.8810179233551025, "time_total_s": 326.96492433547974, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 326.96492433547974, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 21.54, "ram_util_percent": 61.279999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7973870144095474, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.026002848800522105, "policy_loss": -0.010432467277922857, "vf_loss": 0.03455290833252773, "vf_explained_var": 0.2559954454821925, "kl": 0.014873346969969389, "entropy": 0.5012704180132959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84165.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 0.9995626498999721, "episode_reward_min": -1.0, "episode_reward_mean": 0.8300478453042323, "episode_len_mean": 15.248091603053435, "episode_media": {}, "episodes_this_iter": 262, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8227409788355015, 0.9416947908571096, 0.8603571258768823, 0.9402190012027869, 0.8149033013190623, 0.9935320364129565, 0.9021435631431503, 0.8757578360783048, 0.9661323633151755, 0.8562032397419691, 0.9748580833196966, 0.9747844605940125, 0.9917923063851283, 0.8224815805360988, 0.8481728295546205, 0.5367124354973927, 0.9379113957758438, 0.9885125966779263, 0.8488284722267375, 0.9364528736844511, 0.9403264559826897, 0.9600033985272003, 0.8571425792661975, 0.9264143418776365, 0.8291860297657456, 0.8625919058176382, 0.744471915892273, 0.9730588713048016, 0.8570822011808574, 0.864884747997628, 0.9834726583328371, 0.9902172736266643, 0.9812694013293058, 0.8152110868726945, 0.9484010612878746, 0.9630555970121495, 0.9991686363933974, 0.8227312534131538, 0.9480329402321294, 0.8590618403659253, 0.9994846826728425, 0.986479321209307, -1.0, 0.8813501900118745, 0.9281157063181389, 0.6749719368991349, 0.8808514016579867, 0.9995626498999721, 0.9516825996207556, 0.9842001698531413, 0.9926021013216414, 0.8649484961208953, 0.9752446960386875, 0.986292396997808, 0.9545619029971536, 0.9219237794904513, 0.8926373635362945, 0.9037621354366483, 0.9911392116626297, 0.9738437553729784, 0.9968340830918794, 0.6974490192031941, 0.6479096231903858, 0.9231679176087859, 0.9008252233508953, 0.7624418494586809, 0.6700873611437534, 0.9647635279881972, 0.962248376257892, 0.6702792187317332, 0.8486132343894374, 0.9358260719598622, 0.7473645271305804, 0.9787492461407192, 0.9209014798948544, 0.961111625008107, 0.9617132120248123, 0.8633489399907522, 0.9703709405210976, 0.8868819664116447, 0.9647767514146677, 0.8831820666236502, 0.9765611780513297, 0.9613334134873827, 0.9205023656354328, 0.9605145697406272, 0.9103801124599434, 0.9597724572741301, 0.9900208583937878, 0.5, 0.960747558995332, 0.9892518050864018, 0.5848120424359978, 0.5, 0.9925222277907776, 0.9659568617070721, 0.9476844006383118, 0.8088386136328765, 0.832922272217943, 0.9161983373426649, -1.0, 0.9611232553994046, 0.8432190503491636, 0.9229959525727971, 0.9627961077531209, 0.9470982994493028, 0.9183297824635139, 0.8608460827866852, 0.9087581406016277, 0.9284308506508402, 0.9029338083507172, 0.9800808841160925, 0.9442128061962766, 0.9524499662533975, 0.8232680434687505, 0.8814625446006031, 0.9544961836030657, 0.946368304412657, 0.9251227941215495, 0.939170611673744, 0.8931594902598171, 0.8588097277218149, 0.9009959781565344, 0.8004935599256419, 0.9139509485341948, 0.5727554008255973, 0.9554492476770061, 0.9881213563172772, 0.5701847167991132, 0.8907686145572212, 0.7972947026815929, 0.8963497618782952, 0.8969870245163558, 0.9991504846702643, 0.8035132293578173, 0.9861696771109824, 0.9107783263740482, 0.9198402206708043, 0.8250171714815412, 0.9229078656118341, 0.8913436435464918, 0.5, 0.9885018636723072, -1.0, 0.9792747625736375, 0.9641326484440833, 0.6128863847880679, 0.9843270478514665, 0.982168246074498, 0.5, 0.8978431867189862, 0.9313586031363524, 0.9705964496653503, 0.9878511388329626, 0.9327615018561005, 0.7435641584954421, 0.8404735918994144, -1.0, 0.9850284145150638, 0.9056762597600427, 0.8386287139297849, 0.9054341025686709, 0.9575127601765987, 0.5604689166255856, 0.9323491499679746, 0.9694467413764595, 0.9811814257921213, 0.9464249321248328, 0.9395033783450796, 0.9435791081446447, 0.9614798618416829, 0.9647652829238589, 0.7435652747673694, 0.928043948347649, 0.8752149391898546, 0.9920855445549107, 0.9956015054366193, 0.9974816388169782, 0.8932969328658716, 0.971278902491788, 0.7229359781112012, 0.9882384357865672, -1.0, 0.9383245105555993, 0.8662219212365995, 0.9775156070494826, 0.9993034145093177, 0.9187928664068479, -1.0, 0.9677601666986336, 0.963616590419354, 0.7557049904306656, 0.7417520976081637, 0.9203264137054317, 0.9977831068009886, -1.0, 0.9276015969020023, 0.9750585603375557, 0.9987677299408738, 0.8818299957279486, 0.9456686210608151, 0.9488647887891354, 0.9741407053627904, 0.9913409589232952, 0.9961187349383285, 0.6871789871392681, 0.9475896046708986, 0.9308642749092465, 0.595856156842256, 0.5542083547916234, -1.0, 0.8402500425197483, 0.9905749085251188, 0.9819663388806226, 0.9539354516933578, 0.9566689980900078, 0.9394236702297972, 0.8687656951184655, 0.9637278528492964, 0.9168496655420584, -1.0, 0.9797527532280533, 0.986584684856181, 0.9962923908316864, 0.8794294399826157, 0.9922583162582961, 0.9291772512639287, 0.9070120395576134, 0.9846187739981512, 0.9560052532320125, 0.7651188366016651, 0.9589324009522431, 0.5914180745908906, 0.8547900788648198, 0.9479613842641695, 0.9024847779957885, 0.9337226337423181, 0.7825344877004781, 0.9400906962102116, 0.8949449672975849, 0.7974501145140357, 0.903800561930673, 0.930712625823603, 0.9741304067178987, 0.8893905416921722, 0.9140695297223478, 0.9626705172033282, 0.6599298751357904, 0.9986424555834305, 0.9870499175280043, 0.944182322259737, 0.9754588005993189, 0.8257317248949605, 0.8698845861780478, 0.8612986868831259, 0.6988730136198107, 0.771357915540011, 0.9460207020471758, 0.8817984421197229, 0.8984864819030243, 0.9470089531066781, 0.9244430230466655], "episode_lengths": [19, 13, 15, 14, 14, 14, 13, 17, 16, 13, 14, 13, 16, 13, 14, 17, 14, 14, 15, 14, 16, 15, 14, 15, 16, 15, 15, 14, 14, 15, 14, 13, 14, 15, 14, 15, 13, 14, 15, 14, 15, 13, 11, 16, 13, 19, 14, 14, 13, 13, 14, 14, 13, 15, 18, 13, 13, 15, 13, 15, 16, 22, 16, 16, 14, 20, 16, 13, 14, 19, 15, 13, 16, 13, 14, 13, 16, 13, 15, 14, 15, 14, 15, 13, 16, 14, 14, 15, 13, 17, 14, 16, 17, 16, 13, 15, 14, 16, 15, 14, 19, 15, 14, 13, 15, 14, 14, 16, 14, 15, 16, 15, 14, 13, 15, 14, 14, 14, 15, 14, 14, 14, 15, 21, 14, 16, 14, 14, 15, 16, 20, 14, 18, 13, 14, 14, 14, 14, 23, 16, 15, 17, 15, 49, 13, 15, 21, 15, 13, 17, 14, 15, 14, 15, 13, 18, 17, 80, 15, 16, 15, 17, 13, 19, 14, 13, 13, 13, 15, 13, 14, 15, 18, 14, 13, 15, 14, 13, 13, 14, 15, 15, 11, 14, 16, 14, 13, 14, 11, 13, 15, 16, 17, 14, 13, 11, 16, 14, 14, 13, 14, 14, 13, 16, 14, 19, 16, 13, 16, 15, 18, 14, 13, 14, 15, 14, 13, 15, 14, 15, 11, 15, 13, 17, 14, 14, 14, 14, 14, 14, 17, 14, 20, 14, 15, 15, 14, 16, 15, 14, 19, 15, 16, 15, 19, 14, 14, 30, 13, 13, 14, 15, 19, 15, 14, 16, 24, 15, 14, 14, 14, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09805595791176355, "mean_inference_ms": 0.2442858988051084, "mean_action_processing_ms": 0.04400078375741457, "mean_env_wait_ms": 0.04731538567234436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015948564951656428, "StateBufferConnector_ms": 0.0012952862805082597, "ViewRequirementAgentConnector_ms": 0.029481640298857945}}, "episode_reward_max": 0.9995626498999721, "episode_reward_min": -1.0, "episode_reward_mean": 0.8300478453042323, "episode_len_mean": 15.248091603053435, "episodes_this_iter": 262, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8227409788355015, 0.9416947908571096, 0.8603571258768823, 0.9402190012027869, 0.8149033013190623, 0.9935320364129565, 0.9021435631431503, 0.8757578360783048, 0.9661323633151755, 0.8562032397419691, 0.9748580833196966, 0.9747844605940125, 0.9917923063851283, 0.8224815805360988, 0.8481728295546205, 0.5367124354973927, 0.9379113957758438, 0.9885125966779263, 0.8488284722267375, 0.9364528736844511, 0.9403264559826897, 0.9600033985272003, 0.8571425792661975, 0.9264143418776365, 0.8291860297657456, 0.8625919058176382, 0.744471915892273, 0.9730588713048016, 0.8570822011808574, 0.864884747997628, 0.9834726583328371, 0.9902172736266643, 0.9812694013293058, 0.8152110868726945, 0.9484010612878746, 0.9630555970121495, 0.9991686363933974, 0.8227312534131538, 0.9480329402321294, 0.8590618403659253, 0.9994846826728425, 0.986479321209307, -1.0, 0.8813501900118745, 0.9281157063181389, 0.6749719368991349, 0.8808514016579867, 0.9995626498999721, 0.9516825996207556, 0.9842001698531413, 0.9926021013216414, 0.8649484961208953, 0.9752446960386875, 0.986292396997808, 0.9545619029971536, 0.9219237794904513, 0.8926373635362945, 0.9037621354366483, 0.9911392116626297, 0.9738437553729784, 0.9968340830918794, 0.6974490192031941, 0.6479096231903858, 0.9231679176087859, 0.9008252233508953, 0.7624418494586809, 0.6700873611437534, 0.9647635279881972, 0.962248376257892, 0.6702792187317332, 0.8486132343894374, 0.9358260719598622, 0.7473645271305804, 0.9787492461407192, 0.9209014798948544, 0.961111625008107, 0.9617132120248123, 0.8633489399907522, 0.9703709405210976, 0.8868819664116447, 0.9647767514146677, 0.8831820666236502, 0.9765611780513297, 0.9613334134873827, 0.9205023656354328, 0.9605145697406272, 0.9103801124599434, 0.9597724572741301, 0.9900208583937878, 0.5, 0.960747558995332, 0.9892518050864018, 0.5848120424359978, 0.5, 0.9925222277907776, 0.9659568617070721, 0.9476844006383118, 0.8088386136328765, 0.832922272217943, 0.9161983373426649, -1.0, 0.9611232553994046, 0.8432190503491636, 0.9229959525727971, 0.9627961077531209, 0.9470982994493028, 0.9183297824635139, 0.8608460827866852, 0.9087581406016277, 0.9284308506508402, 0.9029338083507172, 0.9800808841160925, 0.9442128061962766, 0.9524499662533975, 0.8232680434687505, 0.8814625446006031, 0.9544961836030657, 0.946368304412657, 0.9251227941215495, 0.939170611673744, 0.8931594902598171, 0.8588097277218149, 0.9009959781565344, 0.8004935599256419, 0.9139509485341948, 0.5727554008255973, 0.9554492476770061, 0.9881213563172772, 0.5701847167991132, 0.8907686145572212, 0.7972947026815929, 0.8963497618782952, 0.8969870245163558, 0.9991504846702643, 0.8035132293578173, 0.9861696771109824, 0.9107783263740482, 0.9198402206708043, 0.8250171714815412, 0.9229078656118341, 0.8913436435464918, 0.5, 0.9885018636723072, -1.0, 0.9792747625736375, 0.9641326484440833, 0.6128863847880679, 0.9843270478514665, 0.982168246074498, 0.5, 0.8978431867189862, 0.9313586031363524, 0.9705964496653503, 0.9878511388329626, 0.9327615018561005, 0.7435641584954421, 0.8404735918994144, -1.0, 0.9850284145150638, 0.9056762597600427, 0.8386287139297849, 0.9054341025686709, 0.9575127601765987, 0.5604689166255856, 0.9323491499679746, 0.9694467413764595, 0.9811814257921213, 0.9464249321248328, 0.9395033783450796, 0.9435791081446447, 0.9614798618416829, 0.9647652829238589, 0.7435652747673694, 0.928043948347649, 0.8752149391898546, 0.9920855445549107, 0.9956015054366193, 0.9974816388169782, 0.8932969328658716, 0.971278902491788, 0.7229359781112012, 0.9882384357865672, -1.0, 0.9383245105555993, 0.8662219212365995, 0.9775156070494826, 0.9993034145093177, 0.9187928664068479, -1.0, 0.9677601666986336, 0.963616590419354, 0.7557049904306656, 0.7417520976081637, 0.9203264137054317, 0.9977831068009886, -1.0, 0.9276015969020023, 0.9750585603375557, 0.9987677299408738, 0.8818299957279486, 0.9456686210608151, 0.9488647887891354, 0.9741407053627904, 0.9913409589232952, 0.9961187349383285, 0.6871789871392681, 0.9475896046708986, 0.9308642749092465, 0.595856156842256, 0.5542083547916234, -1.0, 0.8402500425197483, 0.9905749085251188, 0.9819663388806226, 0.9539354516933578, 0.9566689980900078, 0.9394236702297972, 0.8687656951184655, 0.9637278528492964, 0.9168496655420584, -1.0, 0.9797527532280533, 0.986584684856181, 0.9962923908316864, 0.8794294399826157, 0.9922583162582961, 0.9291772512639287, 0.9070120395576134, 0.9846187739981512, 0.9560052532320125, 0.7651188366016651, 0.9589324009522431, 0.5914180745908906, 0.8547900788648198, 0.9479613842641695, 0.9024847779957885, 0.9337226337423181, 0.7825344877004781, 0.9400906962102116, 0.8949449672975849, 0.7974501145140357, 0.903800561930673, 0.930712625823603, 0.9741304067178987, 0.8893905416921722, 0.9140695297223478, 0.9626705172033282, 0.6599298751357904, 0.9986424555834305, 0.9870499175280043, 0.944182322259737, 0.9754588005993189, 0.8257317248949605, 0.8698845861780478, 0.8612986868831259, 0.6988730136198107, 0.771357915540011, 0.9460207020471758, 0.8817984421197229, 0.8984864819030243, 0.9470089531066781, 0.9244430230466655], "episode_lengths": [19, 13, 15, 14, 14, 14, 13, 17, 16, 13, 14, 13, 16, 13, 14, 17, 14, 14, 15, 14, 16, 15, 14, 15, 16, 15, 15, 14, 14, 15, 14, 13, 14, 15, 14, 15, 13, 14, 15, 14, 15, 13, 11, 16, 13, 19, 14, 14, 13, 13, 14, 14, 13, 15, 18, 13, 13, 15, 13, 15, 16, 22, 16, 16, 14, 20, 16, 13, 14, 19, 15, 13, 16, 13, 14, 13, 16, 13, 15, 14, 15, 14, 15, 13, 16, 14, 14, 15, 13, 17, 14, 16, 17, 16, 13, 15, 14, 16, 15, 14, 19, 15, 14, 13, 15, 14, 14, 16, 14, 15, 16, 15, 14, 13, 15, 14, 14, 14, 15, 14, 14, 14, 15, 21, 14, 16, 14, 14, 15, 16, 20, 14, 18, 13, 14, 14, 14, 14, 23, 16, 15, 17, 15, 49, 13, 15, 21, 15, 13, 17, 14, 15, 14, 15, 13, 18, 17, 80, 15, 16, 15, 17, 13, 19, 14, 13, 13, 13, 15, 13, 14, 15, 18, 14, 13, 15, 14, 13, 13, 14, 15, 15, 11, 14, 16, 14, 13, 14, 11, 13, 15, 16, 17, 14, 13, 11, 16, 14, 14, 13, 14, 14, 13, 16, 14, 19, 16, 13, 16, 15, 18, 14, 13, 14, 15, 14, 13, 15, 14, 15, 11, 15, 13, 17, 14, 14, 14, 14, 14, 14, 17, 14, 20, 14, 15, 15, 14, 16, 15, 14, 19, 15, 16, 15, 19, 14, 14, 30, 13, 13, 14, 15, 19, 15, 14, 16, 24, 15, 14, 14, 14, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09805595791176355, "mean_inference_ms": 0.2442858988051084, "mean_action_processing_ms": 0.04400078375741457, "mean_env_wait_ms": 0.04731538567234436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015948564951656428, "StateBufferConnector_ms": 0.0012952862805082597, "ViewRequirementAgentConnector_ms": 0.029481640298857945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1048.9357193932694, "num_env_steps_trained_throughput_per_sec": 1048.9357193932694, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 3702.208, "sample_time_ms": 1796.491, "load_time_ms": 0.215, "load_throughput": 18633069.747, "learn_time_ms": 1903.42, "learn_throughput": 2101.48, "synch_weights_time_ms": 1.697}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 13290, "training_iteration": 91, "trial_id": "default", "date": "2024-05-22_22-20-31", "timestamp": 1716409231, "time_this_iter_s": 3.8184146881103516, "time_total_s": 330.7833390235901, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 330.7833390235901, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 41.516666666666666, "ram_util_percent": 61.24999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7387526621741634, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.041475333042082285, "policy_loss": -0.0012244980401730024, "vf_loss": 0.041329755162900335, "vf_explained_var": 0.09119922435411842, "kl": 0.010825294310021494, "entropy": 0.44990930209557217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85095.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 0.9993412901148023, "episode_reward_min": -1.0, "episode_reward_mean": 0.8279452283891376, "episode_len_mean": 15.216730038022813, "episode_media": {}, "episodes_this_iter": 263, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8937562382754606, 0.9067821237703342, 0.8449036319325536, 0.9658267042186085, 0.9753044946471696, 0.847219321231535, 0.9270382140786205, 0.9980022578550725, 0.9429539089838886, 0.887167588230329, 0.976821080881259, 0.8715369389220549, 0.9977337114339992, 0.954171428093345, 0.8398552057956947, 0.9860317289970465, 0.764395552783466, 0.9443741977246028, -1.0, 0.8513303033810753, 0.899120050871031, 0.7647550413867308, 0.9927559829838751, 0.7117780749744969, 0.8880581263177343, 0.837422135992841, 0.7870403839265698, 0.9600113050059074, 0.9025163455336792, 0.9870800128578002, 0.9261785314997276, 0.9489167302928418, 0.9686406412821755, 0.7222829919530158, -1.0, 0.7471776499271278, 0.89941664194233, 0.9150443245505415, 0.9563844079600283, 0.8393675225072063, 0.9710419974716583, 0.8850134583531163, 0.9456129258374542, 0.9681006829989054, 0.9914031072128465, 0.9455816131252166, 0.9877037473699126, 0.9900206828772843, 0.8056727574422868, 0.8244122515286486, -1.0, 0.9871655002204939, 0.9728044509769691, 0.5, 0.9391210576492389, 0.893383445451191, 0.970795309474106, 0.776948906467091, 0.9321149684584626, 0.9844224652860508, 0.9474350510555748, 0.8908859478159803, 0.9321768755912344, 0.9821764552334046, 0.9426771526654898, 0.9934279429415337, 0.8967136822182082, 0.93583330262996, 0.9267108773561975, 0.9559457261244189, 0.8139938335105393, 0.9137583004913002, 0.9401045044808796, 0.8681736259238853, 0.969971204812878, 0.9337969913871003, 0.9686980455663615, -1.0, 0.9663930382084072, 0.8605149601884099, 0.9841949942449786, 0.9953513468492321, 0.990323880243288, 0.9619386877510588, 0.7639073846483667, 0.8385085693985497, 0.8491990818571837, 0.9920777289343357, 0.9926128484894164, 0.9956839691255411, 0.9192191049129124, 0.9728519010042288, 0.9615332148072657, 0.7644324251193801, -1.0, 0.9805108057490135, 0.9308117890034804, 0.871274584283457, 0.7887153853244488, 0.7056477229854579, 0.8328201515504876, 0.7537032328888686, 0.7301521249897911, 0.9762970849070639, 0.8187311337042282, 0.9822852036322832, 0.9056768237523358, 0.8646067391111217, 0.9412840214042576, 0.7811436693061032, 0.7101638578174578, 0.8005794469037287, 0.9534223809779393, 0.5733863670967587, 0.9028100367562717, 0.9550694206961308, 0.6879856241515553, 0.9203640070481539, 0.9108973816410273, 0.7729363200668741, 0.9770619262028325, 0.9912821593665397, 0.9272037922742626, 0.9075520423174859, 0.9068874076732691, 0.9626414034260935, 0.9833739500746413, 0.9181950884705046, 0.9576853383036779, 0.9119056200065297, 0.7135244613287961, 0.9577157367065366, 0.7070547196369634, 0.893451561096004, 0.9497489404096551, 0.9241801259843736, 0.9759015600913825, 0.9989110350860381, 0.8774627348693048, 0.9985501791520549, 0.8723694914061437, 0.8827853674633626, 0.773053650909792, 0.924392628140437, 0.8642534895960716, 0.8905764696334588, 0.6583741123192993, 0.7925385173718256, 0.822426011037347, 0.6581711104741388, 0.7568334359682353, 0.936688467573055, 0.8743965971043048, 0.9512991257834519, 0.7635825573147996, 0.9215267686872697, -1.0, 0.9344435190914049, 0.9989333329462448, 0.6223984928771087, 0.8833919798587838, 0.947357031859876, 0.9211039252784652, 0.8365573418378497, 0.9329276510019147, 0.9969809478354263, 0.97506809078856, 0.7367077345870119, 0.918989343134502, 0.9718043856015384, 0.9993412901148023, 0.9366525291624717, 0.9755689783069182, 0.8717141113047109, 0.9537550693453892, 0.9568975288024394, 0.7111935606283124, 0.9976570191607382, 0.9057730373586351, 0.9820715758801433, 0.6678241937237637, 0.9170415166890991, 0.9543968305528321, 0.9924871455133235, 0.8049641543769709, 0.9290243119199421, 0.9518433561736456, 0.8734136654041365, 0.6079424504633474, 0.6171018347391188, 0.8084941636789883, 0.9581490543554885, 0.9972157345547147, 0.7170322296931605, 0.828840290170816, 0.9317987979177477, 0.9089023664013944, 0.9962782585818384, 0.8674431085127541, 0.9333995609186561, 0.9133716012787969, 0.7971179971058928, 0.8458839420645397, 0.9652923612497813, 0.9722570505040194, 0.8797357717016675, 0.920562854267351, 0.9415509836106001, 0.9372848789738074, 0.9687655367489745, 0.850080602811533, 0.933923224936959, 0.9539050016180469, 0.9937524025230421, 0.9926846811836787, 0.9299984457786198, 0.9004820708819984, 0.9169991077699859, 0.9714822528739101, -1.0, 0.8740455157205813, 0.9236266335379328, 0.753158865969432, 0.6435994950747198, 0.9632527885616056, 0.7369279046453638, 0.9774496919849421, 0.9799865127574563, 0.9029868217764785, -1.0, 0.982937952725092, -1.0, 0.9720128504932201, 0.8181543533224545, 0.9201918176679482, 0.9875005713089289, 0.9578475342711655, 0.9845954331783445, 0.9407116403715179, 0.9399963688441125, 0.9745812581083896, 0.6136256411056853, 0.9399855567726694, 0.9283732065044918, 0.8837021169815541, 0.908611336623103, 0.8929002579142347, 0.968331941695729, 0.8770430282559053, 0.9172996337597562, 0.8051520859847301, 0.8405960961554522, 0.8467851783180912, 0.9343542852335379, 0.8357681650553046, 0.8968807333464559, 0.8876627619681041, 0.9956694082551043, 0.9847641021879657, 0.7595635506022265, 0.7410454698356805, 0.8183818442084457, 0.6669959704726636], "episode_lengths": [15, 15, 16, 14, 14, 18, 13, 14, 13, 15, 13, 15, 13, 15, 13, 14, 31, 14, 11, 14, 15, 21, 13, 16, 16, 14, 16, 14, 14, 14, 14, 14, 15, 17, 20, 19, 13, 15, 13, 17, 15, 14, 14, 15, 14, 17, 14, 16, 18, 17, 24, 14, 14, 23, 15, 15, 13, 21, 14, 15, 14, 13, 13, 16, 13, 15, 13, 15, 13, 13, 13, 14, 15, 14, 14, 13, 14, 14, 15, 15, 14, 14, 13, 14, 15, 15, 16, 13, 13, 16, 14, 16, 15, 14, 12, 13, 16, 15, 15, 17, 18, 22, 24, 14, 17, 14, 13, 13, 15, 14, 15, 15, 14, 16, 13, 17, 17, 14, 13, 15, 13, 14, 14, 13, 14, 14, 15, 14, 13, 18, 17, 15, 20, 13, 16, 14, 13, 14, 14, 15, 15, 15, 20, 14, 16, 14, 20, 14, 15, 20, 18, 17, 16, 15, 14, 13, 13, 13, 14, 16, 14, 15, 14, 14, 15, 13, 15, 18, 14, 15, 13, 13, 13, 16, 19, 13, 16, 14, 14, 14, 17, 14, 15, 15, 18, 13, 14, 15, 19, 16, 15, 14, 14, 19, 20, 14, 15, 13, 16, 15, 14, 14, 25, 14, 14, 15, 16, 13, 13, 14, 18, 14, 18, 14, 14, 18, 14, 15, 14, 31, 13, 15, 17, 17, 15, 18, 14, 15, 15, 12, 14, 11, 14, 19, 14, 15, 15, 14, 15, 14, 16, 26, 14, 13, 16, 13, 14, 14, 13, 13, 18, 16, 18, 13, 15, 15, 16, 15, 14, 17, 15, 18, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09815943519025284, "mean_inference_ms": 0.24430437406326544, "mean_action_processing_ms": 0.04400407324248007, "mean_env_wait_ms": 0.047327427432836265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015504459917771952, "StateBufferConnector_ms": 0.001235515899078021, "ViewRequirementAgentConnector_ms": 0.028699976409796074}}, "episode_reward_max": 0.9993412901148023, "episode_reward_min": -1.0, "episode_reward_mean": 0.8279452283891376, "episode_len_mean": 15.216730038022813, "episodes_this_iter": 263, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8937562382754606, 0.9067821237703342, 0.8449036319325536, 0.9658267042186085, 0.9753044946471696, 0.847219321231535, 0.9270382140786205, 0.9980022578550725, 0.9429539089838886, 0.887167588230329, 0.976821080881259, 0.8715369389220549, 0.9977337114339992, 0.954171428093345, 0.8398552057956947, 0.9860317289970465, 0.764395552783466, 0.9443741977246028, -1.0, 0.8513303033810753, 0.899120050871031, 0.7647550413867308, 0.9927559829838751, 0.7117780749744969, 0.8880581263177343, 0.837422135992841, 0.7870403839265698, 0.9600113050059074, 0.9025163455336792, 0.9870800128578002, 0.9261785314997276, 0.9489167302928418, 0.9686406412821755, 0.7222829919530158, -1.0, 0.7471776499271278, 0.89941664194233, 0.9150443245505415, 0.9563844079600283, 0.8393675225072063, 0.9710419974716583, 0.8850134583531163, 0.9456129258374542, 0.9681006829989054, 0.9914031072128465, 0.9455816131252166, 0.9877037473699126, 0.9900206828772843, 0.8056727574422868, 0.8244122515286486, -1.0, 0.9871655002204939, 0.9728044509769691, 0.5, 0.9391210576492389, 0.893383445451191, 0.970795309474106, 0.776948906467091, 0.9321149684584626, 0.9844224652860508, 0.9474350510555748, 0.8908859478159803, 0.9321768755912344, 0.9821764552334046, 0.9426771526654898, 0.9934279429415337, 0.8967136822182082, 0.93583330262996, 0.9267108773561975, 0.9559457261244189, 0.8139938335105393, 0.9137583004913002, 0.9401045044808796, 0.8681736259238853, 0.969971204812878, 0.9337969913871003, 0.9686980455663615, -1.0, 0.9663930382084072, 0.8605149601884099, 0.9841949942449786, 0.9953513468492321, 0.990323880243288, 0.9619386877510588, 0.7639073846483667, 0.8385085693985497, 0.8491990818571837, 0.9920777289343357, 0.9926128484894164, 0.9956839691255411, 0.9192191049129124, 0.9728519010042288, 0.9615332148072657, 0.7644324251193801, -1.0, 0.9805108057490135, 0.9308117890034804, 0.871274584283457, 0.7887153853244488, 0.7056477229854579, 0.8328201515504876, 0.7537032328888686, 0.7301521249897911, 0.9762970849070639, 0.8187311337042282, 0.9822852036322832, 0.9056768237523358, 0.8646067391111217, 0.9412840214042576, 0.7811436693061032, 0.7101638578174578, 0.8005794469037287, 0.9534223809779393, 0.5733863670967587, 0.9028100367562717, 0.9550694206961308, 0.6879856241515553, 0.9203640070481539, 0.9108973816410273, 0.7729363200668741, 0.9770619262028325, 0.9912821593665397, 0.9272037922742626, 0.9075520423174859, 0.9068874076732691, 0.9626414034260935, 0.9833739500746413, 0.9181950884705046, 0.9576853383036779, 0.9119056200065297, 0.7135244613287961, 0.9577157367065366, 0.7070547196369634, 0.893451561096004, 0.9497489404096551, 0.9241801259843736, 0.9759015600913825, 0.9989110350860381, 0.8774627348693048, 0.9985501791520549, 0.8723694914061437, 0.8827853674633626, 0.773053650909792, 0.924392628140437, 0.8642534895960716, 0.8905764696334588, 0.6583741123192993, 0.7925385173718256, 0.822426011037347, 0.6581711104741388, 0.7568334359682353, 0.936688467573055, 0.8743965971043048, 0.9512991257834519, 0.7635825573147996, 0.9215267686872697, -1.0, 0.9344435190914049, 0.9989333329462448, 0.6223984928771087, 0.8833919798587838, 0.947357031859876, 0.9211039252784652, 0.8365573418378497, 0.9329276510019147, 0.9969809478354263, 0.97506809078856, 0.7367077345870119, 0.918989343134502, 0.9718043856015384, 0.9993412901148023, 0.9366525291624717, 0.9755689783069182, 0.8717141113047109, 0.9537550693453892, 0.9568975288024394, 0.7111935606283124, 0.9976570191607382, 0.9057730373586351, 0.9820715758801433, 0.6678241937237637, 0.9170415166890991, 0.9543968305528321, 0.9924871455133235, 0.8049641543769709, 0.9290243119199421, 0.9518433561736456, 0.8734136654041365, 0.6079424504633474, 0.6171018347391188, 0.8084941636789883, 0.9581490543554885, 0.9972157345547147, 0.7170322296931605, 0.828840290170816, 0.9317987979177477, 0.9089023664013944, 0.9962782585818384, 0.8674431085127541, 0.9333995609186561, 0.9133716012787969, 0.7971179971058928, 0.8458839420645397, 0.9652923612497813, 0.9722570505040194, 0.8797357717016675, 0.920562854267351, 0.9415509836106001, 0.9372848789738074, 0.9687655367489745, 0.850080602811533, 0.933923224936959, 0.9539050016180469, 0.9937524025230421, 0.9926846811836787, 0.9299984457786198, 0.9004820708819984, 0.9169991077699859, 0.9714822528739101, -1.0, 0.8740455157205813, 0.9236266335379328, 0.753158865969432, 0.6435994950747198, 0.9632527885616056, 0.7369279046453638, 0.9774496919849421, 0.9799865127574563, 0.9029868217764785, -1.0, 0.982937952725092, -1.0, 0.9720128504932201, 0.8181543533224545, 0.9201918176679482, 0.9875005713089289, 0.9578475342711655, 0.9845954331783445, 0.9407116403715179, 0.9399963688441125, 0.9745812581083896, 0.6136256411056853, 0.9399855567726694, 0.9283732065044918, 0.8837021169815541, 0.908611336623103, 0.8929002579142347, 0.968331941695729, 0.8770430282559053, 0.9172996337597562, 0.8051520859847301, 0.8405960961554522, 0.8467851783180912, 0.9343542852335379, 0.8357681650553046, 0.8968807333464559, 0.8876627619681041, 0.9956694082551043, 0.9847641021879657, 0.7595635506022265, 0.7410454698356805, 0.8183818442084457, 0.6669959704726636], "episode_lengths": [15, 15, 16, 14, 14, 18, 13, 14, 13, 15, 13, 15, 13, 15, 13, 14, 31, 14, 11, 14, 15, 21, 13, 16, 16, 14, 16, 14, 14, 14, 14, 14, 15, 17, 20, 19, 13, 15, 13, 17, 15, 14, 14, 15, 14, 17, 14, 16, 18, 17, 24, 14, 14, 23, 15, 15, 13, 21, 14, 15, 14, 13, 13, 16, 13, 15, 13, 15, 13, 13, 13, 14, 15, 14, 14, 13, 14, 14, 15, 15, 14, 14, 13, 14, 15, 15, 16, 13, 13, 16, 14, 16, 15, 14, 12, 13, 16, 15, 15, 17, 18, 22, 24, 14, 17, 14, 13, 13, 15, 14, 15, 15, 14, 16, 13, 17, 17, 14, 13, 15, 13, 14, 14, 13, 14, 14, 15, 14, 13, 18, 17, 15, 20, 13, 16, 14, 13, 14, 14, 15, 15, 15, 20, 14, 16, 14, 20, 14, 15, 20, 18, 17, 16, 15, 14, 13, 13, 13, 14, 16, 14, 15, 14, 14, 15, 13, 15, 18, 14, 15, 13, 13, 13, 16, 19, 13, 16, 14, 14, 14, 17, 14, 15, 15, 18, 13, 14, 15, 19, 16, 15, 14, 14, 19, 20, 14, 15, 13, 16, 15, 14, 14, 25, 14, 14, 15, 16, 13, 13, 14, 18, 14, 18, 14, 14, 18, 14, 15, 14, 31, 13, 15, 17, 17, 15, 18, 14, 15, 15, 12, 14, 11, 14, 19, 14, 15, 15, 14, 15, 14, 16, 26, 14, 13, 16, 13, 14, 14, 13, 13, 18, 16, 18, 13, 15, 15, 16, 15, 14, 17, 15, 18, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09815943519025284, "mean_inference_ms": 0.24430437406326544, "mean_action_processing_ms": 0.04400407324248007, "mean_env_wait_ms": 0.047327427432836265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015504459917771952, "StateBufferConnector_ms": 0.001235515899078021, "ViewRequirementAgentConnector_ms": 0.028699976409796074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1061.7641727902273, "num_env_steps_trained_throughput_per_sec": 1061.7641727902273, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 3709.004, "sample_time_ms": 1798.611, "load_time_ms": 0.215, "load_throughput": 18597955.881, "learn_time_ms": 1908.084, "learn_throughput": 2096.344, "synch_weights_time_ms": 1.701}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 13553, "training_iteration": 92, "trial_id": "default", "date": "2024-05-22_22-20-35", "timestamp": 1716409235, "time_this_iter_s": 3.7720441818237305, "time_total_s": 334.5553832054138, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 334.5553832054138, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 20.619999999999997, "ram_util_percent": 61.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.361372462844336, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.022368351377356516, "policy_loss": -0.012031702713299824, "vf_loss": 0.03273963058462507, "vf_explained_var": 0.07905779250206486, "kl": 0.013119398973034692, "entropy": 0.43148366286549517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86025.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 0.9998750550335522, "episode_reward_min": -1.0, "episode_reward_mean": 0.8551889851969074, "episode_len_mean": 14.68131868131868, "episode_media": {}, "episodes_this_iter": 273, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7744927324589748, 0.9771272034196651, 0.9379195468221577, 0.9834029449393072, 0.7671936381397831, 0.9383356715072223, 0.9276158884568847, 0.9023355247113928, 0.9288335836742064, 0.8188988279867218, 0.9787051684461743, 0.8892221891544786, 0.9706602823493388, 0.9483288290992673, 0.959940119220665, 0.9737798743590762, 0.9523563350564788, 0.925433122667449, 0.7023087214293701, 0.8273432761078302, 0.8681897676773755, 0.9950641031238019, 0.9530291962753089, 0.9277108793777402, 0.9641033837685377, 0.9946071537411995, 0.734726849139668, 0.6030292576735172, 0.9712933575906632, 0.9581985021230613, 0.6471902813372519, 0.9237638014669023, 0.8230742201934005, 0.5, 0.6292909724102252, 0.819111943067075, 0.9377804500653303, 0.8443782930911787, 0.9365151528804747, 0.9692802363800556, 0.984042094038124, 0.9367047699175801, 0.7664278786481421, 0.9706695545305857, 0.920318497767043, 0.9825799129825126, 0.9213771483384999, 0.8925632927107187, 0.8669497048203916, 0.9282525912228471, 0.9782686393118593, 0.8558325331821619, 0.9853849663398102, 0.9687103877373169, -1.0, 0.9730575342463779, 0.9714192749625856, 0.8588602183503948, 0.9803794074590574, 0.9648045712466014, 0.576815371301358, 0.9347548220817771, 0.9026315634317762, 0.9494648158119797, 0.9597621350923332, 0.8669043252617282, 0.8454018872176675, 0.8665950994784829, 0.907588222120499, 0.8639968010170304, 0.9299510825029147, 0.9112406933460859, 0.8801403706684429, 0.6380927810556364, 0.951806214084519, 0.8551657598076002, 0.8204313666688134, 0.9215638311641118, 0.9603141368516921, 0.9422495704936192, 0.9963273524918415, 0.8361779647089366, 0.9557223093127363, 0.859573125983301, 0.8716206767630605, 0.9443649576922117, 0.9790301175273205, 0.9639333722898882, 0.8923596120966577, 0.9086333303685324, 0.949792325820954, 0.9388614489884954, 0.8805147279925929, 0.9418361198084875, -1.0, 0.8184735216054446, 0.8472997820995383, 0.8428384707713836, 0.989779442634734, 0.9440398563065615, 0.8662519787173133, 0.7996756380687314, 0.9788454140515942, 0.9751704713022221, 0.9924138259031703, 0.8389537829102821, 0.8354459207360392, 0.9040332037012656, 0.9725305158148873, 0.8720867336313286, 0.9391800967030655, 0.9278844809173028, 0.9705189490485833, 0.6441724236649495, 0.9083714948555323, 0.9600062762220234, 0.9421522534109672, 0.9673192208926833, 0.9554511019319349, 0.9743931383765622, 0.9209524115549012, 0.8520522482866606, 0.6785951962497498, 0.9605348308464833, 0.9982841083413444, 0.9030428755698245, 0.9854779897437166, 0.9659990912096977, 0.9727941259921642, 0.896057135936309, 0.9234504947952019, 0.9280062045900122, 0.9768410264725229, 0.6006037894712709, 0.8538532055240797, 0.9731929999696204, 0.7395370950065907, -1.0, 0.9860477074845945, 0.9515708225707474, 0.9180008317453204, 0.5995664405194276, 0.9452510729526585, 0.8639470313709171, 0.9914825761594213, 0.9198795147223077, 0.9493903661006794, 0.8940231667788379, 0.887419848538307, 0.9225678810719264, 0.9989436639350651, 0.9477144068770703, 0.9998750550335522, 0.5, 0.9564518915075776, 0.9601808547349838, 0.9942002780239254, 0.6850374573655142, 0.9928977955317766, 0.9930043925607518, 0.7713075762433843, 0.9702715146698292, 0.9935850382156721, 0.8409600246556201, 0.8001632559536487, 0.6332891218896415, 0.7571387442433544, -1.0, 0.7381102167312116, 0.9973134103953023, 0.8592976142937568, 0.8580940390201938, 0.9109700903414981, 0.9949562581985183, 0.9628301497841806, 0.9929322438282173, 0.8602453369673901, 0.8861921834741936, 0.5, 0.9406127553121243, 0.9236352985444004, -1.0, 0.9403793094066938, 0.9339820599393976, 0.8655778460110248, 0.8845971520329095, 0.9747036482242266, 0.9152038832450282, 0.9708781679752131, 0.9103728074613103, 0.8766650653079617, 0.9495877950630417, 0.8675001924026914, 0.9876379877453926, 0.5177461919105777, 0.879443976006064, 0.9768419107540022, 0.8967070312334029, 0.9576468612458249, 0.838881532417767, 0.8781080010654556, 0.5516679920654499, 0.9923670696207606, 0.9497320965180256, 0.7832880858752415, 0.9377072621097654, 0.9418603168724694, 0.9829362241699093, 0.9124563274499571, 0.9364991337070503, 0.9409662485483647, 0.8946140694632088, 0.9283398444486477, 0.9751255878148581, 0.7895985292362223, 0.9460525179748236, 0.8561423793816144, 0.7090821944501937, 0.8804481407661531, 0.9220253622060846, 0.9981001918553961, 0.8913969925042708, 0.9236532595116473, 0.6963217420787859, 0.927480874086154, 0.9338592520700383, 0.9405334300448325, 0.994615098966377, 0.9510595138774199, 0.9481784906179141, 0.9196652236970657, 0.9682863869832115, 0.9830927489000668, 0.9492460422700977, 0.9004536820087577, 0.9992430956672707, 0.9773412625273152, 0.7700702452395156, 0.7448336789533366, 0.90079602773878, 0.9230908557152546, 0.9924038924860457, 0.9655159833016839, 0.9421013637862204, 0.9779037902356976, 0.5, 0.9948738678868528, 0.9504089473551662, 0.9522164548709127, 0.6765119947010378, 0.9644586844728603, 0.9874067649865652, 0.8300768159591354, 0.9597179737016759, 0.9852252359025659, 0.9569089775897625, 0.9630161010106999, 0.9474869647940554, 0.9337208094734617, 0.9490932163142314, 0.8887539582552413, 0.9864780485090409, -1.0, 0.9558101490601207, 0.7125321237850972, 0.9486855618277766, 0.992026232640072, 0.9747600817266395, 0.8618484091138157, 0.85805300084617, 0.9656075161709639, 0.762332641213206, 0.9952551966480229], "episode_lengths": [15, 13, 13, 13, 21, 13, 16, 14, 13, 16, 17, 13, 13, 16, 13, 13, 13, 14, 22, 17, 13, 16, 15, 15, 14, 15, 16, 16, 14, 14, 17, 14, 15, 16, 14, 15, 14, 14, 13, 13, 18, 13, 15, 13, 13, 14, 13, 13, 14, 13, 14, 13, 14, 14, 12, 13, 13, 13, 14, 13, 20, 16, 13, 13, 14, 13, 13, 15, 14, 13, 15, 14, 17, 17, 17, 18, 17, 13, 14, 14, 13, 14, 14, 14, 14, 13, 14, 13, 16, 13, 16, 14, 14, 13, 20, 14, 15, 18, 13, 15, 14, 15, 14, 15, 13, 17, 16, 15, 13, 16, 16, 14, 14, 18, 13, 14, 15, 14, 13, 14, 14, 16, 16, 14, 16, 13, 13, 14, 14, 15, 14, 15, 14, 17, 14, 13, 19, 10, 14, 13, 15, 20, 13, 13, 16, 16, 14, 14, 14, 15, 14, 13, 17, 14, 14, 14, 14, 16, 15, 14, 19, 13, 14, 17, 16, 18, 16, 11, 16, 14, 17, 14, 13, 13, 13, 13, 16, 14, 21, 14, 18, 27, 14, 14, 14, 14, 15, 14, 22, 15, 14, 16, 13, 13, 16, 15, 14, 14, 15, 15, 14, 19, 14, 13, 19, 14, 14, 13, 14, 13, 15, 15, 13, 15, 17, 16, 16, 16, 14, 13, 13, 13, 14, 20, 13, 13, 13, 16, 13, 14, 14, 18, 13, 13, 13, 14, 13, 18, 24, 14, 13, 14, 14, 15, 13, 16, 14, 15, 14, 18, 13, 13, 15, 14, 14, 13, 15, 14, 13, 15, 14, 13, 11, 15, 14, 14, 15, 13, 14, 14, 14, 22, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09827569210521094, "mean_inference_ms": 0.24433757295784161, "mean_action_processing_ms": 0.044009486456606295, "mean_env_wait_ms": 0.047342660882452536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015831692314846612, "StateBufferConnector_ms": 0.0012553218520167983, "ViewRequirementAgentConnector_ms": 0.02878183846945291}}, "episode_reward_max": 0.9998750550335522, "episode_reward_min": -1.0, "episode_reward_mean": 0.8551889851969074, "episode_len_mean": 14.68131868131868, "episodes_this_iter": 273, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7744927324589748, 0.9771272034196651, 0.9379195468221577, 0.9834029449393072, 0.7671936381397831, 0.9383356715072223, 0.9276158884568847, 0.9023355247113928, 0.9288335836742064, 0.8188988279867218, 0.9787051684461743, 0.8892221891544786, 0.9706602823493388, 0.9483288290992673, 0.959940119220665, 0.9737798743590762, 0.9523563350564788, 0.925433122667449, 0.7023087214293701, 0.8273432761078302, 0.8681897676773755, 0.9950641031238019, 0.9530291962753089, 0.9277108793777402, 0.9641033837685377, 0.9946071537411995, 0.734726849139668, 0.6030292576735172, 0.9712933575906632, 0.9581985021230613, 0.6471902813372519, 0.9237638014669023, 0.8230742201934005, 0.5, 0.6292909724102252, 0.819111943067075, 0.9377804500653303, 0.8443782930911787, 0.9365151528804747, 0.9692802363800556, 0.984042094038124, 0.9367047699175801, 0.7664278786481421, 0.9706695545305857, 0.920318497767043, 0.9825799129825126, 0.9213771483384999, 0.8925632927107187, 0.8669497048203916, 0.9282525912228471, 0.9782686393118593, 0.8558325331821619, 0.9853849663398102, 0.9687103877373169, -1.0, 0.9730575342463779, 0.9714192749625856, 0.8588602183503948, 0.9803794074590574, 0.9648045712466014, 0.576815371301358, 0.9347548220817771, 0.9026315634317762, 0.9494648158119797, 0.9597621350923332, 0.8669043252617282, 0.8454018872176675, 0.8665950994784829, 0.907588222120499, 0.8639968010170304, 0.9299510825029147, 0.9112406933460859, 0.8801403706684429, 0.6380927810556364, 0.951806214084519, 0.8551657598076002, 0.8204313666688134, 0.9215638311641118, 0.9603141368516921, 0.9422495704936192, 0.9963273524918415, 0.8361779647089366, 0.9557223093127363, 0.859573125983301, 0.8716206767630605, 0.9443649576922117, 0.9790301175273205, 0.9639333722898882, 0.8923596120966577, 0.9086333303685324, 0.949792325820954, 0.9388614489884954, 0.8805147279925929, 0.9418361198084875, -1.0, 0.8184735216054446, 0.8472997820995383, 0.8428384707713836, 0.989779442634734, 0.9440398563065615, 0.8662519787173133, 0.7996756380687314, 0.9788454140515942, 0.9751704713022221, 0.9924138259031703, 0.8389537829102821, 0.8354459207360392, 0.9040332037012656, 0.9725305158148873, 0.8720867336313286, 0.9391800967030655, 0.9278844809173028, 0.9705189490485833, 0.6441724236649495, 0.9083714948555323, 0.9600062762220234, 0.9421522534109672, 0.9673192208926833, 0.9554511019319349, 0.9743931383765622, 0.9209524115549012, 0.8520522482866606, 0.6785951962497498, 0.9605348308464833, 0.9982841083413444, 0.9030428755698245, 0.9854779897437166, 0.9659990912096977, 0.9727941259921642, 0.896057135936309, 0.9234504947952019, 0.9280062045900122, 0.9768410264725229, 0.6006037894712709, 0.8538532055240797, 0.9731929999696204, 0.7395370950065907, -1.0, 0.9860477074845945, 0.9515708225707474, 0.9180008317453204, 0.5995664405194276, 0.9452510729526585, 0.8639470313709171, 0.9914825761594213, 0.9198795147223077, 0.9493903661006794, 0.8940231667788379, 0.887419848538307, 0.9225678810719264, 0.9989436639350651, 0.9477144068770703, 0.9998750550335522, 0.5, 0.9564518915075776, 0.9601808547349838, 0.9942002780239254, 0.6850374573655142, 0.9928977955317766, 0.9930043925607518, 0.7713075762433843, 0.9702715146698292, 0.9935850382156721, 0.8409600246556201, 0.8001632559536487, 0.6332891218896415, 0.7571387442433544, -1.0, 0.7381102167312116, 0.9973134103953023, 0.8592976142937568, 0.8580940390201938, 0.9109700903414981, 0.9949562581985183, 0.9628301497841806, 0.9929322438282173, 0.8602453369673901, 0.8861921834741936, 0.5, 0.9406127553121243, 0.9236352985444004, -1.0, 0.9403793094066938, 0.9339820599393976, 0.8655778460110248, 0.8845971520329095, 0.9747036482242266, 0.9152038832450282, 0.9708781679752131, 0.9103728074613103, 0.8766650653079617, 0.9495877950630417, 0.8675001924026914, 0.9876379877453926, 0.5177461919105777, 0.879443976006064, 0.9768419107540022, 0.8967070312334029, 0.9576468612458249, 0.838881532417767, 0.8781080010654556, 0.5516679920654499, 0.9923670696207606, 0.9497320965180256, 0.7832880858752415, 0.9377072621097654, 0.9418603168724694, 0.9829362241699093, 0.9124563274499571, 0.9364991337070503, 0.9409662485483647, 0.8946140694632088, 0.9283398444486477, 0.9751255878148581, 0.7895985292362223, 0.9460525179748236, 0.8561423793816144, 0.7090821944501937, 0.8804481407661531, 0.9220253622060846, 0.9981001918553961, 0.8913969925042708, 0.9236532595116473, 0.6963217420787859, 0.927480874086154, 0.9338592520700383, 0.9405334300448325, 0.994615098966377, 0.9510595138774199, 0.9481784906179141, 0.9196652236970657, 0.9682863869832115, 0.9830927489000668, 0.9492460422700977, 0.9004536820087577, 0.9992430956672707, 0.9773412625273152, 0.7700702452395156, 0.7448336789533366, 0.90079602773878, 0.9230908557152546, 0.9924038924860457, 0.9655159833016839, 0.9421013637862204, 0.9779037902356976, 0.5, 0.9948738678868528, 0.9504089473551662, 0.9522164548709127, 0.6765119947010378, 0.9644586844728603, 0.9874067649865652, 0.8300768159591354, 0.9597179737016759, 0.9852252359025659, 0.9569089775897625, 0.9630161010106999, 0.9474869647940554, 0.9337208094734617, 0.9490932163142314, 0.8887539582552413, 0.9864780485090409, -1.0, 0.9558101490601207, 0.7125321237850972, 0.9486855618277766, 0.992026232640072, 0.9747600817266395, 0.8618484091138157, 0.85805300084617, 0.9656075161709639, 0.762332641213206, 0.9952551966480229], "episode_lengths": [15, 13, 13, 13, 21, 13, 16, 14, 13, 16, 17, 13, 13, 16, 13, 13, 13, 14, 22, 17, 13, 16, 15, 15, 14, 15, 16, 16, 14, 14, 17, 14, 15, 16, 14, 15, 14, 14, 13, 13, 18, 13, 15, 13, 13, 14, 13, 13, 14, 13, 14, 13, 14, 14, 12, 13, 13, 13, 14, 13, 20, 16, 13, 13, 14, 13, 13, 15, 14, 13, 15, 14, 17, 17, 17, 18, 17, 13, 14, 14, 13, 14, 14, 14, 14, 13, 14, 13, 16, 13, 16, 14, 14, 13, 20, 14, 15, 18, 13, 15, 14, 15, 14, 15, 13, 17, 16, 15, 13, 16, 16, 14, 14, 18, 13, 14, 15, 14, 13, 14, 14, 16, 16, 14, 16, 13, 13, 14, 14, 15, 14, 15, 14, 17, 14, 13, 19, 10, 14, 13, 15, 20, 13, 13, 16, 16, 14, 14, 14, 15, 14, 13, 17, 14, 14, 14, 14, 16, 15, 14, 19, 13, 14, 17, 16, 18, 16, 11, 16, 14, 17, 14, 13, 13, 13, 13, 16, 14, 21, 14, 18, 27, 14, 14, 14, 14, 15, 14, 22, 15, 14, 16, 13, 13, 16, 15, 14, 14, 15, 15, 14, 19, 14, 13, 19, 14, 14, 13, 14, 13, 15, 15, 13, 15, 17, 16, 16, 16, 14, 13, 13, 13, 14, 20, 13, 13, 13, 16, 13, 14, 14, 18, 13, 13, 13, 14, 13, 18, 24, 14, 13, 14, 14, 15, 13, 16, 14, 15, 14, 18, 13, 13, 15, 14, 14, 13, 15, 14, 13, 15, 14, 13, 11, 15, 14, 14, 15, 13, 14, 14, 14, 22, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09827569210521094, "mean_inference_ms": 0.24433757295784161, "mean_action_processing_ms": 0.044009486456606295, "mean_env_wait_ms": 0.047342660882452536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015831692314846612, "StateBufferConnector_ms": 0.0012553218520167983, "ViewRequirementAgentConnector_ms": 0.02878183846945291}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1052.8717166037434, "num_env_steps_trained_throughput_per_sec": 1052.8717166037434, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 3728.504, "sample_time_ms": 1803.92, "load_time_ms": 0.217, "load_throughput": 18444608.619, "learn_time_ms": 1922.267, "learn_throughput": 2080.876, "synch_weights_time_ms": 1.706}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 13826, "training_iteration": 93, "trial_id": "default", "date": "2024-05-22_22-20-39", "timestamp": 1716409239, "time_this_iter_s": 3.804172992706299, "time_total_s": 338.3595561981201, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 338.3595561981201, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 22.516666666666666, "ram_util_percent": 61.116666666666674}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2639715151761166, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.028232471079763365, "policy_loss": -0.007552465906627076, "vf_loss": 0.03462811396494808, "vf_explained_var": 0.024231849626828266, "kl": 0.009140323944028939, "entropy": 0.45421316787119836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86955.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 0.9989146892865198, "episode_reward_min": -1.0, "episode_reward_mean": 0.8675466646395332, "episode_len_mean": 14.37410071942446, "episode_media": {}, "episodes_this_iter": 278, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8916743154584461, 0.6176087318210983, 0.9847053702127464, 0.9716978370276081, 0.8462454470051147, 0.8300767726015235, 0.9909513049988729, 0.9607582156685269, 0.8353706575972443, 0.9087778324338873, 0.9490649269881594, 0.8301448462401549, -1.0, 0.9427395342344748, 0.9762970847119797, 0.995698218085576, 0.9390100963609468, 0.9055229687863405, 0.8797722173019985, 0.9858558223765119, 0.7968458003362847, 0.9967858183077063, 0.9788540847190478, 0.9458429542882132, 0.9930177750575406, 0.9809439686975616, 0.8893864092781131, 0.8528065651492092, 0.9225227786442424, 0.9386348880681215, 0.881170999716224, 0.9821210978764288, 0.8996165505253828, 0.9708205371198536, 0.9912050887774135, 0.9475507331410208, 0.9798744731419424, 0.9389894533215662, 0.966935203659555, 0.9809871052335117, 0.9869218903486296, 0.9168072192079955, 0.8626420181572575, 0.9670591539460817, 0.8781982364428603, 0.9538424646465038, 0.7310166210361526, 0.605476165941734, 0.9469321943101885, 0.9651184749993055, 0.8879923053588867, 0.97103453614902, 0.9361064017267305, 0.9542624119633597, 0.9379517040757437, 0.9331224184571701, -1.0, 0.6933940140826542, 0.7322526072819437, 0.9736855957494259, 0.9802821345365077, 0.991183396058359, 0.9717345452031659, 0.973717288072341, 0.8194431158824551, 0.9695258392298414, 0.8410346510443353, 0.8984087812114651, 0.8904617893179569, 0.8625648396225124, 0.9514506936363222, 0.9393196820462967, 0.9207225825790096, 0.8261705893739, 0.9330110727762836, 0.916731327964415, 0.748891587845484, 0.8369094234125274, 0.9079710501502954, 0.9753420984599874, 0.8727807639369511, 0.9423678153411887, -1.0, 0.8675270861502217, 0.6760799186002304, 0.9939471364609526, 0.9808171168082398, 0.9725441553673551, 0.9220884732113641, 0.9903143612779794, 0.8964227263768614, 0.9489595235243781, 0.9239291416722055, 0.9668386043110561, 0.9025035447732017, 0.5, 0.747582731315743, 0.9307029267652039, 0.894135477090588, 0.9290411798896125, 0.9502343342365278, 0.9584921244246899, 0.9010351308734915, 0.9799993981932912, 0.9554927628202959, 0.935947149788638, 0.9771704084410107, 0.9385906735045816, 0.9408100216702773, 0.8315019324493714, 0.8259042298637695, 0.9389535422816253, 0.9559045489154938, 0.9433840883310018, 0.9586383181573777, 0.7702343251564354, 0.7816207934237207, 0.9008165521488333, 0.9896724884976846, 0.9601268165723782, 0.8682150746459123, 0.9169788301154121, 0.938431895086568, 0.8938402292163079, 0.9456027139936865, 0.8268342625977054, 0.9732010996711645, 0.872964060961025, 0.7622822053194005, 0.9006785075918763, 0.9794261563402744, 0.9649104975332303, 0.9092363754913786, 0.9681910570821521, 0.9591252663884983, 0.9443069971752936, 0.9873685253662025, 0.8885829915186507, 0.9870315403647785, 0.9487885769456041, 0.8823747048698859, 0.9750827913912022, 0.8968205959549733, -1.0, 0.9549022477671261, 0.8010439884192405, 0.9339561604843906, 0.6957644262017961, 0.9544354227885603, 0.9384394399079738, 0.965983369650853, 0.9049937881298146, 0.9094515986038998, 0.9953846874201483, 0.9781582717531853, 0.8300180259844565, 0.8083915267761045, 0.967857710278632, 0.9577481423838594, 0.9393369432990928, 0.9850188907605236, 0.7102761263274404, 0.991748273497215, -1.0, 0.9280911258244594, 0.8918318416549077, 0.8741444460553964, 0.982668780138672, 0.9387607401094016, 0.847308870733759, 0.9897951563742593, 0.8640845612771304, 0.6862116337067488, 0.948218938919325, -1.0, 0.9528615643387598, 0.9781919994174804, 0.8994461503119283, 0.9709999475940282, 0.8985513184676877, 0.9279599019323238, 0.8982041733752443, 0.8908650876143244, 0.9747902841239142, 0.9419356196302758, 0.5, 0.9321563758724789, 0.9454592638408605, 0.9915593782895974, 0.9631060380429435, 0.8754778427894878, 0.9336530013148431, 0.9868790685884563, 0.9265281899694697, 0.9689404179009364, 0.6145411676179178, 0.9249128308885314, 0.8535662588213249, 0.8470079973974759, 0.9460739049166994, 0.9903896034528548, 0.8749193458137265, 0.8853746996473132, 0.9989146892865198, 0.9932329579731455, 0.7136083024209177, 0.8905730225824589, 0.9950622060392048, 0.9255559284474401, 0.9533011864485705, 0.9460255789120008, 0.9452634269493075, 0.8645052130550377, 0.9731526719632675, 0.9874369616745741, 0.7272628429997665, 0.9478476489009438, 0.877883547216896, 0.8786051036749082, 0.9913901722003383, 0.906676048689821, 0.900371480094617, 0.9729539861940929, 0.9731711890845497, 0.9786551695664072, 0.9560005386656106, 0.9164351641741943, 0.9512948364564481, 0.8944167762995471, 0.7577912721641347, 0.8333308043547938, 0.8045192736691358, 0.9233858444756047, 0.9347562301950693, 0.9646160990705773, 0.9832527987323062, 0.5536717530827775, 0.8877545021554426, 0.820111734873447, 0.8180699171209997, 0.946710186014564, 0.6158895345464148, 0.9509863686320629, 0.9934551120304359, 0.8532316977072734, 0.9036093755578848, 0.9556344800372878, 0.967430241354655, 0.9544806076775774, 0.8784395049921679, 0.9722298148857248, 0.9871482034157121, 0.9916688863664463, 0.9512786350994877, 0.9109988334761538, 0.940912085727534, 0.8915250812403734, 0.9518395554024537, 0.884178588220402, 0.9908082724412943, 0.6554591111477246, 0.8800249000501483, 0.9060052240313574, 0.9166868140646812, 0.9966283524252371, 0.8941938758232024, 0.9269684035037941, 0.9898992558406994, 0.8759347452148728, 0.8754403913977503, 0.9602967780924616, 0.9531797323597276, 0.9502489504789243, 0.9579632223566117, 0.8595143262505927, 0.9422903798731141, 0.8700138826175277, 0.9565712268515073], "episode_lengths": [15, 15, 13, 14, 14, 14, 14, 13, 14, 14, 13, 16, 13, 15, 16, 14, 13, 14, 15, 15, 21, 14, 14, 13, 14, 13, 13, 16, 13, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 14, 14, 15, 14, 14, 13, 14, 20, 14, 14, 17, 14, 15, 13, 14, 14, 11, 15, 15, 13, 14, 15, 13, 15, 17, 14, 17, 15, 14, 16, 15, 16, 13, 14, 13, 17, 16, 14, 16, 14, 15, 15, 15, 18, 16, 14, 15, 14, 13, 13, 13, 14, 14, 13, 18, 17, 16, 14, 13, 13, 15, 13, 13, 14, 15, 14, 13, 14, 15, 15, 15, 15, 13, 14, 13, 16, 15, 14, 13, 15, 13, 15, 14, 14, 15, 14, 15, 13, 16, 14, 13, 14, 17, 14, 14, 13, 13, 14, 14, 14, 16, 14, 14, 12, 13, 16, 15, 15, 15, 15, 15, 15, 13, 17, 14, 15, 14, 16, 15, 14, 13, 17, 14, 15, 15, 16, 13, 14, 14, 15, 13, 14, 18, 13, 33, 13, 14, 13, 15, 13, 14, 14, 13, 14, 13, 15, 13, 15, 13, 13, 16, 13, 13, 16, 13, 20, 13, 14, 15, 15, 14, 13, 13, 14, 14, 16, 14, 15, 14, 14, 16, 14, 14, 14, 14, 15, 13, 14, 13, 14, 13, 15, 13, 13, 13, 14, 13, 13, 14, 14, 14, 16, 13, 14, 15, 14, 17, 13, 13, 14, 13, 16, 14, 15, 22, 16, 13, 13, 14, 14, 15, 13, 14, 14, 13, 15, 13, 16, 13, 14, 18, 14, 18, 13, 14, 13, 13, 14, 15, 13, 14, 15, 15, 13, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09838403688304004, "mean_inference_ms": 0.24434292262634205, "mean_action_processing_ms": 0.04401120886118528, "mean_env_wait_ms": 0.047352650944594836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015108705424576355, "StateBufferConnector_ms": 0.00121499137055102, "ViewRequirementAgentConnector_ms": 0.02848690362285367}}, "episode_reward_max": 0.9989146892865198, "episode_reward_min": -1.0, "episode_reward_mean": 0.8675466646395332, "episode_len_mean": 14.37410071942446, "episodes_this_iter": 278, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8916743154584461, 0.6176087318210983, 0.9847053702127464, 0.9716978370276081, 0.8462454470051147, 0.8300767726015235, 0.9909513049988729, 0.9607582156685269, 0.8353706575972443, 0.9087778324338873, 0.9490649269881594, 0.8301448462401549, -1.0, 0.9427395342344748, 0.9762970847119797, 0.995698218085576, 0.9390100963609468, 0.9055229687863405, 0.8797722173019985, 0.9858558223765119, 0.7968458003362847, 0.9967858183077063, 0.9788540847190478, 0.9458429542882132, 0.9930177750575406, 0.9809439686975616, 0.8893864092781131, 0.8528065651492092, 0.9225227786442424, 0.9386348880681215, 0.881170999716224, 0.9821210978764288, 0.8996165505253828, 0.9708205371198536, 0.9912050887774135, 0.9475507331410208, 0.9798744731419424, 0.9389894533215662, 0.966935203659555, 0.9809871052335117, 0.9869218903486296, 0.9168072192079955, 0.8626420181572575, 0.9670591539460817, 0.8781982364428603, 0.9538424646465038, 0.7310166210361526, 0.605476165941734, 0.9469321943101885, 0.9651184749993055, 0.8879923053588867, 0.97103453614902, 0.9361064017267305, 0.9542624119633597, 0.9379517040757437, 0.9331224184571701, -1.0, 0.6933940140826542, 0.7322526072819437, 0.9736855957494259, 0.9802821345365077, 0.991183396058359, 0.9717345452031659, 0.973717288072341, 0.8194431158824551, 0.9695258392298414, 0.8410346510443353, 0.8984087812114651, 0.8904617893179569, 0.8625648396225124, 0.9514506936363222, 0.9393196820462967, 0.9207225825790096, 0.8261705893739, 0.9330110727762836, 0.916731327964415, 0.748891587845484, 0.8369094234125274, 0.9079710501502954, 0.9753420984599874, 0.8727807639369511, 0.9423678153411887, -1.0, 0.8675270861502217, 0.6760799186002304, 0.9939471364609526, 0.9808171168082398, 0.9725441553673551, 0.9220884732113641, 0.9903143612779794, 0.8964227263768614, 0.9489595235243781, 0.9239291416722055, 0.9668386043110561, 0.9025035447732017, 0.5, 0.747582731315743, 0.9307029267652039, 0.894135477090588, 0.9290411798896125, 0.9502343342365278, 0.9584921244246899, 0.9010351308734915, 0.9799993981932912, 0.9554927628202959, 0.935947149788638, 0.9771704084410107, 0.9385906735045816, 0.9408100216702773, 0.8315019324493714, 0.8259042298637695, 0.9389535422816253, 0.9559045489154938, 0.9433840883310018, 0.9586383181573777, 0.7702343251564354, 0.7816207934237207, 0.9008165521488333, 0.9896724884976846, 0.9601268165723782, 0.8682150746459123, 0.9169788301154121, 0.938431895086568, 0.8938402292163079, 0.9456027139936865, 0.8268342625977054, 0.9732010996711645, 0.872964060961025, 0.7622822053194005, 0.9006785075918763, 0.9794261563402744, 0.9649104975332303, 0.9092363754913786, 0.9681910570821521, 0.9591252663884983, 0.9443069971752936, 0.9873685253662025, 0.8885829915186507, 0.9870315403647785, 0.9487885769456041, 0.8823747048698859, 0.9750827913912022, 0.8968205959549733, -1.0, 0.9549022477671261, 0.8010439884192405, 0.9339561604843906, 0.6957644262017961, 0.9544354227885603, 0.9384394399079738, 0.965983369650853, 0.9049937881298146, 0.9094515986038998, 0.9953846874201483, 0.9781582717531853, 0.8300180259844565, 0.8083915267761045, 0.967857710278632, 0.9577481423838594, 0.9393369432990928, 0.9850188907605236, 0.7102761263274404, 0.991748273497215, -1.0, 0.9280911258244594, 0.8918318416549077, 0.8741444460553964, 0.982668780138672, 0.9387607401094016, 0.847308870733759, 0.9897951563742593, 0.8640845612771304, 0.6862116337067488, 0.948218938919325, -1.0, 0.9528615643387598, 0.9781919994174804, 0.8994461503119283, 0.9709999475940282, 0.8985513184676877, 0.9279599019323238, 0.8982041733752443, 0.8908650876143244, 0.9747902841239142, 0.9419356196302758, 0.5, 0.9321563758724789, 0.9454592638408605, 0.9915593782895974, 0.9631060380429435, 0.8754778427894878, 0.9336530013148431, 0.9868790685884563, 0.9265281899694697, 0.9689404179009364, 0.6145411676179178, 0.9249128308885314, 0.8535662588213249, 0.8470079973974759, 0.9460739049166994, 0.9903896034528548, 0.8749193458137265, 0.8853746996473132, 0.9989146892865198, 0.9932329579731455, 0.7136083024209177, 0.8905730225824589, 0.9950622060392048, 0.9255559284474401, 0.9533011864485705, 0.9460255789120008, 0.9452634269493075, 0.8645052130550377, 0.9731526719632675, 0.9874369616745741, 0.7272628429997665, 0.9478476489009438, 0.877883547216896, 0.8786051036749082, 0.9913901722003383, 0.906676048689821, 0.900371480094617, 0.9729539861940929, 0.9731711890845497, 0.9786551695664072, 0.9560005386656106, 0.9164351641741943, 0.9512948364564481, 0.8944167762995471, 0.7577912721641347, 0.8333308043547938, 0.8045192736691358, 0.9233858444756047, 0.9347562301950693, 0.9646160990705773, 0.9832527987323062, 0.5536717530827775, 0.8877545021554426, 0.820111734873447, 0.8180699171209997, 0.946710186014564, 0.6158895345464148, 0.9509863686320629, 0.9934551120304359, 0.8532316977072734, 0.9036093755578848, 0.9556344800372878, 0.967430241354655, 0.9544806076775774, 0.8784395049921679, 0.9722298148857248, 0.9871482034157121, 0.9916688863664463, 0.9512786350994877, 0.9109988334761538, 0.940912085727534, 0.8915250812403734, 0.9518395554024537, 0.884178588220402, 0.9908082724412943, 0.6554591111477246, 0.8800249000501483, 0.9060052240313574, 0.9166868140646812, 0.9966283524252371, 0.8941938758232024, 0.9269684035037941, 0.9898992558406994, 0.8759347452148728, 0.8754403913977503, 0.9602967780924616, 0.9531797323597276, 0.9502489504789243, 0.9579632223566117, 0.8595143262505927, 0.9422903798731141, 0.8700138826175277, 0.9565712268515073], "episode_lengths": [15, 15, 13, 14, 14, 14, 14, 13, 14, 14, 13, 16, 13, 15, 16, 14, 13, 14, 15, 15, 21, 14, 14, 13, 14, 13, 13, 16, 13, 13, 13, 15, 13, 13, 13, 15, 13, 13, 13, 13, 14, 14, 15, 14, 14, 13, 14, 20, 14, 14, 17, 14, 15, 13, 14, 14, 11, 15, 15, 13, 14, 15, 13, 15, 17, 14, 17, 15, 14, 16, 15, 16, 13, 14, 13, 17, 16, 14, 16, 14, 15, 15, 15, 18, 16, 14, 15, 14, 13, 13, 13, 14, 14, 13, 18, 17, 16, 14, 13, 13, 15, 13, 13, 14, 15, 14, 13, 14, 15, 15, 15, 15, 13, 14, 13, 16, 15, 14, 13, 15, 13, 15, 14, 14, 15, 14, 15, 13, 16, 14, 13, 14, 17, 14, 14, 13, 13, 14, 14, 14, 16, 14, 14, 12, 13, 16, 15, 15, 15, 15, 15, 15, 13, 17, 14, 15, 14, 16, 15, 14, 13, 17, 14, 15, 15, 16, 13, 14, 14, 15, 13, 14, 18, 13, 33, 13, 14, 13, 15, 13, 14, 14, 13, 14, 13, 15, 13, 15, 13, 13, 16, 13, 13, 16, 13, 20, 13, 14, 15, 15, 14, 13, 13, 14, 14, 16, 14, 15, 14, 14, 16, 14, 14, 14, 14, 15, 13, 14, 13, 14, 13, 15, 13, 13, 13, 14, 13, 13, 14, 14, 14, 16, 13, 14, 15, 14, 17, 13, 13, 14, 13, 16, 14, 15, 22, 16, 13, 13, 14, 14, 15, 13, 14, 14, 13, 15, 13, 16, 13, 14, 18, 14, 18, 13, 14, 13, 13, 14, 15, 13, 14, 15, 15, 13, 15, 13, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09838403688304004, "mean_inference_ms": 0.24434292262634205, "mean_action_processing_ms": 0.04401120886118528, "mean_env_wait_ms": 0.047352650944594836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015108705424576355, "StateBufferConnector_ms": 0.00121499137055102, "ViewRequirementAgentConnector_ms": 0.02848690362285367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1082.087994673025, "num_env_steps_trained_throughput_per_sec": 1082.087994673025, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 3737.238, "sample_time_ms": 1807.686, "load_time_ms": 0.228, "load_throughput": 17560410.299, "learn_time_ms": 1927.224, "learn_throughput": 2075.525, "synch_weights_time_ms": 1.707}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 14104, "training_iteration": 94, "trial_id": "default", "date": "2024-05-22_22-20-42", "timestamp": 1716409242, "time_this_iter_s": 3.701666831970215, "time_total_s": 342.06122303009033, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 342.06122303009033, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 12.9, "ram_util_percent": 60.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.314753096975306, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03541340091458512, "policy_loss": -0.011977312923158689, "vf_loss": 0.04476907976166976, "vf_explained_var": 0.11185762093913171, "kl": 0.020714144458273506, "entropy": 0.4498866773901447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 0.9995864837999094, "episode_reward_min": -1.0, "episode_reward_mean": 0.8272209432238236, "episode_len_mean": 14.347670250896057, "episode_media": {}, "episodes_this_iter": 279, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9995864837999094, 0.7847011099431873, 0.9807096893211036, 0.8134088579216369, 0.9549794302030712, 0.7080252368672166, 0.8950618940340154, 0.9886315783309266, 0.9528964419477042, 0.907972952779464, 0.9427561600204599, 0.9067818828128275, 0.8970957111190679, 0.9425099778888376, 0.8305751575634674, 0.9040355460334584, 0.9542969651819025, 0.9729350107496222, 0.9300800232664972, 0.9664459694865766, 0.6636436849186567, 0.9501170060308177, 0.9251081554156408, 0.9282732208768373, 0.9275656962050887, 0.9692337101887095, 0.9196915045764376, 0.7257997003424161, 0.8955687787710815, 0.8687909186487691, 0.9767424042109643, 0.954357374629052, 0.9657350525819292, 0.9166256128361001, 0.8396369391429482, 0.9005590260249479, 0.9346738541350741, 0.9156826543005104, 0.9842032131433419, 0.9515507761651762, 0.8962659024246646, 0.8273519446991845, 0.9467200505906072, -1.0, 0.9947710106108714, 0.9662098108893428, 0.8874865543424669, 0.9273267442783727, 0.8819972664664871, -1.0, 0.9595089574551529, 0.9362206419586717, 0.9819835346294395, 0.935782393928493, 0.9694309507618403, 0.7703932955960575, 0.8141512715778967, 0.8573724464279842, 0.9157279500453529, 0.8227920962938784, 0.726603287504733, 0.9743094854309683, 0.9570526669328521, 0.9912254037899044, 0.9912323193771126, 0.57633225590016, 0.8917040699543614, 0.9955870735873897, 0.8382686817726771, 0.9694012737703146, 0.8726950266666575, 0.953013792558336, 0.8433331564252066, 0.8998038488366717, 0.9651281250733742, 0.9470237742161794, 0.8317338877216152, 0.8921595047666688, 0.9767154601309819, 0.9200990672530852, 0.8806005082684425, 0.6601713338873327, 0.6654819829953477, 0.944413321125641, 0.9518964589429897, 0.8466080851147626, 0.9930962068500946, 0.9823075581037006, 0.9546947489710369, 0.9576666563854864, 0.6534247401230369, 0.9230389636437227, 0.9840383284084954, -1.0, 0.7907763363604603, 0.9678262028312382, 0.9688514161486134, 0.6086799627324857, 0.993867453623564, 0.9453718197157202, 0.9974244521717047, 0.9935190375926691, 0.9350487275988437, 0.9953448842714678, 0.9084943556679081, 0.841019691794006, 0.7421838071638867, 0.9467007152108302, 0.9544166411034243, 0.829722104030389, 0.607669085863253, 0.9624231542878584, 0.9820934757163681, 0.9824517032585992, -1.0, 0.9668961342408492, 0.9819106409233537, 0.8976368836669975, 0.6094092415013976, 0.8928772876634357, 0.8843148700353757, 0.9085055522151677, 0.9578274213229157, 0.9651031243907381, 0.9783820408940789, 0.7630009761553247, 0.9265490237915802, -1.0, 0.6520725278724054, 0.8647347711931035, 0.9963543642617826, 0.8237703433887873, 0.9314793685647788, 0.964056216516931, 0.5, 0.7635671094280242, 0.9579332417440581, 0.9226969437958518, 0.8601449239216064, 0.9865926117294376, 0.7746784295993878, 0.9905416962225944, 0.5, 0.7098988169560714, 0.9945105597756668, 0.9421086957803272, 0.9602208686694429, 0.9166879783356854, 0.9659973600466162, 0.961415894588258, 0.9664817819400833, 0.9514340238299479, 0.9701424660348061, 0.9969398415621986, 0.8665930978733821, 0.923213728152915, 0.8809575678101744, 0.913914295224399, 0.9686535992903553, 0.9895964379443059, 0.7965805564325255, 0.9134498777411089, 0.9850000949480905, 0.8969057208908521, 0.9841265008780684, 0.9061533335399699, 0.9635845321536984, 0.8599000443895068, 0.9714480853119123, 0.9281936244886073, 0.9898040790372876, 0.9259368938244962, 0.9373785410179608, 0.8471723312570996, 0.8961638959352505, 0.9488888380555923, 0.8753822712379093, 0.8006125763066823, 0.9120407266439626, 0.8123917646238139, 0.8430498994583822, 0.9366827076382372, 0.9787694581846306, 0.9596282531771332, 0.939837841826776, 0.6650399428309206, 0.9501020113274197, 0.9101076209015648, 0.7818070315545966, 0.9391141306799519, 0.9750736451480152, 0.9030401595135736, 0.8364411544628514, 0.9135166299732113, 0.9478758062255823, 0.969541859575631, 0.9876584563142675, 0.9631008966693003, 0.9725270479505681, 0.9184193467022584, 0.9455723886935556, 0.9706244954939551, 0.6687303602135428, 0.9701269045755738, -1.0, 0.8398396614402874, 0.9125292505762913, 0.6071731396441962, 0.938787648831912, 0.6886697478193758, 0.9891198533662414, 0.9456352652388211, 0.9374812863844995, 0.9905662076846062, 0.7686610379767445, 0.9597416161323868, -1.0, 0.9228617573692066, 0.9755558195384556, 0.9395696285298536, 0.9234077082137899, 0.9631262944363876, 0.9123925422880811, 0.861523480001454, -1.0, 0.5, 0.9295075492467347, 0.9144903014052086, 0.7573908953873519, 0.9968737153309944, 0.9742512201264512, 0.869109202454723, 0.9361096879400339, 0.9317643446666863, 0.759352056410806, -1.0, 0.9818959582107488, 0.942472254022109, 0.8420346674115765, 0.928042437817382, 0.8389958785854938, 0.8789497167893673, 0.8728521581074227, 0.7333734512057407, 0.68342228543955, 0.6015291791349602, 0.8968602930925106, 0.9305643943307057, 0.9312230289207957, 0.95935152836115, 0.5990975970745338, 0.9182171071619964, 0.9335012642898824, 0.9710382676883546, 0.8229777242277833, 0.9653758605438885, 0.7027354357344502, 0.936935149696896, 0.9930732483196086, 0.9104316563865736, 0.978162206311515, -1.0, 0.9592924815491995, 0.7019981817226528, 0.9562590122072413, 0.9594758820779824, 0.875775716922728, 0.7341766807352177, 0.9831663733153205, 0.9593393344681035, 0.9399722637631295, 0.941085303155854, 0.8056945467459751, 0.9463918308867121, 0.8958805533200693, 0.8993570439425852, 0.9951467538960425, 0.9770271133445778, 0.7654110564014472], "episode_lengths": [14, 17, 14, 18, 16, 15, 14, 13, 14, 15, 13, 15, 13, 13, 14, 13, 14, 14, 13, 14, 18, 15, 13, 14, 13, 13, 15, 15, 14, 15, 13, 14, 16, 13, 15, 14, 13, 14, 13, 14, 13, 17, 15, 19, 14, 14, 13, 13, 14, 15, 15, 14, 13, 14, 14, 15, 14, 14, 13, 15, 16, 13, 13, 14, 13, 16, 14, 13, 15, 13, 14, 13, 13, 13, 18, 14, 16, 14, 13, 14, 14, 21, 19, 13, 13, 16, 13, 14, 16, 13, 16, 13, 13, 12, 15, 13, 13, 17, 13, 14, 13, 15, 14, 14, 14, 15, 15, 15, 13, 13, 16, 14, 14, 14, 16, 14, 13, 14, 15, 16, 15, 14, 13, 13, 13, 17, 15, 12, 16, 13, 15, 16, 14, 13, 17, 17, 13, 13, 13, 14, 16, 15, 16, 15, 14, 16, 13, 16, 14, 13, 13, 13, 13, 13, 13, 14, 13, 13, 13, 14, 26, 13, 15, 14, 14, 13, 13, 15, 15, 13, 15, 16, 14, 13, 15, 14, 14, 14, 13, 15, 15, 13, 13, 13, 13, 14, 14, 13, 16, 14, 13, 14, 18, 13, 14, 13, 14, 15, 13, 16, 13, 13, 17, 13, 10, 16, 14, 16, 13, 16, 15, 13, 13, 13, 19, 16, 13, 13, 13, 17, 13, 15, 13, 13, 12, 16, 14, 13, 16, 14, 14, 18, 14, 13, 16, 16, 15, 15, 20, 14, 13, 16, 14, 17, 15, 17, 15, 13, 14, 13, 15, 15, 15, 14, 14, 14, 15, 15, 15, 13, 15, 11, 13, 15, 14, 13, 14, 17, 14, 13, 14, 13, 14, 15, 13, 19, 14, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09865183405136926, "mean_inference_ms": 0.2447214280705297, "mean_action_processing_ms": 0.0440851406633968, "mean_env_wait_ms": 0.04742302963193913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017991629979943716, "StateBufferConnector_ms": 0.001327624030437948, "ViewRequirementAgentConnector_ms": 0.03097065887998082}}, "episode_reward_max": 0.9995864837999094, "episode_reward_min": -1.0, "episode_reward_mean": 0.8272209432238236, "episode_len_mean": 14.347670250896057, "episodes_this_iter": 279, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9995864837999094, 0.7847011099431873, 0.9807096893211036, 0.8134088579216369, 0.9549794302030712, 0.7080252368672166, 0.8950618940340154, 0.9886315783309266, 0.9528964419477042, 0.907972952779464, 0.9427561600204599, 0.9067818828128275, 0.8970957111190679, 0.9425099778888376, 0.8305751575634674, 0.9040355460334584, 0.9542969651819025, 0.9729350107496222, 0.9300800232664972, 0.9664459694865766, 0.6636436849186567, 0.9501170060308177, 0.9251081554156408, 0.9282732208768373, 0.9275656962050887, 0.9692337101887095, 0.9196915045764376, 0.7257997003424161, 0.8955687787710815, 0.8687909186487691, 0.9767424042109643, 0.954357374629052, 0.9657350525819292, 0.9166256128361001, 0.8396369391429482, 0.9005590260249479, 0.9346738541350741, 0.9156826543005104, 0.9842032131433419, 0.9515507761651762, 0.8962659024246646, 0.8273519446991845, 0.9467200505906072, -1.0, 0.9947710106108714, 0.9662098108893428, 0.8874865543424669, 0.9273267442783727, 0.8819972664664871, -1.0, 0.9595089574551529, 0.9362206419586717, 0.9819835346294395, 0.935782393928493, 0.9694309507618403, 0.7703932955960575, 0.8141512715778967, 0.8573724464279842, 0.9157279500453529, 0.8227920962938784, 0.726603287504733, 0.9743094854309683, 0.9570526669328521, 0.9912254037899044, 0.9912323193771126, 0.57633225590016, 0.8917040699543614, 0.9955870735873897, 0.8382686817726771, 0.9694012737703146, 0.8726950266666575, 0.953013792558336, 0.8433331564252066, 0.8998038488366717, 0.9651281250733742, 0.9470237742161794, 0.8317338877216152, 0.8921595047666688, 0.9767154601309819, 0.9200990672530852, 0.8806005082684425, 0.6601713338873327, 0.6654819829953477, 0.944413321125641, 0.9518964589429897, 0.8466080851147626, 0.9930962068500946, 0.9823075581037006, 0.9546947489710369, 0.9576666563854864, 0.6534247401230369, 0.9230389636437227, 0.9840383284084954, -1.0, 0.7907763363604603, 0.9678262028312382, 0.9688514161486134, 0.6086799627324857, 0.993867453623564, 0.9453718197157202, 0.9974244521717047, 0.9935190375926691, 0.9350487275988437, 0.9953448842714678, 0.9084943556679081, 0.841019691794006, 0.7421838071638867, 0.9467007152108302, 0.9544166411034243, 0.829722104030389, 0.607669085863253, 0.9624231542878584, 0.9820934757163681, 0.9824517032585992, -1.0, 0.9668961342408492, 0.9819106409233537, 0.8976368836669975, 0.6094092415013976, 0.8928772876634357, 0.8843148700353757, 0.9085055522151677, 0.9578274213229157, 0.9651031243907381, 0.9783820408940789, 0.7630009761553247, 0.9265490237915802, -1.0, 0.6520725278724054, 0.8647347711931035, 0.9963543642617826, 0.8237703433887873, 0.9314793685647788, 0.964056216516931, 0.5, 0.7635671094280242, 0.9579332417440581, 0.9226969437958518, 0.8601449239216064, 0.9865926117294376, 0.7746784295993878, 0.9905416962225944, 0.5, 0.7098988169560714, 0.9945105597756668, 0.9421086957803272, 0.9602208686694429, 0.9166879783356854, 0.9659973600466162, 0.961415894588258, 0.9664817819400833, 0.9514340238299479, 0.9701424660348061, 0.9969398415621986, 0.8665930978733821, 0.923213728152915, 0.8809575678101744, 0.913914295224399, 0.9686535992903553, 0.9895964379443059, 0.7965805564325255, 0.9134498777411089, 0.9850000949480905, 0.8969057208908521, 0.9841265008780684, 0.9061533335399699, 0.9635845321536984, 0.8599000443895068, 0.9714480853119123, 0.9281936244886073, 0.9898040790372876, 0.9259368938244962, 0.9373785410179608, 0.8471723312570996, 0.8961638959352505, 0.9488888380555923, 0.8753822712379093, 0.8006125763066823, 0.9120407266439626, 0.8123917646238139, 0.8430498994583822, 0.9366827076382372, 0.9787694581846306, 0.9596282531771332, 0.939837841826776, 0.6650399428309206, 0.9501020113274197, 0.9101076209015648, 0.7818070315545966, 0.9391141306799519, 0.9750736451480152, 0.9030401595135736, 0.8364411544628514, 0.9135166299732113, 0.9478758062255823, 0.969541859575631, 0.9876584563142675, 0.9631008966693003, 0.9725270479505681, 0.9184193467022584, 0.9455723886935556, 0.9706244954939551, 0.6687303602135428, 0.9701269045755738, -1.0, 0.8398396614402874, 0.9125292505762913, 0.6071731396441962, 0.938787648831912, 0.6886697478193758, 0.9891198533662414, 0.9456352652388211, 0.9374812863844995, 0.9905662076846062, 0.7686610379767445, 0.9597416161323868, -1.0, 0.9228617573692066, 0.9755558195384556, 0.9395696285298536, 0.9234077082137899, 0.9631262944363876, 0.9123925422880811, 0.861523480001454, -1.0, 0.5, 0.9295075492467347, 0.9144903014052086, 0.7573908953873519, 0.9968737153309944, 0.9742512201264512, 0.869109202454723, 0.9361096879400339, 0.9317643446666863, 0.759352056410806, -1.0, 0.9818959582107488, 0.942472254022109, 0.8420346674115765, 0.928042437817382, 0.8389958785854938, 0.8789497167893673, 0.8728521581074227, 0.7333734512057407, 0.68342228543955, 0.6015291791349602, 0.8968602930925106, 0.9305643943307057, 0.9312230289207957, 0.95935152836115, 0.5990975970745338, 0.9182171071619964, 0.9335012642898824, 0.9710382676883546, 0.8229777242277833, 0.9653758605438885, 0.7027354357344502, 0.936935149696896, 0.9930732483196086, 0.9104316563865736, 0.978162206311515, -1.0, 0.9592924815491995, 0.7019981817226528, 0.9562590122072413, 0.9594758820779824, 0.875775716922728, 0.7341766807352177, 0.9831663733153205, 0.9593393344681035, 0.9399722637631295, 0.941085303155854, 0.8056945467459751, 0.9463918308867121, 0.8958805533200693, 0.8993570439425852, 0.9951467538960425, 0.9770271133445778, 0.7654110564014472], "episode_lengths": [14, 17, 14, 18, 16, 15, 14, 13, 14, 15, 13, 15, 13, 13, 14, 13, 14, 14, 13, 14, 18, 15, 13, 14, 13, 13, 15, 15, 14, 15, 13, 14, 16, 13, 15, 14, 13, 14, 13, 14, 13, 17, 15, 19, 14, 14, 13, 13, 14, 15, 15, 14, 13, 14, 14, 15, 14, 14, 13, 15, 16, 13, 13, 14, 13, 16, 14, 13, 15, 13, 14, 13, 13, 13, 18, 14, 16, 14, 13, 14, 14, 21, 19, 13, 13, 16, 13, 14, 16, 13, 16, 13, 13, 12, 15, 13, 13, 17, 13, 14, 13, 15, 14, 14, 14, 15, 15, 15, 13, 13, 16, 14, 14, 14, 16, 14, 13, 14, 15, 16, 15, 14, 13, 13, 13, 17, 15, 12, 16, 13, 15, 16, 14, 13, 17, 17, 13, 13, 13, 14, 16, 15, 16, 15, 14, 16, 13, 16, 14, 13, 13, 13, 13, 13, 13, 14, 13, 13, 13, 14, 26, 13, 15, 14, 14, 13, 13, 15, 15, 13, 15, 16, 14, 13, 15, 14, 14, 14, 13, 15, 15, 13, 13, 13, 13, 14, 14, 13, 16, 14, 13, 14, 18, 13, 14, 13, 14, 15, 13, 16, 13, 13, 17, 13, 10, 16, 14, 16, 13, 16, 15, 13, 13, 13, 19, 16, 13, 13, 13, 17, 13, 15, 13, 13, 12, 16, 14, 13, 16, 14, 14, 18, 14, 13, 16, 16, 15, 15, 20, 14, 13, 16, 14, 17, 15, 17, 15, 13, 14, 13, 15, 15, 15, 14, 14, 14, 15, 15, 15, 13, 15, 11, 13, 15, 14, 13, 14, 17, 14, 13, 14, 13, 14, 15, 13, 19, 14, 14, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09865183405136926, "mean_inference_ms": 0.2447214280705297, "mean_action_processing_ms": 0.0440851406633968, "mean_env_wait_ms": 0.04742302963193913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017991629979943716, "StateBufferConnector_ms": 0.001327624030437948, "ViewRequirementAgentConnector_ms": 0.03097065887998082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1001.4528250878939, "num_env_steps_trained_throughput_per_sec": 1001.4528250878939, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 3762.9, "sample_time_ms": 1839.947, "load_time_ms": 0.23, "load_throughput": 17371314.972, "learn_time_ms": 1920.629, "learn_throughput": 2082.651, "synch_weights_time_ms": 1.703}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 14383, "training_iteration": 95, "trial_id": "default", "date": "2024-05-22_22-20-46", "timestamp": 1716409246, "time_this_iter_s": 3.999282121658325, "time_total_s": 346.06050515174866, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 346.06050515174866, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 28.533333333333335, "ram_util_percent": 60.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.85118061656593, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.027048916475326625, "policy_loss": 0.0004578241019419605, "vf_loss": 0.024789928463387793, "vf_explained_var": 0.19863639871279398, "kl": 0.009487615177008543, "entropy": 0.37466577240215837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88815.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 0.9998782072737039, "episode_reward_min": -1.0, "episode_reward_mean": 0.8796223737908146, "episode_len_mean": 14.264285714285714, "episode_media": {}, "episodes_this_iter": 280, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9897925926603267, 0.9388714759379587, 0.9631871119969165, 0.9853463868464777, 0.957494849568808, 0.714827815105006, 0.9582665463949653, 0.9679100754880344, 0.9776510682136239, 0.8657394033765768, 0.99714528150734, 0.8795914654141763, 0.9424297307908006, 0.9670841125220181, 0.9521297197655555, 0.9691433777377099, 0.9834704117650742, 0.8223604882096813, 0.9426856999130508, 0.9781500267589411, 0.9619003683518224, 0.9976703531281975, 0.9736579050421881, 0.9072341816634374, 0.8892390904991915, 0.9967354807593699, 0.9509909255005273, 0.894948994272167, 0.9650597686457534, 0.9880894727631471, 0.8385088217913587, 0.734817462243111, 0.9142888117472605, 0.9145742699592336, 0.8602606832227646, 0.9757690505734643, 0.9190743858734207, 0.9964845694587181, 0.916948776788197, 0.9309282492090623, 0.9400166613758815, 0.9088876096549534, 0.6767685167116397, 0.7575862298558971, 0.822889976556358, 0.5604605637389137, 0.9421607391637201, 0.9225067789569505, 0.8378915455987351, 0.981432780477867, 0.9400515223169849, 0.9829070988096907, 0.9951640287521125, 0.9910905943759465, 0.8690628303232225, 0.8675045402815738, 0.9810203900892335, 0.9602613297573782, 0.9723996252718431, 0.9782062471180367, 0.9965291281138565, 0.9648696876010949, 0.880346799186762, 0.5, 0.9814834893819971, 0.9431225485418938, 0.9941254147807187, 0.611452065105164, 0.7958747073290271, 0.9307996680939801, 0.956849602220637, 0.8872319509967173, 0.985562758037428, 0.9882014312642743, 0.9542756032909278, 0.9128972384000784, 0.9805936198295335, 0.9753849448753142, 0.6347782936211204, 0.9537800159646744, 0.9933723872999651, 0.94508184176016, 0.9504057206728688, 0.9152918190930284, 0.8388322229479552, 0.9607144795688032, 0.9837574552474581, 0.8446675054005901, 0.983173691598039, 0.9919636385331463, 0.9141920604999711, 0.9711061774039428, 0.959723511056359, 0.9169896532158239, 0.9804899208662947, 0.9839732368470409, 0.9877349001128453, 0.9719671427541404, 0.8938531519422079, 0.9213538063407977, 0.9337620793102189, 0.9151653641272959, 0.9141302997053786, 0.7654844371514591, 0.9758645380723256, 0.9159697302880159, 0.8636797450761243, 0.9796881086629387, 0.9962073016617403, 0.9553254429413598, 0.9807885248602971, 0.9926361896269915, 0.9831196783103946, 0.9647966340815248, 0.6632903897993904, 0.9914010161281946, 0.7315891351466258, -1.0, 0.957822043413729, 0.9821422149728006, 0.983744110641433, 0.9770751337303615, 0.8895853330265162, 0.8892683631424622, 0.8612732563290261, 0.9698055499342471, 0.9632204366066074, 0.9534486720661999, 0.7975053951111855, 0.9284435329889373, 0.9964247671882357, 0.7632101493778747, 0.9559454999126663, 0.9479824170151031, 0.8293900624333933, 0.9559142855279315, 0.716463734594465, 0.5121409759854998, 0.9559582912735611, 0.9969697456344246, 0.9849018273192542, 0.971753996233218, 0.6556643728953997, 0.9783729845379854, 0.9325404706297371, 0.7713840536594361, 0.9464419458809542, 0.9364949592253698, 0.9713374721546251, 0.6993302966105501, 0.9851417714368562, 0.8310477155305406, 0.9448778356802578, 0.82540561320446, 0.9144873641656858, 0.7511034456769604, 0.6781088468621148, 0.9888278503241942, 0.9991878356862837, 0.9871946056112738, 0.8098506808980406, 0.9386407386521636, 0.9070646198812181, 0.9134719947704284, 0.958154434315408, 0.6999055838010685, 0.9783870021616082, 0.9310535912265773, 0.9897049355438389, 0.9521826247021051, 0.9423287784120361, 0.9848757268765272, 0.9436516106586128, 0.8517303065463635, 0.9658705302781666, 0.9331326048569085, 0.9968913584203618, 0.7521481054324591, 0.8485664962729549, 0.9998782072737039, 0.9985731630676691, 0.5, 0.9783216955985485, 0.9962227649341217, 0.9830068782966026, 0.9647057876849267, 0.8586942237254996, 0.9970335486677323, -1.0, 0.9836617054218191, 0.8670750918213146, 0.9725867159921514, 0.9308860478336337, 0.5099266301182488, 0.9200758549861767, 0.932045358494547, 0.9421757435899589, 0.9909892335609728, 0.9025150136776311, 0.9579773469773357, 0.7951890762372626, 0.993394464407229, 0.6287076705734738, 0.6795304806208728, 0.9573174336809731, 0.9089801778002965, 0.9484108158176129, 0.9073547489662516, 0.8271229970437313, 0.9922662688958894, 0.6645018988271992, 0.9269939532448419, 0.9943703209577819, 0.9960723074872847, 0.8787198906936835, 0.9842343237234932, 0.9948233269943829, 0.9614266686382916, 0.6292815670581513, 0.9294745828054072, 0.9864073738845918, 0.9457976982107483, 0.8865270540432059, 0.9435483094562346, 0.9836341912987474, 0.9234668380190995, 0.9236640572846015, 0.8493181244816725, 0.9946413314905317, 0.9020491036547237, 0.8569493584407947, 0.8332568121773214, 0.8994414332451856, 0.9827358777097568, 0.9223762887159623, 0.9762715728032045, 0.8689229728459534, 0.570921874121521, 0.9846068175344145, 0.9690566652028036, 0.8665735373863613, -1.0, 0.8816340134049798, 0.9683319545546445, 0.5, 0.9073690322614157, 0.9611713984038475, 0.8403292896610837, 0.9368119128182916, 0.9823770205779062, 0.9745195623264178, 0.7850128422181001, 0.887413452794902, 0.7618880601597782, 0.969576658112738, 0.9617201520203694, -1.0, 0.9805313494613626, 0.8865827003978809, 0.9913435724272702, 0.9503800542572652, 0.8562670888581397, 0.9591916828811107, 0.917046413152188, 0.9485503095657161, 0.9739236220489241, 0.8333386897787025, 0.9708074161506401, 0.9319444785990927, 0.8657584819214138, 0.7345247414719853, 0.7113763590235417, 0.957884880709335, 0.7229176580479388, 0.9754208680765696, 0.9898614790356075, 0.8280271669628104, 0.9730411296185436, 0.9873972981123329, 0.9119188600131738], "episode_lengths": [14, 17, 13, 13, 15, 14, 13, 14, 14, 15, 13, 17, 13, 14, 13, 15, 15, 17, 13, 13, 13, 15, 14, 14, 13, 15, 13, 16, 14, 14, 14, 17, 13, 13, 14, 15, 14, 13, 13, 13, 14, 15, 18, 14, 16, 15, 15, 14, 15, 13, 13, 14, 13, 17, 15, 15, 13, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 20, 19, 13, 14, 13, 14, 15, 13, 14, 14, 14, 19, 15, 13, 13, 15, 14, 17, 13, 14, 13, 13, 14, 13, 17, 14, 14, 14, 14, 15, 15, 14, 16, 14, 15, 13, 14, 14, 13, 15, 19, 14, 15, 16, 13, 13, 13, 16, 13, 15, 10, 13, 13, 14, 16, 14, 14, 14, 13, 14, 13, 16, 14, 16, 19, 14, 13, 15, 14, 19, 15, 13, 13, 13, 15, 15, 14, 13, 15, 19, 13, 16, 15, 14, 14, 14, 13, 14, 16, 19, 15, 13, 13, 15, 13, 13, 14, 13, 15, 13, 13, 13, 13, 14, 14, 14, 15, 13, 13, 13, 15, 14, 13, 15, 16, 14, 13, 14, 13, 14, 13, 14, 14, 13, 13, 15, 17, 13, 15, 13, 14, 13, 14, 15, 13, 15, 17, 13, 13, 13, 14, 14, 16, 17, 14, 13, 13, 16, 13, 14, 15, 15, 13, 14, 14, 15, 14, 14, 13, 13, 18, 15, 13, 15, 19, 14, 13, 14, 13, 14, 17, 13, 14, 15, 13, 14, 15, 15, 15, 14, 17, 13, 14, 13, 16, 14, 17, 14, 13, 11, 13, 15, 14, 13, 13, 13, 14, 13, 13, 18, 14, 16, 15, 14, 15, 13, 16, 15, 14, 13, 14, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09876620567373216, "mean_inference_ms": 0.24473682821997908, "mean_action_processing_ms": 0.044089214923747795, "mean_env_wait_ms": 0.04743774175127969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015713487352643693, "StateBufferConnector_ms": 0.001244800431387765, "ViewRequirementAgentConnector_ms": 0.028943674904959544}}, "episode_reward_max": 0.9998782072737039, "episode_reward_min": -1.0, "episode_reward_mean": 0.8796223737908146, "episode_len_mean": 14.264285714285714, "episodes_this_iter": 280, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9897925926603267, 0.9388714759379587, 0.9631871119969165, 0.9853463868464777, 0.957494849568808, 0.714827815105006, 0.9582665463949653, 0.9679100754880344, 0.9776510682136239, 0.8657394033765768, 0.99714528150734, 0.8795914654141763, 0.9424297307908006, 0.9670841125220181, 0.9521297197655555, 0.9691433777377099, 0.9834704117650742, 0.8223604882096813, 0.9426856999130508, 0.9781500267589411, 0.9619003683518224, 0.9976703531281975, 0.9736579050421881, 0.9072341816634374, 0.8892390904991915, 0.9967354807593699, 0.9509909255005273, 0.894948994272167, 0.9650597686457534, 0.9880894727631471, 0.8385088217913587, 0.734817462243111, 0.9142888117472605, 0.9145742699592336, 0.8602606832227646, 0.9757690505734643, 0.9190743858734207, 0.9964845694587181, 0.916948776788197, 0.9309282492090623, 0.9400166613758815, 0.9088876096549534, 0.6767685167116397, 0.7575862298558971, 0.822889976556358, 0.5604605637389137, 0.9421607391637201, 0.9225067789569505, 0.8378915455987351, 0.981432780477867, 0.9400515223169849, 0.9829070988096907, 0.9951640287521125, 0.9910905943759465, 0.8690628303232225, 0.8675045402815738, 0.9810203900892335, 0.9602613297573782, 0.9723996252718431, 0.9782062471180367, 0.9965291281138565, 0.9648696876010949, 0.880346799186762, 0.5, 0.9814834893819971, 0.9431225485418938, 0.9941254147807187, 0.611452065105164, 0.7958747073290271, 0.9307996680939801, 0.956849602220637, 0.8872319509967173, 0.985562758037428, 0.9882014312642743, 0.9542756032909278, 0.9128972384000784, 0.9805936198295335, 0.9753849448753142, 0.6347782936211204, 0.9537800159646744, 0.9933723872999651, 0.94508184176016, 0.9504057206728688, 0.9152918190930284, 0.8388322229479552, 0.9607144795688032, 0.9837574552474581, 0.8446675054005901, 0.983173691598039, 0.9919636385331463, 0.9141920604999711, 0.9711061774039428, 0.959723511056359, 0.9169896532158239, 0.9804899208662947, 0.9839732368470409, 0.9877349001128453, 0.9719671427541404, 0.8938531519422079, 0.9213538063407977, 0.9337620793102189, 0.9151653641272959, 0.9141302997053786, 0.7654844371514591, 0.9758645380723256, 0.9159697302880159, 0.8636797450761243, 0.9796881086629387, 0.9962073016617403, 0.9553254429413598, 0.9807885248602971, 0.9926361896269915, 0.9831196783103946, 0.9647966340815248, 0.6632903897993904, 0.9914010161281946, 0.7315891351466258, -1.0, 0.957822043413729, 0.9821422149728006, 0.983744110641433, 0.9770751337303615, 0.8895853330265162, 0.8892683631424622, 0.8612732563290261, 0.9698055499342471, 0.9632204366066074, 0.9534486720661999, 0.7975053951111855, 0.9284435329889373, 0.9964247671882357, 0.7632101493778747, 0.9559454999126663, 0.9479824170151031, 0.8293900624333933, 0.9559142855279315, 0.716463734594465, 0.5121409759854998, 0.9559582912735611, 0.9969697456344246, 0.9849018273192542, 0.971753996233218, 0.6556643728953997, 0.9783729845379854, 0.9325404706297371, 0.7713840536594361, 0.9464419458809542, 0.9364949592253698, 0.9713374721546251, 0.6993302966105501, 0.9851417714368562, 0.8310477155305406, 0.9448778356802578, 0.82540561320446, 0.9144873641656858, 0.7511034456769604, 0.6781088468621148, 0.9888278503241942, 0.9991878356862837, 0.9871946056112738, 0.8098506808980406, 0.9386407386521636, 0.9070646198812181, 0.9134719947704284, 0.958154434315408, 0.6999055838010685, 0.9783870021616082, 0.9310535912265773, 0.9897049355438389, 0.9521826247021051, 0.9423287784120361, 0.9848757268765272, 0.9436516106586128, 0.8517303065463635, 0.9658705302781666, 0.9331326048569085, 0.9968913584203618, 0.7521481054324591, 0.8485664962729549, 0.9998782072737039, 0.9985731630676691, 0.5, 0.9783216955985485, 0.9962227649341217, 0.9830068782966026, 0.9647057876849267, 0.8586942237254996, 0.9970335486677323, -1.0, 0.9836617054218191, 0.8670750918213146, 0.9725867159921514, 0.9308860478336337, 0.5099266301182488, 0.9200758549861767, 0.932045358494547, 0.9421757435899589, 0.9909892335609728, 0.9025150136776311, 0.9579773469773357, 0.7951890762372626, 0.993394464407229, 0.6287076705734738, 0.6795304806208728, 0.9573174336809731, 0.9089801778002965, 0.9484108158176129, 0.9073547489662516, 0.8271229970437313, 0.9922662688958894, 0.6645018988271992, 0.9269939532448419, 0.9943703209577819, 0.9960723074872847, 0.8787198906936835, 0.9842343237234932, 0.9948233269943829, 0.9614266686382916, 0.6292815670581513, 0.9294745828054072, 0.9864073738845918, 0.9457976982107483, 0.8865270540432059, 0.9435483094562346, 0.9836341912987474, 0.9234668380190995, 0.9236640572846015, 0.8493181244816725, 0.9946413314905317, 0.9020491036547237, 0.8569493584407947, 0.8332568121773214, 0.8994414332451856, 0.9827358777097568, 0.9223762887159623, 0.9762715728032045, 0.8689229728459534, 0.570921874121521, 0.9846068175344145, 0.9690566652028036, 0.8665735373863613, -1.0, 0.8816340134049798, 0.9683319545546445, 0.5, 0.9073690322614157, 0.9611713984038475, 0.8403292896610837, 0.9368119128182916, 0.9823770205779062, 0.9745195623264178, 0.7850128422181001, 0.887413452794902, 0.7618880601597782, 0.969576658112738, 0.9617201520203694, -1.0, 0.9805313494613626, 0.8865827003978809, 0.9913435724272702, 0.9503800542572652, 0.8562670888581397, 0.9591916828811107, 0.917046413152188, 0.9485503095657161, 0.9739236220489241, 0.8333386897787025, 0.9708074161506401, 0.9319444785990927, 0.8657584819214138, 0.7345247414719853, 0.7113763590235417, 0.957884880709335, 0.7229176580479388, 0.9754208680765696, 0.9898614790356075, 0.8280271669628104, 0.9730411296185436, 0.9873972981123329, 0.9119188600131738], "episode_lengths": [14, 17, 13, 13, 15, 14, 13, 14, 14, 15, 13, 17, 13, 14, 13, 15, 15, 17, 13, 13, 13, 15, 14, 14, 13, 15, 13, 16, 14, 14, 14, 17, 13, 13, 14, 15, 14, 13, 13, 13, 14, 15, 18, 14, 16, 15, 15, 14, 15, 13, 13, 14, 13, 17, 15, 15, 13, 13, 13, 13, 13, 13, 13, 15, 13, 15, 13, 20, 19, 13, 14, 13, 14, 15, 13, 14, 14, 14, 19, 15, 13, 13, 15, 14, 17, 13, 14, 13, 13, 14, 13, 17, 14, 14, 14, 14, 15, 15, 14, 16, 14, 15, 13, 14, 14, 13, 15, 19, 14, 15, 16, 13, 13, 13, 16, 13, 15, 10, 13, 13, 14, 16, 14, 14, 14, 13, 14, 13, 16, 14, 16, 19, 14, 13, 15, 14, 19, 15, 13, 13, 13, 15, 15, 14, 13, 15, 19, 13, 16, 15, 14, 14, 14, 13, 14, 16, 19, 15, 13, 13, 15, 13, 13, 14, 13, 15, 13, 13, 13, 13, 14, 14, 14, 15, 13, 13, 13, 15, 14, 13, 15, 16, 14, 13, 14, 13, 14, 13, 14, 14, 13, 13, 15, 17, 13, 15, 13, 14, 13, 14, 15, 13, 15, 17, 13, 13, 13, 14, 14, 16, 17, 14, 13, 13, 16, 13, 14, 15, 15, 13, 14, 14, 15, 14, 14, 13, 13, 18, 15, 13, 15, 19, 14, 13, 14, 13, 14, 17, 13, 14, 15, 13, 14, 15, 15, 15, 14, 17, 13, 14, 13, 16, 14, 17, 14, 13, 11, 13, 15, 14, 13, 13, 13, 14, 13, 13, 18, 14, 16, 15, 14, 15, 13, 16, 15, 14, 13, 14, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09876620567373216, "mean_inference_ms": 0.24473682821997908, "mean_action_processing_ms": 0.044089214923747795, "mean_env_wait_ms": 0.04743774175127969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015713487352643693, "StateBufferConnector_ms": 0.001244800431387765, "ViewRequirementAgentConnector_ms": 0.028943674904959544}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1072.4587857867066, "num_env_steps_trained_throughput_per_sec": 1072.4587857867066, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 3765.94, "sample_time_ms": 1842.71, "load_time_ms": 0.227, "load_throughput": 17634240.067, "learn_time_ms": 1920.911, "learn_throughput": 2082.346, "synch_weights_time_ms": 1.702}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 14663, "training_iteration": 96, "trial_id": "default", "date": "2024-05-22_22-20-50", "timestamp": 1716409250, "time_this_iter_s": 3.7349748611450195, "time_total_s": 349.7954800128937, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 349.7954800128937, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 21.8, "ram_util_percent": 60.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4598037171748377, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0343463284033601, "policy_loss": -0.007151761522857091, "vf_loss": 0.039784021141578356, "vf_explained_var": 0.0659461042573375, "kl": 0.009028836898380778, "entropy": 0.3709183370554319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89745.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 0.9996406961148401, "episode_reward_min": -1.0, "episode_reward_mean": 0.8560661299810757, "episode_len_mean": 14.310714285714285, "episode_media": {}, "episodes_this_iter": 280, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9094748913128438, 0.9360745508204137, 0.9146520198993956, 0.9002071379874652, 0.9879512573052681, 0.9990197593490469, 0.9198219951119943, 0.7717736833788196, 0.9798339830806136, 0.852521207043997, 0.8779286900649468, 0.825468118903617, 0.9820293995073273, 0.8045180076701767, 0.9791153275416876, 0.9967210790925941, 0.9100676678252075, 0.9807286753577036, 0.8485071618149366, 0.9846371685953467, 0.9959072942297262, 0.9614675961706637, 0.8076865728546732, 0.9862608867906036, 0.8605281495382555, 0.9238813187039525, 0.9821479685759368, 0.9894231403915528, 0.8217715132946849, 0.9648918693614688, 0.9574551537244016, 0.9355836913598128, 0.8869762790968576, 0.9800585117855345, 0.8110882842316995, 0.9963622219127952, 0.5897058873771723, 0.9964978408315314, 0.9007237653479455, 0.7279560747917122, 0.6680989248273923, 0.9863184598687409, 0.6292613811457086, -1.0, 0.9566198054110999, 0.9799158494828669, 0.7686628563256734, 0.9658686433405289, 0.9035609886751944, 0.973815192304496, 0.8866301808198522, 0.9110277550087438, 0.8528092354456533, 0.8826816147177176, 0.9602841157184949, 0.9481770758123668, 0.926273068658143, 0.9377178122084123, 0.9317445919318016, 0.9137524956537508, 0.5743990411216309, 0.8446352792713202, 0.6916062044255278, 0.8794884235337627, -1.0, 0.9506627560552854, 0.8465269338068924, 0.9598589495559461, 0.9556919541915556, 0.9809958579922102, 0.9948872611097964, 0.8951493838272117, 0.8988427308865418, 0.9149579978895077, 0.9884851075813592, 0.9633213112854461, 0.9393005435325312, 0.957735943379826, 0.9214041442720546, 0.9437767133226995, 0.9267400293809995, 0.9741963467203899, 0.7152533344488334, 0.985353825071464, 0.9657695913096825, 0.9802337152059041, 0.792323208284225, 0.9868177366599084, 0.9249561461395756, 0.5182590743616939, 0.9663071852122949, 0.8964305417123924, 0.8264950732915053, 0.9946893985345963, 0.663882388067585, 0.9892968387668747, 0.9179878532484721, -1.0, 0.9541867682646563, -1.0, 0.9793912607675372, 0.8418081452135419, 0.9795235513504629, 0.8976441027511257, 0.9308601285583823, 0.8656511017392463, 0.9774466221332859, 0.9792487980785339, 0.8959130055490276, 0.968312834809409, 0.9144136236023505, -1.0, 0.9367091442139914, 0.9685312772522096, 0.9158009733348275, 0.9017139428695353, 0.9634070278543795, 0.8807512325610853, 0.9595494894865143, 0.9506177723888048, 0.9884021910438908, 0.9624201658621568, 0.9533430281446139, 0.9816481183700881, 0.7341758596487133, 0.8874490408219986, 0.8878171817148042, 0.848821100641336, 0.8806297781778665, 0.9962507704988732, 0.947600059621952, 0.8569504068785544, -1.0, 0.8426985821873573, 0.9690268603739397, 0.8776204943783643, 0.9053844844711851, 0.6267538386944549, 0.9464307332919123, 0.9515839834401928, 0.8138522017912363, 0.9977448587971625, 0.9764941052674495, 0.9939508775718463, 0.9013908198260026, 0.991906793119666, 0.9417082034602839, 0.965719246734408, 0.9865205958358148, 0.9642537816980238, 0.8779663259321109, 0.9388611106390987, 0.962008991520563, 0.9824686756133149, 0.9049522239968039, 0.8271007316490466, 0.9704149653366043, 0.996419309396635, 0.9802644069470948, 0.8238848032234374, 0.9018046464037053, 0.835705639374728, 0.9813095652135879, 0.9314211106892805, 0.894778736670561, 0.9874359198926568, 0.8421989224134874, 0.9433056996602153, 0.6315319593079187, 0.9663572381938259, 0.7977106612410589, -1.0, 0.957835788761326, 0.9916358963673593, 0.9218471985566074, 0.707392884759637, 0.9464023668147191, 0.8117762780425186, 0.9297009868233718, 0.8676690508122834, 0.8897710421942387, 0.9514251790340484, 0.939403911391494, 0.958258101270422, 0.9741634325511669, 0.8904025724554185, 0.8791821755511985, 0.9441779155142593, 0.8117714469572581, 0.9178328786033387, 0.8763546090662642, 0.9380715422744242, 0.867593306999217, 0.9037353598557827, 0.9338806737417512, 0.9786764575992617, 0.8254641245617546, 0.7312995217413994, 0.7319316975141669, 0.9523423434017422, 0.971696369818057, -1.0, 0.9629372445112148, 0.9584555581921634, 0.6569834662050986, 0.911066459055623, 0.9358869138126591, 0.9206348287616862, 0.9567461754303855, 0.9103872411092033, 0.9890907727979011, 0.951934855588234, 0.667056071393525, 0.9807712599760714, 0.9869195984345286, 0.9448007885792374, 0.9481498444391665, 0.7703763672710954, 0.9628457873056758, 0.9968555937559058, 0.999000290823679, 0.9334838174105661, 0.9330395796185718, 0.9947643972122366, 0.9551955853070677, 0.9642835563981493, 0.9607681793562487, 0.8775705168226887, 0.8277485978928558, 0.98082397066718, 0.9733129538842019, 0.9549446018079943, 0.8089516330382284, 0.9467575586923848, 0.9923115108741039, 0.8522103466692307, 0.747397704437359, 0.6640131134532397, 0.9315724704296376, 0.8998210580877329, 0.9284371627117108, 0.9243016199180316, 0.8901337445651959, 0.9717922754843152, 0.9951290717891133, 0.9698441038185998, 0.94242800787679, 0.9151799946069458, 0.9677406326263446, 0.9996406961148401, 0.7617321921625866, 0.9412444882634332, 0.9399955793992478, 0.9629537596328722, 0.9348803559647906, 0.9943805027686557, 0.8545293875349543, 0.9153202260490944, 0.9565720504382174, 0.9040935681021165, 0.7310329857297371, 0.9649946999774494, 0.9858325030604728, 0.9318894365098394, 0.985451730423024, 0.8561455231095649, 0.9838189166672353, 0.9286215592868052, 0.8309967662691761, 0.8924426273077042, 0.9613436919696593, 0.9910255837206718, 0.9711084391204375, 0.9437561340272335, 0.987374667853297, 0.9940793304451631, 0.9395594564807318, 0.9465058167781536, 0.8303577250518734, 0.994988717240556], "episode_lengths": [13, 14, 15, 14, 13, 13, 13, 18, 13, 15, 16, 14, 14, 21, 13, 13, 15, 14, 14, 13, 13, 13, 15, 14, 15, 13, 14, 15, 15, 14, 16, 15, 14, 15, 14, 13, 16, 14, 13, 19, 18, 13, 16, 10, 15, 14, 17, 15, 16, 13, 13, 14, 14, 18, 14, 15, 15, 14, 14, 14, 15, 19, 16, 13, 10, 14, 14, 15, 15, 13, 14, 16, 18, 13, 19, 14, 13, 13, 14, 14, 14, 15, 16, 18, 13, 14, 18, 13, 13, 15, 14, 13, 16, 14, 15, 13, 15, 16, 13, 11, 15, 16, 13, 13, 13, 13, 14, 14, 13, 14, 13, 21, 14, 15, 15, 13, 13, 13, 14, 15, 15, 14, 14, 14, 15, 13, 16, 15, 13, 13, 14, 16, 13, 14, 13, 15, 13, 15, 13, 14, 13, 16, 13, 13, 13, 14, 13, 15, 14, 15, 14, 13, 13, 13, 13, 16, 14, 14, 15, 17, 13, 17, 13, 14, 14, 14, 13, 13, 17, 15, 16, 11, 14, 13, 14, 15, 13, 17, 13, 14, 14, 13, 14, 13, 13, 16, 15, 13, 15, 13, 15, 13, 14, 16, 14, 14, 18, 14, 17, 14, 15, 14, 13, 13, 20, 13, 13, 13, 15, 14, 14, 13, 16, 13, 14, 13, 14, 16, 13, 14, 14, 14, 14, 13, 15, 14, 14, 16, 16, 14, 13, 15, 15, 14, 16, 13, 17, 17, 13, 14, 13, 15, 15, 13, 13, 14, 14, 13, 13, 15, 16, 14, 14, 13, 15, 13, 13, 14, 14, 15, 19, 14, 14, 13, 13, 14, 15, 18, 14, 13, 13, 14, 13, 14, 14, 14, 13, 15, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09887243687427075, "mean_inference_ms": 0.24475180637991276, "mean_action_processing_ms": 0.04409462155371131, "mean_env_wait_ms": 0.0474510168144447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015638555799211775, "StateBufferConnector_ms": 0.0012384993689400809, "ViewRequirementAgentConnector_ms": 0.028778655188424245}}, "episode_reward_max": 0.9996406961148401, "episode_reward_min": -1.0, "episode_reward_mean": 0.8560661299810757, "episode_len_mean": 14.310714285714285, "episodes_this_iter": 280, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9094748913128438, 0.9360745508204137, 0.9146520198993956, 0.9002071379874652, 0.9879512573052681, 0.9990197593490469, 0.9198219951119943, 0.7717736833788196, 0.9798339830806136, 0.852521207043997, 0.8779286900649468, 0.825468118903617, 0.9820293995073273, 0.8045180076701767, 0.9791153275416876, 0.9967210790925941, 0.9100676678252075, 0.9807286753577036, 0.8485071618149366, 0.9846371685953467, 0.9959072942297262, 0.9614675961706637, 0.8076865728546732, 0.9862608867906036, 0.8605281495382555, 0.9238813187039525, 0.9821479685759368, 0.9894231403915528, 0.8217715132946849, 0.9648918693614688, 0.9574551537244016, 0.9355836913598128, 0.8869762790968576, 0.9800585117855345, 0.8110882842316995, 0.9963622219127952, 0.5897058873771723, 0.9964978408315314, 0.9007237653479455, 0.7279560747917122, 0.6680989248273923, 0.9863184598687409, 0.6292613811457086, -1.0, 0.9566198054110999, 0.9799158494828669, 0.7686628563256734, 0.9658686433405289, 0.9035609886751944, 0.973815192304496, 0.8866301808198522, 0.9110277550087438, 0.8528092354456533, 0.8826816147177176, 0.9602841157184949, 0.9481770758123668, 0.926273068658143, 0.9377178122084123, 0.9317445919318016, 0.9137524956537508, 0.5743990411216309, 0.8446352792713202, 0.6916062044255278, 0.8794884235337627, -1.0, 0.9506627560552854, 0.8465269338068924, 0.9598589495559461, 0.9556919541915556, 0.9809958579922102, 0.9948872611097964, 0.8951493838272117, 0.8988427308865418, 0.9149579978895077, 0.9884851075813592, 0.9633213112854461, 0.9393005435325312, 0.957735943379826, 0.9214041442720546, 0.9437767133226995, 0.9267400293809995, 0.9741963467203899, 0.7152533344488334, 0.985353825071464, 0.9657695913096825, 0.9802337152059041, 0.792323208284225, 0.9868177366599084, 0.9249561461395756, 0.5182590743616939, 0.9663071852122949, 0.8964305417123924, 0.8264950732915053, 0.9946893985345963, 0.663882388067585, 0.9892968387668747, 0.9179878532484721, -1.0, 0.9541867682646563, -1.0, 0.9793912607675372, 0.8418081452135419, 0.9795235513504629, 0.8976441027511257, 0.9308601285583823, 0.8656511017392463, 0.9774466221332859, 0.9792487980785339, 0.8959130055490276, 0.968312834809409, 0.9144136236023505, -1.0, 0.9367091442139914, 0.9685312772522096, 0.9158009733348275, 0.9017139428695353, 0.9634070278543795, 0.8807512325610853, 0.9595494894865143, 0.9506177723888048, 0.9884021910438908, 0.9624201658621568, 0.9533430281446139, 0.9816481183700881, 0.7341758596487133, 0.8874490408219986, 0.8878171817148042, 0.848821100641336, 0.8806297781778665, 0.9962507704988732, 0.947600059621952, 0.8569504068785544, -1.0, 0.8426985821873573, 0.9690268603739397, 0.8776204943783643, 0.9053844844711851, 0.6267538386944549, 0.9464307332919123, 0.9515839834401928, 0.8138522017912363, 0.9977448587971625, 0.9764941052674495, 0.9939508775718463, 0.9013908198260026, 0.991906793119666, 0.9417082034602839, 0.965719246734408, 0.9865205958358148, 0.9642537816980238, 0.8779663259321109, 0.9388611106390987, 0.962008991520563, 0.9824686756133149, 0.9049522239968039, 0.8271007316490466, 0.9704149653366043, 0.996419309396635, 0.9802644069470948, 0.8238848032234374, 0.9018046464037053, 0.835705639374728, 0.9813095652135879, 0.9314211106892805, 0.894778736670561, 0.9874359198926568, 0.8421989224134874, 0.9433056996602153, 0.6315319593079187, 0.9663572381938259, 0.7977106612410589, -1.0, 0.957835788761326, 0.9916358963673593, 0.9218471985566074, 0.707392884759637, 0.9464023668147191, 0.8117762780425186, 0.9297009868233718, 0.8676690508122834, 0.8897710421942387, 0.9514251790340484, 0.939403911391494, 0.958258101270422, 0.9741634325511669, 0.8904025724554185, 0.8791821755511985, 0.9441779155142593, 0.8117714469572581, 0.9178328786033387, 0.8763546090662642, 0.9380715422744242, 0.867593306999217, 0.9037353598557827, 0.9338806737417512, 0.9786764575992617, 0.8254641245617546, 0.7312995217413994, 0.7319316975141669, 0.9523423434017422, 0.971696369818057, -1.0, 0.9629372445112148, 0.9584555581921634, 0.6569834662050986, 0.911066459055623, 0.9358869138126591, 0.9206348287616862, 0.9567461754303855, 0.9103872411092033, 0.9890907727979011, 0.951934855588234, 0.667056071393525, 0.9807712599760714, 0.9869195984345286, 0.9448007885792374, 0.9481498444391665, 0.7703763672710954, 0.9628457873056758, 0.9968555937559058, 0.999000290823679, 0.9334838174105661, 0.9330395796185718, 0.9947643972122366, 0.9551955853070677, 0.9642835563981493, 0.9607681793562487, 0.8775705168226887, 0.8277485978928558, 0.98082397066718, 0.9733129538842019, 0.9549446018079943, 0.8089516330382284, 0.9467575586923848, 0.9923115108741039, 0.8522103466692307, 0.747397704437359, 0.6640131134532397, 0.9315724704296376, 0.8998210580877329, 0.9284371627117108, 0.9243016199180316, 0.8901337445651959, 0.9717922754843152, 0.9951290717891133, 0.9698441038185998, 0.94242800787679, 0.9151799946069458, 0.9677406326263446, 0.9996406961148401, 0.7617321921625866, 0.9412444882634332, 0.9399955793992478, 0.9629537596328722, 0.9348803559647906, 0.9943805027686557, 0.8545293875349543, 0.9153202260490944, 0.9565720504382174, 0.9040935681021165, 0.7310329857297371, 0.9649946999774494, 0.9858325030604728, 0.9318894365098394, 0.985451730423024, 0.8561455231095649, 0.9838189166672353, 0.9286215592868052, 0.8309967662691761, 0.8924426273077042, 0.9613436919696593, 0.9910255837206718, 0.9711084391204375, 0.9437561340272335, 0.987374667853297, 0.9940793304451631, 0.9395594564807318, 0.9465058167781536, 0.8303577250518734, 0.994988717240556], "episode_lengths": [13, 14, 15, 14, 13, 13, 13, 18, 13, 15, 16, 14, 14, 21, 13, 13, 15, 14, 14, 13, 13, 13, 15, 14, 15, 13, 14, 15, 15, 14, 16, 15, 14, 15, 14, 13, 16, 14, 13, 19, 18, 13, 16, 10, 15, 14, 17, 15, 16, 13, 13, 14, 14, 18, 14, 15, 15, 14, 14, 14, 15, 19, 16, 13, 10, 14, 14, 15, 15, 13, 14, 16, 18, 13, 19, 14, 13, 13, 14, 14, 14, 15, 16, 18, 13, 14, 18, 13, 13, 15, 14, 13, 16, 14, 15, 13, 15, 16, 13, 11, 15, 16, 13, 13, 13, 13, 14, 14, 13, 14, 13, 21, 14, 15, 15, 13, 13, 13, 14, 15, 15, 14, 14, 14, 15, 13, 16, 15, 13, 13, 14, 16, 13, 14, 13, 15, 13, 15, 13, 14, 13, 16, 13, 13, 13, 14, 13, 15, 14, 15, 14, 13, 13, 13, 13, 16, 14, 14, 15, 17, 13, 17, 13, 14, 14, 14, 13, 13, 17, 15, 16, 11, 14, 13, 14, 15, 13, 17, 13, 14, 14, 13, 14, 13, 13, 16, 15, 13, 15, 13, 15, 13, 14, 16, 14, 14, 18, 14, 17, 14, 15, 14, 13, 13, 20, 13, 13, 13, 15, 14, 14, 13, 16, 13, 14, 13, 14, 16, 13, 14, 14, 14, 14, 13, 15, 14, 14, 16, 16, 14, 13, 15, 15, 14, 16, 13, 17, 17, 13, 14, 13, 15, 15, 13, 13, 14, 14, 13, 13, 15, 16, 14, 14, 13, 15, 13, 13, 14, 14, 15, 19, 14, 14, 13, 13, 14, 15, 18, 14, 13, 13, 14, 13, 14, 14, 14, 13, 15, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09887243687427075, "mean_inference_ms": 0.24475180637991276, "mean_action_processing_ms": 0.04409462155371131, "mean_env_wait_ms": 0.0474510168144447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015638555799211775, "StateBufferConnector_ms": 0.0012384993689400809, "ViewRequirementAgentConnector_ms": 0.028778655188424245}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1076.2924821966888, "num_env_steps_trained_throughput_per_sec": 1076.2924821966888, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 3767.445, "sample_time_ms": 1843.497, "load_time_ms": 0.223, "load_throughput": 17974304.693, "learn_time_ms": 1921.645, "learn_throughput": 2081.549, "synch_weights_time_ms": 1.689}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 14943, "training_iteration": 97, "trial_id": "default", "date": "2024-05-22_22-20-54", "timestamp": 1716409254, "time_this_iter_s": 3.721592903137207, "time_total_s": 353.5170729160309, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 353.5170729160309, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 21.64, "ram_util_percent": 60.879999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2210001329580944, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.020152600471716454, "policy_loss": -0.006329055907585287, "vf_loss": 0.024299143430256156, "vf_explained_var": 0.19781345398195327, "kl": 0.01149636491484129, "entropy": 0.33764581491229356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90675.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 0.9996178395550881, "episode_reward_min": -1.0, "episode_reward_mean": 0.8805910753320555, "episode_len_mean": 14.271428571428572, "episode_media": {}, "episodes_this_iter": 280, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.998635960680311, 0.9354384757458538, 0.9901902974712266, 0.7254351548086512, 0.9517135393163138, 0.9664198687845805, 0.8578268552977457, 0.8408775138162007, 0.8760093287085745, 0.9993717532011237, 0.9876803734939023, 0.9896686892970771, 0.9657430849865456, 0.7685417313881846, 0.829135937054278, 0.965199041837592, 0.9485003403636418, 0.8923365716210658, 0.8342229455042669, 0.9273780120470921, 0.9069765252550454, 0.9953120342718056, 0.9122379576984442, 0.9956332864630476, 0.9320916346629428, 0.9978025272554991, 0.8671675834652882, 0.8802156225184644, 0.9782393111196612, 0.9793456117701114, -1.0, 0.9730219986342801, 0.8504105156208335, 0.939568180506061, 0.9617356512084474, 0.8530387088807454, 0.9281226292763569, 0.5, 0.7559985669131704, 0.9708896575096897, 0.8779738358177251, 0.9314524381636068, 0.9292807066210093, 0.9711667017765618, 0.9293520009591104, 0.8836075398339294, 0.862333780496344, 0.8599039347621517, 0.9108583088796349, 0.9648507275127772, 0.9601703395991681, 0.9832568771341161, 0.994815402378754, 0.886815084957354, -1.0, 0.9776037420819182, 0.9726064563395518, 0.9988907484776125, 0.9033510937034117, 0.9654131779537238, 0.9069392439174484, 0.8282967592746642, 0.83095988870987, 0.5413135342916915, 0.9814468281171189, 0.841257746836185, 0.9961422819730585, 0.9758149588626572, 0.7436549230725001, 0.745682042878676, 0.840776751592499, 0.9563823452217223, 0.8536644417887945, 0.922556186038284, 0.8931133123704134, 0.9328893268603112, 0.9229293825133201, 0.8791958463612732, 0.9883931209238735, 0.8941275919915589, 0.9679573369922065, 0.9890815367173086, 0.9640579067984127, 0.7000517775018833, 0.9659991194667514, 0.9596140759049162, 0.9859556225134923, 0.9481804560070263, 0.9064599970730571, 0.8870410314042481, 0.9030975119912252, 0.9730800984318257, 0.7735807408101991, 0.9700197484443651, 0.9461226820654488, 0.9619563453098152, 0.968199954832964, 0.925142679659613, 0.9666069703212394, 0.9898351634398372, 0.9442270491851958, 0.9221019270948212, 0.9208781888585211, 0.990147872402312, 0.9311128018951482, 0.769069214324047, 0.9608054418931994, 0.9904454365767199, 0.736570723912287, -1.0, 0.9253666364495821, 0.9484099732425098, 0.937618458328376, 0.8791786817178218, 0.9433748252694658, 0.9143502192285072, 0.9677794700751265, 0.9581608367995225, 0.9613091895099182, 0.826359346863636, 0.9976322664933805, 0.957068721440647, 0.9621311114042334, 0.9847992316923331, 0.9127502109169006, 0.9723755787182475, 0.9474526295903434, 0.9054986542546044, 0.9983749585696328, 0.9647337487533721, 0.905116380920291, 0.9180187506834189, 0.9478891160266754, 0.9170563661944173, 0.8524693941959857, 0.9047845070502968, 0.8873712860558387, 0.9965325591499669, 0.9787140756025865, 0.9187720478142052, 0.929292421743091, 0.8475908947649795, 0.986221642214387, 0.9419825999836228, 0.8524912190664719, 0.956313134305329, 0.9818325361045732, 0.9750117324502982, 0.9221162862422935, 0.9374018443084355, 0.6030886432780753, 0.9420928306997735, 0.7973571430595958, 0.8048813340746842, 0.916342430455891, 0.5, 0.9611588777609427, 0.9505331734755292, 0.9616919905925625, 0.932054530725576, 0.9717394465792056, 0.9145207495061163, 0.8589653178453519, 0.8304944008273732, 0.9863627825915358, 0.9588197026961193, 0.949268892554139, 0.9085061306123581, 0.9480740333723044, 0.9479118489285151, 0.9977435253427066, 0.9100220299917928, 0.9697901467080596, 0.9813253152930899, 0.5769873309326174, 0.8961887818413319, 0.9710317698466164, 0.9546780477869407, 0.992682767624995, 0.9538050281496411, 0.8340348396876923, 0.9392983440083357, 0.8738449959435093, -1.0, 0.9629033910991591, 0.8808597126817415, 0.860943126082125, 0.9776917732580178, 0.9581432137523416, 0.9948677297385493, 0.9696799801588457, 0.988370954783945, 0.9116921816830715, 0.9918280090075554, 0.9996178395550881, 0.7914113224825079, 0.9842080321265787, 0.9664484048858756, 0.9558128767847327, 0.9276838725206629, 0.6443880132654582, 0.9655121363510076, 0.9965726602767161, 0.9167850329434304, 0.9468498629385083, 0.9236839050266028, 0.8393402804502527, 0.9353616237134617, 0.8883313647573903, 0.9428716706792905, 0.9913270312436744, 0.754141381142963, 0.998817700752597, 0.9508811933141499, 0.9784291430310605, 0.6526918044843426, 0.6512296103517203, 0.952089960424638, 0.9356509000822956, 0.7115075755116598, 0.8754499806998823, 0.9598057316295228, 0.9585845938268313, 0.9143772731564482, 0.9736154976046186, 0.9638803582836387, 0.9539493700032986, 0.9739693519752648, 0.8583819166045634, 0.9713569083446233, 0.7992770916763133, 0.9276299952762896, 0.9959860181770677, 0.924664840605798, 0.9195523484760041, 0.9549982299215846, 0.80469430561967, 0.9768040125642368, 0.6349264834372599, 0.9336907639962863, 0.8793987373015212, 0.9802011036011216, 0.9538658565347168, 0.8461018870452338, 0.861817045837947, 0.8890776273887664, 0.9631807169736616, 0.9625373230364838, 0.9823719885826353, 0.9111253362019267, 0.9698956805720054, 0.9910996783710581, 0.9736935253036771, 0.9916633850880066, 0.942672917210119, 0.6682962467004678, 0.9422825353844424, 0.9676364162176748, 0.964737886131563, 0.994742352956104, 0.9472531740019808, 0.9899087648368761, 0.9451481233139047, 0.9764991425100484, 0.6654390227314761, 0.9856527124134801, 0.9337138101869978, -1.0, 0.9074479044708695, 0.9456545929919762, 0.9989022807801622, 0.9587153676006493, 0.8797379276874756, 0.9620884197060827, 0.9970200098335354, 0.8158430549125026, 0.9298313552625529, 0.9713530569561352, 0.9874303478247348, 0.755470406978837], "episode_lengths": [16, 13, 13, 19, 13, 13, 14, 15, 16, 14, 15, 13, 13, 15, 15, 13, 14, 14, 17, 13, 13, 13, 13, 15, 14, 14, 14, 15, 13, 14, 13, 16, 23, 15, 14, 17, 15, 16, 15, 13, 15, 17, 13, 14, 13, 13, 15, 14, 14, 14, 15, 14, 13, 19, 11, 14, 15, 13, 16, 13, 14, 16, 13, 19, 13, 14, 13, 14, 14, 16, 15, 13, 14, 17, 13, 14, 15, 13, 13, 14, 16, 13, 13, 16, 13, 13, 14, 14, 13, 14, 14, 14, 14, 13, 13, 13, 13, 14, 14, 13, 13, 13, 16, 14, 13, 15, 13, 13, 14, 12, 14, 13, 13, 14, 13, 13, 13, 14, 14, 14, 13, 13, 15, 14, 13, 16, 13, 13, 13, 13, 19, 15, 15, 15, 16, 13, 13, 15, 14, 15, 14, 17, 13, 14, 15, 13, 16, 13, 13, 14, 15, 13, 17, 18, 13, 19, 13, 14, 13, 14, 14, 13, 15, 14, 13, 15, 14, 14, 14, 14, 14, 15, 14, 14, 15, 14, 14, 13, 14, 14, 15, 13, 13, 11, 13, 16, 17, 14, 13, 15, 15, 15, 14, 13, 13, 16, 14, 13, 14, 14, 18, 14, 14, 14, 17, 13, 16, 15, 15, 17, 14, 16, 13, 13, 15, 16, 15, 14, 14, 15, 15, 14, 13, 14, 15, 15, 13, 14, 15, 13, 17, 14, 13, 15, 15, 14, 16, 15, 15, 13, 17, 16, 14, 14, 16, 16, 13, 13, 13, 13, 14, 15, 14, 15, 13, 19, 13, 14, 14, 14, 13, 13, 15, 13, 17, 13, 15, 11, 13, 13, 14, 14, 15, 15, 14, 14, 13, 13, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09898061219844423, "mean_inference_ms": 0.24477458994057613, "mean_action_processing_ms": 0.04409957481463161, "mean_env_wait_ms": 0.04746431168259873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015779052461896623, "StateBufferConnector_ms": 0.001250760895865304, "ViewRequirementAgentConnector_ms": 0.028792193957737515}}, "episode_reward_max": 0.9996178395550881, "episode_reward_min": -1.0, "episode_reward_mean": 0.8805910753320555, "episode_len_mean": 14.271428571428572, "episodes_this_iter": 280, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.998635960680311, 0.9354384757458538, 0.9901902974712266, 0.7254351548086512, 0.9517135393163138, 0.9664198687845805, 0.8578268552977457, 0.8408775138162007, 0.8760093287085745, 0.9993717532011237, 0.9876803734939023, 0.9896686892970771, 0.9657430849865456, 0.7685417313881846, 0.829135937054278, 0.965199041837592, 0.9485003403636418, 0.8923365716210658, 0.8342229455042669, 0.9273780120470921, 0.9069765252550454, 0.9953120342718056, 0.9122379576984442, 0.9956332864630476, 0.9320916346629428, 0.9978025272554991, 0.8671675834652882, 0.8802156225184644, 0.9782393111196612, 0.9793456117701114, -1.0, 0.9730219986342801, 0.8504105156208335, 0.939568180506061, 0.9617356512084474, 0.8530387088807454, 0.9281226292763569, 0.5, 0.7559985669131704, 0.9708896575096897, 0.8779738358177251, 0.9314524381636068, 0.9292807066210093, 0.9711667017765618, 0.9293520009591104, 0.8836075398339294, 0.862333780496344, 0.8599039347621517, 0.9108583088796349, 0.9648507275127772, 0.9601703395991681, 0.9832568771341161, 0.994815402378754, 0.886815084957354, -1.0, 0.9776037420819182, 0.9726064563395518, 0.9988907484776125, 0.9033510937034117, 0.9654131779537238, 0.9069392439174484, 0.8282967592746642, 0.83095988870987, 0.5413135342916915, 0.9814468281171189, 0.841257746836185, 0.9961422819730585, 0.9758149588626572, 0.7436549230725001, 0.745682042878676, 0.840776751592499, 0.9563823452217223, 0.8536644417887945, 0.922556186038284, 0.8931133123704134, 0.9328893268603112, 0.9229293825133201, 0.8791958463612732, 0.9883931209238735, 0.8941275919915589, 0.9679573369922065, 0.9890815367173086, 0.9640579067984127, 0.7000517775018833, 0.9659991194667514, 0.9596140759049162, 0.9859556225134923, 0.9481804560070263, 0.9064599970730571, 0.8870410314042481, 0.9030975119912252, 0.9730800984318257, 0.7735807408101991, 0.9700197484443651, 0.9461226820654488, 0.9619563453098152, 0.968199954832964, 0.925142679659613, 0.9666069703212394, 0.9898351634398372, 0.9442270491851958, 0.9221019270948212, 0.9208781888585211, 0.990147872402312, 0.9311128018951482, 0.769069214324047, 0.9608054418931994, 0.9904454365767199, 0.736570723912287, -1.0, 0.9253666364495821, 0.9484099732425098, 0.937618458328376, 0.8791786817178218, 0.9433748252694658, 0.9143502192285072, 0.9677794700751265, 0.9581608367995225, 0.9613091895099182, 0.826359346863636, 0.9976322664933805, 0.957068721440647, 0.9621311114042334, 0.9847992316923331, 0.9127502109169006, 0.9723755787182475, 0.9474526295903434, 0.9054986542546044, 0.9983749585696328, 0.9647337487533721, 0.905116380920291, 0.9180187506834189, 0.9478891160266754, 0.9170563661944173, 0.8524693941959857, 0.9047845070502968, 0.8873712860558387, 0.9965325591499669, 0.9787140756025865, 0.9187720478142052, 0.929292421743091, 0.8475908947649795, 0.986221642214387, 0.9419825999836228, 0.8524912190664719, 0.956313134305329, 0.9818325361045732, 0.9750117324502982, 0.9221162862422935, 0.9374018443084355, 0.6030886432780753, 0.9420928306997735, 0.7973571430595958, 0.8048813340746842, 0.916342430455891, 0.5, 0.9611588777609427, 0.9505331734755292, 0.9616919905925625, 0.932054530725576, 0.9717394465792056, 0.9145207495061163, 0.8589653178453519, 0.8304944008273732, 0.9863627825915358, 0.9588197026961193, 0.949268892554139, 0.9085061306123581, 0.9480740333723044, 0.9479118489285151, 0.9977435253427066, 0.9100220299917928, 0.9697901467080596, 0.9813253152930899, 0.5769873309326174, 0.8961887818413319, 0.9710317698466164, 0.9546780477869407, 0.992682767624995, 0.9538050281496411, 0.8340348396876923, 0.9392983440083357, 0.8738449959435093, -1.0, 0.9629033910991591, 0.8808597126817415, 0.860943126082125, 0.9776917732580178, 0.9581432137523416, 0.9948677297385493, 0.9696799801588457, 0.988370954783945, 0.9116921816830715, 0.9918280090075554, 0.9996178395550881, 0.7914113224825079, 0.9842080321265787, 0.9664484048858756, 0.9558128767847327, 0.9276838725206629, 0.6443880132654582, 0.9655121363510076, 0.9965726602767161, 0.9167850329434304, 0.9468498629385083, 0.9236839050266028, 0.8393402804502527, 0.9353616237134617, 0.8883313647573903, 0.9428716706792905, 0.9913270312436744, 0.754141381142963, 0.998817700752597, 0.9508811933141499, 0.9784291430310605, 0.6526918044843426, 0.6512296103517203, 0.952089960424638, 0.9356509000822956, 0.7115075755116598, 0.8754499806998823, 0.9598057316295228, 0.9585845938268313, 0.9143772731564482, 0.9736154976046186, 0.9638803582836387, 0.9539493700032986, 0.9739693519752648, 0.8583819166045634, 0.9713569083446233, 0.7992770916763133, 0.9276299952762896, 0.9959860181770677, 0.924664840605798, 0.9195523484760041, 0.9549982299215846, 0.80469430561967, 0.9768040125642368, 0.6349264834372599, 0.9336907639962863, 0.8793987373015212, 0.9802011036011216, 0.9538658565347168, 0.8461018870452338, 0.861817045837947, 0.8890776273887664, 0.9631807169736616, 0.9625373230364838, 0.9823719885826353, 0.9111253362019267, 0.9698956805720054, 0.9910996783710581, 0.9736935253036771, 0.9916633850880066, 0.942672917210119, 0.6682962467004678, 0.9422825353844424, 0.9676364162176748, 0.964737886131563, 0.994742352956104, 0.9472531740019808, 0.9899087648368761, 0.9451481233139047, 0.9764991425100484, 0.6654390227314761, 0.9856527124134801, 0.9337138101869978, -1.0, 0.9074479044708695, 0.9456545929919762, 0.9989022807801622, 0.9587153676006493, 0.8797379276874756, 0.9620884197060827, 0.9970200098335354, 0.8158430549125026, 0.9298313552625529, 0.9713530569561352, 0.9874303478247348, 0.755470406978837], "episode_lengths": [16, 13, 13, 19, 13, 13, 14, 15, 16, 14, 15, 13, 13, 15, 15, 13, 14, 14, 17, 13, 13, 13, 13, 15, 14, 14, 14, 15, 13, 14, 13, 16, 23, 15, 14, 17, 15, 16, 15, 13, 15, 17, 13, 14, 13, 13, 15, 14, 14, 14, 15, 14, 13, 19, 11, 14, 15, 13, 16, 13, 14, 16, 13, 19, 13, 14, 13, 14, 14, 16, 15, 13, 14, 17, 13, 14, 15, 13, 13, 14, 16, 13, 13, 16, 13, 13, 14, 14, 13, 14, 14, 14, 14, 13, 13, 13, 13, 14, 14, 13, 13, 13, 16, 14, 13, 15, 13, 13, 14, 12, 14, 13, 13, 14, 13, 13, 13, 14, 14, 14, 13, 13, 15, 14, 13, 16, 13, 13, 13, 13, 19, 15, 15, 15, 16, 13, 13, 15, 14, 15, 14, 17, 13, 14, 15, 13, 16, 13, 13, 14, 15, 13, 17, 18, 13, 19, 13, 14, 13, 14, 14, 13, 15, 14, 13, 15, 14, 14, 14, 14, 14, 15, 14, 14, 15, 14, 14, 13, 14, 14, 15, 13, 13, 11, 13, 16, 17, 14, 13, 15, 15, 15, 14, 13, 13, 16, 14, 13, 14, 14, 18, 14, 14, 14, 17, 13, 16, 15, 15, 17, 14, 16, 13, 13, 15, 16, 15, 14, 14, 15, 15, 14, 13, 14, 15, 15, 13, 14, 15, 13, 17, 14, 13, 15, 15, 14, 16, 15, 15, 13, 17, 16, 14, 14, 16, 16, 13, 13, 13, 13, 14, 15, 14, 15, 13, 19, 13, 14, 14, 14, 13, 13, 15, 13, 17, 13, 15, 11, 13, 13, 14, 14, 15, 15, 14, 14, 13, 13, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09898061219844423, "mean_inference_ms": 0.24477458994057613, "mean_action_processing_ms": 0.04409957481463161, "mean_env_wait_ms": 0.04746431168259873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015779052461896623, "StateBufferConnector_ms": 0.001250760895865304, "ViewRequirementAgentConnector_ms": 0.028792193957737515}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1090.5033312995126, "num_env_steps_trained_throughput_per_sec": 1090.5033312995126, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 3769.976, "sample_time_ms": 1847.09, "load_time_ms": 0.223, "load_throughput": 17901425.523, "learn_time_ms": 1920.588, "learn_throughput": 2082.696, "synch_weights_time_ms": 1.686}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 15223, "training_iteration": 98, "trial_id": "default", "date": "2024-05-22_22-20-57", "timestamp": 1716409257, "time_this_iter_s": 3.67307186126709, "time_total_s": 357.190144777298, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 357.190144777298, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.78333333333333, "ram_util_percent": 60.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.72284360701038, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.057927359067284134, "policy_loss": -0.003617157706219743, "vf_loss": 0.06004390511624215, "vf_explained_var": -0.007540077291509156, "kl": 0.007904458964921073, "entropy": 0.31489069652493284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91605.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 0.9994034798717776, "episode_reward_min": -1.0, "episode_reward_mean": 0.8262809284983039, "episode_len_mean": 14.315412186379929, "episode_media": {}, "episodes_this_iter": 279, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9675869283945766, 0.9069433523997914, 0.9619221494745188, 0.5621270882518792, 0.8820902923202001, 0.8520736732798785, 0.8642856011274421, 0.8909151473260275, 0.9461710759190427, 0.9354876318695408, 0.8793282382214032, 0.9841918681168428, 0.8984672865041342, 0.8492279857001414, 0.9882548612082124, 0.9456351317802459, 0.9443231587297681, 0.9189600172074683, 0.996237249354463, 0.8662151215333684, 0.9529238246540698, 0.9952739584942595, 0.9516771582879788, 0.9841185035258375, 0.9864828422533032, 0.8290622777343887, 0.9723253462608439, 0.6979431112772374, 0.935231420878311, 0.9577947342136487, 0.9948083903679197, 0.9452264267237871, 0.8802983696833018, 0.9227625509502426, 0.8923244673374024, 0.831533537065222, -1.0, 0.9455616510496394, 0.9848693029216739, -1.0, 0.9102625609151591, 0.9166461195857359, 0.9923956599888963, 0.8565817305553007, 0.8413721665522428, 0.9794339637498433, 0.9534750383000494, 0.7686272776141149, 0.794866295085419, 0.9543873472104467, 0.7720949772057178, 0.9656642719372701, 0.9808821183246735, 0.9528940780369258, 0.959815282655339, 0.7317446564655106, 0.9157223095103144, 0.9521501814533581, -1.0, 0.850132089523905, 0.9974755615819553, 0.7092018732304599, 0.9274654535219917, 0.9688614135398885, 0.9204895510191469, -1.0, 0.9515292416021579, 0.9362902446368739, 0.9432613317073536, 0.998178889963441, 0.6876726724147011, 0.9893166391889677, 0.9756442562231825, 0.7986954205823724, 0.9728334713981011, 0.6425627170335484, 0.9472680996591567, 0.9441646491683919, 0.9413915115650905, 0.9935221728090474, 0.9758107427493607, 0.9633972985228261, 0.5, 0.8684648466077483, 0.9186608206215767, 0.9527495149303732, 0.8378476404338369, 0.9837105649418887, 0.8940519213304097, 0.9906063477347373, 0.7817081146014627, 0.9181390716367531, 0.9593738139759502, 0.9359134869218156, 0.9035722412011904, 0.9801618734455669, 0.9803125394395217, 0.9377573346724187, 0.9728167634803652, 0.9643750219573315, 0.5690477626641783, 0.697902452393321, 0.9732947099444705, 0.9916549239555008, 0.941627417468204, 0.8105152294093074, 0.7973856160306008, 0.8628633959923037, 0.9756480402085691, 0.9992436515186321, 0.9831700932011159, 0.9872025525983696, 0.9042449814719553, 0.6668219603344681, 0.9445234090826118, 0.9480435529388209, 0.7670271383394955, 0.9753841647752033, 0.9505547635416919, 0.9763842757158369, 0.9786457066162787, 0.956830870196817, 0.9861149583166059, 0.9169130952341542, 0.7073947838662835, -1.0, 0.9768018019625567, 0.9892076455500405, 0.9005264365183709, 0.8165745771827798, 0.9928453729857895, 0.8571949648180803, 0.6054212513808974, 0.9419879280879482, 0.9839684868400622, 0.9668521074553033, 0.997401030449163, 0.9181164697345512, 0.9775291147202362, 0.9994034798717776, 0.9692757314027983, 0.9922471833843179, 0.7496789990401712, 0.9532626091244382, 0.8243579319773806, 0.9437014557632128, 0.9885155765089456, 0.9410413755852792, 0.9707109789881776, 0.8710850075733279, 0.9685975027899307, 0.5362749252107728, 0.9717132743129151, -1.0, 0.9494445314529734, 0.940956802491951, 0.9418036895365002, 0.9771140434266598, 0.9690645962778985, 0.8067505534588857, 0.9938678052675305, 0.9884517813181946, 0.9192496435711756, 0.8479189722472136, 0.922848679924432, 0.9224754907785202, 0.6771632519649795, 0.8941838839198857, 0.650111600957969, 0.9934042910788179, 0.9617043880449843, 0.9093838245915916, 0.9387841667402615, 0.7744380288234274, 0.8781402501652416, 0.9933811952394281, 0.8631207457014095, -1.0, 0.9869912794599307, 0.9317770320765109, 0.9900254824394079, -1.0, 0.9293076536541672, 0.9759009950916792, 0.9568998086819902, -1.0, 0.8165970810187559, 0.9728498111144693, -1.0, 0.993817052812422, 0.9323880977696978, 0.9827774452735517, 0.9961091926969973, 0.8835623580864311, 0.8309418968974877, 0.8860886539084494, 0.794101210037953, 0.8578129353914887, 0.89707137386247, 0.9991023270649525, 0.9731950744395818, 0.9838558829334794, 0.8358882712837414, 0.9720550133445044, 0.9534879934627527, -1.0, 0.8920846574804051, 0.9616357416096515, 0.8803790676165504, 0.9767847163239102, 0.8163775539521773, 0.6446431426691903, 0.9904369493428535, 0.9543708155775108, 0.9715692882203859, 0.5, -1.0, 0.9524228649227837, 0.8859430553749749, 0.9166578317267418, 0.932380183310217, 0.9188966958469758, 0.7397071420925252, 0.9414971850614747, 0.9932891955130195, 0.9891598289313948, 0.9570927675135925, 0.9040911474945812, 0.9446332786846294, 0.9905510272059622, 0.9651532816040426, 0.9636449306569991, 0.9921592540045545, 0.9326043647385855, 0.9539712319102724, 0.9303748451856794, 0.9683431344054381, 0.817911636644858, 0.7856512207124587, 0.9742671775035886, 0.6033667572426992, 0.8149599783570065, 0.9285319759952444, 0.8858531999550151, 0.9652179001855925, 0.7016980038326663, 0.954192882729768, 0.9929141106973631, 0.9716717850583576, 0.914994858478652, 0.949426245494771, 0.737411735271388, 0.9378756769270711, 0.9480722618213293, 0.9098050441288125, 0.9756170031488782, 0.8091355424791382, 0.9870226305742653, 0.9929080036115034, 0.8649923770630634, 0.999249231632513, 0.9199856653995482, 0.8205679997631989, 0.9174948810048155, 0.9591311080242881, 0.9935154271548675, 0.9554473577861665, 0.8518502249045239, 0.8474220939095134, 0.8851754204138784, 0.9970700635411804, 0.9671792393364996, 0.8893448648323966, 0.9937854799232727, 0.9282488513714164, 0.9079445234388598, 0.9174491933918923, 0.9502180914902054, 0.9127822948811593], "episode_lengths": [13, 13, 13, 15, 13, 17, 15, 18, 14, 13, 13, 13, 14, 14, 14, 13, 16, 14, 13, 15, 15, 13, 14, 13, 15, 15, 15, 21, 15, 15, 13, 14, 13, 15, 15, 14, 12, 13, 13, 13, 14, 14, 14, 13, 13, 16, 13, 16, 15, 13, 19, 14, 13, 14, 13, 16, 14, 13, 15, 14, 14, 20, 13, 13, 13, 12, 14, 14, 14, 13, 18, 13, 16, 15, 13, 24, 14, 14, 13, 13, 15, 13, 16, 15, 13, 14, 13, 16, 14, 13, 16, 16, 15, 13, 14, 15, 13, 13, 15, 14, 15, 15, 14, 15, 14, 18, 20, 14, 15, 13, 15, 13, 14, 18, 13, 14, 14, 14, 13, 13, 14, 14, 13, 13, 16, 11, 13, 13, 14, 22, 13, 14, 18, 14, 14, 16, 14, 13, 13, 15, 14, 14, 18, 14, 13, 14, 13, 14, 13, 17, 13, 15, 15, 12, 14, 13, 13, 15, 13, 13, 13, 13, 14, 17, 15, 13, 15, 14, 16, 13, 14, 14, 13, 16, 14, 15, 14, 16, 13, 16, 14, 12, 13, 15, 14, 12, 14, 13, 12, 15, 16, 13, 15, 16, 13, 14, 15, 15, 13, 14, 13, 13, 13, 14, 13, 11, 13, 15, 17, 13, 16, 17, 15, 13, 13, 17, 17, 13, 13, 14, 15, 16, 15, 14, 13, 13, 16, 15, 14, 14, 14, 13, 15, 13, 15, 15, 15, 16, 16, 14, 15, 13, 13, 13, 13, 18, 13, 14, 13, 13, 14, 16, 13, 13, 14, 14, 16, 16, 15, 14, 13, 13, 16, 14, 14, 14, 13, 16, 19, 20, 14, 14, 13, 13, 13, 15, 13, 16, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09908204754179875, "mean_inference_ms": 0.24478036605753764, "mean_action_processing_ms": 0.04410135025058747, "mean_env_wait_ms": 0.04747263884623904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015474134875882056, "StateBufferConnector_ms": 0.0012519111770028283, "ViewRequirementAgentConnector_ms": 0.028638002265738757}}, "episode_reward_max": 0.9994034798717776, "episode_reward_min": -1.0, "episode_reward_mean": 0.8262809284983039, "episode_len_mean": 14.315412186379929, "episodes_this_iter": 279, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9675869283945766, 0.9069433523997914, 0.9619221494745188, 0.5621270882518792, 0.8820902923202001, 0.8520736732798785, 0.8642856011274421, 0.8909151473260275, 0.9461710759190427, 0.9354876318695408, 0.8793282382214032, 0.9841918681168428, 0.8984672865041342, 0.8492279857001414, 0.9882548612082124, 0.9456351317802459, 0.9443231587297681, 0.9189600172074683, 0.996237249354463, 0.8662151215333684, 0.9529238246540698, 0.9952739584942595, 0.9516771582879788, 0.9841185035258375, 0.9864828422533032, 0.8290622777343887, 0.9723253462608439, 0.6979431112772374, 0.935231420878311, 0.9577947342136487, 0.9948083903679197, 0.9452264267237871, 0.8802983696833018, 0.9227625509502426, 0.8923244673374024, 0.831533537065222, -1.0, 0.9455616510496394, 0.9848693029216739, -1.0, 0.9102625609151591, 0.9166461195857359, 0.9923956599888963, 0.8565817305553007, 0.8413721665522428, 0.9794339637498433, 0.9534750383000494, 0.7686272776141149, 0.794866295085419, 0.9543873472104467, 0.7720949772057178, 0.9656642719372701, 0.9808821183246735, 0.9528940780369258, 0.959815282655339, 0.7317446564655106, 0.9157223095103144, 0.9521501814533581, -1.0, 0.850132089523905, 0.9974755615819553, 0.7092018732304599, 0.9274654535219917, 0.9688614135398885, 0.9204895510191469, -1.0, 0.9515292416021579, 0.9362902446368739, 0.9432613317073536, 0.998178889963441, 0.6876726724147011, 0.9893166391889677, 0.9756442562231825, 0.7986954205823724, 0.9728334713981011, 0.6425627170335484, 0.9472680996591567, 0.9441646491683919, 0.9413915115650905, 0.9935221728090474, 0.9758107427493607, 0.9633972985228261, 0.5, 0.8684648466077483, 0.9186608206215767, 0.9527495149303732, 0.8378476404338369, 0.9837105649418887, 0.8940519213304097, 0.9906063477347373, 0.7817081146014627, 0.9181390716367531, 0.9593738139759502, 0.9359134869218156, 0.9035722412011904, 0.9801618734455669, 0.9803125394395217, 0.9377573346724187, 0.9728167634803652, 0.9643750219573315, 0.5690477626641783, 0.697902452393321, 0.9732947099444705, 0.9916549239555008, 0.941627417468204, 0.8105152294093074, 0.7973856160306008, 0.8628633959923037, 0.9756480402085691, 0.9992436515186321, 0.9831700932011159, 0.9872025525983696, 0.9042449814719553, 0.6668219603344681, 0.9445234090826118, 0.9480435529388209, 0.7670271383394955, 0.9753841647752033, 0.9505547635416919, 0.9763842757158369, 0.9786457066162787, 0.956830870196817, 0.9861149583166059, 0.9169130952341542, 0.7073947838662835, -1.0, 0.9768018019625567, 0.9892076455500405, 0.9005264365183709, 0.8165745771827798, 0.9928453729857895, 0.8571949648180803, 0.6054212513808974, 0.9419879280879482, 0.9839684868400622, 0.9668521074553033, 0.997401030449163, 0.9181164697345512, 0.9775291147202362, 0.9994034798717776, 0.9692757314027983, 0.9922471833843179, 0.7496789990401712, 0.9532626091244382, 0.8243579319773806, 0.9437014557632128, 0.9885155765089456, 0.9410413755852792, 0.9707109789881776, 0.8710850075733279, 0.9685975027899307, 0.5362749252107728, 0.9717132743129151, -1.0, 0.9494445314529734, 0.940956802491951, 0.9418036895365002, 0.9771140434266598, 0.9690645962778985, 0.8067505534588857, 0.9938678052675305, 0.9884517813181946, 0.9192496435711756, 0.8479189722472136, 0.922848679924432, 0.9224754907785202, 0.6771632519649795, 0.8941838839198857, 0.650111600957969, 0.9934042910788179, 0.9617043880449843, 0.9093838245915916, 0.9387841667402615, 0.7744380288234274, 0.8781402501652416, 0.9933811952394281, 0.8631207457014095, -1.0, 0.9869912794599307, 0.9317770320765109, 0.9900254824394079, -1.0, 0.9293076536541672, 0.9759009950916792, 0.9568998086819902, -1.0, 0.8165970810187559, 0.9728498111144693, -1.0, 0.993817052812422, 0.9323880977696978, 0.9827774452735517, 0.9961091926969973, 0.8835623580864311, 0.8309418968974877, 0.8860886539084494, 0.794101210037953, 0.8578129353914887, 0.89707137386247, 0.9991023270649525, 0.9731950744395818, 0.9838558829334794, 0.8358882712837414, 0.9720550133445044, 0.9534879934627527, -1.0, 0.8920846574804051, 0.9616357416096515, 0.8803790676165504, 0.9767847163239102, 0.8163775539521773, 0.6446431426691903, 0.9904369493428535, 0.9543708155775108, 0.9715692882203859, 0.5, -1.0, 0.9524228649227837, 0.8859430553749749, 0.9166578317267418, 0.932380183310217, 0.9188966958469758, 0.7397071420925252, 0.9414971850614747, 0.9932891955130195, 0.9891598289313948, 0.9570927675135925, 0.9040911474945812, 0.9446332786846294, 0.9905510272059622, 0.9651532816040426, 0.9636449306569991, 0.9921592540045545, 0.9326043647385855, 0.9539712319102724, 0.9303748451856794, 0.9683431344054381, 0.817911636644858, 0.7856512207124587, 0.9742671775035886, 0.6033667572426992, 0.8149599783570065, 0.9285319759952444, 0.8858531999550151, 0.9652179001855925, 0.7016980038326663, 0.954192882729768, 0.9929141106973631, 0.9716717850583576, 0.914994858478652, 0.949426245494771, 0.737411735271388, 0.9378756769270711, 0.9480722618213293, 0.9098050441288125, 0.9756170031488782, 0.8091355424791382, 0.9870226305742653, 0.9929080036115034, 0.8649923770630634, 0.999249231632513, 0.9199856653995482, 0.8205679997631989, 0.9174948810048155, 0.9591311080242881, 0.9935154271548675, 0.9554473577861665, 0.8518502249045239, 0.8474220939095134, 0.8851754204138784, 0.9970700635411804, 0.9671792393364996, 0.8893448648323966, 0.9937854799232727, 0.9282488513714164, 0.9079445234388598, 0.9174491933918923, 0.9502180914902054, 0.9127822948811593], "episode_lengths": [13, 13, 13, 15, 13, 17, 15, 18, 14, 13, 13, 13, 14, 14, 14, 13, 16, 14, 13, 15, 15, 13, 14, 13, 15, 15, 15, 21, 15, 15, 13, 14, 13, 15, 15, 14, 12, 13, 13, 13, 14, 14, 14, 13, 13, 16, 13, 16, 15, 13, 19, 14, 13, 14, 13, 16, 14, 13, 15, 14, 14, 20, 13, 13, 13, 12, 14, 14, 14, 13, 18, 13, 16, 15, 13, 24, 14, 14, 13, 13, 15, 13, 16, 15, 13, 14, 13, 16, 14, 13, 16, 16, 15, 13, 14, 15, 13, 13, 15, 14, 15, 15, 14, 15, 14, 18, 20, 14, 15, 13, 15, 13, 14, 18, 13, 14, 14, 14, 13, 13, 14, 14, 13, 13, 16, 11, 13, 13, 14, 22, 13, 14, 18, 14, 14, 16, 14, 13, 13, 15, 14, 14, 18, 14, 13, 14, 13, 14, 13, 17, 13, 15, 15, 12, 14, 13, 13, 15, 13, 13, 13, 13, 14, 17, 15, 13, 15, 14, 16, 13, 14, 14, 13, 16, 14, 15, 14, 16, 13, 16, 14, 12, 13, 15, 14, 12, 14, 13, 12, 15, 16, 13, 15, 16, 13, 14, 15, 15, 13, 14, 13, 13, 13, 14, 13, 11, 13, 15, 17, 13, 16, 17, 15, 13, 13, 17, 17, 13, 13, 14, 15, 16, 15, 14, 13, 13, 16, 15, 14, 14, 14, 13, 15, 13, 15, 15, 15, 16, 16, 14, 15, 13, 13, 13, 13, 18, 13, 14, 13, 13, 14, 16, 13, 13, 14, 14, 16, 16, 15, 14, 13, 13, 16, 14, 14, 14, 13, 16, 19, 20, 14, 14, 13, 13, 13, 15, 13, 16, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09908204754179875, "mean_inference_ms": 0.24478036605753764, "mean_action_processing_ms": 0.04410135025058747, "mean_env_wait_ms": 0.04747263884623904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015474134875882056, "StateBufferConnector_ms": 0.0012519111770028283, "ViewRequirementAgentConnector_ms": 0.028638002265738757}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1065.0165946074176, "num_env_steps_trained_throughput_per_sec": 1065.0165946074176, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3781.085, "sample_time_ms": 1849.981, "load_time_ms": 0.228, "load_throughput": 17564087.102, "learn_time_ms": 1928.801, "learn_throughput": 2073.827, "synch_weights_time_ms": 1.681}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 15502, "training_iteration": 99, "trial_id": "default", "date": "2024-05-22_22-21-01", "timestamp": 1716409261, "time_this_iter_s": 3.761129140853882, "time_total_s": 360.95127391815186, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 360.95127391815186, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 14.16, "ram_util_percent": 60.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.08930774657957, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04550836410133108, "policy_loss": -0.005057096979530749, "vf_loss": 0.04851384118677528, "vf_explained_var": 0.006543530379572222, "kl": 0.010806887668979604, "entropy": 0.2962086460683295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92535.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 0.9999596028104795, "episode_reward_min": -1.0, "episode_reward_mean": 0.8389577543971017, "episode_len_mean": 14.252669039145907, "episode_media": {}, "episodes_this_iter": 281, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9756949069246323, 0.997515204389235, 0.9025487065472338, 0.8620813138370219, 0.9937276811849076, 0.9669459197447369, 0.9992584464569935, 0.9358628702077197, 0.8993427048579539, 0.9915787725574147, 0.933115901413219, 0.9375171861402268, 0.8743308680609134, 0.9440054391827015, 0.9651638665288833, 0.9743247466960308, 0.9808312556969104, 0.93516568174454, 0.9544193801438138, 0.9879992361548142, 0.9163438943716297, 0.9301450041170517, 0.9676802880255653, 0.9960946626962688, 0.9496360342839553, 0.9947347406078163, 0.950063340049125, 0.9234326753031081, 0.9680860636771815, 0.9800767041360603, 0.9847071928405617, 0.9381287588149763, 0.9243701413301516, 0.9288048105396616, 0.7987452551377481, 0.9860867741460124, -1.0, 0.8808131344756445, 0.8563883753920062, 0.9262742767498044, 0.9250309896585562, 0.9897526014801219, 0.9640600723129851, 0.9963265489565603, 0.8881029978006794, 0.9541090259449041, -1.0, 0.9249152957020199, 0.9749826340019748, 0.9424578746553339, 0.9866900505182769, 0.9329769965069746, 0.9872717814324591, 0.7764613201624521, 0.9522308223245063, 0.9294498524049055, 0.9216211869835556, 0.9419129338345076, 0.7587891180601203, 0.8486806084404602, 0.9945786315672086, 0.9494438687131246, 0.8466804085423246, 0.6424917108843254, -1.0, 0.6723037770621041, 0.9398592699028551, 0.9611334051524526, 0.8522987103422099, 0.9316775364557497, 0.9979006424161917, -1.0, 0.9436164586247152, 0.7815898083733671, 0.9082905021973168, 0.9418619046721478, 0.8919610874814692, 0.9748245638583938, 0.8714010055721723, 0.8458265889661231, 0.9377703582455583, 0.8848130107994328, 0.9217943226415204, 0.9793990194995208, 0.8018315875969104, 0.9781660427045842, 0.9301165754521734, 0.9036264292257169, 0.9285988231158129, 0.9541307018696532, 0.9707731931651549, 0.8184008851490638, 0.8606432326220086, 0.7818064597125884, 0.9825462984805287, 0.8043154439059639, 0.9886055372169669, 0.9620353135699806, 0.9202561343354434, 0.9557796799790683, 0.8792806070415436, 0.7823939206409528, 0.9632624627316762, 0.9591762410466259, 0.9475150074585409, 0.8412105651821854, 0.9727712727384682, 0.9521479014958267, 0.9085018641070274, 0.8842104446091249, 0.9414521911304753, 0.918069325463772, 0.8974988649620304, 0.9751163719888303, 0.914252949804823, 0.8270622621129918, 0.9535878275475829, 0.9343296067492095, 0.9461630749342134, 0.9108223166367377, 0.6452109893507507, 0.9992577391696907, 0.8694893639533049, 0.9831524348493781, 0.9572361000029035, 0.9991824385026732, 0.84974141790245, 0.9765700394507573, 0.9960778336670572, 0.9951491690817931, 0.9180824146724973, 0.9674004653763006, 0.9508565946605417, 0.9819877730628676, 0.98812051726004, 0.9534719708358655, -1.0, 0.9392962400751826, 0.8576729402884903, 0.5841165003750011, 0.931588061809905, 0.9934601430528287, 0.9984788405642336, 0.9898007630565343, 0.9215785437535166, 0.9331646033670202, 0.8360903193861975, 0.9772481390104898, 0.909449157704415, 0.8709875556090056, 0.8312217323439179, 0.8086328507266095, 0.85098641825165, 0.9148117553660636, 0.9359390660855132, -1.0, 0.82770950913024, 0.623705082259289, 0.9792995730224082, 0.6488248868401039, 0.9370277405595069, 0.8146716523783724, 0.9833916099454637, 0.9764176761498843, 0.8659679389373831, 0.5133596137409937, 0.9106217840591849, 0.9774772089389488, 0.9980039926573212, 0.6097135129641682, 0.9202775637622027, 0.9806446312230452, 0.907161022945861, 0.9689166265213881, 0.9457419413724011, 0.9630350696266144, 0.6349563178804101, 0.9949239024471799, 0.9399981634001698, 0.9810481322240147, 0.9688840755974528, 0.9642188245618561, 0.7618329286648571, 0.9428986033558044, 0.9953945092177635, 0.938862270050356, 0.9776927209735139, 0.9280374031899167, 0.8324729893392369, 0.9986934155616718, 0.9327935919012639, 0.9963010088960688, 0.9382674656777032, 0.9703588251278471, 0.8546115196971424, 0.9278361171998338, 0.971241556199338, 0.9601396820620318, 0.9996207465568702, 0.8140810274169676, 0.6903035414144233, 0.9899232269621839, 0.9949447131669583, 0.9208660157015542, 0.9416168881275939, 0.996869983089775, 0.9234190178831271, 0.9691141403753726, 0.9830895452067537, 0.9956793417850724, 0.9147929902523766, 0.7442581440782192, 0.8993017058438357, 0.8410258967299847, 0.9738336193687809, 0.9999596028104795, 0.9039765047594502, 0.898663158849413, 0.982088113228312, -1.0, -1.0, 0.8378461734430438, 0.9440401539096454, 0.9927081858285167, 0.8947400392178185, 0.9983671634682058, 0.9055632152000456, 0.9686796325621991, 0.9925558988620061, 0.9437574495442471, 0.9560023467504015, 0.8563067982407702, 0.6652730638205053, 0.9889382993014575, 0.9782201130217902, 0.9953020851100393, 0.9535939982818034, 0.8467912867145264, 0.9875576553103476, 0.7364385495931229, 0.8885689682913837, -1.0, 0.9917256884579085, 0.9518564533128838, 0.9170945426882278, 0.9660807219464679, -1.0, 0.966145381579873, -1.0, 0.9013275462471722, 0.9169034431779002, 0.8869835657872176, 0.9251603960404209, 0.5518934432173832, 0.8689016702487572, 0.9850599672125433, 0.7342107788845673, 0.9561902807674054, 0.9381952658767686, 0.9440790035904479, 0.7209273663328092, 0.9889860043187977, 0.9225550621630223, 0.7810545559849769, 0.9019623279647585, 0.9156795825906301, 0.8764079717490183, 0.8868035430458235, 0.9927982336077646, 0.969508445339681, 0.9437357863592849, 0.9998408302822247, 0.927048998142404, 0.9912238298488564, 0.9758545809961904, 0.9825011922277276, 0.6171495325979561, 0.9339853045249975, 0.9967103422764316, 0.8794444402603913, 0.6236814181707432], "episode_lengths": [14, 13, 14, 15, 14, 13, 13, 13, 17, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 15, 13, 13, 15, 13, 13, 13, 14, 13, 15, 14, 16, 15, 13, 19, 17, 18, 14, 14, 14, 13, 14, 15, 14, 14, 15, 13, 15, 14, 16, 13, 16, 13, 13, 13, 13, 16, 17, 14, 14, 14, 16, 16, 15, 17, 15, 14, 14, 14, 17, 13, 17, 13, 14, 13, 14, 17, 21, 13, 16, 16, 13, 15, 15, 13, 13, 15, 13, 13, 13, 16, 17, 15, 15, 14, 14, 13, 13, 13, 16, 14, 13, 13, 14, 13, 14, 13, 13, 15, 13, 13, 14, 15, 18, 13, 13, 13, 13, 16, 14, 13, 14, 14, 15, 14, 15, 14, 13, 13, 14, 14, 13, 13, 13, 12, 14, 16, 16, 13, 13, 14, 13, 15, 14, 16, 13, 14, 16, 16, 15, 16, 17, 15, 17, 14, 16, 13, 17, 13, 16, 15, 14, 16, 16, 19, 13, 13, 15, 14, 13, 15, 13, 13, 18, 15, 14, 14, 13, 13, 14, 14, 15, 13, 13, 13, 18, 16, 14, 15, 14, 15, 16, 13, 13, 16, 13, 14, 14, 17, 13, 16, 14, 13, 13, 13, 14, 13, 14, 13, 16, 14, 15, 14, 13, 16, 14, 13, 12, 11, 15, 15, 13, 13, 13, 13, 13, 15, 13, 13, 17, 16, 13, 13, 13, 13, 17, 16, 17, 13, 22, 13, 13, 15, 15, 11, 14, 10, 13, 16, 14, 16, 16, 14, 14, 19, 14, 13, 13, 16, 14, 13, 15, 15, 13, 14, 16, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 14, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09918297290591005, "mean_inference_ms": 0.2447866101804625, "mean_action_processing_ms": 0.04410481870829014, "mean_env_wait_ms": 0.047481859831002574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015489571459352757, "StateBufferConnector_ms": 0.0012427462377582155, "ViewRequirementAgentConnector_ms": 0.028665549390256617}}, "episode_reward_max": 0.9999596028104795, "episode_reward_min": -1.0, "episode_reward_mean": 0.8389577543971017, "episode_len_mean": 14.252669039145907, "episodes_this_iter": 281, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9756949069246323, 0.997515204389235, 0.9025487065472338, 0.8620813138370219, 0.9937276811849076, 0.9669459197447369, 0.9992584464569935, 0.9358628702077197, 0.8993427048579539, 0.9915787725574147, 0.933115901413219, 0.9375171861402268, 0.8743308680609134, 0.9440054391827015, 0.9651638665288833, 0.9743247466960308, 0.9808312556969104, 0.93516568174454, 0.9544193801438138, 0.9879992361548142, 0.9163438943716297, 0.9301450041170517, 0.9676802880255653, 0.9960946626962688, 0.9496360342839553, 0.9947347406078163, 0.950063340049125, 0.9234326753031081, 0.9680860636771815, 0.9800767041360603, 0.9847071928405617, 0.9381287588149763, 0.9243701413301516, 0.9288048105396616, 0.7987452551377481, 0.9860867741460124, -1.0, 0.8808131344756445, 0.8563883753920062, 0.9262742767498044, 0.9250309896585562, 0.9897526014801219, 0.9640600723129851, 0.9963265489565603, 0.8881029978006794, 0.9541090259449041, -1.0, 0.9249152957020199, 0.9749826340019748, 0.9424578746553339, 0.9866900505182769, 0.9329769965069746, 0.9872717814324591, 0.7764613201624521, 0.9522308223245063, 0.9294498524049055, 0.9216211869835556, 0.9419129338345076, 0.7587891180601203, 0.8486806084404602, 0.9945786315672086, 0.9494438687131246, 0.8466804085423246, 0.6424917108843254, -1.0, 0.6723037770621041, 0.9398592699028551, 0.9611334051524526, 0.8522987103422099, 0.9316775364557497, 0.9979006424161917, -1.0, 0.9436164586247152, 0.7815898083733671, 0.9082905021973168, 0.9418619046721478, 0.8919610874814692, 0.9748245638583938, 0.8714010055721723, 0.8458265889661231, 0.9377703582455583, 0.8848130107994328, 0.9217943226415204, 0.9793990194995208, 0.8018315875969104, 0.9781660427045842, 0.9301165754521734, 0.9036264292257169, 0.9285988231158129, 0.9541307018696532, 0.9707731931651549, 0.8184008851490638, 0.8606432326220086, 0.7818064597125884, 0.9825462984805287, 0.8043154439059639, 0.9886055372169669, 0.9620353135699806, 0.9202561343354434, 0.9557796799790683, 0.8792806070415436, 0.7823939206409528, 0.9632624627316762, 0.9591762410466259, 0.9475150074585409, 0.8412105651821854, 0.9727712727384682, 0.9521479014958267, 0.9085018641070274, 0.8842104446091249, 0.9414521911304753, 0.918069325463772, 0.8974988649620304, 0.9751163719888303, 0.914252949804823, 0.8270622621129918, 0.9535878275475829, 0.9343296067492095, 0.9461630749342134, 0.9108223166367377, 0.6452109893507507, 0.9992577391696907, 0.8694893639533049, 0.9831524348493781, 0.9572361000029035, 0.9991824385026732, 0.84974141790245, 0.9765700394507573, 0.9960778336670572, 0.9951491690817931, 0.9180824146724973, 0.9674004653763006, 0.9508565946605417, 0.9819877730628676, 0.98812051726004, 0.9534719708358655, -1.0, 0.9392962400751826, 0.8576729402884903, 0.5841165003750011, 0.931588061809905, 0.9934601430528287, 0.9984788405642336, 0.9898007630565343, 0.9215785437535166, 0.9331646033670202, 0.8360903193861975, 0.9772481390104898, 0.909449157704415, 0.8709875556090056, 0.8312217323439179, 0.8086328507266095, 0.85098641825165, 0.9148117553660636, 0.9359390660855132, -1.0, 0.82770950913024, 0.623705082259289, 0.9792995730224082, 0.6488248868401039, 0.9370277405595069, 0.8146716523783724, 0.9833916099454637, 0.9764176761498843, 0.8659679389373831, 0.5133596137409937, 0.9106217840591849, 0.9774772089389488, 0.9980039926573212, 0.6097135129641682, 0.9202775637622027, 0.9806446312230452, 0.907161022945861, 0.9689166265213881, 0.9457419413724011, 0.9630350696266144, 0.6349563178804101, 0.9949239024471799, 0.9399981634001698, 0.9810481322240147, 0.9688840755974528, 0.9642188245618561, 0.7618329286648571, 0.9428986033558044, 0.9953945092177635, 0.938862270050356, 0.9776927209735139, 0.9280374031899167, 0.8324729893392369, 0.9986934155616718, 0.9327935919012639, 0.9963010088960688, 0.9382674656777032, 0.9703588251278471, 0.8546115196971424, 0.9278361171998338, 0.971241556199338, 0.9601396820620318, 0.9996207465568702, 0.8140810274169676, 0.6903035414144233, 0.9899232269621839, 0.9949447131669583, 0.9208660157015542, 0.9416168881275939, 0.996869983089775, 0.9234190178831271, 0.9691141403753726, 0.9830895452067537, 0.9956793417850724, 0.9147929902523766, 0.7442581440782192, 0.8993017058438357, 0.8410258967299847, 0.9738336193687809, 0.9999596028104795, 0.9039765047594502, 0.898663158849413, 0.982088113228312, -1.0, -1.0, 0.8378461734430438, 0.9440401539096454, 0.9927081858285167, 0.8947400392178185, 0.9983671634682058, 0.9055632152000456, 0.9686796325621991, 0.9925558988620061, 0.9437574495442471, 0.9560023467504015, 0.8563067982407702, 0.6652730638205053, 0.9889382993014575, 0.9782201130217902, 0.9953020851100393, 0.9535939982818034, 0.8467912867145264, 0.9875576553103476, 0.7364385495931229, 0.8885689682913837, -1.0, 0.9917256884579085, 0.9518564533128838, 0.9170945426882278, 0.9660807219464679, -1.0, 0.966145381579873, -1.0, 0.9013275462471722, 0.9169034431779002, 0.8869835657872176, 0.9251603960404209, 0.5518934432173832, 0.8689016702487572, 0.9850599672125433, 0.7342107788845673, 0.9561902807674054, 0.9381952658767686, 0.9440790035904479, 0.7209273663328092, 0.9889860043187977, 0.9225550621630223, 0.7810545559849769, 0.9019623279647585, 0.9156795825906301, 0.8764079717490183, 0.8868035430458235, 0.9927982336077646, 0.969508445339681, 0.9437357863592849, 0.9998408302822247, 0.927048998142404, 0.9912238298488564, 0.9758545809961904, 0.9825011922277276, 0.6171495325979561, 0.9339853045249975, 0.9967103422764316, 0.8794444402603913, 0.6236814181707432], "episode_lengths": [14, 13, 14, 15, 14, 13, 13, 13, 17, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 15, 13, 13, 15, 13, 13, 13, 14, 13, 15, 14, 16, 15, 13, 19, 17, 18, 14, 14, 14, 13, 14, 15, 14, 14, 15, 13, 15, 14, 16, 13, 16, 13, 13, 13, 13, 16, 17, 14, 14, 14, 16, 16, 15, 17, 15, 14, 14, 14, 17, 13, 17, 13, 14, 13, 14, 17, 21, 13, 16, 16, 13, 15, 15, 13, 13, 15, 13, 13, 13, 16, 17, 15, 15, 14, 14, 13, 13, 13, 16, 14, 13, 13, 14, 13, 14, 13, 13, 15, 13, 13, 14, 15, 18, 13, 13, 13, 13, 16, 14, 13, 14, 14, 15, 14, 15, 14, 13, 13, 14, 14, 13, 13, 13, 12, 14, 16, 16, 13, 13, 14, 13, 15, 14, 16, 13, 14, 16, 16, 15, 16, 17, 15, 17, 14, 16, 13, 17, 13, 16, 15, 14, 16, 16, 19, 13, 13, 15, 14, 13, 15, 13, 13, 18, 15, 14, 14, 13, 13, 14, 14, 15, 13, 13, 13, 18, 16, 14, 15, 14, 15, 16, 13, 13, 16, 13, 14, 14, 17, 13, 16, 14, 13, 13, 13, 14, 13, 14, 13, 16, 14, 15, 14, 13, 16, 14, 13, 12, 11, 15, 15, 13, 13, 13, 13, 13, 15, 13, 13, 17, 16, 13, 13, 13, 13, 17, 16, 17, 13, 22, 13, 13, 15, 15, 11, 14, 10, 13, 16, 14, 16, 16, 14, 14, 19, 14, 13, 13, 16, 14, 13, 15, 15, 13, 14, 16, 13, 13, 13, 13, 13, 13, 13, 13, 15, 13, 13, 14, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09918297290591005, "mean_inference_ms": 0.2447866101804625, "mean_action_processing_ms": 0.04410481870829014, "mean_env_wait_ms": 0.047481859831002574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015489571459352757, "StateBufferConnector_ms": 0.0012427462377582155, "ViewRequirementAgentConnector_ms": 0.028665549390256617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1091.955217720779, "num_env_steps_trained_throughput_per_sec": 1091.955217720779, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 3760.363, "sample_time_ms": 1849.872, "load_time_ms": 0.227, "load_throughput": 17619424.491, "learn_time_ms": 1909.264, "learn_throughput": 2095.048, "synch_weights_time_ms": 0.656}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 15783, "training_iteration": 100, "trial_id": "default", "date": "2024-05-22_22-21-05", "timestamp": 1716409265, "time_this_iter_s": 3.6682980060577393, "time_total_s": 364.6195719242096, "pid": 5176, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "continuous", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x30e4924d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30ea0b910>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 364.6195719242096, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 18.619999999999997, "ram_util_percent": 60.9}}
