{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.364192883878626, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1602724552194598, "policy_loss": 0.010723321817775248, "vf_loss": 0.14799802826069075, "vf_explained_var": -0.28124533327676915, "kl": 0.007755533359728737, "entropy": 1.784458827716048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": 0.9699598603620143, "episode_reward_min": -1.0, "episode_reward_mean": -0.8915885439395511, "episode_len_mean": 42.04255319148936, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, 0.7648543134370386, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5767100989895696, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9699598603620143, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5175979550463135, 0.8615546418472633, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [24, 59, 48, 37, 40, 21, 56, 58, 58, 30, 20, 31, 80, 38, 80, 25, 21, 29, 36, 36, 42, 17, 42, 80, 22, 15, 20, 80, 32, 26, 80, 55, 12, 39, 36, 44, 25, 26, 16, 50, 17, 43, 74, 80, 18, 12, 55, 27, 44, 23, 30, 22, 37, 80, 19, 80, 34, 80, 43, 51, 63, 80, 70, 26, 43, 41, 34, 31, 44, 56, 14, 23, 76, 51, 61, 74, 19, 11, 20, 54, 17, 35, 80, 48, 23, 80, 60, 17, 17, 28, 43, 13, 65, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09349083131743918, "mean_inference_ms": 0.25574453649923695, "mean_action_processing_ms": 0.03333843758451256, "mean_env_wait_ms": 0.047422295598738264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001619217243600399, "StateBufferConnector_ms": 0.001316374920784159, "ViewRequirementAgentConnector_ms": 0.02907362390071788}}, "episode_reward_max": 0.9699598603620143, "episode_reward_min": -1.0, "episode_reward_mean": -0.8915885439395511, "episode_len_mean": 42.04255319148936, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, 0.7648543134370386, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5767100989895696, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9699598603620143, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5175979550463135, 0.8615546418472633, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [24, 59, 48, 37, 40, 21, 56, 58, 58, 30, 20, 31, 80, 38, 80, 25, 21, 29, 36, 36, 42, 17, 42, 80, 22, 15, 20, 80, 32, 26, 80, 55, 12, 39, 36, 44, 25, 26, 16, 50, 17, 43, 74, 80, 18, 12, 55, 27, 44, 23, 30, 22, 37, 80, 19, 80, 34, 80, 43, 51, 63, 80, 70, 26, 43, 41, 34, 31, 44, 56, 14, 23, 76, 51, 61, 74, 19, 11, 20, 54, 17, 35, 80, 48, 23, 80, 60, 17, 17, 28, 43, 13, 65, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09349083131743918, "mean_inference_ms": 0.25574453649923695, "mean_action_processing_ms": 0.03333843758451256, "mean_env_wait_ms": 0.047422295598738264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001619217243600399, "StateBufferConnector_ms": 0.001316374920784159, "ViewRequirementAgentConnector_ms": 0.02907362390071788}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1079.2440692837854, "num_env_steps_trained_throughput_per_sec": 1079.2440692837854, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 3706.282, "sample_time_ms": 1737.121, "load_time_ms": 0.129, "load_throughput": 31011489.834, "learn_time_ms": 1967.871, "learn_throughput": 2032.654, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 94, "training_iteration": 1, "trial_id": "default", "date": "2024-05-23_11-32-24", "timestamp": 1716456744, "time_this_iter_s": 3.708998203277588, "time_total_s": 3.708998203277588, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3.708998203277588, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 15.666666666666666, "ram_util_percent": 56.166666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9270362530504503, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14226550794937598, "policy_loss": -0.007537916976638058, "vf_loss": 0.14749478343573788, "vf_explained_var": -0.25651380438958443, "kl": 0.01154320539209538, "entropy": 1.758936252645267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": 0.9589689592818973, "episode_reward_min": -1.0, "episode_reward_mean": -0.8226182988163967, "episode_len_mean": 42.77, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9589689592818973, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8716077593921001, -1.0, 0.8794416561892121, -1.0, -1.0, -1.0, 0.7066617789427024, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.720494583603766, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7870276172760532, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8939141205800465, 0.9102984680657028, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5097551750288398, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [17, 28, 43, 13, 65, 80, 53, 20, 80, 47, 80, 17, 80, 10, 75, 16, 17, 21, 38, 42, 80, 40, 51, 80, 13, 58, 28, 56, 48, 18, 32, 14, 14, 80, 64, 20, 16, 61, 33, 80, 80, 39, 80, 32, 59, 30, 36, 55, 32, 70, 80, 80, 11, 27, 18, 80, 33, 34, 80, 13, 48, 17, 80, 16, 16, 46, 33, 31, 80, 38, 79, 36, 39, 17, 25, 38, 70, 18, 18, 40, 14, 18, 20, 19, 80, 72, 19, 38, 33, 18, 45, 80, 39, 29, 13, 77, 45, 16, 62, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09370721744611772, "mean_inference_ms": 0.2560274071396046, "mean_action_processing_ms": 0.03335963695194624, "mean_env_wait_ms": 0.047474700881861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015294551849365234, "StateBufferConnector_ms": 0.0013723373413085938, "ViewRequirementAgentConnector_ms": 0.02914142608642578}}, "episode_reward_max": 0.9589689592818973, "episode_reward_min": -1.0, "episode_reward_mean": -0.8226182988163967, "episode_len_mean": 42.77, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9589689592818973, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8716077593921001, -1.0, 0.8794416561892121, -1.0, -1.0, -1.0, 0.7066617789427024, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.720494583603766, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7870276172760532, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8939141205800465, 0.9102984680657028, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5097551750288398, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [17, 28, 43, 13, 65, 80, 53, 20, 80, 47, 80, 17, 80, 10, 75, 16, 17, 21, 38, 42, 80, 40, 51, 80, 13, 58, 28, 56, 48, 18, 32, 14, 14, 80, 64, 20, 16, 61, 33, 80, 80, 39, 80, 32, 59, 30, 36, 55, 32, 70, 80, 80, 11, 27, 18, 80, 33, 34, 80, 13, 48, 17, 80, 16, 16, 46, 33, 31, 80, 38, 79, 36, 39, 17, 25, 38, 70, 18, 18, 40, 14, 18, 20, 19, 80, 72, 19, 38, 33, 18, 45, 80, 39, 29, 13, 77, 45, 16, 62, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09370721744611772, "mean_inference_ms": 0.2560274071396046, "mean_action_processing_ms": 0.03335963695194624, "mean_env_wait_ms": 0.047474700881861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015294551849365234, "StateBufferConnector_ms": 0.0013723373413085938, "ViewRequirementAgentConnector_ms": 0.02914142608642578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1103.9306716512779, "num_env_steps_trained_throughput_per_sec": 1103.9306716512779, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 3664.841, "sample_time_ms": 1739.138, "load_time_ms": 0.165, "load_throughput": 24174662.824, "learn_time_ms": 1924.45, "learn_throughput": 2078.516, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 188, "training_iteration": 2, "trial_id": "default", "date": "2024-05-23_11-32-28", "timestamp": 1716456748, "time_this_iter_s": 3.626225709915161, "time_total_s": 7.335223913192749, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7.335223913192749, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.06, "ram_util_percent": 56.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.169850639854708, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2796152724634095, "policy_loss": -0.0026805967613253543, "vf_loss": 0.2811488746415063, "vf_explained_var": -0.22502245531287243, "kl": 0.005734970963796342, "entropy": 1.750818011709439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 0.9855548562687743, "episode_reward_min": -1.0, "episode_reward_mean": -0.7456505576670802, "episode_len_mean": 38.705882352941174, "episode_media": {}, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.8828366933288283, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7235338452891324, -1.0, 0.9259918315050626, -1.0, 0.9369892932036412, -1.0, -1.0, 0.569926898640835, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9855548562687743, -1.0, 0.8563352206926974, 0.9440725275482388, -1.0, -1.0, -1.0, 0.9289839287548496, -1.0, 0.9071500007699589, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6613376996615874, -1.0, -1.0, -1.0, -1.0, 0.8871342936550779, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.904600306378122, -1.0, 0.8291957222610193, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [42, 20, 55, 56, 63, 58, 80, 16, 13, 80, 38, 20, 17, 21, 80, 40, 31, 17, 64, 60, 80, 58, 12, 80, 35, 80, 14, 17, 52, 43, 25, 33, 75, 20, 38, 42, 9, 14, 25, 47, 17, 12, 80, 40, 34, 31, 17, 80, 52, 13, 57, 22, 11, 21, 80, 60, 23, 80, 13, 21, 12, 80, 16, 16, 80, 31, 77, 80, 24, 23, 28, 43, 26, 80, 26, 11, 10, 52, 21, 48, 19, 46, 18, 35, 16, 35, 23, 32, 55, 55, 39, 80, 20, 24, 14, 80, 21, 35, 35, 18, 10, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09401777706268614, "mean_inference_ms": 0.25638293528614436, "mean_action_processing_ms": 0.03340669238917998, "mean_env_wait_ms": 0.04753984219729331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001554395638260187, "StateBufferConnector_ms": 0.001331637887393727, "ViewRequirementAgentConnector_ms": 0.02921585943184647}}, "episode_reward_max": 0.9855548562687743, "episode_reward_min": -1.0, "episode_reward_mean": -0.7456505576670802, "episode_len_mean": 38.705882352941174, "episodes_this_iter": 102, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.8828366933288283, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7235338452891324, -1.0, 0.9259918315050626, -1.0, 0.9369892932036412, -1.0, -1.0, 0.569926898640835, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9855548562687743, -1.0, 0.8563352206926974, 0.9440725275482388, -1.0, -1.0, -1.0, 0.9289839287548496, -1.0, 0.9071500007699589, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6613376996615874, -1.0, -1.0, -1.0, -1.0, 0.8871342936550779, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.904600306378122, -1.0, 0.8291957222610193, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [42, 20, 55, 56, 63, 58, 80, 16, 13, 80, 38, 20, 17, 21, 80, 40, 31, 17, 64, 60, 80, 58, 12, 80, 35, 80, 14, 17, 52, 43, 25, 33, 75, 20, 38, 42, 9, 14, 25, 47, 17, 12, 80, 40, 34, 31, 17, 80, 52, 13, 57, 22, 11, 21, 80, 60, 23, 80, 13, 21, 12, 80, 16, 16, 80, 31, 77, 80, 24, 23, 28, 43, 26, 80, 26, 11, 10, 52, 21, 48, 19, 46, 18, 35, 16, 35, 23, 32, 55, 55, 39, 80, 20, 24, 14, 80, 21, 35, 35, 18, 10, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09401777706268614, "mean_inference_ms": 0.25638293528614436, "mean_action_processing_ms": 0.03340669238917998, "mean_env_wait_ms": 0.04753984219729331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001554395638260187, "StateBufferConnector_ms": 0.001331637887393727, "ViewRequirementAgentConnector_ms": 0.02921585943184647}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1112.9530289717638, "num_env_steps_trained_throughput_per_sec": 1112.9530289717638, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 3641.237, "sample_time_ms": 1742.071, "load_time_ms": 0.177, "load_throughput": 22560129.09, "learn_time_ms": 1897.941, "learn_throughput": 2107.547, "synch_weights_time_ms": 0.681}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 290, "training_iteration": 3, "trial_id": "default", "date": "2024-05-23_11-32-32", "timestamp": 1716456752, "time_this_iter_s": 3.5966897010803223, "time_total_s": 10.931913614273071, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 10.931913614273071, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.919999999999998, "ram_util_percent": 56.14000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8724357060687515, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12888206218842477, "policy_loss": -0.0058259713813982985, "vf_loss": 0.13280917637610948, "vf_explained_var": -0.27205932627442064, "kl": 0.009494280845838409, "entropy": 1.7519437841189804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 0.947230856940439, "episode_reward_min": -1.0, "episode_reward_mean": -0.8978394809541874, "episode_len_mean": 41.51, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.947230856940439, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6196901949425955, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8630059387771815, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7861249139210538, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [21, 35, 35, 18, 10, 20, 80, 18, 80, 55, 31, 18, 20, 46, 25, 20, 40, 20, 20, 60, 72, 74, 45, 30, 37, 80, 51, 19, 62, 45, 12, 78, 22, 72, 39, 16, 45, 20, 69, 36, 80, 21, 14, 80, 80, 15, 31, 80, 15, 18, 15, 41, 69, 27, 24, 28, 28, 26, 75, 80, 31, 11, 80, 11, 55, 43, 22, 80, 76, 80, 16, 80, 16, 80, 18, 21, 36, 36, 16, 80, 31, 80, 15, 24, 45, 68, 27, 69, 31, 16, 10, 64, 39, 80, 20, 38, 18, 80, 49, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0938176624986551, "mean_inference_ms": 0.2558281506896739, "mean_action_processing_ms": 0.03331077370244482, "mean_env_wait_ms": 0.04737840373278715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016112327575683594, "StateBufferConnector_ms": 0.0012993812561035156, "ViewRequirementAgentConnector_ms": 0.029027462005615234}}, "episode_reward_max": 0.947230856940439, "episode_reward_min": -1.0, "episode_reward_mean": -0.8978394809541874, "episode_len_mean": 41.51, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.947230856940439, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6196901949425955, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8630059387771815, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7861249139210538, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [21, 35, 35, 18, 10, 20, 80, 18, 80, 55, 31, 18, 20, 46, 25, 20, 40, 20, 20, 60, 72, 74, 45, 30, 37, 80, 51, 19, 62, 45, 12, 78, 22, 72, 39, 16, 45, 20, 69, 36, 80, 21, 14, 80, 80, 15, 31, 80, 15, 18, 15, 41, 69, 27, 24, 28, 28, 26, 75, 80, 31, 11, 80, 11, 55, 43, 22, 80, 76, 80, 16, 80, 16, 80, 18, 21, 36, 36, 16, 80, 31, 80, 15, 24, 45, 68, 27, 69, 31, 16, 10, 64, 39, 80, 20, 38, 18, 80, 49, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0938176624986551, "mean_inference_ms": 0.2558281506896739, "mean_action_processing_ms": 0.03331077370244482, "mean_env_wait_ms": 0.04737840373278715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016112327575683594, "StateBufferConnector_ms": 0.0012993812561035156, "ViewRequirementAgentConnector_ms": 0.029027462005615234}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1120.790043595145, "num_env_steps_trained_throughput_per_sec": 1120.790043595145, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 3623.152, "sample_time_ms": 1737.581, "load_time_ms": 0.188, "load_throughput": 21304401.27, "learn_time_ms": 1884.349, "learn_throughput": 2122.749, "synch_weights_time_ms": 0.682}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 384, "training_iteration": 4, "trial_id": "default", "date": "2024-05-23_11-32-35", "timestamp": 1716456755, "time_this_iter_s": 3.571377754211426, "time_total_s": 14.503291368484497, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 14.503291368484497, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.24, "ram_util_percent": 56.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.434871193109661, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07048109898403768, "policy_loss": -0.012022965298765289, "vf_loss": 0.08025271434296843, "vf_explained_var": -0.06579509665889124, "kl": 0.011256756079915452, "entropy": 1.7374844704904864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 0.9638314530805727, "episode_reward_min": -1.0, "episode_reward_mean": -0.9159761558600961, "episode_len_mean": 50.33, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7861249139210538, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6524280469887556, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9638314530805727, -1.0], "episode_lengths": [36, 36, 16, 80, 31, 80, 15, 24, 45, 68, 27, 69, 31, 16, 10, 64, 39, 80, 20, 38, 18, 80, 49, 16, 79, 22, 80, 67, 34, 80, 32, 80, 18, 80, 80, 66, 58, 14, 45, 80, 53, 70, 65, 80, 27, 80, 73, 39, 28, 78, 17, 42, 11, 29, 67, 39, 80, 9, 80, 80, 80, 64, 26, 21, 80, 42, 49, 80, 80, 80, 32, 80, 15, 80, 57, 28, 22, 18, 19, 18, 53, 80, 67, 80, 15, 80, 21, 80, 22, 33, 80, 80, 80, 32, 12, 80, 51, 68, 18, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09345012205846213, "mean_inference_ms": 0.2555202212114765, "mean_action_processing_ms": 0.03324997446667172, "mean_env_wait_ms": 0.047266888472177374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015289783477783203, "StateBufferConnector_ms": 0.0013005733489990234, "ViewRequirementAgentConnector_ms": 0.028720855712890625}}, "episode_reward_max": 0.9638314530805727, "episode_reward_min": -1.0, "episode_reward_mean": -0.9159761558600961, "episode_len_mean": 50.33, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7861249139210538, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6524280469887556, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9638314530805727, -1.0], "episode_lengths": [36, 36, 16, 80, 31, 80, 15, 24, 45, 68, 27, 69, 31, 16, 10, 64, 39, 80, 20, 38, 18, 80, 49, 16, 79, 22, 80, 67, 34, 80, 32, 80, 18, 80, 80, 66, 58, 14, 45, 80, 53, 70, 65, 80, 27, 80, 73, 39, 28, 78, 17, 42, 11, 29, 67, 39, 80, 9, 80, 80, 80, 64, 26, 21, 80, 42, 49, 80, 80, 80, 32, 80, 15, 80, 57, 28, 22, 18, 19, 18, 53, 80, 67, 80, 15, 80, 21, 80, 22, 33, 80, 80, 80, 32, 12, 80, 51, 68, 18, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09345012205846213, "mean_inference_ms": 0.2555202212114765, "mean_action_processing_ms": 0.03324997446667172, "mean_env_wait_ms": 0.047266888472177374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015289783477783203, "StateBufferConnector_ms": 0.0013005733489990234, "ViewRequirementAgentConnector_ms": 0.028720855712890625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1118.3790704954374, "num_env_steps_trained_throughput_per_sec": 1118.3790704954374, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 3613.84, "sample_time_ms": 1733.382, "load_time_ms": 0.194, "load_throughput": 20656508.249, "learn_time_ms": 1879.24, "learn_throughput": 2128.52, "synch_weights_time_ms": 0.679}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 460, "training_iteration": 5, "trial_id": "default", "date": "2024-05-23_11-32-39", "timestamp": 1716456759, "time_this_iter_s": 3.579015016555786, "time_total_s": 18.082306385040283, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 18.082306385040283, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 15.059999999999999, "ram_util_percent": 56.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6340659647218643, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09328576352507356, "policy_loss": -0.009087864107262063, "vf_loss": 0.10002508653047425, "vf_explained_var": -0.11361007626338672, "kl": 0.01174270778402276, "entropy": 1.7014847782350355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 5115.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 0.9638314530805727, "episode_reward_min": -1.0, "episode_reward_mean": -0.9115168830938035, "episode_len_mean": 56.28, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6524280469887556, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9638314530805727, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5425855427424076, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7290765970726607, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9603900507352542, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 32, 80, 15, 80, 57, 28, 22, 18, 19, 18, 53, 80, 67, 80, 15, 80, 21, 80, 22, 33, 80, 80, 80, 32, 12, 80, 51, 68, 18, 80, 80, 57, 43, 33, 27, 44, 80, 80, 80, 80, 80, 80, 60, 76, 16, 80, 22, 80, 47, 65, 29, 80, 80, 40, 76, 80, 26, 64, 61, 80, 80, 80, 80, 63, 51, 36, 34, 80, 18, 80, 80, 77, 67, 80, 80, 40, 80, 80, 80, 37, 17, 35, 80, 17, 25, 44, 36, 26, 41, 80, 15, 29, 59, 77, 73, 48, 80, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303624505254023, "mean_inference_ms": 0.2576343381770335, "mean_action_processing_ms": 0.03318717108248097, "mean_env_wait_ms": 0.0471585049963458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015568733215332031, "StateBufferConnector_ms": 0.0013086795806884766, "ViewRequirementAgentConnector_ms": 0.028701066970825195}}, "episode_reward_max": 0.9638314530805727, "episode_reward_min": -1.0, "episode_reward_mean": -0.9115168830938035, "episode_len_mean": 56.28, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6524280469887556, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9638314530805727, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5425855427424076, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7290765970726607, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9603900507352542, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 80, 32, 80, 15, 80, 57, 28, 22, 18, 19, 18, 53, 80, 67, 80, 15, 80, 21, 80, 22, 33, 80, 80, 80, 32, 12, 80, 51, 68, 18, 80, 80, 57, 43, 33, 27, 44, 80, 80, 80, 80, 80, 80, 60, 76, 16, 80, 22, 80, 47, 65, 29, 80, 80, 40, 76, 80, 26, 64, 61, 80, 80, 80, 80, 63, 51, 36, 34, 80, 18, 80, 80, 77, 67, 80, 80, 40, 80, 80, 80, 37, 17, 35, 80, 17, 25, 44, 36, 26, 41, 80, 15, 29, 59, 77, 73, 48, 80, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303624505254023, "mean_inference_ms": 0.2576343381770335, "mean_action_processing_ms": 0.03318717108248097, "mean_env_wait_ms": 0.0471585049963458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015568733215332031, "StateBufferConnector_ms": 0.0013086795806884766, "ViewRequirementAgentConnector_ms": 0.028701066970825195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1095.645477537761, "num_env_steps_trained_throughput_per_sec": 1095.645477537761, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 3620.0, "sample_time_ms": 1743.758, "load_time_ms": 0.192, "load_throughput": 20845577.966, "learn_time_ms": 1875.045, "learn_throughput": 2133.282, "synch_weights_time_ms": 0.664}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 528, "training_iteration": 6, "trial_id": "default", "date": "2024-05-23_11-32-42", "timestamp": 1716456762, "time_this_iter_s": 3.6531436443328857, "time_total_s": 21.73545002937317, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 21.73545002937317, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.1, "ram_util_percent": 56.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5058292939457842, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08349853748335473, "policy_loss": -0.0019652499972532193, "vf_loss": 0.08403688883108477, "vf_explained_var": -0.061563034980527814, "kl": 0.007134500376495166, "entropy": 1.704500795820708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6045.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 0.9807681529776624, "episode_reward_min": -1.0, "episode_reward_mean": -0.9305884179628708, "episode_len_mean": 57.62, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9603900507352542, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9807681529776624, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [36, 34, 80, 18, 80, 80, 77, 67, 80, 80, 40, 80, 80, 80, 37, 17, 35, 80, 17, 25, 44, 36, 26, 41, 80, 15, 29, 59, 77, 73, 48, 80, 76, 70, 73, 26, 10, 41, 80, 53, 80, 45, 80, 66, 80, 80, 54, 80, 80, 67, 19, 59, 80, 33, 80, 80, 80, 71, 80, 80, 53, 53, 80, 76, 61, 80, 76, 14, 24, 69, 80, 80, 80, 13, 80, 15, 38, 80, 30, 52, 80, 39, 80, 70, 52, 40, 53, 29, 75, 19, 34, 80, 30, 80, 80, 68, 63, 31, 16, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0926854379657204, "mean_inference_ms": 0.258327924162033, "mean_action_processing_ms": 0.0331420679705103, "mean_env_wait_ms": 0.0470650652839785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015337467193603516, "StateBufferConnector_ms": 0.0012824535369873047, "ViewRequirementAgentConnector_ms": 0.02879190444946289}}, "episode_reward_max": 0.9807681529776624, "episode_reward_min": -1.0, "episode_reward_mean": -0.9305884179628708, "episode_len_mean": 57.62, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9603900507352542, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9807681529776624, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [36, 34, 80, 18, 80, 80, 77, 67, 80, 80, 40, 80, 80, 80, 37, 17, 35, 80, 17, 25, 44, 36, 26, 41, 80, 15, 29, 59, 77, 73, 48, 80, 76, 70, 73, 26, 10, 41, 80, 53, 80, 45, 80, 66, 80, 80, 54, 80, 80, 67, 19, 59, 80, 33, 80, 80, 80, 71, 80, 80, 53, 53, 80, 76, 61, 80, 76, 14, 24, 69, 80, 80, 80, 13, 80, 15, 38, 80, 30, 52, 80, 39, 80, 70, 52, 40, 53, 29, 75, 19, 34, 80, 30, 80, 80, 68, 63, 31, 16, 75]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0926854379657204, "mean_inference_ms": 0.258327924162033, "mean_action_processing_ms": 0.0331420679705103, "mean_env_wait_ms": 0.0470650652839785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015337467193603516, "StateBufferConnector_ms": 0.0012824535369873047, "ViewRequirementAgentConnector_ms": 0.02879190444946289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1117.4086523360647, "num_env_steps_trained_throughput_per_sec": 1117.4086523360647, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 3614.243, "sample_time_ms": 1739.947, "load_time_ms": 0.2, "load_throughput": 19969480.02, "learn_time_ms": 1873.097, "learn_throughput": 2135.501, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 595, "training_iteration": 7, "trial_id": "default", "date": "2024-05-23_11-32-46", "timestamp": 1716456766, "time_this_iter_s": 3.5818896293640137, "time_total_s": 25.317339658737183, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.317339658737183, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 15.5, "ram_util_percent": 56.050000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.274016024749125, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.166540384489382, "policy_loss": -0.01214716317112087, "vf_loss": 0.17715218089601045, "vf_explained_var": -0.031122617760012225, "kl": 0.0076768397131981225, "entropy": 1.679498851812014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 6975.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.9911943369153746, "episode_reward_min": -1.0, "episode_reward_mean": -0.8166100371862087, "episode_len_mean": 57.74, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9807681529776624, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.558361267056598, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9911943369153746, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6900563165804869, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8279182465629636, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7906979612860427, -1.0, -1.0, -1.0], "episode_lengths": [69, 80, 80, 80, 13, 80, 15, 38, 80, 30, 52, 80, 39, 80, 70, 52, 40, 53, 29, 75, 19, 34, 80, 30, 80, 80, 68, 63, 31, 16, 75, 80, 78, 80, 69, 62, 80, 19, 75, 51, 54, 20, 65, 80, 45, 80, 80, 80, 61, 80, 18, 80, 22, 80, 67, 80, 80, 22, 56, 80, 41, 32, 35, 60, 72, 35, 13, 11, 61, 80, 25, 11, 80, 48, 56, 10, 80, 80, 80, 38, 72, 80, 31, 80, 43, 77, 80, 70, 80, 80, 36, 57, 80, 80, 25, 80, 61, 80, 19, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09244724095728411, "mean_inference_ms": 0.257889001697276, "mean_action_processing_ms": 0.0331157565434688, "mean_env_wait_ms": 0.04699930156521434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015723705291748047, "StateBufferConnector_ms": 0.0013206005096435547, "ViewRequirementAgentConnector_ms": 0.028992414474487305}}, "episode_reward_max": 0.9911943369153746, "episode_reward_min": -1.0, "episode_reward_mean": -0.8166100371862087, "episode_len_mean": 57.74, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9807681529776624, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.558361267056598, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9911943369153746, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6900563165804869, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8279182465629636, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7906979612860427, -1.0, -1.0, -1.0], "episode_lengths": [69, 80, 80, 80, 13, 80, 15, 38, 80, 30, 52, 80, 39, 80, 70, 52, 40, 53, 29, 75, 19, 34, 80, 30, 80, 80, 68, 63, 31, 16, 75, 80, 78, 80, 69, 62, 80, 19, 75, 51, 54, 20, 65, 80, 45, 80, 80, 80, 61, 80, 18, 80, 22, 80, 67, 80, 80, 22, 56, 80, 41, 32, 35, 60, 72, 35, 13, 11, 61, 80, 25, 11, 80, 48, 56, 10, 80, 80, 80, 38, 72, 80, 31, 80, 43, 77, 80, 70, 80, 80, 36, 57, 80, 80, 25, 80, 61, 80, 19, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09244724095728411, "mean_inference_ms": 0.257889001697276, "mean_action_processing_ms": 0.0331157565434688, "mean_env_wait_ms": 0.04699930156521434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015723705291748047, "StateBufferConnector_ms": 0.0013206005096435547, "ViewRequirementAgentConnector_ms": 0.028992414474487305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1090.911691845246, "num_env_steps_trained_throughput_per_sec": 1090.911691845246, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 3620.793, "sample_time_ms": 1737.234, "load_time_ms": 0.2, "load_throughput": 20023530.956, "learn_time_ms": 1882.356, "learn_throughput": 2124.997, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 664, "training_iteration": 8, "trial_id": "default", "date": "2024-05-23_11-32-50", "timestamp": 1716456770, "time_this_iter_s": 3.6690633296966553, "time_total_s": 28.986402988433838, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 28.986402988433838, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 15.939999999999998, "ram_util_percent": 56.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.797592991462318, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16938724598737173, "policy_loss": -0.005388480456926489, "vf_loss": 0.17311487275986903, "vf_explained_var": -0.10768417152025367, "kl": 0.008304272711006946, "entropy": 1.679737228219227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 7905.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 0.8415586533156694, "episode_reward_min": -1.0, "episode_reward_mean": -0.7979254949722211, "episode_len_mean": 58.52, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8279182465629636, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7906979612860427, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5058558226684848, -1.0, -1.0, -1.0, -1.0, 0.573486073877679, -1.0, 0.5, -1.0, -1.0, 0.7188325120682295, -1.0, -1.0, 0.8415586533156694, -1.0, -1.0, -1.0, 0.8367094130170784, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7814739163053301, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8309179036764087, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 25, 11, 80, 48, 56, 10, 80, 80, 80, 38, 72, 80, 31, 80, 43, 77, 80, 70, 80, 80, 36, 57, 80, 80, 25, 80, 61, 80, 19, 80, 11, 66, 23, 51, 16, 80, 80, 80, 66, 80, 76, 80, 80, 77, 64, 80, 56, 80, 71, 31, 72, 36, 64, 42, 59, 80, 58, 58, 14, 19, 17, 27, 80, 32, 11, 80, 18, 80, 80, 80, 70, 52, 70, 80, 80, 21, 78, 35, 44, 80, 27, 80, 54, 77, 75, 13, 48, 80, 44, 80, 80, 26, 80, 80, 70, 16, 80, 80, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09228740327442247, "mean_inference_ms": 0.25757022007431984, "mean_action_processing_ms": 0.03309386718140887, "mean_env_wait_ms": 0.04695885358098408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015783309936523438, "StateBufferConnector_ms": 0.0013058185577392578, "ViewRequirementAgentConnector_ms": 0.028835058212280273}}, "episode_reward_max": 0.8415586533156694, "episode_reward_min": -1.0, "episode_reward_mean": -0.7979254949722211, "episode_len_mean": 58.52, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8279182465629636, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7906979612860427, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5058558226684848, -1.0, -1.0, -1.0, -1.0, 0.573486073877679, -1.0, 0.5, -1.0, -1.0, 0.7188325120682295, -1.0, -1.0, 0.8415586533156694, -1.0, -1.0, -1.0, 0.8367094130170784, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7814739163053301, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8309179036764087, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [80, 25, 11, 80, 48, 56, 10, 80, 80, 80, 38, 72, 80, 31, 80, 43, 77, 80, 70, 80, 80, 36, 57, 80, 80, 25, 80, 61, 80, 19, 80, 11, 66, 23, 51, 16, 80, 80, 80, 66, 80, 76, 80, 80, 77, 64, 80, 56, 80, 71, 31, 72, 36, 64, 42, 59, 80, 58, 58, 14, 19, 17, 27, 80, 32, 11, 80, 18, 80, 80, 80, 70, 52, 70, 80, 80, 21, 78, 35, 44, 80, 27, 80, 54, 77, 75, 13, 48, 80, 44, 80, 80, 26, 80, 80, 70, 16, 80, 80, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09228740327442247, "mean_inference_ms": 0.25757022007431984, "mean_action_processing_ms": 0.03309386718140887, "mean_env_wait_ms": 0.04695885358098408, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015783309936523438, "StateBufferConnector_ms": 0.0013058185577392578, "ViewRequirementAgentConnector_ms": 0.028835058212280273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1115.4927359931235, "num_env_steps_trained_throughput_per_sec": 1115.4927359931235, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3616.91, "sample_time_ms": 1735.26, "load_time_ms": 0.203, "load_throughput": 19691568.075, "learn_time_ms": 1880.451, "learn_throughput": 2127.149, "synch_weights_time_ms": 0.657}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 733, "training_iteration": 9, "trial_id": "default", "date": "2024-05-23_11-32-53", "timestamp": 1716456773, "time_this_iter_s": 3.5883209705352783, "time_total_s": 32.574723958969116, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 32.574723958969116, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.18, "ram_util_percent": 56.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0569786787353537, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1348379715756383, "policy_loss": -0.010644604353814997, "vf_loss": 0.14328248889576042, "vf_explained_var": -0.08926691021970523, "kl": 0.011000439071078014, "entropy": 1.6814142400218595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 8835.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 0.9659522086775418, "episode_reward_min": -1.0, "episode_reward_mean": -0.8051447840085509, "episode_len_mean": 53.87, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7814739163053301, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8309179036764087, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9659522086775418, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8947018757798191, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7250432811782646, -1.0, -1.0, 0.9533336222357511, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8448993356371525, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7029483510221323, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7862511046324985, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [21, 78, 35, 44, 80, 27, 80, 54, 77, 75, 13, 48, 80, 44, 80, 80, 26, 80, 80, 70, 16, 80, 80, 18, 64, 80, 23, 28, 80, 26, 22, 54, 14, 22, 80, 23, 37, 11, 63, 80, 38, 80, 50, 66, 45, 56, 80, 80, 41, 46, 80, 80, 44, 70, 42, 60, 34, 17, 19, 38, 80, 63, 60, 80, 26, 80, 45, 62, 80, 80, 80, 80, 39, 80, 28, 18, 80, 24, 80, 80, 35, 80, 61, 19, 47, 49, 37, 37, 37, 80, 80, 23, 21, 80, 51, 58, 75, 80, 37, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09218322586018685, "mean_inference_ms": 0.25732577191981304, "mean_action_processing_ms": 0.033077533734147235, "mean_env_wait_ms": 0.046936197544616344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016202926635742188, "StateBufferConnector_ms": 0.0013003349304199219, "ViewRequirementAgentConnector_ms": 0.028826236724853516}}, "episode_reward_max": 0.9659522086775418, "episode_reward_min": -1.0, "episode_reward_mean": -0.8051447840085509, "episode_len_mean": 53.87, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7814739163053301, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8309179036764087, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9659522086775418, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8947018757798191, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7250432811782646, -1.0, -1.0, 0.9533336222357511, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8448993356371525, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7029483510221323, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7862511046324985, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [21, 78, 35, 44, 80, 27, 80, 54, 77, 75, 13, 48, 80, 44, 80, 80, 26, 80, 80, 70, 16, 80, 80, 18, 64, 80, 23, 28, 80, 26, 22, 54, 14, 22, 80, 23, 37, 11, 63, 80, 38, 80, 50, 66, 45, 56, 80, 80, 41, 46, 80, 80, 44, 70, 42, 60, 34, 17, 19, 38, 80, 63, 60, 80, 26, 80, 45, 62, 80, 80, 80, 80, 39, 80, 28, 18, 80, 24, 80, 80, 35, 80, 61, 19, 47, 49, 37, 37, 37, 80, 80, 23, 21, 80, 51, 58, 75, 80, 37, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09218322586018685, "mean_inference_ms": 0.25732577191981304, "mean_action_processing_ms": 0.033077533734147235, "mean_env_wait_ms": 0.046936197544616344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016202926635742188, "StateBufferConnector_ms": 0.0013003349304199219, "ViewRequirementAgentConnector_ms": 0.028826236724853516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1110.182232442711, "num_env_steps_trained_throughput_per_sec": 1110.182232442711, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 3615.519, "sample_time_ms": 1733.985, "load_time_ms": 0.209, "load_throughput": 19182730.391, "learn_time_ms": 1880.333, "learn_throughput": 2127.282, "synch_weights_time_ms": 0.656}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 809, "training_iteration": 10, "trial_id": "default", "date": "2024-05-23_11-32-57", "timestamp": 1716456777, "time_this_iter_s": 3.6054508686065674, "time_total_s": 36.180174827575684, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 36.180174827575684, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.240000000000002, "ram_util_percent": 56.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2976566014430855, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.15516154378231975, "policy_loss": -0.010349337840753217, "vf_loss": 0.16343828228813026, "vf_explained_var": -0.02460442755811958, "kl": 0.010363002458207756, "entropy": 1.6491165049614445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 0.9865465668793771, "episode_reward_min": -1.0, "episode_reward_mean": -0.8069018538042719, "episode_len_mean": 48.84, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.7029483510221323, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7862511046324985, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9865465668793771, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9773640864738745, 0.5623175920799445, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.797909545214141, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8042022886082586, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9172187257998501, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7750563588627315, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [61, 19, 47, 49, 37, 37, 37, 80, 80, 23, 21, 80, 51, 58, 75, 80, 37, 16, 80, 33, 34, 28, 80, 18, 28, 24, 19, 14, 80, 44, 80, 80, 45, 15, 15, 73, 16, 50, 43, 45, 45, 80, 72, 51, 27, 37, 14, 80, 36, 28, 56, 44, 80, 80, 73, 58, 48, 72, 32, 30, 80, 34, 80, 45, 80, 80, 75, 18, 65, 80, 24, 17, 62, 23, 18, 35, 44, 80, 20, 80, 80, 51, 50, 70, 79, 27, 49, 80, 80, 28, 30, 33, 10, 15, 34, 25, 80, 16, 69, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09216960716502552, "mean_inference_ms": 0.25717265340404827, "mean_action_processing_ms": 0.03307720083063043, "mean_env_wait_ms": 0.04693970802327589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015649795532226562, "StateBufferConnector_ms": 0.0013315677642822266, "ViewRequirementAgentConnector_ms": 0.02868795394897461}}, "episode_reward_max": 0.9865465668793771, "episode_reward_min": -1.0, "episode_reward_mean": -0.8069018538042719, "episode_len_mean": 48.84, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.7029483510221323, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7862511046324985, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9865465668793771, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9773640864738745, 0.5623175920799445, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.797909545214141, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8042022886082586, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9172187257998501, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7750563588627315, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [61, 19, 47, 49, 37, 37, 37, 80, 80, 23, 21, 80, 51, 58, 75, 80, 37, 16, 80, 33, 34, 28, 80, 18, 28, 24, 19, 14, 80, 44, 80, 80, 45, 15, 15, 73, 16, 50, 43, 45, 45, 80, 72, 51, 27, 37, 14, 80, 36, 28, 56, 44, 80, 80, 73, 58, 48, 72, 32, 30, 80, 34, 80, 45, 80, 80, 75, 18, 65, 80, 24, 17, 62, 23, 18, 35, 44, 80, 20, 80, 80, 51, 50, 70, 79, 27, 49, 80, 80, 28, 30, 33, 10, 15, 34, 25, 80, 16, 69, 63]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09216960716502552, "mean_inference_ms": 0.25717265340404827, "mean_action_processing_ms": 0.03307720083063043, "mean_env_wait_ms": 0.04693970802327589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015649795532226562, "StateBufferConnector_ms": 0.0013315677642822266, "ViewRequirementAgentConnector_ms": 0.02868795394897461}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1107.2002462378478, "num_env_steps_trained_throughput_per_sec": 1107.2002462378478, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 3606.161, "sample_time_ms": 1733.182, "load_time_ms": 0.215, "load_throughput": 18637209.509, "learn_time_ms": 1871.795, "learn_throughput": 2136.986, "synch_weights_time_ms": 0.646}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 891, "training_iteration": 11, "trial_id": "default", "date": "2024-05-23_11-33-01", "timestamp": 1716456781, "time_this_iter_s": 3.6150870323181152, "time_total_s": 39.7952618598938, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 39.7952618598938, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.6, "ram_util_percent": 56.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3887851277826933, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1496100967499598, "policy_loss": -0.00457242373977938, "vf_loss": 0.15218682794340996, "vf_explained_var": -0.15619971713712139, "kl": 0.009978452356978279, "entropy": 1.6285218864358881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 10695.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 0.9827505272852679, "episode_reward_min": -1.0, "episode_reward_mean": -0.7561801589942132, "episode_len_mean": 48.73, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9172187257998501, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7750563588627315, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8381723826954905, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8965171694653441, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9249227014607025, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8892946384642691, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6515890707117111, -1.0, 0.9827505272852679, -1.0, -1.0, -1.0, 0.9411324462373396, 0.5653300795959562, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0], "episode_lengths": [51, 50, 70, 79, 27, 49, 80, 80, 28, 30, 33, 10, 15, 34, 25, 80, 16, 69, 63, 36, 29, 80, 39, 71, 80, 80, 45, 52, 80, 20, 16, 80, 80, 15, 65, 80, 15, 53, 18, 80, 71, 13, 80, 18, 45, 20, 70, 44, 14, 78, 45, 15, 80, 60, 80, 15, 57, 80, 56, 80, 23, 80, 42, 80, 24, 31, 80, 53, 47, 56, 49, 26, 31, 34, 80, 27, 24, 20, 80, 28, 38, 61, 15, 15, 61, 62, 38, 80, 51, 80, 74, 38, 58, 38, 14, 51, 39, 19, 80, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09217501738622452, "mean_inference_ms": 0.25706466722747573, "mean_action_processing_ms": 0.03307847077961297, "mean_env_wait_ms": 0.04694213601953872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015358924865722656, "StateBufferConnector_ms": 0.0013341903686523438, "ViewRequirementAgentConnector_ms": 0.029001474380493164}}, "episode_reward_max": 0.9827505272852679, "episode_reward_min": -1.0, "episode_reward_mean": -0.7561801589942132, "episode_len_mean": 48.73, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9172187257998501, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7750563588627315, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8381723826954905, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8965171694653441, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9249227014607025, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8892946384642691, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6515890707117111, -1.0, 0.9827505272852679, -1.0, -1.0, -1.0, 0.9411324462373396, 0.5653300795959562, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0], "episode_lengths": [51, 50, 70, 79, 27, 49, 80, 80, 28, 30, 33, 10, 15, 34, 25, 80, 16, 69, 63, 36, 29, 80, 39, 71, 80, 80, 45, 52, 80, 20, 16, 80, 80, 15, 65, 80, 15, 53, 18, 80, 71, 13, 80, 18, 45, 20, 70, 44, 14, 78, 45, 15, 80, 60, 80, 15, 57, 80, 56, 80, 23, 80, 42, 80, 24, 31, 80, 53, 47, 56, 49, 26, 31, 34, 80, 27, 24, 20, 80, 28, 38, 61, 15, 15, 61, 62, 38, 80, 51, 80, 74, 38, 58, 38, 14, 51, 39, 19, 80, 22]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09217501738622452, "mean_inference_ms": 0.25706466722747573, "mean_action_processing_ms": 0.03307847077961297, "mean_env_wait_ms": 0.04694213601953872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015358924865722656, "StateBufferConnector_ms": 0.0013341903686523438, "ViewRequirementAgentConnector_ms": 0.029001474380493164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1106.2163720025167, "num_env_steps_trained_throughput_per_sec": 1106.2163720025167, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 3605.412, "sample_time_ms": 1731.965, "load_time_ms": 0.215, "load_throughput": 18604142.825, "learn_time_ms": 1872.271, "learn_throughput": 2136.443, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 972, "training_iteration": 12, "trial_id": "default", "date": "2024-05-23_11-33-04", "timestamp": 1716456784, "time_this_iter_s": 3.618400812149048, "time_total_s": 43.41366267204285, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 43.41366267204285, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 14.719999999999999, "ram_util_percent": 56.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9778764515954963, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22100145700587942, "policy_loss": -0.00855954709532921, "vf_loss": 0.2273409835613703, "vf_explained_var": -0.1413626523428066, "kl": 0.01110010667445539, "entropy": 1.6118167865660882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 11625.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 0.9875515198222269, "episode_reward_min": -1.0, "episode_reward_mean": -0.6702342754921163, "episode_len_mean": 42.33, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.7740580464897292, 0.8693554784250626, -1.0, 0.5028828076979109, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8812624642792527, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8716319645576083, 0.9565991455078592, -1.0, -1.0, -1.0, 0.8555215340334081, -1.0, 0.8640877245209043, 0.9875515198222269, -1.0, 0.7559145689756337, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8038411494432581, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9851760214024304, -1.0, -1.0, 0.5412980422804694, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8018355252966245, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5255564580559857, -1.0, -1.0, -1.0], "episode_lengths": [14, 51, 39, 19, 80, 22, 80, 80, 14, 20, 24, 54, 30, 22, 24, 17, 19, 25, 80, 40, 79, 68, 55, 80, 80, 18, 20, 66, 15, 80, 10, 24, 80, 25, 23, 17, 80, 16, 62, 24, 80, 24, 24, 25, 18, 45, 80, 19, 28, 80, 34, 23, 50, 38, 80, 27, 63, 19, 16, 54, 78, 48, 11, 11, 36, 30, 80, 19, 80, 61, 15, 17, 17, 25, 30, 18, 80, 46, 74, 23, 62, 24, 50, 30, 69, 75, 80, 80, 41, 32, 12, 22, 44, 80, 13, 65, 28, 25, 19, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0922641223813536, "mean_inference_ms": 0.25698178481438644, "mean_action_processing_ms": 0.033083276473430324, "mean_env_wait_ms": 0.04698066630891371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015072822570800781, "StateBufferConnector_ms": 0.0013079643249511719, "ViewRequirementAgentConnector_ms": 0.028838157653808594}}, "episode_reward_max": 0.9875515198222269, "episode_reward_min": -1.0, "episode_reward_mean": -0.6702342754921163, "episode_len_mean": 42.33, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.7740580464897292, 0.8693554784250626, -1.0, 0.5028828076979109, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8812624642792527, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8716319645576083, 0.9565991455078592, -1.0, -1.0, -1.0, 0.8555215340334081, -1.0, 0.8640877245209043, 0.9875515198222269, -1.0, 0.7559145689756337, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8038411494432581, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9851760214024304, -1.0, -1.0, 0.5412980422804694, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8018355252966245, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5255564580559857, -1.0, -1.0, -1.0], "episode_lengths": [14, 51, 39, 19, 80, 22, 80, 80, 14, 20, 24, 54, 30, 22, 24, 17, 19, 25, 80, 40, 79, 68, 55, 80, 80, 18, 20, 66, 15, 80, 10, 24, 80, 25, 23, 17, 80, 16, 62, 24, 80, 24, 24, 25, 18, 45, 80, 19, 28, 80, 34, 23, 50, 38, 80, 27, 63, 19, 16, 54, 78, 48, 11, 11, 36, 30, 80, 19, 80, 61, 15, 17, 17, 25, 30, 18, 80, 46, 74, 23, 62, 24, 50, 30, 69, 75, 80, 80, 41, 32, 12, 22, 44, 80, 13, 65, 28, 25, 19, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0922641223813536, "mean_inference_ms": 0.25698178481438644, "mean_action_processing_ms": 0.033083276473430324, "mean_env_wait_ms": 0.04698066630891371, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015072822570800781, "StateBufferConnector_ms": 0.0013079643249511719, "ViewRequirementAgentConnector_ms": 0.028838157653808594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1103.7627582068972, "num_env_steps_trained_throughput_per_sec": 1103.7627582068972, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 3608.405, "sample_time_ms": 1730.88, "load_time_ms": 0.218, "load_throughput": 18390020.826, "learn_time_ms": 1876.341, "learn_throughput": 2131.809, "synch_weights_time_ms": 0.643}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 1066, "training_iteration": 13, "trial_id": "default", "date": "2024-05-23_11-33-08", "timestamp": 1716456788, "time_this_iter_s": 3.626584053039551, "time_total_s": 47.0402467250824, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 47.0402467250824, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.55, "ram_util_percent": 55.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1694319409067915, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2739048280843323, "policy_loss": 0.004969210381950102, "vf_loss": 0.26691729474852804, "vf_explained_var": -0.2476668551403989, "kl": 0.010091611805990304, "entropy": 1.6046115654771047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 0.9887402424023761, "episode_reward_min": -1.0, "episode_reward_mean": -0.6084064779967986, "episode_len_mean": 37.57943925233645, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.9511655308127592, 0.7284395000711943, 0.7502693267316416, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.957927132569216, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8382147120073121, -1.0, -1.0, 0.9871810105787528, 0.8459526139543269, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6045887127787897, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6747132108135439, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7891296040996032, -1.0, 0.9445453204824993, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9835220137644584, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9386453385360805, -1.0, 0.5, -1.0, 0.9731677682540527, -1.0, -1.0, 0.6796348390444484, -1.0, -1.0, -1.0, 0.9887402424023761, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7646699774415001], "episode_lengths": [39, 19, 28, 65, 14, 13, 16, 12, 68, 12, 17, 70, 45, 24, 12, 36, 80, 36, 59, 25, 58, 80, 13, 80, 80, 57, 19, 74, 34, 30, 71, 16, 18, 17, 51, 52, 25, 12, 60, 80, 27, 23, 53, 29, 79, 24, 33, 31, 40, 14, 61, 15, 13, 17, 26, 34, 32, 22, 15, 15, 61, 26, 30, 80, 80, 15, 19, 80, 28, 73, 16, 80, 80, 12, 29, 17, 70, 14, 16, 80, 19, 24, 25, 61, 14, 80, 21, 21, 69, 13, 24, 80, 80, 16, 13, 32, 26, 16, 29, 22, 17, 21, 23, 78, 17, 29, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09238689074045682, "mean_inference_ms": 0.2569242561781602, "mean_action_processing_ms": 0.03308891490115384, "mean_env_wait_ms": 0.047015461763572124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001580247255129235, "StateBufferConnector_ms": 0.0013106337217527015, "ViewRequirementAgentConnector_ms": 0.02900217181054231}}, "episode_reward_max": 0.9887402424023761, "episode_reward_min": -1.0, "episode_reward_mean": -0.6084064779967986, "episode_len_mean": 37.57943925233645, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.9511655308127592, 0.7284395000711943, 0.7502693267316416, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.957927132569216, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8382147120073121, -1.0, -1.0, 0.9871810105787528, 0.8459526139543269, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6045887127787897, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6747132108135439, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7891296040996032, -1.0, 0.9445453204824993, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9835220137644584, -1.0, -1.0, 0.5, -1.0, -1.0, 0.9386453385360805, -1.0, 0.5, -1.0, 0.9731677682540527, -1.0, -1.0, 0.6796348390444484, -1.0, -1.0, -1.0, 0.9887402424023761, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7646699774415001], "episode_lengths": [39, 19, 28, 65, 14, 13, 16, 12, 68, 12, 17, 70, 45, 24, 12, 36, 80, 36, 59, 25, 58, 80, 13, 80, 80, 57, 19, 74, 34, 30, 71, 16, 18, 17, 51, 52, 25, 12, 60, 80, 27, 23, 53, 29, 79, 24, 33, 31, 40, 14, 61, 15, 13, 17, 26, 34, 32, 22, 15, 15, 61, 26, 30, 80, 80, 15, 19, 80, 28, 73, 16, 80, 80, 12, 29, 17, 70, 14, 16, 80, 19, 24, 25, 61, 14, 80, 21, 21, 69, 13, 24, 80, 80, 16, 13, 32, 26, 16, 29, 22, 17, 21, 23, 78, 17, 29, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09238689074045682, "mean_inference_ms": 0.2569242561781602, "mean_action_processing_ms": 0.03308891490115384, "mean_env_wait_ms": 0.047015461763572124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001580247255129235, "StateBufferConnector_ms": 0.0013106337217527015, "ViewRequirementAgentConnector_ms": 0.02900217181054231}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1103.3597420734977, "num_env_steps_trained_throughput_per_sec": 1103.3597420734977, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 3614.043, "sample_time_ms": 1732.365, "load_time_ms": 0.214, "load_throughput": 18693276.88, "learn_time_ms": 1880.498, "learn_throughput": 2127.096, "synch_weights_time_ms": 0.633}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 1173, "training_iteration": 14, "trial_id": "default", "date": "2024-05-23_11-33-11", "timestamp": 1716456791, "time_this_iter_s": 3.628058910369873, "time_total_s": 50.66830563545227, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 50.66830563545227, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.199999999999996, "ram_util_percent": 55.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.35626607027746, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2003707747886418, "policy_loss": -0.00853698734814922, "vf_loss": 0.20641302458981994, "vf_explained_var": -0.19050774048733454, "kl": 0.012473686173329956, "entropy": 1.540775312531379, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 13485.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 0.9586087060597139, "episode_reward_min": -1.0, "episode_reward_mean": -0.6815578510238994, "episode_len_mean": 34.90350877192982, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, 0.5547981782228132, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9586087060597139, -1.0, -1.0, -1.0, 0.5300559906504996, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8665240277465438, -1.0, -1.0, 0.9044718303890062, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7169286320319038, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8747777692002143, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7031846870580447, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5673796207071101, -1.0, 0.6285973047074744, 0.5, -1.0, 0.7461646797590546, 0.6305678221077219, 0.8998078033691992, -1.0, -1.0, -1.0, 0.5656816725175369, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6548562587486353, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [39, 66, 26, 33, 32, 40, 80, 80, 80, 18, 16, 60, 39, 12, 19, 18, 55, 25, 40, 27, 27, 16, 66, 19, 36, 21, 34, 21, 19, 13, 18, 52, 23, 33, 33, 20, 21, 80, 27, 29, 80, 17, 36, 35, 21, 24, 16, 63, 22, 41, 28, 80, 19, 18, 35, 12, 15, 19, 41, 24, 80, 25, 20, 69, 26, 25, 25, 24, 39, 24, 15, 80, 25, 16, 20, 80, 16, 56, 31, 80, 27, 20, 15, 80, 26, 80, 80, 15, 15, 14, 22, 80, 14, 22, 31, 22, 14, 15, 80, 13, 18, 34, 41, 80, 34, 31, 21, 35, 37, 66, 13, 11, 14, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09253320649306726, "mean_inference_ms": 0.25689892565333267, "mean_action_processing_ms": 0.03309321879140557, "mean_env_wait_ms": 0.047041490450256816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015804642125179893, "StateBufferConnector_ms": 0.0013192494710286458, "ViewRequirementAgentConnector_ms": 0.029031644787704737}}, "episode_reward_max": 0.9586087060597139, "episode_reward_min": -1.0, "episode_reward_mean": -0.6815578510238994, "episode_len_mean": 34.90350877192982, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, 0.5547981782228132, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9586087060597139, -1.0, -1.0, -1.0, 0.5300559906504996, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8665240277465438, -1.0, -1.0, 0.9044718303890062, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7169286320319038, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8747777692002143, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7031846870580447, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5673796207071101, -1.0, 0.6285973047074744, 0.5, -1.0, 0.7461646797590546, 0.6305678221077219, 0.8998078033691992, -1.0, -1.0, -1.0, 0.5656816725175369, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6548562587486353, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [39, 66, 26, 33, 32, 40, 80, 80, 80, 18, 16, 60, 39, 12, 19, 18, 55, 25, 40, 27, 27, 16, 66, 19, 36, 21, 34, 21, 19, 13, 18, 52, 23, 33, 33, 20, 21, 80, 27, 29, 80, 17, 36, 35, 21, 24, 16, 63, 22, 41, 28, 80, 19, 18, 35, 12, 15, 19, 41, 24, 80, 25, 20, 69, 26, 25, 25, 24, 39, 24, 15, 80, 25, 16, 20, 80, 16, 56, 31, 80, 27, 20, 15, 80, 26, 80, 80, 15, 15, 14, 22, 80, 14, 22, 31, 22, 14, 15, 80, 13, 18, 34, 41, 80, 34, 31, 21, 35, 37, 66, 13, 11, 14, 24]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09253320649306726, "mean_inference_ms": 0.25689892565333267, "mean_action_processing_ms": 0.03309321879140557, "mean_env_wait_ms": 0.047041490450256816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015804642125179893, "StateBufferConnector_ms": 0.0013192494710286458, "ViewRequirementAgentConnector_ms": 0.029031644787704737}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1079.1656240934437, "num_env_steps_trained_throughput_per_sec": 1079.1656240934437, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 3627.039, "sample_time_ms": 1735.013, "load_time_ms": 0.214, "load_throughput": 18728751.954, "learn_time_ms": 1890.839, "learn_throughput": 2115.463, "synch_weights_time_ms": 0.636}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 1287, "training_iteration": 15, "trial_id": "default", "date": "2024-05-23_11-33-15", "timestamp": 1716456795, "time_this_iter_s": 3.709383964538574, "time_total_s": 54.377689599990845, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 54.377689599990845, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.259999999999998, "ram_util_percent": 55.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4259191476529645, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26555455821210777, "policy_loss": -0.007480895943859572, "vf_loss": 0.2718379040649261, "vf_explained_var": -0.10604135605596728, "kl": 0.005987740439985906, "entropy": 1.5119555793782715, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 14415.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.9935893997367097, "episode_reward_min": -1.0, "episode_reward_mean": -0.5905920119416791, "episode_len_mean": 42.42, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8482470515657518, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7869882194297283, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8055058898923972, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9284378590240283, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6929464163546671, -1.0, 0.7890537381278337, -1.0, 0.7288865375081997, -1.0, -1.0, -1.0, -1.0, 0.8782515635616758, -1.0, -1.0, -1.0, 0.6174127556961391, -1.0, -1.0, 0.9935893997367097, 0.656106434134774, -1.0, -1.0, 0.9855510586781601, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9403585571671411, 0.5, -1.0, 0.7040367612527316, 0.5, 0.6213911114936502, -1.0, 0.9640354522085114, -1.0], "episode_lengths": [21, 35, 37, 66, 13, 11, 14, 24, 61, 27, 54, 49, 15, 80, 13, 80, 62, 30, 17, 32, 80, 80, 44, 24, 80, 53, 46, 80, 53, 80, 80, 10, 80, 19, 31, 19, 28, 24, 71, 66, 80, 80, 80, 18, 11, 17, 28, 80, 24, 38, 20, 80, 65, 59, 18, 16, 11, 29, 53, 64, 53, 16, 21, 57, 13, 17, 13, 65, 80, 16, 47, 74, 69, 26, 31, 23, 53, 19, 10, 19, 17, 13, 16, 20, 44, 55, 18, 80, 80, 15, 14, 45, 77, 80, 33, 31, 15, 80, 75, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09255168399774336, "mean_inference_ms": 0.25683722975793555, "mean_action_processing_ms": 0.03309001407327319, "mean_env_wait_ms": 0.047037027374310834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001611948013305664, "StateBufferConnector_ms": 0.0013420581817626953, "ViewRequirementAgentConnector_ms": 0.029018878936767578}}, "episode_reward_max": 0.9935893997367097, "episode_reward_min": -1.0, "episode_reward_mean": -0.5905920119416791, "episode_len_mean": 42.42, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8482470515657518, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7869882194297283, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8055058898923972, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9284378590240283, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6929464163546671, -1.0, 0.7890537381278337, -1.0, 0.7288865375081997, -1.0, -1.0, -1.0, -1.0, 0.8782515635616758, -1.0, -1.0, -1.0, 0.6174127556961391, -1.0, -1.0, 0.9935893997367097, 0.656106434134774, -1.0, -1.0, 0.9855510586781601, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9403585571671411, 0.5, -1.0, 0.7040367612527316, 0.5, 0.6213911114936502, -1.0, 0.9640354522085114, -1.0], "episode_lengths": [21, 35, 37, 66, 13, 11, 14, 24, 61, 27, 54, 49, 15, 80, 13, 80, 62, 30, 17, 32, 80, 80, 44, 24, 80, 53, 46, 80, 53, 80, 80, 10, 80, 19, 31, 19, 28, 24, 71, 66, 80, 80, 80, 18, 11, 17, 28, 80, 24, 38, 20, 80, 65, 59, 18, 16, 11, 29, 53, 64, 53, 16, 21, 57, 13, 17, 13, 65, 80, 16, 47, 74, 69, 26, 31, 23, 53, 19, 10, 19, 17, 13, 16, 20, 44, 55, 18, 80, 80, 15, 14, 45, 77, 80, 33, 31, 15, 80, 75, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09255168399774336, "mean_inference_ms": 0.25683722975793555, "mean_action_processing_ms": 0.03309001407327319, "mean_env_wait_ms": 0.047037027374310834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001611948013305664, "StateBufferConnector_ms": 0.0013420581817626953, "ViewRequirementAgentConnector_ms": 0.029018878936767578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1007.5937005935159, "num_env_steps_trained_throughput_per_sec": 1007.5937005935159, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 3658.943, "sample_time_ms": 1728.54, "load_time_ms": 0.219, "load_throughput": 18267874.564, "learn_time_ms": 1929.207, "learn_throughput": 2073.391, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 1379, "training_iteration": 16, "trial_id": "default", "date": "2024-05-23_11-33-19", "timestamp": 1716456799, "time_this_iter_s": 3.972327947616577, "time_total_s": 58.35001754760742, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.35001754760742, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.183333333333334, "ram_util_percent": 55.916666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.941570317617027, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2430037041465121, "policy_loss": -0.005223217042743839, "vf_loss": 0.24662498222483742, "vf_explained_var": -0.12830792063026017, "kl": 0.008009697956915886, "entropy": 1.4890174170976045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 15345.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 0.9947653232636755, "episode_reward_min": -1.0, "episode_reward_mean": -0.4545358542641753, "episode_len_mean": 46.52, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, 0.9403585571671411, 0.5, -1.0, 0.7040367612527316, 0.5, 0.6213911114936502, -1.0, 0.9640354522085114, -1.0, -1.0, 0.7289329607789599, -1.0, -1.0, 0.8353996581402614, 0.844044844044067, -1.0, -1.0, 0.9853189294360071, 0.5, -1.0, -1.0, 0.911430106936915, -1.0, -1.0, -1.0, -1.0, 0.660143427362359, -1.0, 0.8804192740304424, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9230617092133437, 0.7504428090868555, -1.0, 0.6884513030510635, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7782992332417608, 0.659413947778287, 0.9947653232636755, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6479192481784699, -1.0, -1.0, -1.0, -1.0, 0.5797782185664522, -1.0, -1.0, 0.7636743530137686, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.7639322689174846, -1.0, -1.0, 0.6502075850063356, -1.0, 0.6834478782645357, -1.0, 0.5875096131493867], "episode_lengths": [18, 80, 80, 15, 14, 45, 77, 80, 33, 31, 15, 80, 75, 52, 69, 23, 21, 20, 19, 64, 65, 29, 16, 21, 41, 24, 28, 80, 80, 20, 80, 37, 14, 55, 18, 16, 21, 80, 80, 29, 26, 64, 27, 74, 27, 45, 73, 80, 20, 80, 29, 57, 80, 76, 31, 36, 33, 80, 80, 23, 18, 23, 80, 80, 48, 21, 80, 38, 44, 34, 54, 12, 80, 19, 47, 19, 21, 80, 32, 80, 78, 39, 23, 33, 26, 29, 48, 25, 45, 58, 80, 54, 47, 80, 80, 17, 80, 17, 80, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09258461752007224, "mean_inference_ms": 0.2569887282055223, "mean_action_processing_ms": 0.033111796057970266, "mean_env_wait_ms": 0.047062760817555345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015506744384765625, "StateBufferConnector_ms": 0.001332998275756836, "ViewRequirementAgentConnector_ms": 0.029193878173828125}}, "episode_reward_max": 0.9947653232636755, "episode_reward_min": -1.0, "episode_reward_mean": -0.4545358542641753, "episode_len_mean": 46.52, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5, -1.0, 0.9403585571671411, 0.5, -1.0, 0.7040367612527316, 0.5, 0.6213911114936502, -1.0, 0.9640354522085114, -1.0, -1.0, 0.7289329607789599, -1.0, -1.0, 0.8353996581402614, 0.844044844044067, -1.0, -1.0, 0.9853189294360071, 0.5, -1.0, -1.0, 0.911430106936915, -1.0, -1.0, -1.0, -1.0, 0.660143427362359, -1.0, 0.8804192740304424, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9230617092133437, 0.7504428090868555, -1.0, 0.6884513030510635, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7782992332417608, 0.659413947778287, 0.9947653232636755, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6479192481784699, -1.0, -1.0, -1.0, -1.0, 0.5797782185664522, -1.0, -1.0, 0.7636743530137686, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.7639322689174846, -1.0, -1.0, 0.6502075850063356, -1.0, 0.6834478782645357, -1.0, 0.5875096131493867], "episode_lengths": [18, 80, 80, 15, 14, 45, 77, 80, 33, 31, 15, 80, 75, 52, 69, 23, 21, 20, 19, 64, 65, 29, 16, 21, 41, 24, 28, 80, 80, 20, 80, 37, 14, 55, 18, 16, 21, 80, 80, 29, 26, 64, 27, 74, 27, 45, 73, 80, 20, 80, 29, 57, 80, 76, 31, 36, 33, 80, 80, 23, 18, 23, 80, 80, 48, 21, 80, 38, 44, 34, 54, 12, 80, 19, 47, 19, 21, 80, 32, 80, 78, 39, 23, 33, 26, 29, 48, 25, 45, 58, 80, 54, 47, 80, 80, 17, 80, 17, 80, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09258461752007224, "mean_inference_ms": 0.2569887282055223, "mean_action_processing_ms": 0.033111796057970266, "mean_env_wait_ms": 0.047062760817555345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015506744384765625, "StateBufferConnector_ms": 0.001332998275756836, "ViewRequirementAgentConnector_ms": 0.029193878173828125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.1751492519093, "num_env_steps_trained_throughput_per_sec": 1098.1751492519093, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 3665.212, "sample_time_ms": 1732.15, "load_time_ms": 0.214, "load_throughput": 18720392.769, "learn_time_ms": 1931.869, "learn_throughput": 2070.534, "synch_weights_time_ms": 0.637}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 1465, "training_iteration": 17, "trial_id": "default", "date": "2024-05-23_11-33-23", "timestamp": 1716456803, "time_this_iter_s": 3.645049810409546, "time_total_s": 61.99506735801697, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 61.99506735801697, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.34, "ram_util_percent": 56.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5800265988995954, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24505573592088636, "policy_loss": -0.02072517096305326, "vf_loss": 0.26297379436311863, "vf_explained_var": -0.14890714499258226, "kl": 0.014035556881770198, "entropy": 1.4759663749766607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 16275.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 0.9990449844809591, "episode_reward_min": -1.0, "episode_reward_mean": -0.47560125430610384, "episode_len_mean": 47.96, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.7639322689174846, -1.0, -1.0, 0.6502075850063356, -1.0, 0.6834478782645357, -1.0, 0.5875096131493867, -1.0, 0.7743467694341285, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7062762061730734, -1.0, 0.6017021098926203, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9627115302949459, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8121831981578328, 0.6069186836444893, 0.5, -1.0, 0.8903124959187826, 0.5, 0.9990449844809591, -1.0, 0.8659327855074612, -1.0, 0.9529130032969646, 0.7592932586638914, -1.0, 0.7474609099718058, -1.0, 0.9886983634776505, 0.6647411853010369, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9120235735945164, -1.0, 0.548820355423342, -1.0, -1.0, 0.9613978108183772, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [29, 48, 25, 45, 58, 80, 54, 47, 80, 80, 17, 80, 17, 80, 17, 62, 68, 80, 57, 36, 60, 19, 20, 16, 19, 22, 17, 20, 14, 21, 76, 36, 62, 18, 46, 80, 50, 23, 80, 51, 70, 80, 26, 24, 27, 15, 80, 80, 80, 63, 24, 80, 18, 80, 80, 19, 17, 80, 38, 80, 58, 37, 80, 15, 14, 24, 19, 25, 72, 28, 80, 68, 59, 21, 21, 19, 37, 69, 20, 20, 80, 49, 57, 80, 22, 20, 80, 80, 64, 80, 78, 80, 24, 80, 39, 61, 45, 44, 34, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0925730527217981, "mean_inference_ms": 0.2569707139010955, "mean_action_processing_ms": 0.03311765871243088, "mean_env_wait_ms": 0.04706192869247717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015425682067871094, "StateBufferConnector_ms": 0.0013604164123535156, "ViewRequirementAgentConnector_ms": 0.02922511100769043}}, "episode_reward_max": 0.9990449844809591, "episode_reward_min": -1.0, "episode_reward_mean": -0.47560125430610384, "episode_len_mean": 47.96, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.7639322689174846, -1.0, -1.0, 0.6502075850063356, -1.0, 0.6834478782645357, -1.0, 0.5875096131493867, -1.0, 0.7743467694341285, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7062762061730734, -1.0, 0.6017021098926203, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9627115302949459, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8121831981578328, 0.6069186836444893, 0.5, -1.0, 0.8903124959187826, 0.5, 0.9990449844809591, -1.0, 0.8659327855074612, -1.0, 0.9529130032969646, 0.7592932586638914, -1.0, 0.7474609099718058, -1.0, 0.9886983634776505, 0.6647411853010369, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9120235735945164, -1.0, 0.548820355423342, -1.0, -1.0, 0.9613978108183772, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [29, 48, 25, 45, 58, 80, 54, 47, 80, 80, 17, 80, 17, 80, 17, 62, 68, 80, 57, 36, 60, 19, 20, 16, 19, 22, 17, 20, 14, 21, 76, 36, 62, 18, 46, 80, 50, 23, 80, 51, 70, 80, 26, 24, 27, 15, 80, 80, 80, 63, 24, 80, 18, 80, 80, 19, 17, 80, 38, 80, 58, 37, 80, 15, 14, 24, 19, 25, 72, 28, 80, 68, 59, 21, 21, 19, 37, 69, 20, 20, 80, 49, 57, 80, 22, 20, 80, 80, 64, 80, 78, 80, 24, 80, 39, 61, 45, 44, 34, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0925730527217981, "mean_inference_ms": 0.2569707139010955, "mean_action_processing_ms": 0.03311765871243088, "mean_env_wait_ms": 0.04706192869247717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015425682067871094, "StateBufferConnector_ms": 0.0013604164123535156, "ViewRequirementAgentConnector_ms": 0.02922511100769043}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1109.0302069841364, "num_env_steps_trained_throughput_per_sec": 1109.0302069841364, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3659.222, "sample_time_ms": 1733.316, "load_time_ms": 0.212, "load_throughput": 18825421.903, "learn_time_ms": 1924.721, "learn_throughput": 2078.223, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 1550, "training_iteration": 18, "trial_id": "default", "date": "2024-05-23_11-33-26", "timestamp": 1716456806, "time_this_iter_s": 3.6093461513519287, "time_total_s": 65.6044135093689, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 65.6044135093689, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.959999999999999, "ram_util_percent": 56.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6486317673357584, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17051926315899799, "policy_loss": -0.012784514488071524, "vf_loss": 0.1814443200876716, "vf_explained_var": 0.07057664343105849, "kl": 0.009297282969575254, "entropy": 1.3878466065211963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 17205.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 0.9670051480436, "episode_reward_min": -1.0, "episode_reward_mean": -0.5790589827737083, "episode_len_mean": 45.17, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9120235735945164, -1.0, 0.548820355423342, -1.0, -1.0, 0.9613978108183772, -1.0, -1.0, -1.0, -1.0, 0.5951407661266872, 0.890877126210176, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6588176817314326, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5759509023880378, -1.0, -1.0, -1.0, -1.0, 0.9670051480436, -1.0, 0.6483411525542082, -1.0, -1.0, -1.0, 0.538467740619847, -1.0, 0.9649944513480566, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9015079500020362, 0.8522818644823744, 0.5210016680164405, -1.0, 0.5, -1.0, -1.0, -1.0, 0.813530304880422, -1.0, -1.0, -1.0, -1.0, 0.8800590552144308, 0.6450796815265213, -1.0, -1.0, -1.0, 0.6515203190413907, 0.5, -1.0, 0.56728417060727, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0], "episode_lengths": [78, 80, 24, 80, 39, 61, 45, 44, 34, 42, 15, 16, 30, 11, 11, 48, 15, 28, 21, 33, 80, 19, 26, 80, 80, 14, 26, 27, 25, 67, 80, 24, 17, 80, 44, 19, 69, 17, 67, 70, 80, 67, 80, 18, 60, 19, 55, 24, 80, 80, 80, 19, 27, 53, 12, 80, 22, 76, 80, 52, 25, 80, 27, 38, 56, 34, 33, 16, 60, 64, 80, 62, 80, 78, 12, 22, 14, 19, 80, 80, 25, 23, 17, 48, 19, 52, 43, 18, 37, 14, 65, 75, 80, 17, 80, 35, 17, 37, 80, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09257163719975697, "mean_inference_ms": 0.25693491590742373, "mean_action_processing_ms": 0.033119463201421985, "mean_env_wait_ms": 0.047059323059405446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015554428100585938, "StateBufferConnector_ms": 0.0013184547424316406, "ViewRequirementAgentConnector_ms": 0.028772592544555664}}, "episode_reward_max": 0.9670051480436, "episode_reward_min": -1.0, "episode_reward_mean": -0.5790589827737083, "episode_len_mean": 45.17, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9120235735945164, -1.0, 0.548820355423342, -1.0, -1.0, 0.9613978108183772, -1.0, -1.0, -1.0, -1.0, 0.5951407661266872, 0.890877126210176, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6588176817314326, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5759509023880378, -1.0, -1.0, -1.0, -1.0, 0.9670051480436, -1.0, 0.6483411525542082, -1.0, -1.0, -1.0, 0.538467740619847, -1.0, 0.9649944513480566, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9015079500020362, 0.8522818644823744, 0.5210016680164405, -1.0, 0.5, -1.0, -1.0, -1.0, 0.813530304880422, -1.0, -1.0, -1.0, -1.0, 0.8800590552144308, 0.6450796815265213, -1.0, -1.0, -1.0, 0.6515203190413907, 0.5, -1.0, 0.56728417060727, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0], "episode_lengths": [78, 80, 24, 80, 39, 61, 45, 44, 34, 42, 15, 16, 30, 11, 11, 48, 15, 28, 21, 33, 80, 19, 26, 80, 80, 14, 26, 27, 25, 67, 80, 24, 17, 80, 44, 19, 69, 17, 67, 70, 80, 67, 80, 18, 60, 19, 55, 24, 80, 80, 80, 19, 27, 53, 12, 80, 22, 76, 80, 52, 25, 80, 27, 38, 56, 34, 33, 16, 60, 64, 80, 62, 80, 78, 12, 22, 14, 19, 80, 80, 25, 23, 17, 48, 19, 52, 43, 18, 37, 14, 65, 75, 80, 17, 80, 35, 17, 37, 80, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09257163719975697, "mean_inference_ms": 0.25693491590742373, "mean_action_processing_ms": 0.033119463201421985, "mean_env_wait_ms": 0.047059323059405446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015554428100585938, "StateBufferConnector_ms": 0.0013184547424316406, "ViewRequirementAgentConnector_ms": 0.028772592544555664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1104.4458425295243, "num_env_steps_trained_throughput_per_sec": 1104.4458425295243, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 3662.808, "sample_time_ms": 1734.649, "load_time_ms": 0.21, "load_throughput": 19041216.661, "learn_time_ms": 1926.975, "learn_throughput": 2075.793, "synch_weights_time_ms": 0.633}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 1640, "training_iteration": 19, "trial_id": "default", "date": "2024-05-23_11-33-30", "timestamp": 1716456810, "time_this_iter_s": 3.6243679523468018, "time_total_s": 69.2287814617157, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 69.2287814617157, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.919999999999998, "ram_util_percent": 56.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.513323073009009, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18011945551361447, "policy_loss": -0.017053286103852174, "vf_loss": 0.19590390326595433, "vf_explained_var": -0.053467751767045706, "kl": 0.006344190867843394, "entropy": 1.3653457405746625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 18135.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 0.9920092381148611, "episode_reward_min": -1.0, "episode_reward_mean": -0.5919701900402331, "episode_len_mean": 45.76, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7108043529123673, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7550612303725612, -1.0, -1.0, 0.6931367566122388, -1.0, -1.0, -1.0, -1.0, 0.9920092381148611, -1.0, -1.0, 0.7344759897192095, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.900298177760301, -1.0, -1.0, 0.5, -1.0, 0.6586612232646987, -1.0, 0.9370831615431063, -1.0, 0.5286820770486098, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8673723334806553, 0.5030727077169826, -1.0, 0.5, 0.5857508643276392, -1.0, 0.9789251730688711, 0.8812591769981616, 0.8471524363394654, -1.0, -1.0, 0.5, -1.0, 0.9300010960440467, -1.0, -1.0, 0.799235000652913, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [37, 14, 65, 75, 80, 17, 80, 35, 17, 37, 80, 25, 22, 35, 25, 29, 10, 64, 22, 69, 15, 71, 11, 80, 80, 66, 13, 11, 44, 18, 25, 80, 80, 19, 80, 76, 41, 69, 14, 43, 59, 26, 63, 80, 80, 16, 18, 80, 12, 80, 66, 80, 21, 80, 19, 35, 80, 19, 21, 74, 28, 15, 20, 17, 72, 80, 18, 52, 76, 80, 80, 80, 16, 22, 80, 18, 19, 31, 55, 76, 80, 28, 31, 17, 20, 80, 52, 18, 16, 34, 80, 24, 64, 80, 80, 80, 25, 21, 9, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09270529243156869, "mean_inference_ms": 0.25734743007362565, "mean_action_processing_ms": 0.03316318793312588, "mean_env_wait_ms": 0.04712238116140721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016412734985351562, "StateBufferConnector_ms": 0.0013873577117919922, "ViewRequirementAgentConnector_ms": 0.029541015625}}, "episode_reward_max": 0.9920092381148611, "episode_reward_min": -1.0, "episode_reward_mean": -0.5919701900402331, "episode_len_mean": 45.76, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7108043529123673, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7550612303725612, -1.0, -1.0, 0.6931367566122388, -1.0, -1.0, -1.0, -1.0, 0.9920092381148611, -1.0, -1.0, 0.7344759897192095, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.900298177760301, -1.0, -1.0, 0.5, -1.0, 0.6586612232646987, -1.0, 0.9370831615431063, -1.0, 0.5286820770486098, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8673723334806553, 0.5030727077169826, -1.0, 0.5, 0.5857508643276392, -1.0, 0.9789251730688711, 0.8812591769981616, 0.8471524363394654, -1.0, -1.0, 0.5, -1.0, 0.9300010960440467, -1.0, -1.0, 0.799235000652913, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [37, 14, 65, 75, 80, 17, 80, 35, 17, 37, 80, 25, 22, 35, 25, 29, 10, 64, 22, 69, 15, 71, 11, 80, 80, 66, 13, 11, 44, 18, 25, 80, 80, 19, 80, 76, 41, 69, 14, 43, 59, 26, 63, 80, 80, 16, 18, 80, 12, 80, 66, 80, 21, 80, 19, 35, 80, 19, 21, 74, 28, 15, 20, 17, 72, 80, 18, 52, 76, 80, 80, 80, 16, 22, 80, 18, 19, 31, 55, 76, 80, 28, 31, 17, 20, 80, 52, 18, 16, 34, 80, 24, 64, 80, 80, 80, 25, 21, 9, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09270529243156869, "mean_inference_ms": 0.25734743007362565, "mean_action_processing_ms": 0.03316318793312588, "mean_env_wait_ms": 0.04712238116140721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016412734985351562, "StateBufferConnector_ms": 0.0013873577117919922, "ViewRequirementAgentConnector_ms": 0.029541015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1084.3020586092068, "num_env_steps_trained_throughput_per_sec": 1084.3020586092068, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 3671.408, "sample_time_ms": 1741.955, "load_time_ms": 0.204, "load_throughput": 19650053.877, "learn_time_ms": 1928.277, "learn_throughput": 2074.39, "synch_weights_time_ms": 0.631}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 1728, "training_iteration": 20, "trial_id": "default", "date": "2024-05-23_11-33-34", "timestamp": 1716456814, "time_this_iter_s": 3.6915671825408936, "time_total_s": 72.92034864425659, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 72.92034864425659, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 22.3, "ram_util_percent": 56.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8485291102240162, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1613603120577404, "policy_loss": -0.00434240609637752, "vf_loss": 0.16378263258625583, "vf_explained_var": 0.11313981131840778, "kl": 0.009600428338826242, "entropy": 1.3269856905424466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19065.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 0.9461351385299932, "episode_reward_min": -1.0, "episode_reward_mean": -0.5073103130619266, "episode_len_mean": 47.5, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8812591769981616, 0.8471524363394654, -1.0, -1.0, 0.5, -1.0, 0.9300010960440467, -1.0, -1.0, 0.799235000652913, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5541922541590065, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.8779216251467031, -1.0, -1.0, 0.7211003531840878, -1.0, -1.0, -1.0, 0.9461351385299932, 0.6191128415283751, -1.0, 0.5, -1.0, -1.0, 0.8242921545605112, -1.0, -1.0, 0.5787976230589225, -1.0, -1.0, 0.7012895622420315, -1.0, -1.0, -1.0, 0.6872449319143537, -1.0, -1.0, 0.9289980896054599, -1.0, -1.0, -1.0, -1.0, 0.7702411526096973, -1.0, -1.0, -1.0, 0.5, 0.7947848109824178, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.703100023673815, -1.0, -1.0, -1.0, 0.8449677476459896, -1.0, -1.0, 0.8235662295314523, -1.0, 0.5, 0.5, -1.0, 0.8517711303112872, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5838053150886386], "episode_lengths": [31, 17, 20, 80, 52, 18, 16, 34, 80, 24, 64, 80, 80, 80, 25, 21, 9, 19, 18, 80, 23, 31, 16, 80, 80, 58, 80, 80, 72, 17, 80, 45, 14, 17, 80, 17, 18, 80, 80, 21, 17, 18, 58, 24, 46, 80, 15, 80, 80, 52, 18, 80, 37, 57, 15, 19, 17, 80, 77, 20, 28, 80, 80, 26, 20, 35, 12, 80, 70, 63, 80, 66, 69, 13, 80, 78, 60, 79, 44, 15, 80, 73, 80, 26, 80, 21, 19, 80, 20, 18, 14, 14, 80, 80, 23, 80, 59, 62, 18, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0926944000673075, "mean_inference_ms": 0.25737140735954583, "mean_action_processing_ms": 0.033173666044266775, "mean_env_wait_ms": 0.04713845803295155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015716552734375, "StateBufferConnector_ms": 0.001310586929321289, "ViewRequirementAgentConnector_ms": 0.029218673706054688}}, "episode_reward_max": 0.9461351385299932, "episode_reward_min": -1.0, "episode_reward_mean": -0.5073103130619266, "episode_len_mean": 47.5, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8812591769981616, 0.8471524363394654, -1.0, -1.0, 0.5, -1.0, 0.9300010960440467, -1.0, -1.0, 0.799235000652913, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5541922541590065, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.8779216251467031, -1.0, -1.0, 0.7211003531840878, -1.0, -1.0, -1.0, 0.9461351385299932, 0.6191128415283751, -1.0, 0.5, -1.0, -1.0, 0.8242921545605112, -1.0, -1.0, 0.5787976230589225, -1.0, -1.0, 0.7012895622420315, -1.0, -1.0, -1.0, 0.6872449319143537, -1.0, -1.0, 0.9289980896054599, -1.0, -1.0, -1.0, -1.0, 0.7702411526096973, -1.0, -1.0, -1.0, 0.5, 0.7947848109824178, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.703100023673815, -1.0, -1.0, -1.0, 0.8449677476459896, -1.0, -1.0, 0.8235662295314523, -1.0, 0.5, 0.5, -1.0, 0.8517711303112872, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5838053150886386], "episode_lengths": [31, 17, 20, 80, 52, 18, 16, 34, 80, 24, 64, 80, 80, 80, 25, 21, 9, 19, 18, 80, 23, 31, 16, 80, 80, 58, 80, 80, 72, 17, 80, 45, 14, 17, 80, 17, 18, 80, 80, 21, 17, 18, 58, 24, 46, 80, 15, 80, 80, 52, 18, 80, 37, 57, 15, 19, 17, 80, 77, 20, 28, 80, 80, 26, 20, 35, 12, 80, 70, 63, 80, 66, 69, 13, 80, 78, 60, 79, 44, 15, 80, 73, 80, 26, 80, 21, 19, 80, 20, 18, 14, 14, 80, 80, 23, 80, 59, 62, 18, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0926944000673075, "mean_inference_ms": 0.25737140735954583, "mean_action_processing_ms": 0.033173666044266775, "mean_env_wait_ms": 0.04713845803295155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015716552734375, "StateBufferConnector_ms": 0.001310586929321289, "ViewRequirementAgentConnector_ms": 0.029218673706054688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1105.1222749324647, "num_env_steps_trained_throughput_per_sec": 1105.1222749324647, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 3672.087, "sample_time_ms": 1742.358, "load_time_ms": 0.207, "load_throughput": 19346420.664, "learn_time_ms": 1928.542, "learn_throughput": 2074.105, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 1810, "training_iteration": 21, "trial_id": "default", "date": "2024-05-23_11-33-37", "timestamp": 1716456817, "time_this_iter_s": 3.622080087661743, "time_total_s": 76.54242873191833, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 76.54242873191833, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 21.366666666666664, "ram_util_percent": 56.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.502803984989402, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2437371990838719, "policy_loss": -0.007407022750265496, "vf_loss": 0.2496188403798207, "vf_explained_var": 0.10053730312214103, "kl": 0.007626891508907951, "entropy": 1.3117872863687494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 19995.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 0.9749176475458793, "episode_reward_min": -1.0, "episode_reward_mean": -0.39106614345684404, "episode_len_mean": 49.59, "episode_media": {}, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.703100023673815, -1.0, -1.0, -1.0, 0.8449677476459896, -1.0, -1.0, 0.8235662295314523, -1.0, 0.5, 0.5, -1.0, 0.8517711303112872, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5838053150886386, -1.0, -1.0, -1.0, 0.5, 0.8235203911523025, -1.0, 0.9000136896997764, -1.0, 0.5, -1.0, 0.9675795587114661, -1.0, -1.0, -1.0, 0.8524877331818267, 0.9226555112966047, 0.5, -1.0, 0.6011577036765001, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5720559940179147, -1.0, -1.0, 0.8784503415849554, 0.7405747744477856, -1.0, 0.5, 0.5149575813396736, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9520156565563165, -1.0, -1.0, -1.0, 0.9334947890671441, -1.0, -1.0, 0.6833585830684672, 0.5, 0.7221283172481094, -1.0, -1.0, 0.6736257266889503, 0.7313658111076615, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.806974425198923, 0.5, -1.0, 0.6847263108715864, -1.0, -1.0, -1.0, -1.0, 0.9749176475458793, 0.5, 0.6501146616025614, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [15, 80, 73, 80, 26, 80, 21, 19, 80, 20, 18, 14, 14, 80, 80, 23, 80, 59, 62, 18, 18, 35, 80, 80, 19, 79, 77, 58, 19, 62, 68, 13, 80, 76, 56, 54, 18, 60, 49, 52, 80, 31, 21, 21, 80, 21, 80, 80, 18, 17, 80, 29, 16, 67, 29, 75, 80, 80, 80, 15, 73, 48, 11, 14, 80, 36, 16, 30, 35, 79, 22, 15, 55, 34, 26, 80, 16, 80, 80, 80, 53, 23, 80, 67, 23, 18, 23, 80, 63, 29, 79, 52, 75, 16, 80, 24, 80, 80, 29, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09265910653071457, "mean_inference_ms": 0.2573691171165066, "mean_action_processing_ms": 0.033180298562198465, "mean_env_wait_ms": 0.047151068305120586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017199516296386719, "StateBufferConnector_ms": 0.0013175010681152344, "ViewRequirementAgentConnector_ms": 0.029416561126708984}}, "episode_reward_max": 0.9749176475458793, "episode_reward_min": -1.0, "episode_reward_mean": -0.39106614345684404, "episode_len_mean": 49.59, "episodes_this_iter": 79, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.703100023673815, -1.0, -1.0, -1.0, 0.8449677476459896, -1.0, -1.0, 0.8235662295314523, -1.0, 0.5, 0.5, -1.0, 0.8517711303112872, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5838053150886386, -1.0, -1.0, -1.0, 0.5, 0.8235203911523025, -1.0, 0.9000136896997764, -1.0, 0.5, -1.0, 0.9675795587114661, -1.0, -1.0, -1.0, 0.8524877331818267, 0.9226555112966047, 0.5, -1.0, 0.6011577036765001, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5720559940179147, -1.0, -1.0, 0.8784503415849554, 0.7405747744477856, -1.0, 0.5, 0.5149575813396736, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.9520156565563165, -1.0, -1.0, -1.0, 0.9334947890671441, -1.0, -1.0, 0.6833585830684672, 0.5, 0.7221283172481094, -1.0, -1.0, 0.6736257266889503, 0.7313658111076615, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.806974425198923, 0.5, -1.0, 0.6847263108715864, -1.0, -1.0, -1.0, -1.0, 0.9749176475458793, 0.5, 0.6501146616025614, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [15, 80, 73, 80, 26, 80, 21, 19, 80, 20, 18, 14, 14, 80, 80, 23, 80, 59, 62, 18, 18, 35, 80, 80, 19, 79, 77, 58, 19, 62, 68, 13, 80, 76, 56, 54, 18, 60, 49, 52, 80, 31, 21, 21, 80, 21, 80, 80, 18, 17, 80, 29, 16, 67, 29, 75, 80, 80, 80, 15, 73, 48, 11, 14, 80, 36, 16, 30, 35, 79, 22, 15, 55, 34, 26, 80, 16, 80, 80, 80, 53, 23, 80, 67, 23, 18, 23, 80, 63, 29, 79, 52, 75, 16, 80, 24, 80, 80, 29, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09265910653071457, "mean_inference_ms": 0.2573691171165066, "mean_action_processing_ms": 0.033180298562198465, "mean_env_wait_ms": 0.047151068305120586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0017199516296386719, "StateBufferConnector_ms": 0.0013175010681152344, "ViewRequirementAgentConnector_ms": 0.029416561126708984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1074.6985636493032, "num_env_steps_trained_throughput_per_sec": 1074.6985636493032, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 3682.692, "sample_time_ms": 1743.163, "load_time_ms": 0.207, "load_throughput": 19341959.88, "learn_time_ms": 1938.327, "learn_throughput": 2063.635, "synch_weights_time_ms": 0.644}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 1889, "training_iteration": 22, "trial_id": "default", "date": "2024-05-23_11-33-41", "timestamp": 1716456821, "time_this_iter_s": 3.7245731353759766, "time_total_s": 80.26700186729431, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 80.26700186729431, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 19.46, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.103200594007328, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.208038626993776, "policy_loss": -0.017110990017892853, "vf_loss": 0.22303828158445896, "vf_explained_var": 0.07673525887150918, "kl": 0.010556669661889081, "entropy": 1.304988964142338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 20925.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 0.9987709367962078, "episode_reward_min": -1.0, "episode_reward_mean": -0.37566852662173766, "episode_len_mean": 52.5, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, 0.806974425198923, 0.5, -1.0, 0.6847263108715864, -1.0, -1.0, -1.0, -1.0, 0.9749176475458793, 0.5, 0.6501146616025614, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.8997227863249796, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6242644114316576, 0.7555377855723994, 0.5, -1.0, 0.9987709367962078, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.9833046683954394, -1.0, -1.0, 0.8836340884548542, 0.8175045191620891, -1.0, 0.5, -1.0, 0.5, -1.0, 0.7017355066361406, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.6395860973229635, 0.5, 0.8332514149826493, -1.0, -1.0, 0.9816533646413296, -1.0, -1.0, 0.8841466463080144, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7734222480931512, 0.8385706093664078, 0.6878338424888366, -1.0, 0.5, 0.7412980806579696, -1.0, -1.0, 0.9584075793350264, 0.7397849894922045, -1.0, 0.5739847171449564, 0.5, -1.0, -1.0], "episode_lengths": [16, 80, 80, 80, 53, 23, 80, 67, 23, 18, 23, 80, 63, 29, 79, 52, 75, 16, 80, 24, 80, 80, 29, 80, 63, 80, 80, 16, 14, 80, 80, 80, 23, 15, 22, 13, 14, 80, 13, 80, 80, 22, 80, 80, 72, 80, 15, 17, 72, 80, 53, 18, 69, 15, 80, 63, 80, 17, 45, 22, 80, 51, 80, 80, 34, 36, 23, 16, 80, 80, 22, 30, 80, 21, 46, 80, 80, 80, 80, 53, 54, 80, 21, 80, 80, 15, 13, 20, 64, 23, 16, 80, 80, 76, 65, 48, 77, 20, 63, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09260615505365984, "mean_inference_ms": 0.2573515325160468, "mean_action_processing_ms": 0.03318245831887255, "mean_env_wait_ms": 0.04714465474363097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016570091247558594, "StateBufferConnector_ms": 0.001313924789428711, "ViewRequirementAgentConnector_ms": 0.028937578201293945}}, "episode_reward_max": 0.9987709367962078, "episode_reward_min": -1.0, "episode_reward_mean": -0.37566852662173766, "episode_len_mean": 52.5, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, 0.806974425198923, 0.5, -1.0, 0.6847263108715864, -1.0, -1.0, -1.0, -1.0, 0.9749176475458793, 0.5, 0.6501146616025614, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.8997227863249796, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6242644114316576, 0.7555377855723994, 0.5, -1.0, 0.9987709367962078, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.9833046683954394, -1.0, -1.0, 0.8836340884548542, 0.8175045191620891, -1.0, 0.5, -1.0, 0.5, -1.0, 0.7017355066361406, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.6395860973229635, 0.5, 0.8332514149826493, -1.0, -1.0, 0.9816533646413296, -1.0, -1.0, 0.8841466463080144, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.7734222480931512, 0.8385706093664078, 0.6878338424888366, -1.0, 0.5, 0.7412980806579696, -1.0, -1.0, 0.9584075793350264, 0.7397849894922045, -1.0, 0.5739847171449564, 0.5, -1.0, -1.0], "episode_lengths": [16, 80, 80, 80, 53, 23, 80, 67, 23, 18, 23, 80, 63, 29, 79, 52, 75, 16, 80, 24, 80, 80, 29, 80, 63, 80, 80, 16, 14, 80, 80, 80, 23, 15, 22, 13, 14, 80, 13, 80, 80, 22, 80, 80, 72, 80, 15, 17, 72, 80, 53, 18, 69, 15, 80, 63, 80, 17, 45, 22, 80, 51, 80, 80, 34, 36, 23, 16, 80, 80, 22, 30, 80, 21, 46, 80, 80, 80, 80, 53, 54, 80, 21, 80, 80, 15, 13, 20, 64, 23, 16, 80, 80, 76, 65, 48, 77, 20, 63, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09260615505365984, "mean_inference_ms": 0.2573515325160468, "mean_action_processing_ms": 0.03318245831887255, "mean_env_wait_ms": 0.04714465474363097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016570091247558594, "StateBufferConnector_ms": 0.001313924789428711, "ViewRequirementAgentConnector_ms": 0.028937578201293945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.3983055214749, "num_env_steps_trained_throughput_per_sec": 1101.3983055214749, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 3683.47, "sample_time_ms": 1742.327, "load_time_ms": 0.204, "load_throughput": 19645451.991, "learn_time_ms": 1939.953, "learn_throughput": 2061.906, "synch_weights_time_ms": 0.637}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 1965, "training_iteration": 23, "trial_id": "default", "date": "2024-05-23_11-33-45", "timestamp": 1716456825, "time_this_iter_s": 3.63409161567688, "time_total_s": 83.90109348297119, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 83.90109348297119, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.560000000000002, "ram_util_percent": 56.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0177813337054302, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23961977694604186, "policy_loss": -0.0009331028628092941, "vf_loss": 0.23889443754989614, "vf_explained_var": 0.040157360351213846, "kl": 0.008292210328281265, "entropy": 1.2970064905381973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 21855.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 0.9785854244486412, "episode_reward_min": -1.0, "episode_reward_mean": -0.3323521075811602, "episode_len_mean": 43.51, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7397849894922045, -1.0, 0.5739847171449564, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7423304859480284, -1.0, 0.8153475868317148, 0.6651201147138528, 0.5, -1.0, 0.9065314825828048, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8445785753793795, 0.6330484947299023, 0.5, -1.0, 0.833058309351846, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5320340524841604, -1.0, 0.7756624284090983, -1.0, -1.0, 0.8283179888464097, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5174696361165543, -1.0, -1.0, 0.655654466645817, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6766109359035073, -1.0, 0.5, 0.5712703196446167, 0.958441805757177, 0.9246039727404186, 0.6028915219988461, -1.0, -1.0, 0.9785854244486412, 0.8263564977832041, -1.0, -1.0, -1.0, -1.0, 0.5988214895464041, -1.0, 0.6666209077918799, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7253439856467723, 0.7335446842250034, -1.0, 0.5, -1.0, 0.5, 0.9687649508838855, 0.5, 0.5, -1.0, 0.9700094168368981], "episode_lengths": [65, 48, 77, 20, 63, 20, 80, 80, 42, 55, 18, 80, 18, 21, 17, 16, 17, 11, 24, 80, 18, 80, 76, 80, 14, 37, 16, 80, 18, 80, 17, 80, 80, 51, 42, 60, 19, 80, 11, 17, 15, 18, 16, 80, 12, 62, 23, 15, 64, 16, 80, 21, 15, 28, 80, 80, 17, 53, 53, 80, 80, 16, 80, 80, 17, 80, 14, 15, 20, 70, 16, 80, 80, 29, 21, 69, 80, 31, 47, 14, 21, 25, 14, 24, 79, 17, 13, 50, 37, 15, 24, 80, 17, 80, 69, 18, 24, 73, 80, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09259105787463745, "mean_inference_ms": 0.2572956806315363, "mean_action_processing_ms": 0.03318333771200372, "mean_env_wait_ms": 0.04713971540068077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015583038330078125, "StateBufferConnector_ms": 0.0013272762298583984, "ViewRequirementAgentConnector_ms": 0.029078960418701172}}, "episode_reward_max": 0.9785854244486412, "episode_reward_min": -1.0, "episode_reward_mean": -0.3323521075811602, "episode_len_mean": 43.51, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7397849894922045, -1.0, 0.5739847171449564, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7423304859480284, -1.0, 0.8153475868317148, 0.6651201147138528, 0.5, -1.0, 0.9065314825828048, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8445785753793795, 0.6330484947299023, 0.5, -1.0, 0.833058309351846, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5320340524841604, -1.0, 0.7756624284090983, -1.0, -1.0, 0.8283179888464097, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5174696361165543, -1.0, -1.0, 0.655654466645817, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6766109359035073, -1.0, 0.5, 0.5712703196446167, 0.958441805757177, 0.9246039727404186, 0.6028915219988461, -1.0, -1.0, 0.9785854244486412, 0.8263564977832041, -1.0, -1.0, -1.0, -1.0, 0.5988214895464041, -1.0, 0.6666209077918799, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7253439856467723, 0.7335446842250034, -1.0, 0.5, -1.0, 0.5, 0.9687649508838855, 0.5, 0.5, -1.0, 0.9700094168368981], "episode_lengths": [65, 48, 77, 20, 63, 20, 80, 80, 42, 55, 18, 80, 18, 21, 17, 16, 17, 11, 24, 80, 18, 80, 76, 80, 14, 37, 16, 80, 18, 80, 17, 80, 80, 51, 42, 60, 19, 80, 11, 17, 15, 18, 16, 80, 12, 62, 23, 15, 64, 16, 80, 21, 15, 28, 80, 80, 17, 53, 53, 80, 80, 16, 80, 80, 17, 80, 14, 15, 20, 70, 16, 80, 80, 29, 21, 69, 80, 31, 47, 14, 21, 25, 14, 24, 79, 17, 13, 50, 37, 15, 24, 80, 17, 80, 69, 18, 24, 73, 80, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09259105787463745, "mean_inference_ms": 0.2572956806315363, "mean_action_processing_ms": 0.03318333771200372, "mean_env_wait_ms": 0.04713971540068077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015583038330078125, "StateBufferConnector_ms": 0.0013272762298583984, "ViewRequirementAgentConnector_ms": 0.029078960418701172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.782379471242, "num_env_steps_trained_throughput_per_sec": 1101.782379471242, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 3683.989, "sample_time_ms": 1741.645, "load_time_ms": 0.206, "load_throughput": 19424818.803, "learn_time_ms": 1941.153, "learn_throughput": 2060.631, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 2059, "training_iteration": 24, "trial_id": "default", "date": "2024-05-23_11-33-48", "timestamp": 1716456828, "time_this_iter_s": 3.633098840713501, "time_total_s": 87.53419232368469, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 87.53419232368469, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 56.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.259996808216136, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.230077093143657, "policy_loss": -0.001196969136275271, "vf_loss": 0.22935206418636667, "vf_explained_var": 0.02897794015945927, "kl": 0.00960998190144112, "entropy": 1.253527707181951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 22785.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 0.9700094168368981, "episode_reward_min": -1.0, "episode_reward_mean": -0.36614227281107814, "episode_len_mean": 46.78, "episode_media": {}, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, -1.0, 0.7253439856467723, 0.7335446842250034, -1.0, 0.5, -1.0, 0.5, 0.9687649508838855, 0.5, 0.5, -1.0, 0.9700094168368981, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8165824169620216, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9240128829402889, 0.5635337039243092, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8682000550891443, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.70182243067503, 0.7730178931589212, 0.8868848488493432, -1.0, -1.0, 0.5, 0.8561161958736334, 0.5, -1.0, 0.800425480430177, 0.533808813115263, -1.0, 0.5008358722216194, 0.5, 0.7256656628214468, -1.0, -1.0, 0.7207120987348155, -1.0, 0.8602539216432012, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9549592397784639, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.9465087333649418, -1.0, -1.0, -1.0, -1.0, 0.6948720201826682, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8598974115343341], "episode_lengths": [79, 17, 13, 50, 37, 15, 24, 80, 17, 80, 69, 18, 24, 73, 80, 16, 80, 80, 80, 16, 73, 80, 80, 19, 73, 80, 24, 20, 14, 79, 63, 27, 32, 17, 58, 80, 17, 41, 19, 13, 80, 19, 38, 80, 21, 39, 18, 16, 80, 52, 78, 16, 27, 22, 78, 16, 54, 18, 58, 15, 25, 80, 14, 80, 50, 11, 12, 17, 80, 80, 57, 72, 77, 76, 28, 18, 80, 80, 80, 23, 80, 19, 63, 16, 80, 58, 80, 80, 19, 80, 16, 66, 16, 18, 80, 12, 17, 59, 80, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09256494695053231, "mean_inference_ms": 0.2572396154986194, "mean_action_processing_ms": 0.03317892703124461, "mean_env_wait_ms": 0.047135516614585794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015192031860351562, "StateBufferConnector_ms": 0.0013332366943359375, "ViewRequirementAgentConnector_ms": 0.029036998748779297}}, "episode_reward_max": 0.9700094168368981, "episode_reward_min": -1.0, "episode_reward_mean": -0.36614227281107814, "episode_len_mean": 46.78, "episodes_this_iter": 84, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, -1.0, 0.7253439856467723, 0.7335446842250034, -1.0, 0.5, -1.0, 0.5, 0.9687649508838855, 0.5, 0.5, -1.0, 0.9700094168368981, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8165824169620216, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9240128829402889, 0.5635337039243092, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8682000550891443, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.70182243067503, 0.7730178931589212, 0.8868848488493432, -1.0, -1.0, 0.5, 0.8561161958736334, 0.5, -1.0, 0.800425480430177, 0.533808813115263, -1.0, 0.5008358722216194, 0.5, 0.7256656628214468, -1.0, -1.0, 0.7207120987348155, -1.0, 0.8602539216432012, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.9549592397784639, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.9465087333649418, -1.0, -1.0, -1.0, -1.0, 0.6948720201826682, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8598974115343341], "episode_lengths": [79, 17, 13, 50, 37, 15, 24, 80, 17, 80, 69, 18, 24, 73, 80, 16, 80, 80, 80, 16, 73, 80, 80, 19, 73, 80, 24, 20, 14, 79, 63, 27, 32, 17, 58, 80, 17, 41, 19, 13, 80, 19, 38, 80, 21, 39, 18, 16, 80, 52, 78, 16, 27, 22, 78, 16, 54, 18, 58, 15, 25, 80, 14, 80, 50, 11, 12, 17, 80, 80, 57, 72, 77, 76, 28, 18, 80, 80, 80, 23, 80, 19, 63, 16, 80, 58, 80, 80, 19, 80, 16, 66, 16, 18, 80, 12, 17, 59, 80, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09256494695053231, "mean_inference_ms": 0.2572396154986194, "mean_action_processing_ms": 0.03317892703124461, "mean_env_wait_ms": 0.047135516614585794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015192031860351562, "StateBufferConnector_ms": 0.0013332366943359375, "ViewRequirementAgentConnector_ms": 0.029036998748779297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1104.2295851791223, "num_env_steps_trained_throughput_per_sec": 1104.2295851791223, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 3675.576, "sample_time_ms": 1739.955, "load_time_ms": 0.204, "load_throughput": 19576681.447, "learn_time_ms": 1934.441, "learn_throughput": 2067.781, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 2143, "training_iteration": 25, "trial_id": "default", "date": "2024-05-23_11-33-52", "timestamp": 1716456832, "time_this_iter_s": 3.6249420642852783, "time_total_s": 91.15913438796997, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.15913438796997, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.119999999999997, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.764733295575265, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23856508344604624, "policy_loss": -0.010843107873393643, "vf_loss": 0.24755787104568494, "vf_explained_var": -0.005288675203118273, "kl": 0.009251609433887857, "entropy": 1.2468590530016088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 23715.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 0.9861423709840141, "episode_reward_min": -1.0, "episode_reward_mean": -0.5456610919579148, "episode_len_mean": 52.4, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.9549592397784639, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.9465087333649418, -1.0, -1.0, -1.0, -1.0, 0.6948720201826682, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8598974115343341, -1.0, -1.0, -1.0, 0.8520486068215243, -1.0, -1.0, -1.0, 0.5290196616550693, -1.0, -1.0, -1.0, -1.0, 0.8032287282587064, -1.0, 0.8756142042670741, -1.0, -1.0, -1.0, 0.6123065309138349, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.8824720170255135, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8147088454000967, 0.5, -1.0, 0.7740558825629951, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8742167404712331, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9861423709840141, -1.0, -1.0, 0.5549022289696173, -1.0, -1.0, 0.7499723796101956, -1.0, 0.5772055703757941, -1.0, -1.0, -1.0, -1.0, 0.5917596320324477, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [28, 18, 80, 80, 80, 23, 80, 19, 63, 16, 80, 58, 80, 80, 19, 80, 16, 66, 16, 18, 80, 12, 17, 59, 80, 17, 62, 32, 31, 75, 80, 80, 75, 17, 80, 80, 17, 70, 70, 72, 15, 34, 80, 40, 46, 80, 28, 80, 17, 80, 80, 80, 41, 32, 70, 41, 80, 79, 80, 80, 80, 76, 21, 14, 62, 80, 61, 80, 80, 21, 80, 54, 48, 11, 70, 80, 57, 22, 80, 13, 80, 29, 13, 59, 80, 79, 16, 80, 16, 44, 16, 73, 80, 26, 22, 59, 21, 16, 39, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09251368129610904, "mean_inference_ms": 0.2572048097892195, "mean_action_processing_ms": 0.033176499729022174, "mean_env_wait_ms": 0.04712907038445259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015537738800048828, "StateBufferConnector_ms": 0.0013239383697509766, "ViewRequirementAgentConnector_ms": 0.029254674911499023}}, "episode_reward_max": 0.9861423709840141, "episode_reward_min": -1.0, "episode_reward_mean": -0.5456610919579148, "episode_len_mean": 52.4, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.9549592397784639, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.9465087333649418, -1.0, -1.0, -1.0, -1.0, 0.6948720201826682, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8598974115343341, -1.0, -1.0, -1.0, 0.8520486068215243, -1.0, -1.0, -1.0, 0.5290196616550693, -1.0, -1.0, -1.0, -1.0, 0.8032287282587064, -1.0, 0.8756142042670741, -1.0, -1.0, -1.0, 0.6123065309138349, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.8824720170255135, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8147088454000967, 0.5, -1.0, 0.7740558825629951, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8742167404712331, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9861423709840141, -1.0, -1.0, 0.5549022289696173, -1.0, -1.0, 0.7499723796101956, -1.0, 0.5772055703757941, -1.0, -1.0, -1.0, -1.0, 0.5917596320324477, -1.0, -1.0, -1.0, -1.0], "episode_lengths": [28, 18, 80, 80, 80, 23, 80, 19, 63, 16, 80, 58, 80, 80, 19, 80, 16, 66, 16, 18, 80, 12, 17, 59, 80, 17, 62, 32, 31, 75, 80, 80, 75, 17, 80, 80, 17, 70, 70, 72, 15, 34, 80, 40, 46, 80, 28, 80, 17, 80, 80, 80, 41, 32, 70, 41, 80, 79, 80, 80, 80, 76, 21, 14, 62, 80, 61, 80, 80, 21, 80, 54, 48, 11, 70, 80, 57, 22, 80, 13, 80, 29, 13, 59, 80, 79, 16, 80, 16, 44, 16, 73, 80, 26, 22, 59, 21, 16, 39, 33]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09251368129610904, "mean_inference_ms": 0.2572048097892195, "mean_action_processing_ms": 0.033176499729022174, "mean_env_wait_ms": 0.04712907038445259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015537738800048828, "StateBufferConnector_ms": 0.0013239383697509766, "ViewRequirementAgentConnector_ms": 0.029254674911499023}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1105.0581463742874, "num_env_steps_trained_throughput_per_sec": 1105.0581463742874, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 3640.562, "sample_time_ms": 1739.4, "load_time_ms": 0.199, "load_throughput": 20056444.71, "learn_time_ms": 1899.987, "learn_throughput": 2105.277, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 2217, "training_iteration": 26, "trial_id": "default", "date": "2024-05-23_11-33-56", "timestamp": 1716456836, "time_this_iter_s": 3.6222240924835205, "time_total_s": 94.78135848045349, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 94.78135848045349, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 15.183333333333335, "ram_util_percent": 56.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5679901847916264, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2542280243289086, "policy_loss": -0.010613085907353189, "vf_loss": 0.2625730736080998, "vf_explained_var": -0.020539516338738063, "kl": 0.011340179709873732, "entropy": 1.259906481671077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 24645.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 0.9768680013711315, "episode_reward_min": -1.0, "episode_reward_mean": -0.3354563167205905, "episode_len_mean": 47.61, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5549022289696173, -1.0, -1.0, 0.7499723796101956, -1.0, 0.5772055703757941, -1.0, -1.0, -1.0, -1.0, 0.5917596320324477, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8626045264503555, 0.5, -1.0, 0.7398165875041554, -1.0, 0.6893114363937756, 0.7309765738934106, -1.0, 0.7156326699867623, 0.5, 0.5, 0.9551299834871889, 0.9563614269691734, -1.0, 0.7842028647268104, -1.0, -1.0, 0.9768680013711315, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6496236589636204, -1.0, -1.0, -1.0, 0.5379958907670199, 0.5, -1.0, -1.0, 0.8735502773260435, 0.9655145190461258, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6259917399658194, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8300938795275576, -1.0, 0.5, 0.9265733305227096, 0.5, 0.9410394801948085, -1.0, -1.0, 0.9405149935894362, -1.0, 0.8389347152909495, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8070936777218632, 0.5467895281009969, -1.0, -1.0, -1.0, -1.0, 0.805351495455252, 0.5, -1.0, 0.7353359717011909, -1.0, 0.5, 0.6863397675448067, 0.8588815204519223], "episode_lengths": [59, 80, 79, 16, 80, 16, 44, 16, 73, 80, 26, 22, 59, 21, 16, 39, 33, 80, 80, 14, 16, 34, 80, 69, 9, 16, 23, 80, 17, 19, 22, 15, 22, 80, 53, 16, 80, 14, 15, 80, 55, 80, 80, 59, 19, 19, 80, 80, 20, 57, 16, 80, 69, 51, 54, 80, 79, 11, 69, 15, 80, 59, 65, 18, 80, 80, 80, 80, 80, 16, 80, 61, 17, 22, 16, 71, 80, 78, 31, 23, 63, 80, 25, 80, 80, 32, 14, 15, 80, 16, 78, 15, 44, 22, 9, 73, 80, 39, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09246934797756651, "mean_inference_ms": 0.2571598226691858, "mean_action_processing_ms": 0.033170580050509615, "mean_env_wait_ms": 0.04712729021831894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00159454345703125, "StateBufferConnector_ms": 0.0013494491577148438, "ViewRequirementAgentConnector_ms": 0.028997421264648438}}, "episode_reward_max": 0.9768680013711315, "episode_reward_min": -1.0, "episode_reward_mean": -0.3354563167205905, "episode_len_mean": 47.61, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5549022289696173, -1.0, -1.0, 0.7499723796101956, -1.0, 0.5772055703757941, -1.0, -1.0, -1.0, -1.0, 0.5917596320324477, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.8626045264503555, 0.5, -1.0, 0.7398165875041554, -1.0, 0.6893114363937756, 0.7309765738934106, -1.0, 0.7156326699867623, 0.5, 0.5, 0.9551299834871889, 0.9563614269691734, -1.0, 0.7842028647268104, -1.0, -1.0, 0.9768680013711315, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6496236589636204, -1.0, -1.0, -1.0, 0.5379958907670199, 0.5, -1.0, -1.0, 0.8735502773260435, 0.9655145190461258, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.6259917399658194, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8300938795275576, -1.0, 0.5, 0.9265733305227096, 0.5, 0.9410394801948085, -1.0, -1.0, 0.9405149935894362, -1.0, 0.8389347152909495, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8070936777218632, 0.5467895281009969, -1.0, -1.0, -1.0, -1.0, 0.805351495455252, 0.5, -1.0, 0.7353359717011909, -1.0, 0.5, 0.6863397675448067, 0.8588815204519223], "episode_lengths": [59, 80, 79, 16, 80, 16, 44, 16, 73, 80, 26, 22, 59, 21, 16, 39, 33, 80, 80, 14, 16, 34, 80, 69, 9, 16, 23, 80, 17, 19, 22, 15, 22, 80, 53, 16, 80, 14, 15, 80, 55, 80, 80, 59, 19, 19, 80, 80, 20, 57, 16, 80, 69, 51, 54, 80, 79, 11, 69, 15, 80, 59, 65, 18, 80, 80, 80, 80, 80, 16, 80, 61, 17, 22, 16, 71, 80, 78, 31, 23, 63, 80, 25, 80, 80, 32, 14, 15, 80, 16, 78, 15, 44, 22, 9, 73, 80, 39, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09246934797756651, "mean_inference_ms": 0.2571598226691858, "mean_action_processing_ms": 0.033170580050509615, "mean_env_wait_ms": 0.04712729021831894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00159454345703125, "StateBufferConnector_ms": 0.0013494491577148438, "ViewRequirementAgentConnector_ms": 0.028997421264648438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1088.251754529578, "num_env_steps_trained_throughput_per_sec": 1088.251754529578, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3643.884, "sample_time_ms": 1736.769, "load_time_ms": 0.199, "load_throughput": 20075644.37, "learn_time_ms": 1905.943, "learn_throughput": 2098.699, "synch_weights_time_ms": 0.637}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 2300, "training_iteration": 27, "trial_id": "default", "date": "2024-05-23_11-33-59", "timestamp": 1716456839, "time_this_iter_s": 3.678124189376831, "time_total_s": 98.45948266983032, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 98.45948266983032, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 15.98, "ram_util_percent": 56.81999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9108439410245546, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28800549635661127, "policy_loss": -0.01172899226507833, "vf_loss": 0.2978490618287876, "vf_explained_var": 0.17447602242551824, "kl": 0.009427147915213896, "entropy": 1.232844542816121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 25575.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 0.9952384239981992, "episode_reward_min": -1.0, "episode_reward_mean": -0.1120550362229471, "episode_len_mean": 44.17, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.805351495455252, 0.5, -1.0, 0.7353359717011909, -1.0, 0.5, 0.6863397675448067, 0.8588815204519223, -1.0, 0.6571354347543479, -1.0, -1.0, 0.9632318011805874, -1.0, -1.0, -1.0, -1.0, 0.9535431487765322, 0.8610971408435788, 0.5, -1.0, 0.9938203251274792, 0.5, 0.5, -1.0, 0.7108379105781809, -1.0, 0.9007575421527408, 0.7649339040962779, -1.0, 0.8129520896673442, -1.0, 0.6796705507031554, -1.0, -1.0, 0.5, -1.0, 0.9184853979293901, -1.0, -1.0, 0.5, 0.9741211692587558, -1.0, 0.8195295897344622, 0.5, -1.0, -1.0, 0.6275699917850968, -1.0, 0.6642431995955813, 0.5, -1.0, 0.6487270749118801, -1.0, -1.0, 0.8221780762577652, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.620672195045273, -1.0, 0.5388112039858877, 0.5, 0.7360790777160561, -1.0, -1.0, -1.0, 0.5845725701698312, 0.5, -1.0, 0.9952384239981992, -1.0, 0.6658548202528456, 0.9151217503930261, 0.7157183131068645, 0.5, 0.9348180857221879, 0.5, -1.0, -1.0, -1.0, 0.5, 0.6501912934266335, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8964534112502422, 0.5, -1.0, 0.6822221301319158, -1.0], "episode_lengths": [78, 15, 44, 22, 9, 73, 80, 39, 15, 18, 80, 18, 57, 42, 44, 47, 80, 80, 80, 15, 15, 16, 80, 17, 16, 26, 80, 14, 74, 16, 15, 70, 75, 11, 26, 51, 80, 44, 19, 67, 80, 12, 17, 16, 80, 15, 17, 80, 52, 16, 22, 18, 39, 43, 17, 80, 80, 18, 80, 65, 80, 19, 16, 21, 61, 80, 16, 73, 70, 21, 71, 80, 35, 29, 65, 26, 55, 18, 15, 14, 66, 21, 22, 10, 80, 14, 24, 67, 54, 63, 52, 46, 80, 80, 18, 14, 53, 80, 56, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0924753844920391, "mean_inference_ms": 0.2571664637371052, "mean_action_processing_ms": 0.03317312985000695, "mean_env_wait_ms": 0.04713651163412171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015869140625, "StateBufferConnector_ms": 0.0013260841369628906, "ViewRequirementAgentConnector_ms": 0.029149770736694336}}, "episode_reward_max": 0.9952384239981992, "episode_reward_min": -1.0, "episode_reward_mean": -0.1120550362229471, "episode_len_mean": 44.17, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.805351495455252, 0.5, -1.0, 0.7353359717011909, -1.0, 0.5, 0.6863397675448067, 0.8588815204519223, -1.0, 0.6571354347543479, -1.0, -1.0, 0.9632318011805874, -1.0, -1.0, -1.0, -1.0, 0.9535431487765322, 0.8610971408435788, 0.5, -1.0, 0.9938203251274792, 0.5, 0.5, -1.0, 0.7108379105781809, -1.0, 0.9007575421527408, 0.7649339040962779, -1.0, 0.8129520896673442, -1.0, 0.6796705507031554, -1.0, -1.0, 0.5, -1.0, 0.9184853979293901, -1.0, -1.0, 0.5, 0.9741211692587558, -1.0, 0.8195295897344622, 0.5, -1.0, -1.0, 0.6275699917850968, -1.0, 0.6642431995955813, 0.5, -1.0, 0.6487270749118801, -1.0, -1.0, 0.8221780762577652, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.620672195045273, -1.0, 0.5388112039858877, 0.5, 0.7360790777160561, -1.0, -1.0, -1.0, 0.5845725701698312, 0.5, -1.0, 0.9952384239981992, -1.0, 0.6658548202528456, 0.9151217503930261, 0.7157183131068645, 0.5, 0.9348180857221879, 0.5, -1.0, -1.0, -1.0, 0.5, 0.6501912934266335, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8964534112502422, 0.5, -1.0, 0.6822221301319158, -1.0], "episode_lengths": [78, 15, 44, 22, 9, 73, 80, 39, 15, 18, 80, 18, 57, 42, 44, 47, 80, 80, 80, 15, 15, 16, 80, 17, 16, 26, 80, 14, 74, 16, 15, 70, 75, 11, 26, 51, 80, 44, 19, 67, 80, 12, 17, 16, 80, 15, 17, 80, 52, 16, 22, 18, 39, 43, 17, 80, 80, 18, 80, 65, 80, 19, 16, 21, 61, 80, 16, 73, 70, 21, 71, 80, 35, 29, 65, 26, 55, 18, 15, 14, 66, 21, 22, 10, 80, 14, 24, 67, 54, 63, 52, 46, 80, 80, 18, 14, 53, 80, 56, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0924753844920391, "mean_inference_ms": 0.2571664637371052, "mean_action_processing_ms": 0.03317312985000695, "mean_env_wait_ms": 0.04713651163412171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015869140625, "StateBufferConnector_ms": 0.0013260841369628906, "ViewRequirementAgentConnector_ms": 0.029149770736694336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1099.6469730996005, "num_env_steps_trained_throughput_per_sec": 1099.6469730996005, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 3646.961, "sample_time_ms": 1737.838, "load_time_ms": 0.2, "load_throughput": 19956245.985, "learn_time_ms": 1907.953, "learn_throughput": 2096.488, "synch_weights_time_ms": 0.632}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 2390, "training_iteration": 28, "trial_id": "default", "date": "2024-05-23_11-34-03", "timestamp": 1716456843, "time_this_iter_s": 3.6401009559631348, "time_total_s": 102.09958362579346, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 102.09958362579346, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 21.1, "ram_util_percent": 56.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5322225118196138, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2584983673523761, "policy_loss": -0.00510477472837734, "vf_loss": 0.2620579765769102, "vf_explained_var": 0.21277550317907845, "kl": 0.007725839855293736, "entropy": 1.2205232767648595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 26505.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 0.9930137365123092, "episode_reward_min": -1.0, "episode_reward_mean": -0.24545262096764628, "episode_len_mean": 46.32, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8964534112502422, 0.5, -1.0, 0.6822221301319158, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6478639598368059, 0.7365254767175673, -1.0, 0.856578098905145, -1.0, -1.0, 0.5, -1.0, 0.626201320426131, -1.0, 0.6251628324252176, -1.0, 0.9803508123578704, -1.0, 0.5, 0.8606527217700216, -1.0, 0.5384533512830934, 0.533310510190363, -1.0, -1.0, -1.0, -1.0, 0.5802743931450082, 0.9131998815963397, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5517378179941852, -1.0, 0.5, 0.5756744547921789, 0.5, -1.0, -1.0, -1.0, 0.5, 0.7995608488069611, -1.0, -1.0, 0.8946263410920842, 0.742199959598878, -1.0, -1.0, -1.0, -1.0, 0.5453564426039343, -1.0, -1.0, 0.8609582029868541, 0.8065492890433046, 0.5, 0.5, -1.0, -1.0, 0.8609610864793831, 0.9930137365123092, 0.5, 0.5082902210911528, 0.5, 0.7410905539333459, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6520134003952903, -1.0, 0.5, 0.8232533497607575, -1.0, 0.5, -1.0, -1.0, 0.5, 0.6222032981090309], "episode_lengths": [54, 63, 52, 46, 80, 80, 18, 14, 53, 80, 56, 57, 80, 60, 80, 13, 14, 13, 18, 62, 16, 80, 80, 16, 80, 17, 14, 15, 80, 14, 65, 16, 13, 80, 15, 13, 80, 45, 80, 80, 58, 18, 80, 10, 80, 21, 49, 80, 14, 80, 20, 23, 15, 16, 43, 80, 55, 80, 74, 15, 73, 80, 42, 19, 63, 80, 16, 17, 14, 80, 80, 63, 16, 51, 20, 80, 18, 13, 14, 43, 77, 48, 50, 80, 30, 27, 26, 80, 22, 63, 63, 80, 31, 15, 66, 63, 16, 24, 19, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0924793391593289, "mean_inference_ms": 0.2571611880714009, "mean_action_processing_ms": 0.03317863288973785, "mean_env_wait_ms": 0.04714556456167587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015506744384765625, "StateBufferConnector_ms": 0.0013108253479003906, "ViewRequirementAgentConnector_ms": 0.029007911682128906}}, "episode_reward_max": 0.9930137365123092, "episode_reward_min": -1.0, "episode_reward_mean": -0.24545262096764628, "episode_len_mean": 46.32, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8964534112502422, 0.5, -1.0, 0.6822221301319158, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6478639598368059, 0.7365254767175673, -1.0, 0.856578098905145, -1.0, -1.0, 0.5, -1.0, 0.626201320426131, -1.0, 0.6251628324252176, -1.0, 0.9803508123578704, -1.0, 0.5, 0.8606527217700216, -1.0, 0.5384533512830934, 0.533310510190363, -1.0, -1.0, -1.0, -1.0, 0.5802743931450082, 0.9131998815963397, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5517378179941852, -1.0, 0.5, 0.5756744547921789, 0.5, -1.0, -1.0, -1.0, 0.5, 0.7995608488069611, -1.0, -1.0, 0.8946263410920842, 0.742199959598878, -1.0, -1.0, -1.0, -1.0, 0.5453564426039343, -1.0, -1.0, 0.8609582029868541, 0.8065492890433046, 0.5, 0.5, -1.0, -1.0, 0.8609610864793831, 0.9930137365123092, 0.5, 0.5082902210911528, 0.5, 0.7410905539333459, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6520134003952903, -1.0, 0.5, 0.8232533497607575, -1.0, 0.5, -1.0, -1.0, 0.5, 0.6222032981090309], "episode_lengths": [54, 63, 52, 46, 80, 80, 18, 14, 53, 80, 56, 57, 80, 60, 80, 13, 14, 13, 18, 62, 16, 80, 80, 16, 80, 17, 14, 15, 80, 14, 65, 16, 13, 80, 15, 13, 80, 45, 80, 80, 58, 18, 80, 10, 80, 21, 49, 80, 14, 80, 20, 23, 15, 16, 43, 80, 55, 80, 74, 15, 73, 80, 42, 19, 63, 80, 16, 17, 14, 80, 80, 63, 16, 51, 20, 80, 18, 13, 14, 43, 77, 48, 50, 80, 30, 27, 26, 80, 22, 63, 63, 80, 31, 15, 66, 63, 16, 24, 19, 67]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0924793391593289, "mean_inference_ms": 0.2571611880714009, "mean_action_processing_ms": 0.03317863288973785, "mean_env_wait_ms": 0.04714556456167587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015506744384765625, "StateBufferConnector_ms": 0.0013108253479003906, "ViewRequirementAgentConnector_ms": 0.029007911682128906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1076.3656763036627, "num_env_steps_trained_throughput_per_sec": 1076.3656763036627, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 3656.409, "sample_time_ms": 1738.313, "load_time_ms": 0.199, "load_throughput": 20058842.659, "learn_time_ms": 1916.902, "learn_throughput": 2086.701, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 2478, "training_iteration": 29, "trial_id": "default", "date": "2024-05-23_11-34-07", "timestamp": 1716456847, "time_this_iter_s": 3.7188780307769775, "time_total_s": 105.81846165657043, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 105.81846165657043, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 16.1, "ram_util_percent": 56.81999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5814622018926885, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23206734751821845, "policy_loss": -0.002555850126169702, "vf_loss": 0.23293067782075816, "vf_explained_var": 0.07358754110592668, "kl": 0.008462590014357249, "entropy": 1.190796023414981, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 27435.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 0.950760783372203, "episode_reward_min": -1.0, "episode_reward_mean": -0.22569446721737713, "episode_len_mean": 45.15, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.6520134003952903, -1.0, 0.5, 0.8232533497607575, -1.0, 0.5, -1.0, -1.0, 0.5, 0.6222032981090309, -1.0, -1.0, 0.5, 0.5039677079686047, 0.9093357821010241, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5853321649914023, 0.7873917501535618, 0.5, 0.5, 0.715089598508434, 0.5, 0.5, -1.0, 0.5, 0.5, 0.7578756396490642, 0.6210249486430401, -1.0, 0.7271589424018334, 0.7123797374068083, -1.0, 0.6164569101920011, -1.0, -1.0, -1.0, 0.5291555449617835, -1.0, 0.5832512163051607, -1.0, -1.0, 0.5231215801659608, -1.0, 0.6989849417807108, 0.5, 0.7644719789495724, 0.5, -1.0, 0.5, -1.0, 0.7162717465525986, 0.5, 0.5017204211549666, 0.8992897682735501, -1.0, 0.5554203587598173, 0.6812000889504572, -1.0, 0.5, 0.607480894926016, 0.8971996039697564, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6012373424234101, -1.0, -1.0, -1.0, 0.8875037774354699, -1.0, -1.0, -1.0, -1.0, -1.0, 0.950760783372203, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0], "episode_lengths": [22, 63, 63, 80, 31, 15, 66, 63, 16, 24, 19, 67, 47, 80, 14, 69, 14, 23, 37, 79, 80, 22, 48, 48, 68, 68, 60, 57, 21, 15, 22, 13, 12, 52, 15, 13, 43, 80, 13, 42, 16, 14, 80, 80, 80, 14, 16, 18, 17, 80, 14, 80, 17, 19, 74, 15, 80, 50, 15, 45, 14, 14, 44, 80, 55, 13, 80, 18, 39, 18, 80, 50, 80, 80, 80, 80, 80, 24, 21, 16, 60, 68, 80, 17, 57, 17, 80, 60, 70, 15, 80, 16, 18, 80, 33, 25, 25, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09247503709719929, "mean_inference_ms": 0.2571516093535202, "mean_action_processing_ms": 0.03317979527355642, "mean_env_wait_ms": 0.04715023597355767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015151500701904297, "StateBufferConnector_ms": 0.0013136863708496094, "ViewRequirementAgentConnector_ms": 0.028992652893066406}}, "episode_reward_max": 0.950760783372203, "episode_reward_min": -1.0, "episode_reward_mean": -0.22569446721737713, "episode_len_mean": 45.15, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.6520134003952903, -1.0, 0.5, 0.8232533497607575, -1.0, 0.5, -1.0, -1.0, 0.5, 0.6222032981090309, -1.0, -1.0, 0.5, 0.5039677079686047, 0.9093357821010241, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5853321649914023, 0.7873917501535618, 0.5, 0.5, 0.715089598508434, 0.5, 0.5, -1.0, 0.5, 0.5, 0.7578756396490642, 0.6210249486430401, -1.0, 0.7271589424018334, 0.7123797374068083, -1.0, 0.6164569101920011, -1.0, -1.0, -1.0, 0.5291555449617835, -1.0, 0.5832512163051607, -1.0, -1.0, 0.5231215801659608, -1.0, 0.6989849417807108, 0.5, 0.7644719789495724, 0.5, -1.0, 0.5, -1.0, 0.7162717465525986, 0.5, 0.5017204211549666, 0.8992897682735501, -1.0, 0.5554203587598173, 0.6812000889504572, -1.0, 0.5, 0.607480894926016, 0.8971996039697564, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.6012373424234101, -1.0, -1.0, -1.0, 0.8875037774354699, -1.0, -1.0, -1.0, -1.0, -1.0, 0.950760783372203, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0], "episode_lengths": [22, 63, 63, 80, 31, 15, 66, 63, 16, 24, 19, 67, 47, 80, 14, 69, 14, 23, 37, 79, 80, 22, 48, 48, 68, 68, 60, 57, 21, 15, 22, 13, 12, 52, 15, 13, 43, 80, 13, 42, 16, 14, 80, 80, 80, 14, 16, 18, 17, 80, 14, 80, 17, 19, 74, 15, 80, 50, 15, 45, 14, 14, 44, 80, 55, 13, 80, 18, 39, 18, 80, 50, 80, 80, 80, 80, 80, 24, 21, 16, 60, 68, 80, 17, 57, 17, 80, 60, 70, 15, 80, 16, 18, 80, 33, 25, 25, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09247503709719929, "mean_inference_ms": 0.2571516093535202, "mean_action_processing_ms": 0.03317979527355642, "mean_env_wait_ms": 0.04715023597355767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015151500701904297, "StateBufferConnector_ms": 0.0013136863708496094, "ViewRequirementAgentConnector_ms": 0.028992652893066406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.6285007460535, "num_env_steps_trained_throughput_per_sec": 1101.6285007460535, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 3650.607, "sample_time_ms": 1732.272, "load_time_ms": 0.203, "load_throughput": 19710075.188, "learn_time_ms": 1917.134, "learn_throughput": 2086.448, "synch_weights_time_ms": 0.657}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 2566, "training_iteration": 30, "trial_id": "default", "date": "2024-05-23_11-34-10", "timestamp": 1716456850, "time_this_iter_s": 3.6335129737854004, "time_total_s": 109.45197463035583, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 109.45197463035583, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 14.260000000000002, "ram_util_percent": 56.78000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4785263175605445, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28022823027705634, "policy_loss": -0.007267590944645226, "vf_loss": 0.28571406874445177, "vf_explained_var": 0.11251747082638484, "kl": 0.008908746353571851, "entropy": 1.158208026039985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 28365.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 0.9918066509071322, "episode_reward_min": -1.0, "episode_reward_mean": -0.16426551564490827, "episode_len_mean": 44.49, "episode_media": {}, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9918066509071322, -1.0, 0.6409405444342724, -1.0, -1.0, -1.0, 0.8838989787216885, -1.0, 0.7499175846600916, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9290763501612046, 0.5422756516129146, 0.5, -1.0, 0.5, 0.5, 0.8209980087952564, 0.9345608648440931, -1.0, 0.5538735777481876, 0.597174868726057, 0.5, -1.0, 0.5, 0.5, 0.5962445313142626, 0.666178570498699, 0.5, 0.7928184166058105, -1.0, 0.7966521998451158, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8869612364772739, -1.0, 0.5, -1.0, 0.7503291815628682, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5372373219445052, -1.0, -1.0, 0.608718330451451, -1.0, 0.5916949423181558, 0.6833769195371799, 0.8034164891938578, -1.0, -1.0, 0.6424534805319744, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5026832361136137, 0.8145404484106977, 0.5, 0.9049692770415306, 0.7703958576886303, -1.0, -1.0, 0.8769712907427447, 0.7383223932985749, -1.0, -1.0, 0.845562600353174, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.619398630968157, 0.5, -1.0, 0.5], "episode_lengths": [18, 80, 33, 25, 25, 80, 80, 80, 64, 54, 19, 80, 63, 49, 14, 79, 48, 23, 15, 20, 80, 80, 80, 80, 60, 14, 20, 43, 16, 57, 23, 49, 15, 80, 50, 14, 19, 22, 14, 49, 14, 18, 18, 18, 68, 47, 43, 47, 80, 80, 47, 13, 80, 40, 80, 77, 59, 80, 80, 22, 24, 74, 17, 35, 27, 56, 51, 44, 54, 49, 55, 18, 17, 61, 66, 20, 80, 80, 55, 31, 28, 13, 48, 80, 14, 17, 19, 32, 80, 18, 65, 15, 15, 67, 52, 17, 14, 16, 80, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09247672735654643, "mean_inference_ms": 0.2571245649679306, "mean_action_processing_ms": 0.03318064321084371, "mean_env_wait_ms": 0.04715252102950669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015726089477539062, "StateBufferConnector_ms": 0.0013089179992675781, "ViewRequirementAgentConnector_ms": 0.028820514678955078}}, "episode_reward_max": 0.9918066509071322, "episode_reward_min": -1.0, "episode_reward_mean": -0.16426551564490827, "episode_len_mean": 44.49, "episodes_this_iter": 92, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.9918066509071322, -1.0, 0.6409405444342724, -1.0, -1.0, -1.0, 0.8838989787216885, -1.0, 0.7499175846600916, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, 0.9290763501612046, 0.5422756516129146, 0.5, -1.0, 0.5, 0.5, 0.8209980087952564, 0.9345608648440931, -1.0, 0.5538735777481876, 0.597174868726057, 0.5, -1.0, 0.5, 0.5, 0.5962445313142626, 0.666178570498699, 0.5, 0.7928184166058105, -1.0, 0.7966521998451158, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8869612364772739, -1.0, 0.5, -1.0, 0.7503291815628682, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5372373219445052, -1.0, -1.0, 0.608718330451451, -1.0, 0.5916949423181558, 0.6833769195371799, 0.8034164891938578, -1.0, -1.0, 0.6424534805319744, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5026832361136137, 0.8145404484106977, 0.5, 0.9049692770415306, 0.7703958576886303, -1.0, -1.0, 0.8769712907427447, 0.7383223932985749, -1.0, -1.0, 0.845562600353174, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.619398630968157, 0.5, -1.0, 0.5], "episode_lengths": [18, 80, 33, 25, 25, 80, 80, 80, 64, 54, 19, 80, 63, 49, 14, 79, 48, 23, 15, 20, 80, 80, 80, 80, 60, 14, 20, 43, 16, 57, 23, 49, 15, 80, 50, 14, 19, 22, 14, 49, 14, 18, 18, 18, 68, 47, 43, 47, 80, 80, 47, 13, 80, 40, 80, 77, 59, 80, 80, 22, 24, 74, 17, 35, 27, 56, 51, 44, 54, 49, 55, 18, 17, 61, 66, 20, 80, 80, 55, 31, 28, 13, 48, 80, 14, 17, 19, 32, 80, 18, 65, 15, 15, 67, 52, 17, 14, 16, 80, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09247672735654643, "mean_inference_ms": 0.2571245649679306, "mean_action_processing_ms": 0.03318064321084371, "mean_env_wait_ms": 0.04715252102950669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015726089477539062, "StateBufferConnector_ms": 0.0013089179992675781, "ViewRequirementAgentConnector_ms": 0.028820514678955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.1503578608613, "num_env_steps_trained_throughput_per_sec": 1102.1503578608613, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 3651.583, "sample_time_ms": 1732.278, "load_time_ms": 0.202, "load_throughput": 19756495.525, "learn_time_ms": 1918.111, "learn_throughput": 2085.385, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 2658, "training_iteration": 31, "trial_id": "default", "date": "2024-05-23_11-34-14", "timestamp": 1716456854, "time_this_iter_s": 3.63185715675354, "time_total_s": 113.08383178710938, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 113.08383178710938, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 19.083333333333332, "ram_util_percent": 56.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.724175939572755, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.29648557667850806, "policy_loss": -0.00401565434951936, "vf_loss": 0.29954822428564554, "vf_explained_var": 0.01975634918417982, "kl": 0.004765034750940153, "entropy": 1.1516432922373536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 0.9909069895367156, "episode_reward_min": -1.0, "episode_reward_mean": -0.017478897886086878, "episode_len_mean": 41.6, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.619398630968157, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.8335814323210059, 0.7636662630829588, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6204259420057938, 0.5523687607062419, -1.0, -1.0, 0.8667207541560702, 0.7021523116460868, -1.0, -1.0, 0.6725258615011571, 0.9909069895367156, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.7692763257975944, -1.0, 0.7383201056491014, -1.0, -1.0, 0.6378818618631595, -1.0, -1.0, 0.5, 0.828244980418881, 0.5, 0.5, 0.5, 0.8126546426426817, 0.5, 0.5, 0.5656708598646293, 0.8324694662003379, 0.5, 0.5965787532120118, 0.9056802394297435, 0.7591112714532288, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7705814903910955, 0.5094685875310132, 0.8119483523702906, 0.5, 0.5, 0.5, -1.0, 0.8055046639654471, 0.5, 0.9012078989027955, -1.0, -1.0, 0.9252532402527437, 0.7600442885093778, 0.8924300503877683, 0.6459639411001841, -1.0, 0.6395119280638455, 0.5962124906290742, -1.0, 0.6867680548995581, 0.6476848532602985, -1.0, -1.0, 0.7932714403847118, 0.551454214566643, -1.0, 0.900030186452642, -1.0, 0.8219788410089357, 0.6790011096055361, -1.0, -1.0, 0.5, 0.9186347758322622, 0.9275243508215342], "episode_lengths": [52, 17, 14, 16, 80, 20, 80, 46, 80, 58, 17, 51, 80, 80, 52, 80, 80, 33, 13, 14, 80, 80, 16, 43, 80, 17, 14, 13, 80, 80, 58, 80, 63, 80, 16, 13, 21, 40, 18, 80, 49, 80, 45, 57, 15, 45, 28, 14, 14, 21, 18, 34, 17, 22, 15, 52, 52, 80, 16, 15, 22, 49, 76, 80, 13, 47, 14, 14, 78, 38, 53, 19, 18, 17, 23, 15, 20, 47, 55, 16, 80, 13, 17, 80, 21, 13, 79, 55, 17, 14, 53, 15, 80, 32, 15, 53, 80, 16, 48, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0924861349732331, "mean_inference_ms": 0.2571070015671016, "mean_action_processing_ms": 0.03318242032188404, "mean_env_wait_ms": 0.04716330398230841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015561580657958984, "StateBufferConnector_ms": 0.0013239383697509766, "ViewRequirementAgentConnector_ms": 0.029114961624145508}}, "episode_reward_max": 0.9909069895367156, "episode_reward_min": -1.0, "episode_reward_mean": -0.017478897886086878, "episode_len_mean": 41.6, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.619398630968157, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.8335814323210059, 0.7636662630829588, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.6204259420057938, 0.5523687607062419, -1.0, -1.0, 0.8667207541560702, 0.7021523116460868, -1.0, -1.0, 0.6725258615011571, 0.9909069895367156, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.7692763257975944, -1.0, 0.7383201056491014, -1.0, -1.0, 0.6378818618631595, -1.0, -1.0, 0.5, 0.828244980418881, 0.5, 0.5, 0.5, 0.8126546426426817, 0.5, 0.5, 0.5656708598646293, 0.8324694662003379, 0.5, 0.5965787532120118, 0.9056802394297435, 0.7591112714532288, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7705814903910955, 0.5094685875310132, 0.8119483523702906, 0.5, 0.5, 0.5, -1.0, 0.8055046639654471, 0.5, 0.9012078989027955, -1.0, -1.0, 0.9252532402527437, 0.7600442885093778, 0.8924300503877683, 0.6459639411001841, -1.0, 0.6395119280638455, 0.5962124906290742, -1.0, 0.6867680548995581, 0.6476848532602985, -1.0, -1.0, 0.7932714403847118, 0.551454214566643, -1.0, 0.900030186452642, -1.0, 0.8219788410089357, 0.6790011096055361, -1.0, -1.0, 0.5, 0.9186347758322622, 0.9275243508215342], "episode_lengths": [52, 17, 14, 16, 80, 20, 80, 46, 80, 58, 17, 51, 80, 80, 52, 80, 80, 33, 13, 14, 80, 80, 16, 43, 80, 17, 14, 13, 80, 80, 58, 80, 63, 80, 16, 13, 21, 40, 18, 80, 49, 80, 45, 57, 15, 45, 28, 14, 14, 21, 18, 34, 17, 22, 15, 52, 52, 80, 16, 15, 22, 49, 76, 80, 13, 47, 14, 14, 78, 38, 53, 19, 18, 17, 23, 15, 20, 47, 55, 16, 80, 13, 17, 80, 21, 13, 79, 55, 17, 14, 53, 15, 80, 32, 15, 53, 80, 16, 48, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0924861349732331, "mean_inference_ms": 0.2571070015671016, "mean_action_processing_ms": 0.03318242032188404, "mean_env_wait_ms": 0.04716330398230841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015561580657958984, "StateBufferConnector_ms": 0.0013239383697509766, "ViewRequirementAgentConnector_ms": 0.029114961624145508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.3820989697324, "num_env_steps_trained_throughput_per_sec": 1102.3820989697324, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 3642.236, "sample_time_ms": 1732.231, "load_time_ms": 0.203, "load_throughput": 19661568.03, "learn_time_ms": 1908.822, "learn_throughput": 2095.533, "synch_weights_time_ms": 0.647}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 2752, "training_iteration": 32, "trial_id": "default", "date": "2024-05-23_11-34-18", "timestamp": 1716456858, "time_this_iter_s": 3.631182909011841, "time_total_s": 116.71501469612122, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 116.71501469612122, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 19.26, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.285710704454812, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2782088767411688, "policy_loss": -0.0017629247278936448, "vf_loss": 0.2794038696114414, "vf_explained_var": 0.012463812674245527, "kl": 0.005679306682562903, "entropy": 1.1276853014064092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 30225.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 0.9937881699710186, "episode_reward_min": -1.0, "episode_reward_mean": 0.025830790657835046, "episode_len_mean": 45.13, "episode_media": {}, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7932714403847118, 0.551454214566643, -1.0, 0.900030186452642, -1.0, 0.8219788410089357, 0.6790011096055361, -1.0, -1.0, 0.5, 0.9186347758322622, 0.9275243508215342, -1.0, 0.854384011297057, 0.5, 0.5, 0.9380135263966628, 0.5, 0.5, 0.5, 0.6830182698025395, 0.7987311578901868, -1.0, -1.0, -1.0, 0.5, 0.7198118115255882, 0.7284933846374884, -1.0, -1.0, 0.8171162139378649, 0.9937881699710186, -1.0, 0.5, 0.5, -1.0, 0.6150785550347179, -1.0, -1.0, 0.5, 0.8705221953344384, 0.9831630154751484, 0.5, 0.7587649832114803, 0.7760600070903335, -1.0, -1.0, 0.5, 0.5907364972052038, 0.6025987970386208, 0.8558563548460444, 0.9233704495391514, 0.6553750862772373, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7666118884883859, 0.6631388320645337, 0.7299436281141618, 0.5275980138416454, 0.8904286332979854, -1.0, -1.0, -1.0, -1.0, 0.7443091536875983, -1.0, 0.7933163053999939, 0.5, -1.0, 0.9920344037967621, -1.0, 0.8349426929544191, 0.6442718077432573, -1.0, -1.0, 0.5431798932725986, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8249293222504398, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5303356572799485, 0.5376346446266294, 0.8835264498954168, -1.0, 0.9201003338866817, -1.0, 0.5], "episode_lengths": [17, 14, 53, 15, 80, 32, 15, 53, 80, 16, 48, 41, 80, 55, 17, 15, 14, 26, 45, 63, 37, 14, 80, 80, 80, 17, 64, 23, 21, 49, 19, 19, 21, 56, 56, 80, 15, 80, 80, 16, 69, 14, 14, 17, 77, 80, 80, 22, 51, 35, 55, 16, 78, 49, 41, 17, 80, 80, 58, 64, 14, 74, 55, 19, 80, 43, 80, 18, 80, 16, 16, 21, 15, 80, 14, 17, 52, 80, 17, 80, 80, 80, 80, 80, 23, 15, 16, 80, 53, 80, 28, 43, 16, 16, 41, 22, 80, 45, 31, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09248461220838938, "mean_inference_ms": 0.2570949276681894, "mean_action_processing_ms": 0.033184881044345624, "mean_env_wait_ms": 0.04716388481765796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015587806701660156, "StateBufferConnector_ms": 0.001293182373046875, "ViewRequirementAgentConnector_ms": 0.029102325439453125}}, "episode_reward_max": 0.9937881699710186, "episode_reward_min": -1.0, "episode_reward_mean": 0.025830790657835046, "episode_len_mean": 45.13, "episodes_this_iter": 88, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7932714403847118, 0.551454214566643, -1.0, 0.900030186452642, -1.0, 0.8219788410089357, 0.6790011096055361, -1.0, -1.0, 0.5, 0.9186347758322622, 0.9275243508215342, -1.0, 0.854384011297057, 0.5, 0.5, 0.9380135263966628, 0.5, 0.5, 0.5, 0.6830182698025395, 0.7987311578901868, -1.0, -1.0, -1.0, 0.5, 0.7198118115255882, 0.7284933846374884, -1.0, -1.0, 0.8171162139378649, 0.9937881699710186, -1.0, 0.5, 0.5, -1.0, 0.6150785550347179, -1.0, -1.0, 0.5, 0.8705221953344384, 0.9831630154751484, 0.5, 0.7587649832114803, 0.7760600070903335, -1.0, -1.0, 0.5, 0.5907364972052038, 0.6025987970386208, 0.8558563548460444, 0.9233704495391514, 0.6553750862772373, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7666118884883859, 0.6631388320645337, 0.7299436281141618, 0.5275980138416454, 0.8904286332979854, -1.0, -1.0, -1.0, -1.0, 0.7443091536875983, -1.0, 0.7933163053999939, 0.5, -1.0, 0.9920344037967621, -1.0, 0.8349426929544191, 0.6442718077432573, -1.0, -1.0, 0.5431798932725986, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, 0.8249293222504398, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.5303356572799485, 0.5376346446266294, 0.8835264498954168, -1.0, 0.9201003338866817, -1.0, 0.5], "episode_lengths": [17, 14, 53, 15, 80, 32, 15, 53, 80, 16, 48, 41, 80, 55, 17, 15, 14, 26, 45, 63, 37, 14, 80, 80, 80, 17, 64, 23, 21, 49, 19, 19, 21, 56, 56, 80, 15, 80, 80, 16, 69, 14, 14, 17, 77, 80, 80, 22, 51, 35, 55, 16, 78, 49, 41, 17, 80, 80, 58, 64, 14, 74, 55, 19, 80, 43, 80, 18, 80, 16, 16, 21, 15, 80, 14, 17, 52, 80, 17, 80, 80, 80, 80, 80, 23, 15, 16, 80, 53, 80, 28, 43, 16, 16, 41, 22, 80, 45, 31, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09248461220838938, "mean_inference_ms": 0.2570949276681894, "mean_action_processing_ms": 0.033184881044345624, "mean_env_wait_ms": 0.04716388481765796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015587806701660156, "StateBufferConnector_ms": 0.001293182373046875, "ViewRequirementAgentConnector_ms": 0.029102325439453125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1100.5824411702406, "num_env_steps_trained_throughput_per_sec": 1100.5824411702406, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 3642.506, "sample_time_ms": 1732.775, "load_time_ms": 0.203, "load_throughput": 19682327.546, "learn_time_ms": 1908.548, "learn_throughput": 2095.835, "synch_weights_time_ms": 0.647}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 2840, "training_iteration": 33, "trial_id": "default", "date": "2024-05-23_11-34-21", "timestamp": 1716456861, "time_this_iter_s": 3.637030839920044, "time_total_s": 120.35204553604126, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 120.35204553604126, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 18.4, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8819908672122545, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2322102140781084, "policy_loss": -0.007671636695502907, "vf_loss": 0.23918828560860567, "vf_explained_var": 0.24768947247535952, "kl": 0.006935644626118907, "entropy": 1.1207388286308575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 31155.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 0.9917099383133723, "episode_reward_min": -1.0, "episode_reward_mean": 0.06185910539116873, "episode_len_mean": 43.8, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.5303356572799485, 0.5376346446266294, 0.8835264498954168, -1.0, 0.9201003338866817, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.6968867660841869, -1.0, 0.7386481239851341, 0.5, -1.0, 0.9305045813995781, 0.9870945598321388, 0.8805378589728423, -1.0, -1.0, -1.0, 0.7957994514855239, 0.9553718488878774, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7091307480811114, 0.8871540496629994, 0.52746229119448, 0.5, 0.8255149302732991, 0.9917099383133723, 0.8613931153402281, -1.0, 0.9542895118650448, -1.0, -1.0, 0.5, 0.7300227031890825, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.7657306046459891, 0.8602532207518341, 0.5, 0.5, -1.0, 0.5, 0.5803908129427309, -1.0, 0.6511708419662383, 0.9636604277667948, -1.0, 0.9622020914373073, 0.7665379592309743, 0.9863019992807366, -1.0, 0.5166087787910025, -1.0, -1.0, -1.0, 0.7324740628719644, -1.0, -1.0, -1.0, 0.9484898706592361, -1.0, 0.8538222971618861, 0.5, 0.9722892300268045, 0.9644353949774669, -1.0, 0.5, 0.6118554105037541, -1.0, -1.0, 0.9232958105388033, 0.6340037105425422, 0.5, 0.9202137112769816, 0.9740380765468277, -1.0, -1.0, 0.9549939123236714, 0.905305657787072, 0.8007898494560687, 0.5, 0.5295226374979398, 0.5644066058766706, -1.0], "episode_lengths": [28, 43, 16, 16, 41, 22, 80, 45, 31, 50, 80, 15, 66, 15, 18, 80, 18, 15, 80, 78, 13, 14, 19, 78, 80, 48, 44, 65, 80, 41, 80, 78, 79, 48, 16, 13, 44, 13, 13, 80, 14, 80, 80, 69, 21, 14, 80, 14, 80, 80, 80, 50, 14, 18, 50, 69, 21, 75, 61, 10, 14, 15, 25, 52, 17, 43, 80, 74, 55, 62, 80, 17, 21, 48, 80, 14, 80, 14, 20, 42, 21, 58, 18, 15, 51, 80, 17, 19, 68, 68, 68, 80, 18, 19, 14, 16, 22, 15, 17, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09248073426494154, "mean_inference_ms": 0.2570809506302446, "mean_action_processing_ms": 0.033183743405032044, "mean_env_wait_ms": 0.04716386922386784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001592397689819336, "StateBufferConnector_ms": 0.0013041496276855469, "ViewRequirementAgentConnector_ms": 0.029079198837280273}}, "episode_reward_max": 0.9917099383133723, "episode_reward_min": -1.0, "episode_reward_mean": 0.06185910539116873, "episode_len_mean": 43.8, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.5303356572799485, 0.5376346446266294, 0.8835264498954168, -1.0, 0.9201003338866817, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, 0.6968867660841869, -1.0, 0.7386481239851341, 0.5, -1.0, 0.9305045813995781, 0.9870945598321388, 0.8805378589728423, -1.0, -1.0, -1.0, 0.7957994514855239, 0.9553718488878774, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7091307480811114, 0.8871540496629994, 0.52746229119448, 0.5, 0.8255149302732991, 0.9917099383133723, 0.8613931153402281, -1.0, 0.9542895118650448, -1.0, -1.0, 0.5, 0.7300227031890825, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.5, 0.7657306046459891, 0.8602532207518341, 0.5, 0.5, -1.0, 0.5, 0.5803908129427309, -1.0, 0.6511708419662383, 0.9636604277667948, -1.0, 0.9622020914373073, 0.7665379592309743, 0.9863019992807366, -1.0, 0.5166087787910025, -1.0, -1.0, -1.0, 0.7324740628719644, -1.0, -1.0, -1.0, 0.9484898706592361, -1.0, 0.8538222971618861, 0.5, 0.9722892300268045, 0.9644353949774669, -1.0, 0.5, 0.6118554105037541, -1.0, -1.0, 0.9232958105388033, 0.6340037105425422, 0.5, 0.9202137112769816, 0.9740380765468277, -1.0, -1.0, 0.9549939123236714, 0.905305657787072, 0.8007898494560687, 0.5, 0.5295226374979398, 0.5644066058766706, -1.0], "episode_lengths": [28, 43, 16, 16, 41, 22, 80, 45, 31, 50, 80, 15, 66, 15, 18, 80, 18, 15, 80, 78, 13, 14, 19, 78, 80, 48, 44, 65, 80, 41, 80, 78, 79, 48, 16, 13, 44, 13, 13, 80, 14, 80, 80, 69, 21, 14, 80, 14, 80, 80, 80, 50, 14, 18, 50, 69, 21, 75, 61, 10, 14, 15, 25, 52, 17, 43, 80, 74, 55, 62, 80, 17, 21, 48, 80, 14, 80, 14, 20, 42, 21, 58, 18, 15, 51, 80, 17, 19, 68, 68, 68, 80, 18, 19, 14, 16, 22, 15, 17, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09248073426494154, "mean_inference_ms": 0.2570809506302446, "mean_action_processing_ms": 0.033183743405032044, "mean_env_wait_ms": 0.04716386922386784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001592397689819336, "StateBufferConnector_ms": 0.0013041496276855469, "ViewRequirementAgentConnector_ms": 0.029079198837280273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1095.1223264675784, "num_env_steps_trained_throughput_per_sec": 1095.1223264675784, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 3644.714, "sample_time_ms": 1732.845, "load_time_ms": 0.205, "load_throughput": 19478945.78, "learn_time_ms": 1910.684, "learn_throughput": 2093.492, "synch_weights_time_ms": 0.648}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 2930, "training_iteration": 34, "trial_id": "default", "date": "2024-05-23_11-34-25", "timestamp": 1716456865, "time_this_iter_s": 3.6552069187164307, "time_total_s": 124.00725245475769, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 124.00725245475769, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.04, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.312998020200319, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2981656069454226, "policy_loss": -0.006741693369062838, "vf_loss": 0.30380622415292646, "vf_explained_var": 0.1584400426956915, "kl": 0.011010753626331355, "entropy": 1.1019787904395852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 32085.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 0.9932218360918985, "episode_reward_min": -1.0, "episode_reward_mean": 0.026428720574238344, "episode_len_mean": 38.41346153846154, "episode_media": {}, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9572739436837719, -1.0, 0.5, 0.877950189074624, 0.9034632808257097, 0.5, -1.0, 0.9475214111480669, 0.8096681348545551, 0.7075053622835641, 0.6751047732259324, 0.9151371492500355, 0.7151411597740697, 0.5, -1.0, 0.5, 0.7305990155915305, 0.5533430804325756, 0.6564736154035307, -1.0, 0.7543606199672399, -1.0, 0.740493595067244, -1.0, 0.5513094766689901, -1.0, -1.0, 0.9932218360918985, -1.0, -1.0, 0.7073051815598091, 0.5, 0.5, 0.5, 0.9377957793855407, -1.0, 0.5, 0.5100714604456349, 0.5, -1.0, -1.0, 0.6973024069127702, 0.9261649767759821, 0.5, -1.0, -1.0, -1.0, 0.5, 0.8366233259953305, 0.5344617704256835, 0.5863300483501432, -1.0, 0.7684710102859026, -1.0, 0.9658030946183315, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9924562940793294, 0.5, 0.8646976242603162, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.6948005868502619, 0.7561105096946767, 0.5, 0.5, -1.0, -1.0, -1.0, 0.6906365498890688, -1.0, 0.5, -1.0, -1.0, 0.9600436509326209, 0.9578022101538529, 0.5, -1.0, 0.9002390241442729, 0.8641604510008158, -1.0, 0.8818432557468758, -1.0, 0.5, 0.6742635483832655, 0.5, 0.5526375364869643], "episode_lengths": [14, 80, 19, 15, 13, 24, 80, 40, 15, 24, 60, 62, 78, 30, 31, 27, 64, 34, 14, 80, 14, 50, 13, 80, 14, 48, 34, 17, 52, 80, 27, 18, 35, 29, 65, 26, 23, 13, 13, 13, 31, 17, 54, 17, 26, 80, 70, 39, 13, 15, 69, 20, 15, 43, 17, 20, 15, 41, 26, 38, 20, 17, 68, 80, 31, 36, 16, 69, 65, 16, 58, 54, 48, 20, 14, 47, 80, 44, 53, 15, 16, 18, 27, 48, 80, 80, 45, 80, 62, 62, 44, 72, 14, 18, 17, 19, 56, 80, 15, 55, 18, 33, 36, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09253058075668984, "mean_inference_ms": 0.25711205277083365, "mean_action_processing_ms": 0.033193002051044744, "mean_env_wait_ms": 0.04718662514848266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001604281938993014, "StateBufferConnector_ms": 0.0013262033462524414, "ViewRequirementAgentConnector_ms": 0.02923745375413161}}, "episode_reward_max": 0.9932218360918985, "episode_reward_min": -1.0, "episode_reward_mean": 0.026428720574238344, "episode_len_mean": 38.41346153846154, "episodes_this_iter": 104, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9572739436837719, -1.0, 0.5, 0.877950189074624, 0.9034632808257097, 0.5, -1.0, 0.9475214111480669, 0.8096681348545551, 0.7075053622835641, 0.6751047732259324, 0.9151371492500355, 0.7151411597740697, 0.5, -1.0, 0.5, 0.7305990155915305, 0.5533430804325756, 0.6564736154035307, -1.0, 0.7543606199672399, -1.0, 0.740493595067244, -1.0, 0.5513094766689901, -1.0, -1.0, 0.9932218360918985, -1.0, -1.0, 0.7073051815598091, 0.5, 0.5, 0.5, 0.9377957793855407, -1.0, 0.5, 0.5100714604456349, 0.5, -1.0, -1.0, 0.6973024069127702, 0.9261649767759821, 0.5, -1.0, -1.0, -1.0, 0.5, 0.8366233259953305, 0.5344617704256835, 0.5863300483501432, -1.0, 0.7684710102859026, -1.0, 0.9658030946183315, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9924562940793294, 0.5, 0.8646976242603162, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.6948005868502619, 0.7561105096946767, 0.5, 0.5, -1.0, -1.0, -1.0, 0.6906365498890688, -1.0, 0.5, -1.0, -1.0, 0.9600436509326209, 0.9578022101538529, 0.5, -1.0, 0.9002390241442729, 0.8641604510008158, -1.0, 0.8818432557468758, -1.0, 0.5, 0.6742635483832655, 0.5, 0.5526375364869643], "episode_lengths": [14, 80, 19, 15, 13, 24, 80, 40, 15, 24, 60, 62, 78, 30, 31, 27, 64, 34, 14, 80, 14, 50, 13, 80, 14, 48, 34, 17, 52, 80, 27, 18, 35, 29, 65, 26, 23, 13, 13, 13, 31, 17, 54, 17, 26, 80, 70, 39, 13, 15, 69, 20, 15, 43, 17, 20, 15, 41, 26, 38, 20, 17, 68, 80, 31, 36, 16, 69, 65, 16, 58, 54, 48, 20, 14, 47, 80, 44, 53, 15, 16, 18, 27, 48, 80, 80, 45, 80, 62, 62, 44, 72, 14, 18, 17, 19, 56, 80, 15, 55, 18, 33, 36, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09253058075668984, "mean_inference_ms": 0.25711205277083365, "mean_action_processing_ms": 0.033193002051044744, "mean_env_wait_ms": 0.04718662514848266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001604281938993014, "StateBufferConnector_ms": 0.0013262033462524414, "ViewRequirementAgentConnector_ms": 0.02923745375413161}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1094.4421554616247, "num_env_steps_trained_throughput_per_sec": 1094.4421554616247, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 3647.953, "sample_time_ms": 1735.47, "load_time_ms": 0.21, "load_throughput": 19045539.789, "learn_time_ms": 1911.297, "learn_throughput": 2092.82, "synch_weights_time_ms": 0.643}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 3034, "training_iteration": 35, "trial_id": "default", "date": "2024-05-23_11-34-29", "timestamp": 1716456869, "time_this_iter_s": 3.6575798988342285, "time_total_s": 127.66483235359192, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 127.66483235359192, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 15.240000000000004, "ram_util_percent": 56.760000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6529588032794256, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.31553930173432754, "policy_loss": -0.014844208017932951, "vf_loss": 0.3292599595762709, "vf_explained_var": 0.12534656787431367, "kl": 0.011235508943214276, "entropy": 1.0587758393056932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33015.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 0.9954099866120774, "episode_reward_min": -1.0, "episode_reward_mean": 0.07070955921793182, "episode_len_mean": 41.82, "episode_media": {}, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8818432557468758, -1.0, 0.5, 0.6742635483832655, 0.5, 0.5526375364869643, -1.0, 0.5, -1.0, -1.0, 0.6113079715702094, 0.815151068255653, 0.6267484751940668, 0.5, -1.0, 0.5, -1.0, 0.6358033767330349, -1.0, 0.8753013850926988, 0.7170107227223462, 0.8246510628140693, -1.0, 0.9954099866120774, 0.5, -1.0, 0.5, 0.5, -1.0, 0.7623332028153718, -1.0, 0.8642874211481322, 0.5136930313237109, -1.0, 0.6687927119471361, 0.687923232322156, -1.0, -1.0, 0.5, -1.0, 0.9641375925232692, -1.0, 0.983768197493396, 0.7769666306128291, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5885090432297608, 0.502910781908673, -1.0, -1.0, 0.7182867620513447, 0.5, 0.9519997387824328, -1.0, -1.0, -1.0, 0.8084067617191794, 0.5, -1.0, -1.0, 0.9696013844866384, 0.871401313299739, 0.9368747691713796, 0.5, -1.0, 0.6022831041749741, 0.8297402587884578, 0.740313211897959, 0.6166703933839556, 0.801609599157714, 0.968844766933391, 0.9730773577430027, -1.0, 0.7912429762122652, -1.0, -1.0, 0.5, -1.0, 0.6999667637473712, 0.5, -1.0, 0.5, 0.6532436877120267, 0.5, 0.7188700873848921, 0.8136277459232123, -1.0, -1.0, 0.5, 0.7680138062224655, 0.5412766797553916, 0.7721545183096916, 0.5, 0.5, -1.0, -1.0, -1.0], "episode_lengths": [15, 55, 18, 33, 36, 15, 70, 18, 80, 80, 63, 16, 14, 19, 80, 68, 80, 13, 80, 47, 50, 63, 80, 53, 42, 22, 16, 63, 24, 59, 80, 39, 36, 27, 15, 45, 80, 40, 34, 25, 37, 80, 44, 57, 49, 17, 75, 16, 31, 45, 19, 28, 70, 17, 14, 15, 80, 80, 16, 19, 15, 20, 80, 19, 53, 54, 15, 25, 14, 14, 58, 33, 15, 21, 52, 27, 17, 75, 80, 52, 13, 59, 19, 50, 57, 38, 18, 14, 15, 80, 24, 20, 73, 27, 14, 33, 47, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09255262381261811, "mean_inference_ms": 0.25711518808780526, "mean_action_processing_ms": 0.03319452077480599, "mean_env_wait_ms": 0.04719485316439506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015273094177246094, "StateBufferConnector_ms": 0.0013129711151123047, "ViewRequirementAgentConnector_ms": 0.02898883819580078}}, "episode_reward_max": 0.9954099866120774, "episode_reward_min": -1.0, "episode_reward_mean": 0.07070955921793182, "episode_len_mean": 41.82, "episodes_this_iter": 94, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8818432557468758, -1.0, 0.5, 0.6742635483832655, 0.5, 0.5526375364869643, -1.0, 0.5, -1.0, -1.0, 0.6113079715702094, 0.815151068255653, 0.6267484751940668, 0.5, -1.0, 0.5, -1.0, 0.6358033767330349, -1.0, 0.8753013850926988, 0.7170107227223462, 0.8246510628140693, -1.0, 0.9954099866120774, 0.5, -1.0, 0.5, 0.5, -1.0, 0.7623332028153718, -1.0, 0.8642874211481322, 0.5136930313237109, -1.0, 0.6687927119471361, 0.687923232322156, -1.0, -1.0, 0.5, -1.0, 0.9641375925232692, -1.0, 0.983768197493396, 0.7769666306128291, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5885090432297608, 0.502910781908673, -1.0, -1.0, 0.7182867620513447, 0.5, 0.9519997387824328, -1.0, -1.0, -1.0, 0.8084067617191794, 0.5, -1.0, -1.0, 0.9696013844866384, 0.871401313299739, 0.9368747691713796, 0.5, -1.0, 0.6022831041749741, 0.8297402587884578, 0.740313211897959, 0.6166703933839556, 0.801609599157714, 0.968844766933391, 0.9730773577430027, -1.0, 0.7912429762122652, -1.0, -1.0, 0.5, -1.0, 0.6999667637473712, 0.5, -1.0, 0.5, 0.6532436877120267, 0.5, 0.7188700873848921, 0.8136277459232123, -1.0, -1.0, 0.5, 0.7680138062224655, 0.5412766797553916, 0.7721545183096916, 0.5, 0.5, -1.0, -1.0, -1.0], "episode_lengths": [15, 55, 18, 33, 36, 15, 70, 18, 80, 80, 63, 16, 14, 19, 80, 68, 80, 13, 80, 47, 50, 63, 80, 53, 42, 22, 16, 63, 24, 59, 80, 39, 36, 27, 15, 45, 80, 40, 34, 25, 37, 80, 44, 57, 49, 17, 75, 16, 31, 45, 19, 28, 70, 17, 14, 15, 80, 80, 16, 19, 15, 20, 80, 19, 53, 54, 15, 25, 14, 14, 58, 33, 15, 21, 52, 27, 17, 75, 80, 52, 13, 59, 19, 50, 57, 38, 18, 14, 15, 80, 24, 20, 73, 27, 14, 33, 47, 80, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09255262381261811, "mean_inference_ms": 0.25711518808780526, "mean_action_processing_ms": 0.03319452077480599, "mean_env_wait_ms": 0.04719485316439506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015273094177246094, "StateBufferConnector_ms": 0.0013129711151123047, "ViewRequirementAgentConnector_ms": 0.02898883819580078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1074.5391492413635, "num_env_steps_trained_throughput_per_sec": 1074.5391492413635, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3658.234, "sample_time_ms": 1737.123, "load_time_ms": 0.21, "load_throughput": 19011009.632, "learn_time_ms": 1919.914, "learn_throughput": 2083.427, "synch_weights_time_ms": 0.648}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 3128, "training_iteration": 36, "trial_id": "default", "date": "2024-05-23_11-34-32", "timestamp": 1716456872, "time_this_iter_s": 3.7253026962280273, "time_total_s": 131.39013504981995, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 131.39013504981995, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.416666666666668, "ram_util_percent": 56.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8046870018846244, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3126516153656637, "policy_loss": -0.009449419947541369, "vf_loss": 0.321119282955444, "vf_explained_var": 0.14530649396681017, "kl": 0.009817536671616724, "entropy": 0.9992263363253686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 33945.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 0.9966594220026603, "episode_reward_min": -1.0, "episode_reward_mean": 0.13971133005686068, "episode_len_mean": 42.77, "episode_media": {}, "episodes_this_iter": 95, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, -1.0, -1.0, -1.0, 0.5493991256835156, -1.0, -1.0, -1.0, 0.5, 0.5, 0.9354039969868605, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7907096206061289, 0.5, -1.0, 0.54933438338923, -1.0, 0.5, -1.0, 0.5, 0.9366664888918627, 0.6674066120884266, 0.7195303690647372, 0.9701101367080694, -1.0, 0.7218195760865207, 0.5, 0.5, 0.9366362944280465, 0.5421572882172466, -1.0, 0.8411702087544056, 0.8681454994437396, 0.9822799119612385, 0.6558899443140195, -1.0, 0.9926358730657738, 0.9227054921615719, 0.6251078931904346, 0.6159991262870994, 0.5, -1.0, 0.648016572518956, 0.6822930803068143, 0.7297812484039812, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.9541747601255787, 0.7216997341348514, 0.9435137692157076, 0.9233606961776095, 0.5639323278440008, -1.0, 0.9587287727744475, 0.86063746807193, -1.0, 0.5, 0.7823860283377876, 0.5, -1.0, 0.5, -1.0, 0.8529920350851936, -1.0, 0.6253158505444232, 0.7892163474859332, 0.9283624754252213, -1.0, 0.9924328916779147, 0.9966594220026603, 0.5789953173216799, 0.7126294294393544, 0.9287899892467789, -1.0, 0.8584686798911919, 0.8856234709226601, 0.8755022337140326, 0.6709410115701395, -1.0, 0.6975915920189453, -1.0, 0.707144379833557, 0.6010892725316064, 0.5, -1.0, 0.622050091600319, 0.5556962161338634], "episode_lengths": [33, 47, 80, 80, 80, 13, 80, 16, 80, 55, 49, 14, 19, 80, 73, 14, 22, 18, 36, 24, 80, 48, 56, 13, 16, 80, 14, 80, 39, 41, 76, 13, 63, 36, 53, 60, 15, 62, 63, 80, 13, 37, 16, 13, 80, 13, 47, 26, 21, 21, 80, 18, 59, 42, 30, 80, 80, 80, 16, 14, 13, 13, 17, 50, 14, 16, 48, 51, 59, 14, 53, 18, 80, 14, 33, 54, 80, 16, 13, 15, 80, 13, 13, 55, 46, 60, 80, 16, 14, 15, 53, 80, 51, 80, 60, 13, 77, 80, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0925659662944739, "mean_inference_ms": 0.25712107754444075, "mean_action_processing_ms": 0.03319935076204843, "mean_env_wait_ms": 0.04720556141294291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016093254089355469, "StateBufferConnector_ms": 0.0013422966003417969, "ViewRequirementAgentConnector_ms": 0.029047250747680664}}, "episode_reward_max": 0.9966594220026603, "episode_reward_min": -1.0, "episode_reward_mean": 0.13971133005686068, "episode_len_mean": 42.77, "episodes_this_iter": 95, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, -1.0, -1.0, -1.0, 0.5493991256835156, -1.0, -1.0, -1.0, 0.5, 0.5, 0.9354039969868605, 0.5, -1.0, 0.5, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7907096206061289, 0.5, -1.0, 0.54933438338923, -1.0, 0.5, -1.0, 0.5, 0.9366664888918627, 0.6674066120884266, 0.7195303690647372, 0.9701101367080694, -1.0, 0.7218195760865207, 0.5, 0.5, 0.9366362944280465, 0.5421572882172466, -1.0, 0.8411702087544056, 0.8681454994437396, 0.9822799119612385, 0.6558899443140195, -1.0, 0.9926358730657738, 0.9227054921615719, 0.6251078931904346, 0.6159991262870994, 0.5, -1.0, 0.648016572518956, 0.6822930803068143, 0.7297812484039812, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, 0.9541747601255787, 0.7216997341348514, 0.9435137692157076, 0.9233606961776095, 0.5639323278440008, -1.0, 0.9587287727744475, 0.86063746807193, -1.0, 0.5, 0.7823860283377876, 0.5, -1.0, 0.5, -1.0, 0.8529920350851936, -1.0, 0.6253158505444232, 0.7892163474859332, 0.9283624754252213, -1.0, 0.9924328916779147, 0.9966594220026603, 0.5789953173216799, 0.7126294294393544, 0.9287899892467789, -1.0, 0.8584686798911919, 0.8856234709226601, 0.8755022337140326, 0.6709410115701395, -1.0, 0.6975915920189453, -1.0, 0.707144379833557, 0.6010892725316064, 0.5, -1.0, 0.622050091600319, 0.5556962161338634], "episode_lengths": [33, 47, 80, 80, 80, 13, 80, 16, 80, 55, 49, 14, 19, 80, 73, 14, 22, 18, 36, 24, 80, 48, 56, 13, 16, 80, 14, 80, 39, 41, 76, 13, 63, 36, 53, 60, 15, 62, 63, 80, 13, 37, 16, 13, 80, 13, 47, 26, 21, 21, 80, 18, 59, 42, 30, 80, 80, 80, 16, 14, 13, 13, 17, 50, 14, 16, 48, 51, 59, 14, 53, 18, 80, 14, 33, 54, 80, 16, 13, 15, 80, 13, 13, 55, 46, 60, 80, 16, 14, 15, 53, 80, 51, 80, 60, 13, 77, 80, 15, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0925659662944739, "mean_inference_ms": 0.25712107754444075, "mean_action_processing_ms": 0.03319935076204843, "mean_env_wait_ms": 0.04720556141294291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016093254089355469, "StateBufferConnector_ms": 0.0013422966003417969, "ViewRequirementAgentConnector_ms": 0.029047250747680664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.5597835517394, "num_env_steps_trained_throughput_per_sec": 1098.5597835517394, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 3654.785, "sample_time_ms": 1738.594, "load_time_ms": 0.21, "load_throughput": 19056356.202, "learn_time_ms": 1914.989, "learn_throughput": 2088.785, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 3223, "training_iteration": 37, "trial_id": "default", "date": "2024-05-23_11-34-36", "timestamp": 1716456876, "time_this_iter_s": 3.6437671184539795, "time_total_s": 135.03390216827393, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 135.03390216827393, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 14.36, "ram_util_percent": 56.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5653100750459137, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21228699394982428, "policy_loss": -0.016684307598619053, "vf_loss": 0.2278647937040816, "vf_explained_var": 0.08360033394188009, "kl": 0.011065063496236652, "entropy": 0.9781749427318573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 34875.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 0.992851537587351, "episode_reward_min": -1.0, "episode_reward_mean": 0.36900997775840166, "episode_len_mean": 37.429906542056074, "episode_media": {}, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.9710526010861495, 0.5, -1.0, 0.5, 0.7153458469855938, -1.0, -1.0, 0.717600190583318, -1.0, 0.8665117005371442, 0.9663679128849245, 0.8329453589075368, 0.9164322408167597, 0.5, 0.8028323701206455, 0.5124166857804622, 0.5, 0.6623383914673175, 0.5462734418479183, -1.0, -1.0, 0.7964157208205995, 0.8743618250285701, -1.0, 0.9666355826925915, 0.5, 0.5, 0.5, 0.9759342034725423, 0.9451833352420094, 0.5, 0.5, 0.7370493032377199, 0.7320515679425637, 0.684694333869083, -1.0, -1.0, -1.0, 0.9646391527355525, 0.918670922444839, 0.8449259696050422, 0.8661930304733351, 0.5700336164481521, 0.8634050612155669, 0.9064305847160796, 0.7660950956243425, -1.0, 0.8399123664846543, -1.0, 0.6994001228717337, 0.5, -1.0, 0.5602738843571959, 0.7722676698743032, 0.992851537587351, 0.9117374499805053, 0.8996625566238942, 0.5, -1.0, 0.7537957037892395, 0.6000985280089404, 0.8707327211486381, 0.5, 0.7133046729684551, 0.7614427223380095, -1.0, -1.0, 0.5, 0.5808131648449593, 0.976721071213945, 0.5566654718895301, 0.8768879054696206, -1.0, 0.9484448323390399, 0.9774330297805999, 0.5139839286915985, 0.9568013047411764, 0.9019316649910543, -1.0, 0.6739594644600376, 0.5, -1.0, 0.5, 0.8035447240754918, 0.94115663241009, 0.5452905081159161, 0.9613562414571558, -1.0, 0.5, 0.5566959500451465, 0.5, 0.5574295219289099, 0.9617606998356087, 0.7172975532618704, 0.5, 0.5841169687267872, 0.6739052936693692, 0.8169885441146936, 0.5, 0.9592508486197427, 0.5, 0.7542379286487446, 0.9592431014778132, 0.9298352827207922, -1.0, 0.5], "episode_lengths": [80, 62, 21, 80, 13, 41, 15, 80, 64, 80, 65, 52, 13, 17, 61, 36, 13, 30, 15, 16, 37, 80, 22, 57, 80, 18, 13, 33, 14, 15, 36, 15, 56, 64, 40, 22, 80, 80, 80, 19, 25, 14, 14, 54, 76, 52, 14, 34, 17, 27, 59, 65, 80, 48, 54, 51, 17, 15, 21, 63, 13, 32, 14, 14, 16, 13, 26, 30, 42, 13, 27, 72, 54, 29, 47, 66, 31, 54, 14, 36, 17, 24, 80, 16, 19, 13, 15, 15, 27, 24, 52, 15, 14, 15, 31, 15, 47, 41, 48, 63, 14, 19, 54, 15, 60, 80, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09260631796709819, "mean_inference_ms": 0.2571493896015169, "mean_action_processing_ms": 0.03320195916591484, "mean_env_wait_ms": 0.047219309285851184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015263245484539282, "StateBufferConnector_ms": 0.0013057316575094918, "ViewRequirementAgentConnector_ms": 0.029133413439599153}}, "episode_reward_max": 0.992851537587351, "episode_reward_min": -1.0, "episode_reward_mean": 0.36900997775840166, "episode_len_mean": 37.429906542056074, "episodes_this_iter": 107, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.9710526010861495, 0.5, -1.0, 0.5, 0.7153458469855938, -1.0, -1.0, 0.717600190583318, -1.0, 0.8665117005371442, 0.9663679128849245, 0.8329453589075368, 0.9164322408167597, 0.5, 0.8028323701206455, 0.5124166857804622, 0.5, 0.6623383914673175, 0.5462734418479183, -1.0, -1.0, 0.7964157208205995, 0.8743618250285701, -1.0, 0.9666355826925915, 0.5, 0.5, 0.5, 0.9759342034725423, 0.9451833352420094, 0.5, 0.5, 0.7370493032377199, 0.7320515679425637, 0.684694333869083, -1.0, -1.0, -1.0, 0.9646391527355525, 0.918670922444839, 0.8449259696050422, 0.8661930304733351, 0.5700336164481521, 0.8634050612155669, 0.9064305847160796, 0.7660950956243425, -1.0, 0.8399123664846543, -1.0, 0.6994001228717337, 0.5, -1.0, 0.5602738843571959, 0.7722676698743032, 0.992851537587351, 0.9117374499805053, 0.8996625566238942, 0.5, -1.0, 0.7537957037892395, 0.6000985280089404, 0.8707327211486381, 0.5, 0.7133046729684551, 0.7614427223380095, -1.0, -1.0, 0.5, 0.5808131648449593, 0.976721071213945, 0.5566654718895301, 0.8768879054696206, -1.0, 0.9484448323390399, 0.9774330297805999, 0.5139839286915985, 0.9568013047411764, 0.9019316649910543, -1.0, 0.6739594644600376, 0.5, -1.0, 0.5, 0.8035447240754918, 0.94115663241009, 0.5452905081159161, 0.9613562414571558, -1.0, 0.5, 0.5566959500451465, 0.5, 0.5574295219289099, 0.9617606998356087, 0.7172975532618704, 0.5, 0.5841169687267872, 0.6739052936693692, 0.8169885441146936, 0.5, 0.9592508486197427, 0.5, 0.7542379286487446, 0.9592431014778132, 0.9298352827207922, -1.0, 0.5], "episode_lengths": [80, 62, 21, 80, 13, 41, 15, 80, 64, 80, 65, 52, 13, 17, 61, 36, 13, 30, 15, 16, 37, 80, 22, 57, 80, 18, 13, 33, 14, 15, 36, 15, 56, 64, 40, 22, 80, 80, 80, 19, 25, 14, 14, 54, 76, 52, 14, 34, 17, 27, 59, 65, 80, 48, 54, 51, 17, 15, 21, 63, 13, 32, 14, 14, 16, 13, 26, 30, 42, 13, 27, 72, 54, 29, 47, 66, 31, 54, 14, 36, 17, 24, 80, 16, 19, 13, 15, 15, 27, 24, 52, 15, 14, 15, 31, 15, 47, 41, 48, 63, 14, 19, 54, 15, 60, 80, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09260631796709819, "mean_inference_ms": 0.2571493896015169, "mean_action_processing_ms": 0.03320195916591484, "mean_env_wait_ms": 0.047219309285851184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015263245484539282, "StateBufferConnector_ms": 0.0013057316575094918, "ViewRequirementAgentConnector_ms": 0.029133413439599153}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1094.9124913373025, "num_env_steps_trained_throughput_per_sec": 1094.9124913373025, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 3656.358, "sample_time_ms": 1739.499, "load_time_ms": 0.212, "load_throughput": 18876255.626, "learn_time_ms": 1915.649, "learn_throughput": 2088.065, "synch_weights_time_ms": 0.658}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 3330, "training_iteration": 38, "trial_id": "default", "date": "2024-05-23_11-34-40", "timestamp": 1716456880, "time_this_iter_s": 3.656079053878784, "time_total_s": 138.6899812221527, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 138.6899812221527, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 19.82, "ram_util_percent": 56.739999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.745818194714926, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.29597822007352625, "policy_loss": -0.0042269007583218875, "vf_loss": 0.29921903895434515, "vf_explained_var": 0.07175155243565959, "kl": 0.009860805564692059, "entropy": 0.9337915580759766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 35805.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 0.9903504019250975, "episode_reward_min": -1.0, "episode_reward_mean": 0.1855249897040329, "episode_len_mean": 45.19, "episode_media": {}, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9617606998356087, 0.7172975532618704, 0.5, 0.5841169687267872, 0.6739052936693692, 0.8169885441146936, 0.5, 0.9592508486197427, 0.5, 0.7542379286487446, 0.9592431014778132, 0.9298352827207922, -1.0, 0.5, 0.5950516644668742, 0.8315903180021154, 0.9315043714534603, 0.8953144386765826, 0.6509236810936336, -1.0, 0.803773276571999, 0.9403034339978928, 0.9746924800257013, -1.0, 0.6757442068429568, -1.0, 0.5, -1.0, -1.0, 0.725056746328758, 0.8644360491532611, -1.0, -1.0, 0.5660900782168592, 0.5, 0.5, -1.0, 0.6577964894899082, -1.0, 0.9061096810761265, 0.5, 0.5572548049695449, 0.5, 0.5364316314882718, 0.5, -1.0, 0.5845477007103959, 0.9903504019250975, -1.0, -1.0, -1.0, 0.7228555438262706, 0.8744553267321913, 0.5937309271475839, -1.0, 0.77127485231963, -1.0, 0.7149316501616576, 0.6177811801438513, 0.6083762971091421, 0.7787083672759791, 0.6334536281143635, -1.0, 0.6737723136377405, 0.7951285147646039, 0.7105715018904339, -1.0, -1.0, -1.0, 0.5, 0.5324178994715, 0.9849825893866833, 0.9334571020451805, -1.0, 0.5, 0.853483765995021, 0.6148055777292489, -1.0, 0.5350230220803769, -1.0, -1.0, -1.0, -1.0, 0.8830345901076742, 0.7339187392761655, 0.9486128948830524, 0.5, -1.0, -1.0, -1.0, 0.8761901873961554, 0.5524723802375133, 0.5, 0.621136659294157, 0.5776381634271428, 0.6394924380495541, 0.6086146011101289, -1.0, 0.5824946490044873, 0.5360759322209399], "episode_lengths": [15, 31, 15, 47, 41, 48, 63, 14, 19, 54, 15, 60, 80, 14, 78, 18, 23, 13, 58, 44, 14, 14, 68, 24, 21, 80, 78, 26, 80, 58, 42, 29, 80, 21, 24, 77, 80, 61, 80, 75, 15, 16, 20, 56, 58, 80, 16, 55, 80, 80, 80, 57, 64, 51, 66, 18, 80, 60, 31, 17, 53, 14, 80, 43, 51, 13, 80, 80, 80, 71, 14, 49, 64, 80, 18, 54, 56, 64, 16, 80, 80, 28, 18, 13, 18, 64, 16, 25, 80, 80, 62, 16, 19, 21, 17, 14, 17, 55, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09259644167591993, "mean_inference_ms": 0.2571352841853405, "mean_action_processing_ms": 0.03320175091951364, "mean_env_wait_ms": 0.04721851863670768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015835762023925781, "StateBufferConnector_ms": 0.0013055801391601562, "ViewRequirementAgentConnector_ms": 0.028863906860351562}}, "episode_reward_max": 0.9903504019250975, "episode_reward_min": -1.0, "episode_reward_mean": 0.1855249897040329, "episode_len_mean": 45.19, "episodes_this_iter": 86, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9617606998356087, 0.7172975532618704, 0.5, 0.5841169687267872, 0.6739052936693692, 0.8169885441146936, 0.5, 0.9592508486197427, 0.5, 0.7542379286487446, 0.9592431014778132, 0.9298352827207922, -1.0, 0.5, 0.5950516644668742, 0.8315903180021154, 0.9315043714534603, 0.8953144386765826, 0.6509236810936336, -1.0, 0.803773276571999, 0.9403034339978928, 0.9746924800257013, -1.0, 0.6757442068429568, -1.0, 0.5, -1.0, -1.0, 0.725056746328758, 0.8644360491532611, -1.0, -1.0, 0.5660900782168592, 0.5, 0.5, -1.0, 0.6577964894899082, -1.0, 0.9061096810761265, 0.5, 0.5572548049695449, 0.5, 0.5364316314882718, 0.5, -1.0, 0.5845477007103959, 0.9903504019250975, -1.0, -1.0, -1.0, 0.7228555438262706, 0.8744553267321913, 0.5937309271475839, -1.0, 0.77127485231963, -1.0, 0.7149316501616576, 0.6177811801438513, 0.6083762971091421, 0.7787083672759791, 0.6334536281143635, -1.0, 0.6737723136377405, 0.7951285147646039, 0.7105715018904339, -1.0, -1.0, -1.0, 0.5, 0.5324178994715, 0.9849825893866833, 0.9334571020451805, -1.0, 0.5, 0.853483765995021, 0.6148055777292489, -1.0, 0.5350230220803769, -1.0, -1.0, -1.0, -1.0, 0.8830345901076742, 0.7339187392761655, 0.9486128948830524, 0.5, -1.0, -1.0, -1.0, 0.8761901873961554, 0.5524723802375133, 0.5, 0.621136659294157, 0.5776381634271428, 0.6394924380495541, 0.6086146011101289, -1.0, 0.5824946490044873, 0.5360759322209399], "episode_lengths": [15, 31, 15, 47, 41, 48, 63, 14, 19, 54, 15, 60, 80, 14, 78, 18, 23, 13, 58, 44, 14, 14, 68, 24, 21, 80, 78, 26, 80, 58, 42, 29, 80, 21, 24, 77, 80, 61, 80, 75, 15, 16, 20, 56, 58, 80, 16, 55, 80, 80, 80, 57, 64, 51, 66, 18, 80, 60, 31, 17, 53, 14, 80, 43, 51, 13, 80, 80, 80, 71, 14, 49, 64, 80, 18, 54, 56, 64, 16, 80, 80, 28, 18, 13, 18, 64, 16, 25, 80, 80, 62, 16, 19, 21, 17, 14, 17, 55, 17, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09259644167591993, "mean_inference_ms": 0.2571352841853405, "mean_action_processing_ms": 0.03320175091951364, "mean_env_wait_ms": 0.04721851863670768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015835762023925781, "StateBufferConnector_ms": 0.0013055801391601562, "ViewRequirementAgentConnector_ms": 0.028863906860351562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1093.6330672000413, "num_env_steps_trained_throughput_per_sec": 1093.6330672000413, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 3650.49, "sample_time_ms": 1738.962, "load_time_ms": 0.215, "load_throughput": 18620661.487, "learn_time_ms": 1910.341, "learn_throughput": 2093.867, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 3416, "training_iteration": 39, "trial_id": "default", "date": "2024-05-23_11-34-43", "timestamp": 1716456883, "time_this_iter_s": 3.660123109817505, "time_total_s": 142.35010433197021, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.35010433197021, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 14.819999999999999, "ram_util_percent": 56.71999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.538115676115918, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.25948396694223064, "policy_loss": -0.0020226932831749482, "vf_loss": 0.2606164902608882, "vf_explained_var": 0.1555101005620854, "kl": 0.008901697259686033, "entropy": 0.9838854823061215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 36735.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 0.9820547944746919, "episode_reward_min": -1.0, "episode_reward_mean": 0.08455938742564871, "episode_len_mean": 43.73, "episode_media": {}, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.8761901873961554, 0.5524723802375133, 0.5, 0.621136659294157, 0.5776381634271428, 0.6394924380495541, 0.6086146011101289, -1.0, 0.5824946490044873, 0.5360759322209399, 0.58220749025075, 0.5, -1.0, 0.8731199364504724, -1.0, 0.7849252341076179, 0.9820547944746919, 0.974408574284468, 0.5, 0.801927292683863, -1.0, 0.5, 0.5, 0.7044842820956547, -1.0, -1.0, -1.0, 0.5, 0.7656342689050666, -1.0, 0.5, 0.5, -1.0, 0.5587543273288456, 0.6906701775590036, 0.5, 0.5718341423370953, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6923378399884383, -1.0, 0.6202343582905618, 0.8827911109449288, 0.5, 0.6379081391353743, 0.5269199572101707, 0.9628512864172457, 0.6874675967833404, -1.0, 0.71638376948594, 0.877785436238428, 0.6282372727741115, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7526316539868663, 0.78084551192246, 0.5, 0.7458384932897468, 0.5, -1.0, 0.9590311791247172, -1.0, 0.5310964739641857, 0.9655219831069564, 0.5, 0.5716438493258212, -1.0, 0.5692401642849487, -1.0, 0.9248918205394803, -1.0, 0.8795708361546432, 0.6474037814077143, -1.0, 0.9663713934994195, -1.0, 0.5, 0.6595925668135485, -1.0, -1.0, -1.0, 0.8479006587204477, 0.5, -1.0, 0.8360320830383773, 0.6805021358311326, 0.6450125746603654, -1.0, 0.9757592844078935, 0.5], "episode_lengths": [80, 62, 16, 19, 21, 17, 14, 17, 55, 17, 17, 48, 16, 80, 56, 80, 25, 13, 15, 27, 19, 80, 15, 56, 51, 64, 80, 80, 59, 13, 80, 15, 49, 80, 14, 15, 20, 52, 80, 80, 30, 49, 80, 18, 17, 35, 51, 63, 15, 48, 75, 13, 58, 36, 16, 15, 70, 80, 80, 38, 23, 80, 15, 39, 19, 57, 53, 16, 69, 80, 53, 49, 74, 16, 14, 54, 80, 16, 42, 50, 19, 17, 79, 78, 14, 46, 61, 13, 23, 80, 80, 73, 59, 80, 25, 13, 14, 48, 54, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.092598143388959, "mean_inference_ms": 0.2571397413648889, "mean_action_processing_ms": 0.03320364082666665, "mean_env_wait_ms": 0.04722250626745739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015435218811035156, "StateBufferConnector_ms": 0.0013117790222167969, "ViewRequirementAgentConnector_ms": 0.029100656509399414}}, "episode_reward_max": 0.9820547944746919, "episode_reward_min": -1.0, "episode_reward_mean": 0.08455938742564871, "episode_len_mean": 43.73, "episodes_this_iter": 89, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.8761901873961554, 0.5524723802375133, 0.5, 0.621136659294157, 0.5776381634271428, 0.6394924380495541, 0.6086146011101289, -1.0, 0.5824946490044873, 0.5360759322209399, 0.58220749025075, 0.5, -1.0, 0.8731199364504724, -1.0, 0.7849252341076179, 0.9820547944746919, 0.974408574284468, 0.5, 0.801927292683863, -1.0, 0.5, 0.5, 0.7044842820956547, -1.0, -1.0, -1.0, 0.5, 0.7656342689050666, -1.0, 0.5, 0.5, -1.0, 0.5587543273288456, 0.6906701775590036, 0.5, 0.5718341423370953, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6923378399884383, -1.0, 0.6202343582905618, 0.8827911109449288, 0.5, 0.6379081391353743, 0.5269199572101707, 0.9628512864172457, 0.6874675967833404, -1.0, 0.71638376948594, 0.877785436238428, 0.6282372727741115, -1.0, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7526316539868663, 0.78084551192246, 0.5, 0.7458384932897468, 0.5, -1.0, 0.9590311791247172, -1.0, 0.5310964739641857, 0.9655219831069564, 0.5, 0.5716438493258212, -1.0, 0.5692401642849487, -1.0, 0.9248918205394803, -1.0, 0.8795708361546432, 0.6474037814077143, -1.0, 0.9663713934994195, -1.0, 0.5, 0.6595925668135485, -1.0, -1.0, -1.0, 0.8479006587204477, 0.5, -1.0, 0.8360320830383773, 0.6805021358311326, 0.6450125746603654, -1.0, 0.9757592844078935, 0.5], "episode_lengths": [80, 62, 16, 19, 21, 17, 14, 17, 55, 17, 17, 48, 16, 80, 56, 80, 25, 13, 15, 27, 19, 80, 15, 56, 51, 64, 80, 80, 59, 13, 80, 15, 49, 80, 14, 15, 20, 52, 80, 80, 30, 49, 80, 18, 17, 35, 51, 63, 15, 48, 75, 13, 58, 36, 16, 15, 70, 80, 80, 38, 23, 80, 15, 39, 19, 57, 53, 16, 69, 80, 53, 49, 74, 16, 14, 54, 80, 16, 42, 50, 19, 17, 79, 78, 14, 46, 61, 13, 23, 80, 80, 73, 59, 80, 25, 13, 14, 48, 54, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.092598143388959, "mean_inference_ms": 0.2571397413648889, "mean_action_processing_ms": 0.03320364082666665, "mean_env_wait_ms": 0.04722250626745739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015435218811035156, "StateBufferConnector_ms": 0.0013117790222167969, "ViewRequirementAgentConnector_ms": 0.029100656509399414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1080.7600201887005, "num_env_steps_trained_throughput_per_sec": 1080.7600201887005, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 3657.501, "sample_time_ms": 1739.457, "load_time_ms": 0.212, "load_throughput": 18912429.264, "learn_time_ms": 1916.864, "learn_throughput": 2086.742, "synch_weights_time_ms": 0.635}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 3505, "training_iteration": 40, "trial_id": "default", "date": "2024-05-23_11-34-47", "timestamp": 1716456887, "time_this_iter_s": 3.7037580013275146, "time_total_s": 146.05386233329773, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 146.05386233329773, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 21.1, "ram_util_percent": 56.74000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7869742606275825, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.29955758291615237, "policy_loss": -0.005234197891687834, "vf_loss": 0.30381493113374197, "vf_explained_var": 0.1500206732621757, "kl": 0.00976852107614643, "entropy": 1.0007561351663323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 37665.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 0.999776339044168, "episode_reward_min": -1.0, "episode_reward_mean": 0.12149442582778361, "episode_len_mean": 38.70873786407767, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6534501540726422, 0.8992471957938791, -1.0, -1.0, 0.9509044093874317, -1.0, 0.6618728692889722, -1.0, 0.7328112438047579, -1.0, 0.5, -1.0, 0.7070060019483089, 0.5, 0.5222621723798184, -1.0, 0.5, -1.0, 0.5, 0.5, 0.515485742757154, 0.5, -1.0, 0.5, -1.0, 0.7234030352641626, 0.7867775154675559, 0.98546425587032, 0.5216935693362338, 0.771784044368802, -1.0, 0.5, 0.6945562579242555, -1.0, 0.5, 0.9770748218211364, 0.5, -1.0, 0.5, 0.5, 0.5289273046862637, 0.6551003154246638, -1.0, 0.5, 0.8048230104140088, -1.0, 0.8810520971518282, 0.7225313082820933, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6685045587385052, 0.8301596930781682, 0.5, 0.826366342978773, -1.0, 0.5024980280795246, 0.5, 0.8672715606035191, -1.0, 0.7022446231495427, 0.9302923962076222, 0.5006174500560402, 0.7559080355694143, 0.5, -1.0, 0.89591363414424, 0.5865152752242768, 0.999776339044168, -1.0, 0.8124736910602217, 0.8497859004466211, 0.7606965446735635, -1.0, 0.5, 0.9512231119005573, 0.9369157481411069, -1.0, 0.8302249110270628, -1.0, 0.5, -1.0, 0.8008413392758875, -1.0, 0.5, -1.0, 0.5021685867906234, -1.0, -1.0, -1.0, 0.9910227234042138, 0.5, -1.0, 0.5, 0.9300470537156876, 0.5, 0.5322498922078609, 0.946763443979392, 0.5, 0.9072176513208292], "episode_lengths": [14, 65, 80, 46, 37, 80, 13, 45, 15, 80, 62, 25, 53, 15, 15, 33, 48, 80, 13, 13, 44, 40, 80, 19, 80, 19, 15, 15, 15, 16, 80, 33, 39, 74, 49, 13, 18, 46, 16, 15, 14, 17, 80, 15, 41, 80, 19, 56, 80, 80, 80, 18, 18, 80, 16, 13, 17, 15, 28, 22, 14, 48, 80, 17, 18, 52, 62, 20, 15, 78, 52, 17, 17, 13, 15, 13, 65, 58, 54, 15, 80, 17, 21, 61, 30, 58, 80, 17, 41, 13, 80, 80, 64, 13, 18, 80, 14, 16, 13, 37, 37, 34, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09263185680469722, "mean_inference_ms": 0.2571614419348872, "mean_action_processing_ms": 0.033204861862943046, "mean_env_wait_ms": 0.047232328236476315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015599056355004171, "StateBufferConnector_ms": 0.0012944045576077064, "ViewRequirementAgentConnector_ms": 0.02924377478442146}}, "episode_reward_max": 0.999776339044168, "episode_reward_min": -1.0, "episode_reward_mean": 0.12149442582778361, "episode_len_mean": 38.70873786407767, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6534501540726422, 0.8992471957938791, -1.0, -1.0, 0.9509044093874317, -1.0, 0.6618728692889722, -1.0, 0.7328112438047579, -1.0, 0.5, -1.0, 0.7070060019483089, 0.5, 0.5222621723798184, -1.0, 0.5, -1.0, 0.5, 0.5, 0.515485742757154, 0.5, -1.0, 0.5, -1.0, 0.7234030352641626, 0.7867775154675559, 0.98546425587032, 0.5216935693362338, 0.771784044368802, -1.0, 0.5, 0.6945562579242555, -1.0, 0.5, 0.9770748218211364, 0.5, -1.0, 0.5, 0.5, 0.5289273046862637, 0.6551003154246638, -1.0, 0.5, 0.8048230104140088, -1.0, 0.8810520971518282, 0.7225313082820933, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6685045587385052, 0.8301596930781682, 0.5, 0.826366342978773, -1.0, 0.5024980280795246, 0.5, 0.8672715606035191, -1.0, 0.7022446231495427, 0.9302923962076222, 0.5006174500560402, 0.7559080355694143, 0.5, -1.0, 0.89591363414424, 0.5865152752242768, 0.999776339044168, -1.0, 0.8124736910602217, 0.8497859004466211, 0.7606965446735635, -1.0, 0.5, 0.9512231119005573, 0.9369157481411069, -1.0, 0.8302249110270628, -1.0, 0.5, -1.0, 0.8008413392758875, -1.0, 0.5, -1.0, 0.5021685867906234, -1.0, -1.0, -1.0, 0.9910227234042138, 0.5, -1.0, 0.5, 0.9300470537156876, 0.5, 0.5322498922078609, 0.946763443979392, 0.5, 0.9072176513208292], "episode_lengths": [14, 65, 80, 46, 37, 80, 13, 45, 15, 80, 62, 25, 53, 15, 15, 33, 48, 80, 13, 13, 44, 40, 80, 19, 80, 19, 15, 15, 15, 16, 80, 33, 39, 74, 49, 13, 18, 46, 16, 15, 14, 17, 80, 15, 41, 80, 19, 56, 80, 80, 80, 18, 18, 80, 16, 13, 17, 15, 28, 22, 14, 48, 80, 17, 18, 52, 62, 20, 15, 78, 52, 17, 17, 13, 15, 13, 65, 58, 54, 15, 80, 17, 21, 61, 30, 58, 80, 17, 41, 13, 80, 80, 64, 13, 18, 80, 14, 16, 13, 37, 37, 34, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09263185680469722, "mean_inference_ms": 0.2571614419348872, "mean_action_processing_ms": 0.033204861862943046, "mean_env_wait_ms": 0.047232328236476315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015599056355004171, "StateBufferConnector_ms": 0.0012944045576077064, "ViewRequirementAgentConnector_ms": 0.02924377478442146}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1090.771613620992, "num_env_steps_trained_throughput_per_sec": 1090.771613620992, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 3661.288, "sample_time_ms": 1740.933, "load_time_ms": 0.211, "load_throughput": 18968022.612, "learn_time_ms": 1919.176, "learn_throughput": 2084.228, "synch_weights_time_ms": 0.634}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 3608, "training_iteration": 41, "trial_id": "default", "date": "2024-05-23_11-34-51", "timestamp": 1716456891, "time_this_iter_s": 3.6698923110961914, "time_total_s": 149.72375464439392, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 149.72375464439392, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 18.483333333333334, "ram_util_percent": 56.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.947141290416, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.277209845652944, "policy_loss": -0.008166262036770261, "vf_loss": 0.284233943885693, "vf_explained_var": -0.061659017045010804, "kl": 0.011421623539229025, "entropy": 0.9150770643065053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 38595.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 0.9910227234042138, "episode_reward_min": -1.0, "episode_reward_mean": 0.13951253528505278, "episode_len_mean": 42.35, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9910227234042138, 0.5, -1.0, 0.5, 0.9300470537156876, 0.5, 0.5322498922078609, 0.946763443979392, 0.5, 0.9072176513208292, -1.0, -1.0, 0.6468221172336206, 0.9251910709878719, 0.9514052947179129, -1.0, 0.8264327721692326, 0.8427880805042944, 0.9040096272123092, 0.7685778631521257, 0.5, 0.8565309880391722, 0.5393012323473962, 0.9263248182676741, 0.5563281204087993, -1.0, -1.0, 0.5, -1.0, 0.7367293834952569, 0.8303556392912284, -1.0, -1.0, 0.7469407015329036, -1.0, -1.0, -1.0, -1.0, 0.6930801805385765, 0.6720606532357524, 0.9180910807683289, -1.0, 0.6857265209409951, 0.5019966385064079, -1.0, -1.0, 0.5, -1.0, 0.5675575028917821, -1.0, 0.8676340312355298, 0.6520294057544093, 0.5, 0.9231673603143288, -1.0, 0.5, -1.0, 0.5, 0.7708078186981576, -1.0, 0.5, 0.6540403340679493, 0.9725710995559805, 0.6843255477888635, -1.0, 0.828630264914806, -1.0, -1.0, 0.9236023237883019, -1.0, 0.6086379676253841, 0.6618076717486638, 0.8507869749005695, 0.9354522818744881, 0.5579772107715142, 0.6949426907067502, -1.0, 0.5, 0.9493870623399268, 0.5555674337770105, 0.7857761216352362, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5398405109710317, 0.7174693626553256, 0.919455396495323, 0.6867113296388818, 0.8969160168883255, 0.7476838088024771, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5721127886555188, 0.5, 0.5903696620308991], "episode_lengths": [13, 18, 80, 14, 16, 13, 37, 37, 34, 13, 80, 13, 15, 14, 63, 80, 67, 35, 48, 47, 19, 44, 14, 15, 54, 73, 72, 27, 56, 14, 72, 65, 21, 14, 80, 78, 80, 80, 13, 58, 74, 80, 15, 14, 80, 28, 15, 80, 15, 20, 16, 67, 66, 36, 15, 51, 80, 47, 45, 68, 15, 19, 47, 16, 64, 13, 17, 80, 17, 61, 49, 63, 46, 51, 58, 14, 16, 15, 64, 19, 14, 80, 22, 31, 80, 55, 13, 32, 60, 14, 13, 57, 80, 80, 38, 80, 53, 13, 36, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09263276661723258, "mean_inference_ms": 0.2571583969328068, "mean_action_processing_ms": 0.03320513245825624, "mean_env_wait_ms": 0.047235449832769304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015347003936767578, "StateBufferConnector_ms": 0.001308441162109375, "ViewRequirementAgentConnector_ms": 0.029131650924682617}}, "episode_reward_max": 0.9910227234042138, "episode_reward_min": -1.0, "episode_reward_mean": 0.13951253528505278, "episode_len_mean": 42.35, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9910227234042138, 0.5, -1.0, 0.5, 0.9300470537156876, 0.5, 0.5322498922078609, 0.946763443979392, 0.5, 0.9072176513208292, -1.0, -1.0, 0.6468221172336206, 0.9251910709878719, 0.9514052947179129, -1.0, 0.8264327721692326, 0.8427880805042944, 0.9040096272123092, 0.7685778631521257, 0.5, 0.8565309880391722, 0.5393012323473962, 0.9263248182676741, 0.5563281204087993, -1.0, -1.0, 0.5, -1.0, 0.7367293834952569, 0.8303556392912284, -1.0, -1.0, 0.7469407015329036, -1.0, -1.0, -1.0, -1.0, 0.6930801805385765, 0.6720606532357524, 0.9180910807683289, -1.0, 0.6857265209409951, 0.5019966385064079, -1.0, -1.0, 0.5, -1.0, 0.5675575028917821, -1.0, 0.8676340312355298, 0.6520294057544093, 0.5, 0.9231673603143288, -1.0, 0.5, -1.0, 0.5, 0.7708078186981576, -1.0, 0.5, 0.6540403340679493, 0.9725710995559805, 0.6843255477888635, -1.0, 0.828630264914806, -1.0, -1.0, 0.9236023237883019, -1.0, 0.6086379676253841, 0.6618076717486638, 0.8507869749005695, 0.9354522818744881, 0.5579772107715142, 0.6949426907067502, -1.0, 0.5, 0.9493870623399268, 0.5555674337770105, 0.7857761216352362, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5398405109710317, 0.7174693626553256, 0.919455396495323, 0.6867113296388818, 0.8969160168883255, 0.7476838088024771, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5721127886555188, 0.5, 0.5903696620308991], "episode_lengths": [13, 18, 80, 14, 16, 13, 37, 37, 34, 13, 80, 13, 15, 14, 63, 80, 67, 35, 48, 47, 19, 44, 14, 15, 54, 73, 72, 27, 56, 14, 72, 65, 21, 14, 80, 78, 80, 80, 13, 58, 74, 80, 15, 14, 80, 28, 15, 80, 15, 20, 16, 67, 66, 36, 15, 51, 80, 47, 45, 68, 15, 19, 47, 16, 64, 13, 17, 80, 17, 61, 49, 63, 46, 51, 58, 14, 16, 15, 64, 19, 14, 80, 22, 31, 80, 55, 13, 32, 60, 14, 13, 57, 80, 80, 38, 80, 53, 13, 36, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09263276661723258, "mean_inference_ms": 0.2571583969328068, "mean_action_processing_ms": 0.03320513245825624, "mean_env_wait_ms": 0.047235449832769304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015347003936767578, "StateBufferConnector_ms": 0.001308441162109375, "ViewRequirementAgentConnector_ms": 0.029131650924682617}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1095.1511350468395, "num_env_steps_trained_throughput_per_sec": 1095.1511350468395, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 3663.684, "sample_time_ms": 1741.006, "load_time_ms": 0.209, "load_throughput": 19132416.467, "learn_time_ms": 1921.501, "learn_throughput": 2081.706, "synch_weights_time_ms": 0.633}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 3698, "training_iteration": 42, "trial_id": "default", "date": "2024-05-23_11-34-54", "timestamp": 1716456894, "time_this_iter_s": 3.6551740169525146, "time_total_s": 153.37892866134644, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.37892866134644, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 19.48, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.112665972786565, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2673238961231364, "policy_loss": -0.011505071264541438, "vf_loss": 0.27773280152550306, "vf_explained_var": 0.24424287599902, "kl": 0.010961640431514015, "entropy": 0.8906208802935898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 39525.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 0.978989396589063, "episode_reward_min": -1.0, "episode_reward_mean": 0.1030674499171548, "episode_len_mean": 39.77, "episode_media": {}, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8111223040398472, 0.6482692591955446, 0.543999773022338, 0.9075896134464773, 0.5, 0.5167246112299707, -1.0, 0.5, 0.8665377731416704, -1.0, 0.5, 0.6847727441853813, -1.0, 0.7306553592011127, 0.7954663122888812, 0.9443033530011415, 0.9414954230306185, -1.0, 0.5, 0.9072405370903014, -1.0, 0.7073027971774783, -1.0, 0.5, 0.5, 0.5, -1.0, 0.7834862263616149, 0.8277259657739122, -1.0, -1.0, 0.7528992288195303, 0.8959552823525934, 0.7060108174360094, 0.8078223551937334, 0.7650447591157066, -1.0, 0.6477721946704249, 0.5, -1.0, 0.875462538524166, -1.0, 0.9430727428545929, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.978989396589063, 0.5, 0.940848430669488, -1.0, 0.5, -1.0, 0.6497246006442741, -1.0, 0.5, -1.0, 0.5, 0.7912856763915384, -1.0, 0.5007661806783301, 0.5480475426524405, 0.5, -1.0, 0.538761990767145, 0.735166769599445, -1.0, 0.5896947372302836, 0.5068775328379311, -1.0, 0.796901307280074, 0.9774142156362808, 0.5, 0.8623283185122994, 0.9706612830605754, 0.8233414395619219, -1.0, 0.6416673155094339, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.6385912653386518, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.828231394332972, 0.9767136232702853], "episode_lengths": [58, 44, 33, 14, 49, 43, 80, 14, 68, 30, 50, 57, 39, 14, 48, 16, 61, 80, 15, 44, 80, 61, 80, 16, 14, 16, 67, 13, 13, 80, 29, 54, 15, 13, 35, 31, 27, 13, 63, 80, 65, 80, 13, 80, 44, 26, 18, 32, 19, 80, 50, 15, 13, 34, 48, 16, 13, 80, 64, 15, 13, 13, 15, 14, 32, 14, 19, 53, 13, 16, 17, 20, 42, 13, 13, 13, 15, 16, 30, 80, 13, 14, 45, 80, 80, 51, 80, 33, 80, 13, 36, 76, 80, 80, 36, 80, 80, 41, 43, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09266186085965232, "mean_inference_ms": 0.25716261583956423, "mean_action_processing_ms": 0.03320814802886703, "mean_env_wait_ms": 0.04724154341304785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016090869903564453, "StateBufferConnector_ms": 0.0013761520385742188, "ViewRequirementAgentConnector_ms": 0.029058456420898438}}, "episode_reward_max": 0.978989396589063, "episode_reward_min": -1.0, "episode_reward_mean": 0.1030674499171548, "episode_len_mean": 39.77, "episodes_this_iter": 100, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8111223040398472, 0.6482692591955446, 0.543999773022338, 0.9075896134464773, 0.5, 0.5167246112299707, -1.0, 0.5, 0.8665377731416704, -1.0, 0.5, 0.6847727441853813, -1.0, 0.7306553592011127, 0.7954663122888812, 0.9443033530011415, 0.9414954230306185, -1.0, 0.5, 0.9072405370903014, -1.0, 0.7073027971774783, -1.0, 0.5, 0.5, 0.5, -1.0, 0.7834862263616149, 0.8277259657739122, -1.0, -1.0, 0.7528992288195303, 0.8959552823525934, 0.7060108174360094, 0.8078223551937334, 0.7650447591157066, -1.0, 0.6477721946704249, 0.5, -1.0, 0.875462538524166, -1.0, 0.9430727428545929, -1.0, 0.5, -1.0, 0.5, -1.0, 0.5, -1.0, 0.978989396589063, 0.5, 0.940848430669488, -1.0, 0.5, -1.0, 0.6497246006442741, -1.0, 0.5, -1.0, 0.5, 0.7912856763915384, -1.0, 0.5007661806783301, 0.5480475426524405, 0.5, -1.0, 0.538761990767145, 0.735166769599445, -1.0, 0.5896947372302836, 0.5068775328379311, -1.0, 0.796901307280074, 0.9774142156362808, 0.5, 0.8623283185122994, 0.9706612830605754, 0.8233414395619219, -1.0, 0.6416673155094339, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.6385912653386518, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.828231394332972, 0.9767136232702853], "episode_lengths": [58, 44, 33, 14, 49, 43, 80, 14, 68, 30, 50, 57, 39, 14, 48, 16, 61, 80, 15, 44, 80, 61, 80, 16, 14, 16, 67, 13, 13, 80, 29, 54, 15, 13, 35, 31, 27, 13, 63, 80, 65, 80, 13, 80, 44, 26, 18, 32, 19, 80, 50, 15, 13, 34, 48, 16, 13, 80, 64, 15, 13, 13, 15, 14, 32, 14, 19, 53, 13, 16, 17, 20, 42, 13, 13, 13, 15, 16, 30, 80, 13, 14, 45, 80, 80, 51, 80, 33, 80, 13, 36, 76, 80, 80, 36, 80, 80, 41, 43, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09266186085965232, "mean_inference_ms": 0.25716261583956423, "mean_action_processing_ms": 0.03320814802886703, "mean_env_wait_ms": 0.04724154341304785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016090869903564453, "StateBufferConnector_ms": 0.0013761520385742188, "ViewRequirementAgentConnector_ms": 0.029058456420898438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1070.1542559946715, "num_env_steps_trained_throughput_per_sec": 1070.1542559946715, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 3674.018, "sample_time_ms": 1742.083, "load_time_ms": 0.21, "load_throughput": 19067184.907, "learn_time_ms": 1930.741, "learn_throughput": 2071.743, "synch_weights_time_ms": 0.642}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 3798, "training_iteration": 43, "trial_id": "default", "date": "2024-05-23_11-34-58", "timestamp": 1716456898, "time_this_iter_s": 3.7405760288238525, "time_total_s": 157.1195046901703, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 157.1195046901703, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 15.16, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.485887751720285, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.25674199654410285, "policy_loss": 0.0009924825120677231, "vf_loss": 0.25507611623134024, "vf_explained_var": 0.021707941319352837, "kl": 0.006733958611141495, "entropy": 0.86619031570291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 40455.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 0.9921278606342882, "episode_reward_min": -1.0, "episode_reward_mean": 0.22189291010098322, "episode_len_mean": 38.04716981132076, "episode_media": {}, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5306403960828406, 0.5, 0.5, 0.5, 0.7756386053198039, -1.0, 0.5, -1.0, 0.6680608252292426, -1.0, 0.8421560260066279, 0.5, 0.7416261910988091, 0.5, -1.0, 0.6262286398803942, 0.5, -1.0, -1.0, 0.7864163134078882, 0.8925447706369163, 0.5, 0.5, 0.9779401528720036, 0.8545684694819248, 0.9921278606342882, 0.9041270992842968, 0.8610068036249416, -1.0, 0.5, 0.7949085488447378, 0.5, -1.0, 0.8900221313537588, 0.7062897028428621, 0.7250958627495303, -1.0, 0.5, -1.0, 0.8785796706541334, 0.5295006829680124, 0.8292892602920421, 0.9512973090913082, 0.7784431892323368, 0.7033671408053395, -1.0, 0.5, 0.6076463412967585, -1.0, 0.8506003355532686, -1.0, 0.5, 0.9622421089931468, 0.7188247630368096, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7528897742660356, 0.5, 0.742410705548658, -1.0, 0.728008789097597, -1.0, 0.5, 0.7497642392225521, 0.5, 0.5785785274260815, 0.9485660282525707, 0.7154085288532646, 0.6203304652131993, 0.7541914341457925, 0.5, -1.0, 0.5, 0.9085428327001726, 0.6273862192580972, 0.9064243779201471, 0.835917181685635, 0.5615651225807539, 0.5, 0.6838982404701246, -1.0, -1.0, -1.0, 0.9265031765725747, 0.9765842171053354, 0.6003051913595, 0.9396736661589629, 0.6070941025094376, 0.5, 0.6534738115754449, 0.5401977252850945, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.8446517473831747, 0.9390931648399917], "episode_lengths": [80, 80, 62, 13, 15, 47, 39, 51, 80, 22, 80, 56, 20, 67, 32, 57, 17, 14, 49, 15, 80, 80, 53, 56, 28, 58, 13, 46, 13, 15, 59, 16, 14, 14, 13, 35, 14, 46, 14, 22, 15, 80, 44, 61, 58, 47, 13, 57, 80, 16, 14, 17, 42, 50, 18, 56, 13, 80, 15, 80, 80, 75, 80, 47, 57, 14, 80, 65, 80, 33, 13, 13, 13, 16, 14, 13, 13, 16, 21, 13, 47, 15, 41, 35, 13, 15, 46, 80, 80, 49, 35, 13, 27, 13, 13, 14, 14, 57, 60, 24, 66, 16, 15, 13, 20, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09269046678868803, "mean_inference_ms": 0.25717368631929005, "mean_action_processing_ms": 0.033211317525178266, "mean_env_wait_ms": 0.04725177831497682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016981700681290538, "StateBufferConnector_ms": 0.0013214237285110186, "ViewRequirementAgentConnector_ms": 0.029080768801131338}}, "episode_reward_max": 0.9921278606342882, "episode_reward_min": -1.0, "episode_reward_mean": 0.22189291010098322, "episode_len_mean": 38.04716981132076, "episodes_this_iter": 106, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, -1.0, 0.5306403960828406, 0.5, 0.5, 0.5, 0.7756386053198039, -1.0, 0.5, -1.0, 0.6680608252292426, -1.0, 0.8421560260066279, 0.5, 0.7416261910988091, 0.5, -1.0, 0.6262286398803942, 0.5, -1.0, -1.0, 0.7864163134078882, 0.8925447706369163, 0.5, 0.5, 0.9779401528720036, 0.8545684694819248, 0.9921278606342882, 0.9041270992842968, 0.8610068036249416, -1.0, 0.5, 0.7949085488447378, 0.5, -1.0, 0.8900221313537588, 0.7062897028428621, 0.7250958627495303, -1.0, 0.5, -1.0, 0.8785796706541334, 0.5295006829680124, 0.8292892602920421, 0.9512973090913082, 0.7784431892323368, 0.7033671408053395, -1.0, 0.5, 0.6076463412967585, -1.0, 0.8506003355532686, -1.0, 0.5, 0.9622421089931468, 0.7188247630368096, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7528897742660356, 0.5, 0.742410705548658, -1.0, 0.728008789097597, -1.0, 0.5, 0.7497642392225521, 0.5, 0.5785785274260815, 0.9485660282525707, 0.7154085288532646, 0.6203304652131993, 0.7541914341457925, 0.5, -1.0, 0.5, 0.9085428327001726, 0.6273862192580972, 0.9064243779201471, 0.835917181685635, 0.5615651225807539, 0.5, 0.6838982404701246, -1.0, -1.0, -1.0, 0.9265031765725747, 0.9765842171053354, 0.6003051913595, 0.9396736661589629, 0.6070941025094376, 0.5, 0.6534738115754449, 0.5401977252850945, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.8446517473831747, 0.9390931648399917], "episode_lengths": [80, 80, 62, 13, 15, 47, 39, 51, 80, 22, 80, 56, 20, 67, 32, 57, 17, 14, 49, 15, 80, 80, 53, 56, 28, 58, 13, 46, 13, 15, 59, 16, 14, 14, 13, 35, 14, 46, 14, 22, 15, 80, 44, 61, 58, 47, 13, 57, 80, 16, 14, 17, 42, 50, 18, 56, 13, 80, 15, 80, 80, 75, 80, 47, 57, 14, 80, 65, 80, 33, 13, 13, 13, 16, 14, 13, 13, 16, 21, 13, 47, 15, 41, 35, 13, 15, 46, 80, 80, 49, 35, 13, 27, 13, 13, 14, 14, 57, 60, 24, 66, 16, 15, 13, 20, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09269046678868803, "mean_inference_ms": 0.25717368631929005, "mean_action_processing_ms": 0.033211317525178266, "mean_env_wait_ms": 0.04725177831497682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016981700681290538, "StateBufferConnector_ms": 0.0013214237285110186, "ViewRequirementAgentConnector_ms": 0.029080768801131338}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.2977226376036, "num_env_steps_trained_throughput_per_sec": 1098.2977226376036, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 3672.962, "sample_time_ms": 1743.473, "load_time_ms": 0.21, "load_throughput": 19080195.61, "learn_time_ms": 1928.298, "learn_throughput": 2074.368, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 3904, "training_iteration": 44, "trial_id": "default", "date": "2024-05-23_11-35-02", "timestamp": 1716456902, "time_this_iter_s": 3.644688129425049, "time_total_s": 160.76419281959534, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 160.76419281959534, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 19.2, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7281166545485935, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2701089725817143, "policy_loss": -0.0054693196089037, "vf_loss": 0.27498656248934167, "vf_explained_var": 0.011313799119764758, "kl": 0.0059173278532490365, "entropy": 0.8192914116767145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 41385.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 0.9954298994545896, "episode_reward_min": -1.0, "episode_reward_mean": 0.24339029707151655, "episode_len_mean": 38.90291262135922, "episode_media": {}, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.762929335039443, 0.559746233698948, 0.5, -1.0, 0.9781309461227559, 0.579901031985328, 0.7048200746225577, -1.0, 0.5, 0.5507170142261559, -1.0, 0.5, 0.6189217200520334, -1.0, 0.5, 0.9386342432763523, -1.0, 0.5542125168705936, 0.892975282872287, -1.0, 0.7016896476122902, -1.0, 0.6441669296751529, -1.0, 0.8240513477717211, -1.0, 0.9938928992997217, 0.8624719953066365, -1.0, 0.74162775364049, 0.9647373095889541, 0.8531465533571098, 0.6293212342466875, 0.5, 0.5, 0.5368089972442278, 0.8953478071954639, 0.9273849664773066, 0.5, 0.9283042835049979, 0.5, 0.8308427541222387, 0.7220291964987101, 0.5109873380875779, 0.8609215872216802, -1.0, -1.0, -1.0, 0.8718869514831561, 0.9954298994545896, -1.0, 0.6695720572299824, 0.7996951209625578, 0.5, 0.7407706938655064, 0.5, 0.9799873122443258, 0.8623200166317395, -1.0, 0.9542128678916668, -1.0, 0.582727219897673, 0.7954916007945736, 0.5, -1.0, -1.0, 0.648396970630242, -1.0, 0.5, 0.5, 0.5, 0.7656005273182589, 0.6679229935178992, 0.9832914307350126, 0.9727143451654007, -1.0, 0.8130971528830041, 0.9092113134863158, 0.7410376435694528, -1.0, -1.0, 0.5323626951828982, 0.5, -1.0, 0.9712266820023877, 0.8028918762975188, -1.0, 0.5, -1.0, -1.0, 0.7358607778446279, 0.8452099923572665, 0.8212672368859891, 0.8520894133543396, 0.8877274676851716, 0.5, -1.0, 0.7269207868211365, -1.0, 0.5715565525560917, 0.5], "episode_lengths": [55, 16, 58, 17, 26, 80, 17, 20, 13, 80, 18, 15, 80, 14, 15, 18, 23, 13, 80, 15, 13, 32, 19, 16, 50, 30, 13, 80, 54, 61, 15, 55, 42, 59, 48, 19, 14, 54, 54, 56, 29, 13, 14, 13, 48, 17, 52, 54, 80, 80, 13, 14, 80, 43, 13, 14, 48, 19, 13, 13, 29, 53, 40, 60, 14, 23, 80, 48, 67, 25, 16, 27, 50, 44, 57, 38, 47, 80, 49, 59, 15, 80, 80, 53, 15, 80, 13, 50, 80, 17, 80, 80, 14, 46, 50, 13, 14, 15, 17, 15, 80, 52, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09271686754924933, "mean_inference_ms": 0.2571973565367842, "mean_action_processing_ms": 0.03321506405661366, "mean_env_wait_ms": 0.04726062320944872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015851363395024273, "StateBufferConnector_ms": 0.0013300516072986194, "ViewRequirementAgentConnector_ms": 0.02900674505141175}}, "episode_reward_max": 0.9954298994545896, "episode_reward_min": -1.0, "episode_reward_mean": 0.24339029707151655, "episode_len_mean": 38.90291262135922, "episodes_this_iter": 103, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.762929335039443, 0.559746233698948, 0.5, -1.0, 0.9781309461227559, 0.579901031985328, 0.7048200746225577, -1.0, 0.5, 0.5507170142261559, -1.0, 0.5, 0.6189217200520334, -1.0, 0.5, 0.9386342432763523, -1.0, 0.5542125168705936, 0.892975282872287, -1.0, 0.7016896476122902, -1.0, 0.6441669296751529, -1.0, 0.8240513477717211, -1.0, 0.9938928992997217, 0.8624719953066365, -1.0, 0.74162775364049, 0.9647373095889541, 0.8531465533571098, 0.6293212342466875, 0.5, 0.5, 0.5368089972442278, 0.8953478071954639, 0.9273849664773066, 0.5, 0.9283042835049979, 0.5, 0.8308427541222387, 0.7220291964987101, 0.5109873380875779, 0.8609215872216802, -1.0, -1.0, -1.0, 0.8718869514831561, 0.9954298994545896, -1.0, 0.6695720572299824, 0.7996951209625578, 0.5, 0.7407706938655064, 0.5, 0.9799873122443258, 0.8623200166317395, -1.0, 0.9542128678916668, -1.0, 0.582727219897673, 0.7954916007945736, 0.5, -1.0, -1.0, 0.648396970630242, -1.0, 0.5, 0.5, 0.5, 0.7656005273182589, 0.6679229935178992, 0.9832914307350126, 0.9727143451654007, -1.0, 0.8130971528830041, 0.9092113134863158, 0.7410376435694528, -1.0, -1.0, 0.5323626951828982, 0.5, -1.0, 0.9712266820023877, 0.8028918762975188, -1.0, 0.5, -1.0, -1.0, 0.7358607778446279, 0.8452099923572665, 0.8212672368859891, 0.8520894133543396, 0.8877274676851716, 0.5, -1.0, 0.7269207868211365, -1.0, 0.5715565525560917, 0.5], "episode_lengths": [55, 16, 58, 17, 26, 80, 17, 20, 13, 80, 18, 15, 80, 14, 15, 18, 23, 13, 80, 15, 13, 32, 19, 16, 50, 30, 13, 80, 54, 61, 15, 55, 42, 59, 48, 19, 14, 54, 54, 56, 29, 13, 14, 13, 48, 17, 52, 54, 80, 80, 13, 14, 80, 43, 13, 14, 48, 19, 13, 13, 29, 53, 40, 60, 14, 23, 80, 48, 67, 25, 16, 27, 50, 44, 57, 38, 47, 80, 49, 59, 15, 80, 80, 53, 15, 80, 13, 50, 80, 17, 80, 80, 14, 46, 50, 13, 14, 15, 17, 15, 80, 52, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09271686754924933, "mean_inference_ms": 0.2571973565367842, "mean_action_processing_ms": 0.03321506405661366, "mean_env_wait_ms": 0.04726062320944872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015851363395024273, "StateBufferConnector_ms": 0.0013300516072986194, "ViewRequirementAgentConnector_ms": 0.02900674505141175}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.6992071812103, "num_env_steps_trained_throughput_per_sec": 1098.6992071812103, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3671.546, "sample_time_ms": 1743.15, "load_time_ms": 0.207, "load_throughput": 19355348.408, "learn_time_ms": 1927.195, "learn_throughput": 2075.556, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 4007, "training_iteration": 45, "trial_id": "default", "date": "2024-05-23_11-35-05", "timestamp": 1716456905, "time_this_iter_s": 3.643326997756958, "time_total_s": 164.4075198173523, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 164.4075198173523, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 19.2, "ram_util_percent": 56.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.593141535212917, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23140345006700486, "policy_loss": -0.011365197557375155, "vf_loss": 0.24154820564373206, "vf_explained_var": 0.18284792733448807, "kl": 0.012204436112283173, "entropy": 0.8183165909141623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 42315.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 0.9979544262532377, "episode_reward_min": -1.0, "episode_reward_mean": 0.20250450080136598, "episode_len_mean": 36.234234234234236, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.8760653153560407, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8240662264055074, 0.861212837307536, 0.5, 0.7105108823809179, 0.5300230844068974, 0.961879887530872, 0.5, 0.8052300809632217, -1.0, -1.0, -1.0, 0.9470262873712688, 0.5, 0.6808613606207918, 0.8973014475875377, 0.6227355261278882, 0.67662247351346, 0.9610343112744317, 0.8983761934007733, 0.681129958044228, 0.5, 0.9037689383144618, 0.5035658317964955, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5958378740619301, 0.5710990134304332, 0.6618512846309123, 0.5, 0.9788191757355752, 0.9404375788405419, 0.9184807725740172, 0.9307013160155733, -1.0, 0.8219159374318394, -1.0, -1.0, -1.0, -1.0, 0.6556861736637472, -1.0, 0.9637007154272358, 0.6435848534441542, 0.5, 0.5, 0.8486964010588751, 0.5, -1.0, -1.0, 0.992074547793297, 0.8891778337493933, -1.0, -1.0, -1.0, 0.7814610277141959, -1.0, -1.0, 0.8154951722694359, 0.7426156411812281, 0.9402684133974527, 0.5, 0.9737894618232233, -1.0, 0.9550898631937124, -1.0, 0.6324864800354114, 0.6769777970819862, -1.0, 0.6689686888397621, 0.6215371005862302, 0.9617359102337244, 0.5, 0.9719986045108708, -1.0, 0.5, 0.975103859166817, -1.0, 0.9280791150921925, 0.9919776539580518, 0.5, -1.0, 0.8589261471539409, -1.0, 0.6687755012675474, 0.7886136930030286, -1.0, 0.679659741803025, -1.0, 0.9979544262532377, -1.0, 0.720449100587223, 0.7980036737201615, 0.5, 0.7240963731418124, 0.7617500873113827, 0.8833070655823495, 0.9644677136354264, 0.7409371561483323, 0.5, 0.5, 0.5], "episode_lengths": [80, 50, 74, 80, 19, 13, 28, 14, 13, 22, 13, 17, 13, 15, 16, 80, 80, 80, 37, 51, 13, 63, 16, 16, 13, 50, 18, 14, 15, 13, 20, 80, 30, 80, 23, 19, 56, 13, 14, 44, 14, 47, 13, 80, 13, 80, 80, 21, 18, 16, 80, 17, 15, 32, 62, 37, 15, 31, 26, 13, 14, 80, 80, 31, 14, 80, 80, 19, 17, 49, 22, 14, 16, 77, 80, 41, 13, 80, 66, 23, 13, 18, 15, 80, 61, 16, 16, 13, 15, 34, 80, 15, 80, 32, 14, 15, 14, 80, 13, 80, 16, 48, 18, 15, 14, 51, 52, 45, 20, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09276464570718668, "mean_inference_ms": 0.2572130912932393, "mean_action_processing_ms": 0.03321900661793438, "mean_env_wait_ms": 0.047269837669614574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016650638064822636, "StateBufferConnector_ms": 0.0013280559230495143, "ViewRequirementAgentConnector_ms": 0.029305509618810704}}, "episode_reward_max": 0.9979544262532377, "episode_reward_min": -1.0, "episode_reward_mean": 0.20250450080136598, "episode_len_mean": 36.234234234234236, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.8760653153560407, -1.0, -1.0, -1.0, 0.5, -1.0, 0.8240662264055074, 0.861212837307536, 0.5, 0.7105108823809179, 0.5300230844068974, 0.961879887530872, 0.5, 0.8052300809632217, -1.0, -1.0, -1.0, 0.9470262873712688, 0.5, 0.6808613606207918, 0.8973014475875377, 0.6227355261278882, 0.67662247351346, 0.9610343112744317, 0.8983761934007733, 0.681129958044228, 0.5, 0.9037689383144618, 0.5035658317964955, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5958378740619301, 0.5710990134304332, 0.6618512846309123, 0.5, 0.9788191757355752, 0.9404375788405419, 0.9184807725740172, 0.9307013160155733, -1.0, 0.8219159374318394, -1.0, -1.0, -1.0, -1.0, 0.6556861736637472, -1.0, 0.9637007154272358, 0.6435848534441542, 0.5, 0.5, 0.8486964010588751, 0.5, -1.0, -1.0, 0.992074547793297, 0.8891778337493933, -1.0, -1.0, -1.0, 0.7814610277141959, -1.0, -1.0, 0.8154951722694359, 0.7426156411812281, 0.9402684133974527, 0.5, 0.9737894618232233, -1.0, 0.9550898631937124, -1.0, 0.6324864800354114, 0.6769777970819862, -1.0, 0.6689686888397621, 0.6215371005862302, 0.9617359102337244, 0.5, 0.9719986045108708, -1.0, 0.5, 0.975103859166817, -1.0, 0.9280791150921925, 0.9919776539580518, 0.5, -1.0, 0.8589261471539409, -1.0, 0.6687755012675474, 0.7886136930030286, -1.0, 0.679659741803025, -1.0, 0.9979544262532377, -1.0, 0.720449100587223, 0.7980036737201615, 0.5, 0.7240963731418124, 0.7617500873113827, 0.8833070655823495, 0.9644677136354264, 0.7409371561483323, 0.5, 0.5, 0.5], "episode_lengths": [80, 50, 74, 80, 19, 13, 28, 14, 13, 22, 13, 17, 13, 15, 16, 80, 80, 80, 37, 51, 13, 63, 16, 16, 13, 50, 18, 14, 15, 13, 20, 80, 30, 80, 23, 19, 56, 13, 14, 44, 14, 47, 13, 80, 13, 80, 80, 21, 18, 16, 80, 17, 15, 32, 62, 37, 15, 31, 26, 13, 14, 80, 80, 31, 14, 80, 80, 19, 17, 49, 22, 14, 16, 77, 80, 41, 13, 80, 66, 23, 13, 18, 15, 80, 61, 16, 16, 13, 15, 34, 80, 15, 80, 32, 14, 15, 14, 80, 13, 80, 16, 48, 18, 15, 14, 51, 52, 45, 20, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09276464570718668, "mean_inference_ms": 0.2572130912932393, "mean_action_processing_ms": 0.03321900661793438, "mean_env_wait_ms": 0.047269837669614574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016650638064822636, "StateBufferConnector_ms": 0.0013280559230495143, "ViewRequirementAgentConnector_ms": 0.029305509618810704}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1095.0986659641555, "num_env_steps_trained_throughput_per_sec": 1095.0986659641555, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 3664.557, "sample_time_ms": 1744.209, "load_time_ms": 0.226, "load_throughput": 17686291.377, "learn_time_ms": 1919.131, "learn_throughput": 2084.277, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 4118, "training_iteration": 46, "trial_id": "default", "date": "2024-05-23_11-35-09", "timestamp": 1716456909, "time_this_iter_s": 3.655470132827759, "time_total_s": 168.06298995018005, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 168.06298995018005, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.14, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.652835936892417, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.25291698875146046, "policy_loss": -0.006207233579248511, "vf_loss": 0.25824035278531493, "vf_explained_var": 0.1683463231850696, "kl": 0.008838695722114692, "entropy": 0.8276325105338969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 43245.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 0.9986174909016128, "episode_reward_min": -1.0, "episode_reward_mean": 0.05061281421421451, "episode_len_mean": 40.49, "episode_media": {}, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7409371561483323, 0.5, 0.5, 0.5, -1.0, 0.8798254431811279, -1.0, 0.5477864173022831, 0.7933887559079906, 0.5452278356212026, -1.0, 0.8166984731099545, 0.7760837771441864, 0.5, -1.0, 0.7413345313242105, 0.7812666056998414, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.6440106991750718, -1.0, 0.5, 0.5, 0.5, -1.0, 0.8529239007546184, 0.9235977321715219, 0.9986174909016128, 0.8266436556950876, 0.5, -1.0, 0.5073195090865424, 0.7468119888458999, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8153218781413005, -1.0, -1.0, -1.0, 0.5474195979494763, -1.0, -1.0, -1.0, 0.5673272742586306, -1.0, 0.8778725393555454, 0.5, -1.0, 0.773020113690396, 0.9774300803800197, 0.5, 0.8208198185187415, -1.0, -1.0, 0.9725131495562133, 0.5, -1.0, -1.0, -1.0, 0.9462956856793273, 0.6625544339699273, 0.7032062716849868, 0.8829102735233999, 0.5, 0.755928903691621, 0.70826679743295, 0.5, 0.8011927473799343, 0.5896822900426077, -1.0, 0.9605546579411539, -1.0, 0.9103055883127382, 0.651880043281358, 0.6828140095651154, -1.0, 0.5896972202865127, 0.5, -1.0, 0.6056019224983329, 0.5, 0.5, 0.6865167348362302, 0.5141727040206603, 0.5548427436012235, 0.5794154185257501, -1.0, -1.0, -1.0, 0.8012445512278163, 0.5], "episode_lengths": [45, 20, 13, 15, 80, 16, 37, 15, 46, 53, 58, 14, 74, 17, 80, 14, 15, 11, 80, 80, 41, 37, 14, 80, 80, 13, 80, 33, 14, 68, 80, 57, 14, 49, 13, 18, 80, 49, 16, 36, 50, 80, 54, 16, 48, 63, 15, 80, 14, 80, 25, 80, 13, 80, 45, 24, 80, 18, 13, 13, 13, 80, 48, 13, 44, 80, 80, 53, 54, 20, 13, 43, 22, 13, 15, 19, 15, 51, 54, 16, 80, 14, 46, 50, 20, 14, 15, 80, 16, 19, 37, 13, 13, 14, 13, 80, 80, 80, 54, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09278232978079014, "mean_inference_ms": 0.2572165931780801, "mean_action_processing_ms": 0.03322139105563467, "mean_env_wait_ms": 0.04727811842811043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001692056655883789, "StateBufferConnector_ms": 0.0013720989227294922, "ViewRequirementAgentConnector_ms": 0.029597043991088867}}, "episode_reward_max": 0.9986174909016128, "episode_reward_min": -1.0, "episode_reward_mean": 0.05061281421421451, "episode_len_mean": 40.49, "episodes_this_iter": 96, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7409371561483323, 0.5, 0.5, 0.5, -1.0, 0.8798254431811279, -1.0, 0.5477864173022831, 0.7933887559079906, 0.5452278356212026, -1.0, 0.8166984731099545, 0.7760837771441864, 0.5, -1.0, 0.7413345313242105, 0.7812666056998414, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, -1.0, -1.0, 0.6440106991750718, -1.0, 0.5, 0.5, 0.5, -1.0, 0.8529239007546184, 0.9235977321715219, 0.9986174909016128, 0.8266436556950876, 0.5, -1.0, 0.5073195090865424, 0.7468119888458999, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8153218781413005, -1.0, -1.0, -1.0, 0.5474195979494763, -1.0, -1.0, -1.0, 0.5673272742586306, -1.0, 0.8778725393555454, 0.5, -1.0, 0.773020113690396, 0.9774300803800197, 0.5, 0.8208198185187415, -1.0, -1.0, 0.9725131495562133, 0.5, -1.0, -1.0, -1.0, 0.9462956856793273, 0.6625544339699273, 0.7032062716849868, 0.8829102735233999, 0.5, 0.755928903691621, 0.70826679743295, 0.5, 0.8011927473799343, 0.5896822900426077, -1.0, 0.9605546579411539, -1.0, 0.9103055883127382, 0.651880043281358, 0.6828140095651154, -1.0, 0.5896972202865127, 0.5, -1.0, 0.6056019224983329, 0.5, 0.5, 0.6865167348362302, 0.5141727040206603, 0.5548427436012235, 0.5794154185257501, -1.0, -1.0, -1.0, 0.8012445512278163, 0.5], "episode_lengths": [45, 20, 13, 15, 80, 16, 37, 15, 46, 53, 58, 14, 74, 17, 80, 14, 15, 11, 80, 80, 41, 37, 14, 80, 80, 13, 80, 33, 14, 68, 80, 57, 14, 49, 13, 18, 80, 49, 16, 36, 50, 80, 54, 16, 48, 63, 15, 80, 14, 80, 25, 80, 13, 80, 45, 24, 80, 18, 13, 13, 13, 80, 48, 13, 44, 80, 80, 53, 54, 20, 13, 43, 22, 13, 15, 19, 15, 51, 54, 16, 80, 14, 46, 50, 20, 14, 15, 80, 16, 19, 37, 13, 13, 14, 13, 80, 80, 80, 54, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09278232978079014, "mean_inference_ms": 0.2572165931780801, "mean_action_processing_ms": 0.03322139105563467, "mean_env_wait_ms": 0.04727811842811043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001692056655883789, "StateBufferConnector_ms": 0.0013720989227294922, "ViewRequirementAgentConnector_ms": 0.029597043991088867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.1154899968838, "num_env_steps_trained_throughput_per_sec": 1098.1154899968838, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 3664.704, "sample_time_ms": 1744.52, "load_time_ms": 0.228, "load_throughput": 17538381.769, "learn_time_ms": 1918.972, "learn_throughput": 2084.45, "synch_weights_time_ms": 0.642}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 4214, "training_iteration": 47, "trial_id": "default", "date": "2024-05-23_11-35-13", "timestamp": 1716456913, "time_this_iter_s": 3.6452949047088623, "time_total_s": 171.70828485488892, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 171.70828485488892, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 18.32, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.582862792156076, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.240510783180274, "policy_loss": -0.006016337691295531, "vf_loss": 0.24591213115641186, "vf_explained_var": 0.11441594272531488, "kl": 0.006149909335537513, "entropy": 0.7918505290503143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 44175.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 0.9821098100979585, "episode_reward_min": -1.0, "episode_reward_mean": 0.13556462234771982, "episode_len_mean": 40.03, "episode_media": {}, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, 0.5578382974156708, -1.0, 0.5, -1.0, 0.8452484473864967, -1.0, -1.0, 0.9452173006162016, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7660840762049526, 0.6646105507495698, 0.7685908509313817, 0.8573722743015441, 0.518557791301153, 0.6358346526530942, 0.812983124121917, 0.7144415718266184, 0.7077983641432013, 0.5, -1.0, 0.8273599667563581, 0.5, 0.8550452319739952, -1.0, -1.0, -1.0, 0.7304466469213262, 0.5, 0.8713237646036519, 0.5, 0.5, 0.5, -1.0, 0.5312826080462774, 0.9160516169795597, -1.0, 0.5, 0.5, 0.5, -1.0, 0.7288163209384604, 0.9821098100979585, 0.5, 0.5, 0.5279040524676624, 0.7532210990243533, 0.9712136476449363, -1.0, 0.7661617578805161, 0.8249016439093776, 0.5644435421856988, 0.877469876687092, 0.5904253785461665, -1.0, -1.0, 0.73154882751133, -1.0, -1.0, 0.5, -1.0, 0.5821688162288536, 0.6082012253339668, 0.9349500021090094, -1.0, -1.0, 0.9803625901248967, 0.6322644789209112, 0.5, 0.8412032591137477, 0.7785078480328755, 0.7975147926985667, 0.9703158089885074, 0.7329293522937175, 0.8605139483011561, -1.0, 0.5, 0.7624912427016296, 0.5279372738081282, 0.7722500710795375, 0.7682543149109438, -1.0, 0.622112695451617, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5401814208473963, -1.0, 0.5], "episode_lengths": [19, 80, 80, 80, 53, 80, 13, 80, 13, 80, 15, 13, 50, 13, 16, 80, 80, 80, 15, 50, 57, 14, 52, 13, 51, 14, 46, 47, 72, 80, 54, 13, 14, 19, 80, 80, 45, 15, 53, 15, 15, 15, 80, 38, 56, 28, 19, 20, 56, 80, 13, 13, 13, 18, 14, 13, 13, 80, 14, 13, 52, 43, 13, 80, 80, 44, 80, 17, 17, 80, 15, 13, 45, 76, 80, 49, 42, 20, 13, 14, 48, 13, 45, 13, 16, 18, 14, 13, 45, 42, 80, 14, 13, 26, 80, 80, 16, 25, 80, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09279930674408167, "mean_inference_ms": 0.25723101197784487, "mean_action_processing_ms": 0.033222352026104976, "mean_env_wait_ms": 0.04728329723007159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015838146209716797, "StateBufferConnector_ms": 0.0013098716735839844, "ViewRequirementAgentConnector_ms": 0.029008865356445312}}, "episode_reward_max": 0.9821098100979585, "episode_reward_min": -1.0, "episode_reward_mean": 0.13556462234771982, "episode_len_mean": 40.03, "episodes_this_iter": 99, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, -1.0, 0.5578382974156708, -1.0, 0.5, -1.0, 0.8452484473864967, -1.0, -1.0, 0.9452173006162016, 0.5, 0.5, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7660840762049526, 0.6646105507495698, 0.7685908509313817, 0.8573722743015441, 0.518557791301153, 0.6358346526530942, 0.812983124121917, 0.7144415718266184, 0.7077983641432013, 0.5, -1.0, 0.8273599667563581, 0.5, 0.8550452319739952, -1.0, -1.0, -1.0, 0.7304466469213262, 0.5, 0.8713237646036519, 0.5, 0.5, 0.5, -1.0, 0.5312826080462774, 0.9160516169795597, -1.0, 0.5, 0.5, 0.5, -1.0, 0.7288163209384604, 0.9821098100979585, 0.5, 0.5, 0.5279040524676624, 0.7532210990243533, 0.9712136476449363, -1.0, 0.7661617578805161, 0.8249016439093776, 0.5644435421856988, 0.877469876687092, 0.5904253785461665, -1.0, -1.0, 0.73154882751133, -1.0, -1.0, 0.5, -1.0, 0.5821688162288536, 0.6082012253339668, 0.9349500021090094, -1.0, -1.0, 0.9803625901248967, 0.6322644789209112, 0.5, 0.8412032591137477, 0.7785078480328755, 0.7975147926985667, 0.9703158089885074, 0.7329293522937175, 0.8605139483011561, -1.0, 0.5, 0.7624912427016296, 0.5279372738081282, 0.7722500710795375, 0.7682543149109438, -1.0, 0.622112695451617, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5401814208473963, -1.0, 0.5], "episode_lengths": [19, 80, 80, 80, 53, 80, 13, 80, 13, 80, 15, 13, 50, 13, 16, 80, 80, 80, 15, 50, 57, 14, 52, 13, 51, 14, 46, 47, 72, 80, 54, 13, 14, 19, 80, 80, 45, 15, 53, 15, 15, 15, 80, 38, 56, 28, 19, 20, 56, 80, 13, 13, 13, 18, 14, 13, 13, 80, 14, 13, 52, 43, 13, 80, 80, 44, 80, 17, 17, 80, 15, 13, 45, 76, 80, 49, 42, 20, 13, 14, 48, 13, 45, 13, 16, 18, 14, 13, 45, 42, 80, 14, 13, 26, 80, 80, 16, 25, 80, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09279930674408167, "mean_inference_ms": 0.25723101197784487, "mean_action_processing_ms": 0.033222352026104976, "mean_env_wait_ms": 0.04728329723007159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015838146209716797, "StateBufferConnector_ms": 0.0013098716735839844, "ViewRequirementAgentConnector_ms": 0.029008865356445312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1091.8096846053172, "num_env_steps_trained_throughput_per_sec": 1091.8096846053172, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 3665.742, "sample_time_ms": 1744.091, "load_time_ms": 0.229, "load_throughput": 17445373.817, "learn_time_ms": 1920.434, "learn_throughput": 2082.863, "synch_weights_time_ms": 0.646}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 4313, "training_iteration": 48, "trial_id": "default", "date": "2024-05-23_11-35-16", "timestamp": 1716456916, "time_this_iter_s": 3.6663482189178467, "time_total_s": 175.37463307380676, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 175.37463307380676, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 17.880000000000003, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6394890119632084, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.25620953757253284, "policy_loss": -0.0008304981529832847, "vf_loss": 0.2561369882956628, "vf_explained_var": 0.20171181585199088, "kl": 0.009030494772451447, "entropy": 0.8077937868333632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 45105.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 0.9996836475464809, "episode_reward_min": -1.0, "episode_reward_mean": 0.2554610003890545, "episode_len_mean": 33.924369747899156, "episode_media": {}, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.9418013882189205, -1.0, 0.9936645199061752, -1.0, 0.7850757156456621, 0.5, 0.9597205943279739, 0.5095971928663247, -1.0, -1.0, 0.9877072329081746, -1.0, 0.6622370914892284, -1.0, -1.0, 0.5, 0.8894051642659568, 0.5, 0.9881215216605954, -1.0, 0.9548196009043091, 0.6492756035431587, 0.6911537878147044, 0.5, -1.0, 0.5, 0.5, 0.9065679098332492, 0.5, 0.9417641055308484, 0.9666615399122577, 0.8245572296755018, 0.8883720016207941, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5243405950629554, -1.0, 0.6127767782596457, 0.5, 0.9480866499835852, 0.9951436266613497, 0.6297015422813885, 0.9831952194070146, 0.9246560201622103, 0.8326738517460874, 0.9996836475464809, 0.5, 0.9854453050798684, -1.0, 0.5, -1.0, 0.866200823889153, 0.8148202685480654, 0.9123863586499621, 0.999011141047778, 0.9211968564075455, 0.7489406193456742, 0.5342517000262472, 0.5635512430269031, 0.7294809588169602, -1.0, 0.5924641918955081, -1.0, 0.5, 0.7563775450521294, 0.8268624138740699, 0.5768093151330427, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.6031091487159985, -1.0, 0.5, 0.8384278610870396, 0.5, 0.9299336306465353, 0.5, 0.7189901075352594, 0.8500408641511554, -1.0, 0.9377477926067886, 0.7167179523382712, 0.9873100918011641, 0.5, -1.0, 0.8913804545817902, -1.0, 0.5, 0.6845568649622262, 0.5023367309964826, -1.0, -1.0, 0.8559556048240156, 0.7113762977739828, 0.5, -1.0, 0.8468239957470163, -1.0, 0.8120525067000348, 0.9944087544892499, 0.6615297677889052, 0.6697473228142452, 0.5947136937489879, 0.7713230394089279, -1.0, 0.8981471112136064, -1.0, -1.0, 0.604670580338343], "episode_lengths": [80, 20, 13, 80, 14, 80, 45, 17, 15, 51, 80, 15, 15, 73, 14, 19, 80, 13, 45, 14, 13, 80, 13, 13, 53, 19, 16, 39, 13, 14, 14, 44, 15, 62, 18, 18, 80, 44, 61, 16, 18, 13, 15, 24, 14, 13, 14, 13, 15, 13, 48, 49, 21, 54, 17, 16, 80, 13, 13, 13, 16, 46, 13, 76, 16, 13, 80, 18, 29, 40, 69, 13, 56, 45, 80, 19, 13, 59, 80, 14, 14, 55, 46, 42, 19, 13, 13, 13, 56, 80, 49, 13, 14, 26, 9, 13, 80, 15, 17, 16, 80, 16, 39, 13, 14, 80, 13, 80, 42, 14, 16, 24, 40, 15, 80, 14, 28, 80, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09284839163704746, "mean_inference_ms": 0.2572517115341368, "mean_action_processing_ms": 0.03322450925660124, "mean_env_wait_ms": 0.04729216882436508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015182655398585216, "StateBufferConnector_ms": 0.0013525746449702927, "ViewRequirementAgentConnector_ms": 0.029099087755219275}}, "episode_reward_max": 0.9996836475464809, "episode_reward_min": -1.0, "episode_reward_mean": 0.2554610003890545, "episode_len_mean": 33.924369747899156, "episodes_this_iter": 119, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.9418013882189205, -1.0, 0.9936645199061752, -1.0, 0.7850757156456621, 0.5, 0.9597205943279739, 0.5095971928663247, -1.0, -1.0, 0.9877072329081746, -1.0, 0.6622370914892284, -1.0, -1.0, 0.5, 0.8894051642659568, 0.5, 0.9881215216605954, -1.0, 0.9548196009043091, 0.6492756035431587, 0.6911537878147044, 0.5, -1.0, 0.5, 0.5, 0.9065679098332492, 0.5, 0.9417641055308484, 0.9666615399122577, 0.8245572296755018, 0.8883720016207941, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5243405950629554, -1.0, 0.6127767782596457, 0.5, 0.9480866499835852, 0.9951436266613497, 0.6297015422813885, 0.9831952194070146, 0.9246560201622103, 0.8326738517460874, 0.9996836475464809, 0.5, 0.9854453050798684, -1.0, 0.5, -1.0, 0.866200823889153, 0.8148202685480654, 0.9123863586499621, 0.999011141047778, 0.9211968564075455, 0.7489406193456742, 0.5342517000262472, 0.5635512430269031, 0.7294809588169602, -1.0, 0.5924641918955081, -1.0, 0.5, 0.7563775450521294, 0.8268624138740699, 0.5768093151330427, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.5, 0.6031091487159985, -1.0, 0.5, 0.8384278610870396, 0.5, 0.9299336306465353, 0.5, 0.7189901075352594, 0.8500408641511554, -1.0, 0.9377477926067886, 0.7167179523382712, 0.9873100918011641, 0.5, -1.0, 0.8913804545817902, -1.0, 0.5, 0.6845568649622262, 0.5023367309964826, -1.0, -1.0, 0.8559556048240156, 0.7113762977739828, 0.5, -1.0, 0.8468239957470163, -1.0, 0.8120525067000348, 0.9944087544892499, 0.6615297677889052, 0.6697473228142452, 0.5947136937489879, 0.7713230394089279, -1.0, 0.8981471112136064, -1.0, -1.0, 0.604670580338343], "episode_lengths": [80, 20, 13, 80, 14, 80, 45, 17, 15, 51, 80, 15, 15, 73, 14, 19, 80, 13, 45, 14, 13, 80, 13, 13, 53, 19, 16, 39, 13, 14, 14, 44, 15, 62, 18, 18, 80, 44, 61, 16, 18, 13, 15, 24, 14, 13, 14, 13, 15, 13, 48, 49, 21, 54, 17, 16, 80, 13, 13, 13, 16, 46, 13, 76, 16, 13, 80, 18, 29, 40, 69, 13, 56, 45, 80, 19, 13, 59, 80, 14, 14, 55, 46, 42, 19, 13, 13, 13, 56, 80, 49, 13, 14, 26, 9, 13, 80, 15, 17, 16, 80, 16, 39, 13, 14, 80, 13, 80, 42, 14, 16, 24, 40, 15, 80, 14, 28, 80, 47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09284839163704746, "mean_inference_ms": 0.2572517115341368, "mean_action_processing_ms": 0.03322450925660124, "mean_env_wait_ms": 0.04729216882436508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015182655398585216, "StateBufferConnector_ms": 0.0013525746449702927, "ViewRequirementAgentConnector_ms": 0.029099087755219275}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1089.763545075923, "num_env_steps_trained_throughput_per_sec": 1089.763545075923, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 3667.041, "sample_time_ms": 1746.324, "load_time_ms": 0.226, "load_throughput": 17665806.044, "learn_time_ms": 1919.506, "learn_throughput": 2083.87, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 4432, "training_iteration": 49, "trial_id": "default", "date": "2024-05-23_11-35-20", "timestamp": 1716456920, "time_this_iter_s": 3.6734111309051514, "time_total_s": 179.0480442047119, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 179.0480442047119, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 14.2, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4907713075478872, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24308521142141815, "policy_loss": 0.004826615049794156, "vf_loss": 0.23754415431170053, "vf_explained_var": 0.07533292340975936, "kl": 0.0071444147817224515, "entropy": 0.8012554028341847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46035.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 0.9948394688979767, "episode_reward_min": -1.0, "episode_reward_mean": 0.1632200734968666, "episode_len_mean": 38.05714285714286, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.549448540720678, 0.5, -1.0, 0.6897575978893828, 0.8005555939191491, -1.0, -1.0, 0.7060123493091103, 0.721161175007516, 0.9878050142043706, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, 0.9216589244250667, 0.5, 0.6279107403630216, 0.5, -1.0, -1.0, -1.0, 0.9948394688979767, 0.5, 0.5911947595944607, 0.9831526607074089, 0.7346607030500074, -1.0, -1.0, 0.8165639068861014, 0.5, 0.8369661654955273, 0.6781033545136761, 0.5, 0.9199231513322378, 0.5, 0.5, 0.7389156038901523, -1.0, 0.8254246792392675, 0.5206079475863923, 0.8786109273832373, -1.0, -1.0, 0.9742738867467048, 0.5, 0.9780712490996115, 0.6549070603724202, 0.7011986081968125, 0.5, 0.9051958647754461, 0.9369090252059453, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.9151089264720882, 0.7995546134631796, 0.5154772857754846, 0.5458137397063879, -1.0, 0.5, 0.5, 0.6865908337629054, 0.9341871496144631, 0.5, -1.0, 0.5517679544818922, -1.0, 0.5, 0.5, -1.0, 0.752365824374249, -1.0, 0.5, 0.8207923328928307, 0.5, 0.8154463720811017, 0.7355165256566647, 0.695783100728247, 0.893645599514083, 0.5398670070284115, 0.7018547359898866, 0.8684859347492273, 0.5, -1.0, 0.968477196592073, -1.0, 0.5, 0.8583780427362826, 0.865165582739854, 0.5, 0.5, -1.0], "episode_lengths": [50, 48, 80, 18, 14, 80, 80, 13, 15, 13, 13, 80, 15, 16, 26, 19, 13, 80, 13, 38, 44, 16, 72, 80, 74, 48, 15, 13, 30, 16, 80, 80, 46, 38, 14, 14, 48, 49, 20, 14, 13, 30, 15, 51, 13, 18, 80, 13, 17, 15, 13, 14, 58, 58, 42, 47, 80, 35, 80, 29, 15, 80, 80, 80, 20, 80, 56, 52, 52, 53, 45, 80, 13, 19, 72, 13, 13, 17, 13, 80, 18, 59, 80, 13, 80, 17, 47, 16, 13, 13, 13, 13, 15, 13, 13, 14, 80, 13, 80, 65, 13, 13, 15, 75, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0928645282959193, "mean_inference_ms": 0.25725721119052186, "mean_action_processing_ms": 0.03322536783541058, "mean_env_wait_ms": 0.04729348973837711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015553973969959077, "StateBufferConnector_ms": 0.0013703391665504092, "ViewRequirementAgentConnector_ms": 0.029194014413016185}}, "episode_reward_max": 0.9948394688979767, "episode_reward_min": -1.0, "episode_reward_mean": 0.1632200734968666, "episode_len_mean": 38.05714285714286, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.549448540720678, 0.5, -1.0, 0.6897575978893828, 0.8005555939191491, -1.0, -1.0, 0.7060123493091103, 0.721161175007516, 0.9878050142043706, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, 0.5, -1.0, 0.9216589244250667, 0.5, 0.6279107403630216, 0.5, -1.0, -1.0, -1.0, 0.9948394688979767, 0.5, 0.5911947595944607, 0.9831526607074089, 0.7346607030500074, -1.0, -1.0, 0.8165639068861014, 0.5, 0.8369661654955273, 0.6781033545136761, 0.5, 0.9199231513322378, 0.5, 0.5, 0.7389156038901523, -1.0, 0.8254246792392675, 0.5206079475863923, 0.8786109273832373, -1.0, -1.0, 0.9742738867467048, 0.5, 0.9780712490996115, 0.6549070603724202, 0.7011986081968125, 0.5, 0.9051958647754461, 0.9369090252059453, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, 0.9151089264720882, 0.7995546134631796, 0.5154772857754846, 0.5458137397063879, -1.0, 0.5, 0.5, 0.6865908337629054, 0.9341871496144631, 0.5, -1.0, 0.5517679544818922, -1.0, 0.5, 0.5, -1.0, 0.752365824374249, -1.0, 0.5, 0.8207923328928307, 0.5, 0.8154463720811017, 0.7355165256566647, 0.695783100728247, 0.893645599514083, 0.5398670070284115, 0.7018547359898866, 0.8684859347492273, 0.5, -1.0, 0.968477196592073, -1.0, 0.5, 0.8583780427362826, 0.865165582739854, 0.5, 0.5, -1.0], "episode_lengths": [50, 48, 80, 18, 14, 80, 80, 13, 15, 13, 13, 80, 15, 16, 26, 19, 13, 80, 13, 38, 44, 16, 72, 80, 74, 48, 15, 13, 30, 16, 80, 80, 46, 38, 14, 14, 48, 49, 20, 14, 13, 30, 15, 51, 13, 18, 80, 13, 17, 15, 13, 14, 58, 58, 42, 47, 80, 35, 80, 29, 15, 80, 80, 80, 20, 80, 56, 52, 52, 53, 45, 80, 13, 19, 72, 13, 13, 17, 13, 80, 18, 59, 80, 13, 80, 17, 47, 16, 13, 13, 13, 13, 15, 13, 13, 14, 80, 13, 80, 65, 13, 13, 15, 75, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0928645282959193, "mean_inference_ms": 0.25725721119052186, "mean_action_processing_ms": 0.03322536783541058, "mean_env_wait_ms": 0.04729348973837711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015553973969959077, "StateBufferConnector_ms": 0.0013703391665504092, "ViewRequirementAgentConnector_ms": 0.029194014413016185}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1069.0985493914368, "num_env_steps_trained_throughput_per_sec": 1069.0985493914368, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 3671.078, "sample_time_ms": 1746.674, "load_time_ms": 0.227, "load_throughput": 17641657.203, "learn_time_ms": 1923.18, "learn_throughput": 2079.889, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 4537, "training_iteration": 50, "trial_id": "default", "date": "2024-05-23_11-35-24", "timestamp": 1716456924, "time_this_iter_s": 3.7442739009857178, "time_total_s": 182.79231810569763, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 182.79231810569763, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 18.63333333333333, "ram_util_percent": 56.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.063086017293315, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2298620282293057, "policy_loss": -0.008689454696591823, "vf_loss": 0.23740022216512952, "vf_explained_var": 0.14121877801033758, "kl": 0.011512604881314238, "entropy": 0.7565577221814023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 46965.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 0.9795243182963086, "episode_reward_min": -1.0, "episode_reward_mean": 0.2872883844678736, "episode_len_mean": 37.398148148148145, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9429541326593308, 0.8762200152004143, 0.5, 0.96784811684191, -1.0, 0.9566224701304706, 0.8622944159629856, 0.781717368964996, 0.7774308741988623, 0.9494760868399692, -1.0, 0.5, -1.0, -1.0, 0.8352939150808233, 0.844416845648462, 0.6203403000061697, 0.8155382776075228, 0.5, 0.818499564303731, 0.7769057600030772, 0.5, 0.802174484131323, 0.5, -1.0, 0.5, 0.6478346816496304, 0.7074915889751417, 0.6260103704885371, 0.8295506147948543, 0.5, -1.0, -1.0, 0.6558902122499923, -1.0, 0.8443160742683746, 0.7981388615068148, 0.5, 0.9244692383439284, 0.6891208388415546, 0.569452396590926, 0.839395435771423, -1.0, 0.5939512614721929, 0.6616886443397761, 0.6095041369629941, 0.5, 0.7845760023104933, 0.612357735907593, -1.0, 0.5, 0.5685544169401195, 0.8061225009239895, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7763414808080805, 0.7886032649711833, 0.5, 0.8815628444857062, 0.658803215160725, 0.7405446124225528, 0.5, 0.736820363107876, -1.0, 0.5, 0.5, 0.8231814971752723, 0.9795243182963086, 0.7300755309776347, -1.0, 0.5, 0.71505964381015, 0.5, 0.5, 0.9169454571183513, -1.0, 0.714352788640898, -1.0, 0.5604020239058635, -1.0, -1.0, 0.5, 0.8048410272146926, 0.8745705666679806, -1.0, 0.5441239289950119, -1.0, 0.7580731604907062, 0.8517955286015022, -1.0, 0.758798099564345, 0.5, 0.9272781887866952, 0.5, 0.670464985253024, -1.0, -1.0, 0.5, 0.8651113441606683, 0.8395615153803503, -1.0, 0.6381412341063429, 0.9102800663624447, 0.6657311961475962, 0.5], "episode_lengths": [50, 38, 26, 42, 80, 51, 13, 18, 13, 45, 19, 31, 20, 73, 13, 13, 13, 38, 13, 13, 52, 17, 47, 38, 80, 52, 13, 13, 36, 53, 19, 80, 20, 16, 80, 42, 15, 13, 22, 60, 15, 15, 80, 14, 18, 14, 18, 14, 36, 80, 19, 15, 14, 41, 80, 80, 80, 80, 13, 57, 15, 52, 52, 13, 54, 53, 24, 14, 15, 42, 45, 17, 80, 31, 52, 15, 14, 59, 80, 16, 55, 45, 80, 80, 14, 14, 14, 80, 17, 16, 44, 51, 54, 67, 14, 13, 18, 50, 20, 80, 49, 13, 60, 80, 14, 53, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09289233986219629, "mean_inference_ms": 0.2572726723261924, "mean_action_processing_ms": 0.03322950955154285, "mean_env_wait_ms": 0.04730349614895664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459678791187427, "StateBufferConnector_ms": 0.0013391176859537761, "ViewRequirementAgentConnector_ms": 0.029282437430487737}}, "episode_reward_max": 0.9795243182963086, "episode_reward_min": -1.0, "episode_reward_mean": 0.2872883844678736, "episode_len_mean": 37.398148148148145, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9429541326593308, 0.8762200152004143, 0.5, 0.96784811684191, -1.0, 0.9566224701304706, 0.8622944159629856, 0.781717368964996, 0.7774308741988623, 0.9494760868399692, -1.0, 0.5, -1.0, -1.0, 0.8352939150808233, 0.844416845648462, 0.6203403000061697, 0.8155382776075228, 0.5, 0.818499564303731, 0.7769057600030772, 0.5, 0.802174484131323, 0.5, -1.0, 0.5, 0.6478346816496304, 0.7074915889751417, 0.6260103704885371, 0.8295506147948543, 0.5, -1.0, -1.0, 0.6558902122499923, -1.0, 0.8443160742683746, 0.7981388615068148, 0.5, 0.9244692383439284, 0.6891208388415546, 0.569452396590926, 0.839395435771423, -1.0, 0.5939512614721929, 0.6616886443397761, 0.6095041369629941, 0.5, 0.7845760023104933, 0.612357735907593, -1.0, 0.5, 0.5685544169401195, 0.8061225009239895, 0.5, -1.0, -1.0, -1.0, -1.0, 0.7763414808080805, 0.7886032649711833, 0.5, 0.8815628444857062, 0.658803215160725, 0.7405446124225528, 0.5, 0.736820363107876, -1.0, 0.5, 0.5, 0.8231814971752723, 0.9795243182963086, 0.7300755309776347, -1.0, 0.5, 0.71505964381015, 0.5, 0.5, 0.9169454571183513, -1.0, 0.714352788640898, -1.0, 0.5604020239058635, -1.0, -1.0, 0.5, 0.8048410272146926, 0.8745705666679806, -1.0, 0.5441239289950119, -1.0, 0.7580731604907062, 0.8517955286015022, -1.0, 0.758798099564345, 0.5, 0.9272781887866952, 0.5, 0.670464985253024, -1.0, -1.0, 0.5, 0.8651113441606683, 0.8395615153803503, -1.0, 0.6381412341063429, 0.9102800663624447, 0.6657311961475962, 0.5], "episode_lengths": [50, 38, 26, 42, 80, 51, 13, 18, 13, 45, 19, 31, 20, 73, 13, 13, 13, 38, 13, 13, 52, 17, 47, 38, 80, 52, 13, 13, 36, 53, 19, 80, 20, 16, 80, 42, 15, 13, 22, 60, 15, 15, 80, 14, 18, 14, 18, 14, 36, 80, 19, 15, 14, 41, 80, 80, 80, 80, 13, 57, 15, 52, 52, 13, 54, 53, 24, 14, 15, 42, 45, 17, 80, 31, 52, 15, 14, 59, 80, 16, 55, 45, 80, 80, 14, 14, 14, 80, 17, 16, 44, 51, 54, 67, 14, 13, 18, 50, 20, 80, 49, 13, 60, 80, 14, 53, 15, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09289233986219629, "mean_inference_ms": 0.2572726723261924, "mean_action_processing_ms": 0.03322950955154285, "mean_env_wait_ms": 0.04730349614895664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015459678791187427, "StateBufferConnector_ms": 0.0013391176859537761, "ViewRequirementAgentConnector_ms": 0.029282437430487737}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1094.700236606717, "num_env_steps_trained_throughput_per_sec": 1094.700236606717, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 3669.762, "sample_time_ms": 1746.988, "load_time_ms": 0.225, "load_throughput": 17812098.949, "learn_time_ms": 1921.548, "learn_throughput": 2081.655, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 4645, "training_iteration": 51, "trial_id": "default", "date": "2024-05-23_11-35-28", "timestamp": 1716456928, "time_this_iter_s": 3.656691074371338, "time_total_s": 186.44900918006897, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 186.44900918006897, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 14.84, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4047825195456065, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2616148085141259, "policy_loss": -0.0012314558214437897, "vf_loss": 0.2620783309702591, "vf_explained_var": 0.2307777201616636, "kl": 0.007679345643124487, "entropy": 0.7655270438040457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 47895.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 0.9918961433896267, "episode_reward_min": -1.0, "episode_reward_mean": 0.23338319706552876, "episode_len_mean": 43.96, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.8651113441606683, 0.8395615153803503, -1.0, 0.6381412341063429, 0.9102800663624447, 0.6657311961475962, 0.5, 0.7185578477300897, -1.0, 0.9058170411528694, 0.5, 0.9301012133993214, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7903283483691987, 0.8254168293337723, -1.0, 0.621660923480019, 0.5, 0.8860698316392638, 0.5, 0.8077162030271705, -1.0, 0.5, 0.9381949605075899, -1.0, 0.9131076402476592, -1.0, -1.0, 0.8969770595428269, 0.5037510100498993, 0.5004702714859033, 0.7157081543214125, 0.9814116476998151, 0.5, 0.9564856168275744, 0.9463508839596662, 0.5, 0.6176219527596825, 0.5, -1.0, -1.0, 0.5387212908789542, -1.0, -1.0, 0.640361707659023, 0.7122818308202795, 0.5, 0.5, 0.9552348613324203, 0.5225743122188644, 0.8489007332055041, 0.7057165361262862, 0.8194423126925456, -1.0, 0.8684145621748494, 0.8323079951542445, 0.5, 0.801086857737505, 0.9210386136782008, 0.9287908567070355, 0.744409090184357, 0.9835127684368503, 0.9918961433896267, 0.5563839607042051, 0.5, 0.5, -1.0, 0.824198670097794, -1.0, 0.7874920774210479, 0.7145682293220101, 0.832709055819501, -1.0, 0.7321347891291101, 0.7941318989582903, 0.6408460116211008, 0.5059502133025742, -1.0, 0.5, -1.0, 0.7929101687886271, -1.0, 0.7701925871107239, 0.6206375120657903, -1.0, 0.5466708769178377, -1.0, 0.6377077427456497, -1.0, 0.7895924154484097, -1.0, 0.7069819791407779, 0.8959482538717485], "episode_lengths": [20, 80, 49, 13, 60, 80, 14, 53, 15, 13, 44, 80, 14, 47, 13, 80, 55, 80, 16, 30, 62, 43, 80, 52, 15, 13, 17, 13, 80, 64, 48, 80, 49, 80, 80, 13, 16, 40, 49, 50, 15, 46, 57, 21, 53, 13, 80, 80, 54, 80, 80, 19, 13, 56, 14, 52, 13, 47, 13, 54, 79, 15, 40, 18, 56, 55, 13, 45, 13, 14, 18, 13, 48, 80, 52, 60, 14, 22, 52, 80, 13, 14, 61, 13, 80, 40, 80, 31, 80, 62, 16, 80, 16, 35, 14, 79, 76, 80, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09289259791977854, "mean_inference_ms": 0.2572786575493319, "mean_action_processing_ms": 0.03322978740712976, "mean_env_wait_ms": 0.04730249241706437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001508951187133789, "StateBufferConnector_ms": 0.0013430118560791016, "ViewRequirementAgentConnector_ms": 0.029271364212036133}}, "episode_reward_max": 0.9918961433896267, "episode_reward_min": -1.0, "episode_reward_mean": 0.23338319706552876, "episode_len_mean": 43.96, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.8651113441606683, 0.8395615153803503, -1.0, 0.6381412341063429, 0.9102800663624447, 0.6657311961475962, 0.5, 0.7185578477300897, -1.0, 0.9058170411528694, 0.5, 0.9301012133993214, -1.0, 0.5, -1.0, -1.0, -1.0, 0.7903283483691987, 0.8254168293337723, -1.0, 0.621660923480019, 0.5, 0.8860698316392638, 0.5, 0.8077162030271705, -1.0, 0.5, 0.9381949605075899, -1.0, 0.9131076402476592, -1.0, -1.0, 0.8969770595428269, 0.5037510100498993, 0.5004702714859033, 0.7157081543214125, 0.9814116476998151, 0.5, 0.9564856168275744, 0.9463508839596662, 0.5, 0.6176219527596825, 0.5, -1.0, -1.0, 0.5387212908789542, -1.0, -1.0, 0.640361707659023, 0.7122818308202795, 0.5, 0.5, 0.9552348613324203, 0.5225743122188644, 0.8489007332055041, 0.7057165361262862, 0.8194423126925456, -1.0, 0.8684145621748494, 0.8323079951542445, 0.5, 0.801086857737505, 0.9210386136782008, 0.9287908567070355, 0.744409090184357, 0.9835127684368503, 0.9918961433896267, 0.5563839607042051, 0.5, 0.5, -1.0, 0.824198670097794, -1.0, 0.7874920774210479, 0.7145682293220101, 0.832709055819501, -1.0, 0.7321347891291101, 0.7941318989582903, 0.6408460116211008, 0.5059502133025742, -1.0, 0.5, -1.0, 0.7929101687886271, -1.0, 0.7701925871107239, 0.6206375120657903, -1.0, 0.5466708769178377, -1.0, 0.6377077427456497, -1.0, 0.7895924154484097, -1.0, 0.7069819791407779, 0.8959482538717485], "episode_lengths": [20, 80, 49, 13, 60, 80, 14, 53, 15, 13, 44, 80, 14, 47, 13, 80, 55, 80, 16, 30, 62, 43, 80, 52, 15, 13, 17, 13, 80, 64, 48, 80, 49, 80, 80, 13, 16, 40, 49, 50, 15, 46, 57, 21, 53, 13, 80, 80, 54, 80, 80, 19, 13, 56, 14, 52, 13, 47, 13, 54, 79, 15, 40, 18, 56, 55, 13, 45, 13, 14, 18, 13, 48, 80, 52, 60, 14, 22, 52, 80, 13, 14, 61, 13, 80, 40, 80, 31, 80, 62, 16, 80, 16, 35, 14, 79, 76, 80, 38, 41]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09289259791977854, "mean_inference_ms": 0.2572786575493319, "mean_action_processing_ms": 0.03322978740712976, "mean_env_wait_ms": 0.04730249241706437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001508951187133789, "StateBufferConnector_ms": 0.0013430118560791016, "ViewRequirementAgentConnector_ms": 0.029271364212036133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1092.0291361104332, "num_env_steps_trained_throughput_per_sec": 1092.0291361104332, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 3670.806, "sample_time_ms": 1747.297, "load_time_ms": 0.225, "load_throughput": 17755546.619, "learn_time_ms": 1922.28, "learn_throughput": 2080.862, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 4735, "training_iteration": 52, "trial_id": "default", "date": "2024-05-23_11-35-31", "timestamp": 1716456931, "time_this_iter_s": 3.665532350540161, "time_total_s": 190.11454153060913, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 190.11454153060913, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.419999999999998, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.114078035341796, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18570229469608235, "policy_loss": -0.007298332920438179, "vf_loss": 0.19208880859397112, "vf_explained_var": -0.05857503574381592, "kl": 0.009118172076420284, "entropy": 0.7223279579993217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 48825.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 0.993618960677829, "episode_reward_min": -1.0, "episode_reward_mean": 0.4145229751560205, "episode_len_mean": 35.4954954954955, "episode_media": {}, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.6658169410984092, 0.5, 0.617067219166765, 0.9036726534568926, -1.0, 0.8902556756729322, 0.9023720106795269, 0.8338250598670569, 0.873395362255688, 0.921845084553004, 0.640408035942375, 0.8374963237306414, -1.0, 0.5, 0.6354385508436619, 0.6311829296791346, 0.5, 0.5, 0.6646394826513744, 0.8623963072201336, 0.5, 0.881991034064552, 0.5, 0.8396241787529557, 0.7227784429628421, 0.5107039830090536, -1.0, 0.6641791340916384, 0.7877317476460456, 0.9196003429663774, 0.6239483933162535, 0.9429302636702959, 0.5, 0.9322133236124264, -1.0, -1.0, 0.5, 0.6364614867062993, -1.0, 0.5, -1.0, 0.5, 0.6543876042645923, -1.0, 0.5767344125677081, 0.7131134306326428, 0.7169636309106668, 0.6372265691998493, 0.7280061217567779, 0.7806016126358915, 0.669760154795411, 0.5, 0.9076557116836944, 0.5, 0.7417368301321042, 0.8447547419116014, -1.0, -1.0, 0.5, 0.8331637198952757, 0.6032335677311457, 0.6441705904207236, 0.5, 0.81208195670488, 0.631821805559474, 0.7078453677457869, 0.970462762051382, 0.5, 0.9795366204625957, -1.0, 0.5, 0.5, 0.6828078923511448, 0.5, 0.9060457917932889, 0.5, 0.6269044278605544, 0.9436110299680163, 0.5363643085037306, 0.7285594485083466, 0.5, -1.0, 0.6031356351068999, 0.5, -1.0, 0.5, 0.5, 0.6766665863578116, 0.7165030595830659, 0.9555911471284873, 0.6529893930632, -1.0, -1.0, 0.7735829183147916, 0.5, 0.9270385000372776, 0.7942146233367785, 0.5, 0.5, 0.9766793818430717, 0.7977301948077148, 0.8438564875706089, -1.0, 0.9879598942362378, 0.6204525176974335, 0.993618960677829, -1.0, 0.7725068648934419], "episode_lengths": [13, 80, 24, 13, 37, 35, 48, 80, 20, 21, 60, 54, 51, 15, 15, 80, 39, 49, 40, 45, 48, 14, 51, 30, 53, 14, 14, 50, 32, 15, 14, 16, 48, 73, 42, 14, 52, 65, 17, 17, 30, 80, 14, 54, 14, 17, 80, 38, 47, 18, 14, 44, 49, 64, 15, 14, 61, 15, 55, 80, 80, 20, 55, 13, 20, 15, 51, 14, 54, 57, 60, 13, 74, 16, 15, 49, 25, 13, 17, 13, 14, 16, 16, 16, 16, 14, 37, 76, 15, 29, 14, 17, 55, 13, 80, 80, 16, 13, 52, 43, 35, 74, 13, 38, 19, 16, 29, 16, 14, 65, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09292855715906959, "mean_inference_ms": 0.25730465244129824, "mean_action_processing_ms": 0.03323151774778927, "mean_env_wait_ms": 0.047311380856088874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015694815833289344, "StateBufferConnector_ms": 0.0013491054912945172, "ViewRequirementAgentConnector_ms": 0.029254604030299832}}, "episode_reward_max": 0.993618960677829, "episode_reward_min": -1.0, "episode_reward_mean": 0.4145229751560205, "episode_len_mean": 35.4954954954955, "episodes_this_iter": 111, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.5, 0.6658169410984092, 0.5, 0.617067219166765, 0.9036726534568926, -1.0, 0.8902556756729322, 0.9023720106795269, 0.8338250598670569, 0.873395362255688, 0.921845084553004, 0.640408035942375, 0.8374963237306414, -1.0, 0.5, 0.6354385508436619, 0.6311829296791346, 0.5, 0.5, 0.6646394826513744, 0.8623963072201336, 0.5, 0.881991034064552, 0.5, 0.8396241787529557, 0.7227784429628421, 0.5107039830090536, -1.0, 0.6641791340916384, 0.7877317476460456, 0.9196003429663774, 0.6239483933162535, 0.9429302636702959, 0.5, 0.9322133236124264, -1.0, -1.0, 0.5, 0.6364614867062993, -1.0, 0.5, -1.0, 0.5, 0.6543876042645923, -1.0, 0.5767344125677081, 0.7131134306326428, 0.7169636309106668, 0.6372265691998493, 0.7280061217567779, 0.7806016126358915, 0.669760154795411, 0.5, 0.9076557116836944, 0.5, 0.7417368301321042, 0.8447547419116014, -1.0, -1.0, 0.5, 0.8331637198952757, 0.6032335677311457, 0.6441705904207236, 0.5, 0.81208195670488, 0.631821805559474, 0.7078453677457869, 0.970462762051382, 0.5, 0.9795366204625957, -1.0, 0.5, 0.5, 0.6828078923511448, 0.5, 0.9060457917932889, 0.5, 0.6269044278605544, 0.9436110299680163, 0.5363643085037306, 0.7285594485083466, 0.5, -1.0, 0.6031356351068999, 0.5, -1.0, 0.5, 0.5, 0.6766665863578116, 0.7165030595830659, 0.9555911471284873, 0.6529893930632, -1.0, -1.0, 0.7735829183147916, 0.5, 0.9270385000372776, 0.7942146233367785, 0.5, 0.5, 0.9766793818430717, 0.7977301948077148, 0.8438564875706089, -1.0, 0.9879598942362378, 0.6204525176974335, 0.993618960677829, -1.0, 0.7725068648934419], "episode_lengths": [13, 80, 24, 13, 37, 35, 48, 80, 20, 21, 60, 54, 51, 15, 15, 80, 39, 49, 40, 45, 48, 14, 51, 30, 53, 14, 14, 50, 32, 15, 14, 16, 48, 73, 42, 14, 52, 65, 17, 17, 30, 80, 14, 54, 14, 17, 80, 38, 47, 18, 14, 44, 49, 64, 15, 14, 61, 15, 55, 80, 80, 20, 55, 13, 20, 15, 51, 14, 54, 57, 60, 13, 74, 16, 15, 49, 25, 13, 17, 13, 14, 16, 16, 16, 16, 14, 37, 76, 15, 29, 14, 17, 55, 13, 80, 80, 16, 13, 52, 43, 35, 74, 13, 38, 19, 16, 29, 16, 14, 65, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09292855715906959, "mean_inference_ms": 0.25730465244129824, "mean_action_processing_ms": 0.03323151774778927, "mean_env_wait_ms": 0.047311380856088874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015694815833289344, "StateBufferConnector_ms": 0.0013491054912945172, "ViewRequirementAgentConnector_ms": 0.029254604030299832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1082.6520678407626, "num_env_steps_trained_throughput_per_sec": 1082.6520678407626, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 3666.491, "sample_time_ms": 1748.268, "load_time_ms": 0.238, "load_throughput": 16814207.256, "learn_time_ms": 1916.975, "learn_throughput": 2086.621, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 4846, "training_iteration": 53, "trial_id": "default", "date": "2024-05-23_11-35-35", "timestamp": 1716456935, "time_this_iter_s": 3.697622776031494, "time_total_s": 193.81216430664062, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 193.81216430664062, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 18.880000000000003, "ram_util_percent": 56.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1462146799730997, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23472564842424265, "policy_loss": -0.001171274637422895, "vf_loss": 0.23490819767598184, "vf_explained_var": 0.2887166563541658, "kl": 0.009887289755462998, "entropy": 0.7452815594852612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 49755.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 0.9997216895450355, "episode_reward_min": -1.0, "episode_reward_mean": 0.17649042445522486, "episode_len_mean": 42.73, "episode_media": {}, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9766793818430717, 0.7977301948077148, 0.8438564875706089, -1.0, 0.9879598942362378, 0.6204525176974335, 0.993618960677829, -1.0, 0.7725068648934419, -1.0, 0.781435651648677, -1.0, 0.7420132505138701, 0.8053134441624422, 0.5, -1.0, 0.748937687093376, 0.5835670481538319, -1.0, -1.0, 0.9997216895450355, 0.8248836757512659, -1.0, 0.7767049929175298, 0.7054747991676523, 0.7326492617534819, 0.9465883521621125, -1.0, 0.5, 0.6240992766430492, 0.8938934084571668, 0.7072721179117322, -1.0, -1.0, 0.9887107650354504, 0.7363081690388278, -1.0, 0.7512194127277376, -1.0, 0.5, 0.5043291773123308, -1.0, 0.9242191328421566, -1.0, -1.0, 0.5, 0.9426973967735397, 0.5, -1.0, 0.9200822512266541, 0.6589838462600767, -1.0, 0.5, 0.5, -1.0, 0.5, 0.8806995274511595, 0.8586356172804027, 0.586714690625015, -1.0, 0.7933997802888092, -1.0, 0.7365942714294258, -1.0, 0.6877718927461118, 0.6414220851389092, 0.8061234063926015, 0.8599299136316008, 0.5, 0.5, -1.0, -1.0, 0.7175030410846783, -1.0, -1.0, 0.503065014905183, -1.0, -1.0, 0.5438813625960413, -1.0, 0.5962780668801013, 0.7678895458985344, 0.6718983159534782, 0.5, -1.0, 0.8552574324209855, 0.5, 0.8508842597150864, -1.0, 0.8680669543022781, 0.5, 0.9328824022131883, -1.0, 0.938182359621982, 0.5, 0.9071883434271322, 0.5, 0.9896095537226459, 0.951984330376629, 0.9112711685961724], "episode_lengths": [13, 38, 19, 16, 29, 16, 14, 65, 14, 80, 59, 80, 19, 13, 13, 80, 43, 23, 80, 80, 55, 48, 16, 16, 58, 22, 42, 80, 23, 73, 31, 14, 80, 50, 52, 15, 80, 16, 80, 15, 22, 80, 13, 80, 80, 60, 58, 13, 80, 13, 46, 80, 15, 14, 80, 35, 47, 50, 14, 80, 40, 80, 47, 80, 14, 13, 15, 13, 15, 17, 29, 80, 71, 80, 80, 14, 80, 80, 14, 80, 33, 44, 38, 30, 80, 13, 14, 13, 80, 13, 14, 13, 80, 13, 14, 38, 16, 54, 58, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09294757281460793, "mean_inference_ms": 0.2573528881201205, "mean_action_processing_ms": 0.033240253044374925, "mean_env_wait_ms": 0.047322813180601886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001676321029663086, "StateBufferConnector_ms": 0.0013124942779541016, "ViewRequirementAgentConnector_ms": 0.029512405395507812}}, "episode_reward_max": 0.9997216895450355, "episode_reward_min": -1.0, "episode_reward_mean": 0.17649042445522486, "episode_len_mean": 42.73, "episodes_this_iter": 91, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9766793818430717, 0.7977301948077148, 0.8438564875706089, -1.0, 0.9879598942362378, 0.6204525176974335, 0.993618960677829, -1.0, 0.7725068648934419, -1.0, 0.781435651648677, -1.0, 0.7420132505138701, 0.8053134441624422, 0.5, -1.0, 0.748937687093376, 0.5835670481538319, -1.0, -1.0, 0.9997216895450355, 0.8248836757512659, -1.0, 0.7767049929175298, 0.7054747991676523, 0.7326492617534819, 0.9465883521621125, -1.0, 0.5, 0.6240992766430492, 0.8938934084571668, 0.7072721179117322, -1.0, -1.0, 0.9887107650354504, 0.7363081690388278, -1.0, 0.7512194127277376, -1.0, 0.5, 0.5043291773123308, -1.0, 0.9242191328421566, -1.0, -1.0, 0.5, 0.9426973967735397, 0.5, -1.0, 0.9200822512266541, 0.6589838462600767, -1.0, 0.5, 0.5, -1.0, 0.5, 0.8806995274511595, 0.8586356172804027, 0.586714690625015, -1.0, 0.7933997802888092, -1.0, 0.7365942714294258, -1.0, 0.6877718927461118, 0.6414220851389092, 0.8061234063926015, 0.8599299136316008, 0.5, 0.5, -1.0, -1.0, 0.7175030410846783, -1.0, -1.0, 0.503065014905183, -1.0, -1.0, 0.5438813625960413, -1.0, 0.5962780668801013, 0.7678895458985344, 0.6718983159534782, 0.5, -1.0, 0.8552574324209855, 0.5, 0.8508842597150864, -1.0, 0.8680669543022781, 0.5, 0.9328824022131883, -1.0, 0.938182359621982, 0.5, 0.9071883434271322, 0.5, 0.9896095537226459, 0.951984330376629, 0.9112711685961724], "episode_lengths": [13, 38, 19, 16, 29, 16, 14, 65, 14, 80, 59, 80, 19, 13, 13, 80, 43, 23, 80, 80, 55, 48, 16, 16, 58, 22, 42, 80, 23, 73, 31, 14, 80, 50, 52, 15, 80, 16, 80, 15, 22, 80, 13, 80, 80, 60, 58, 13, 80, 13, 46, 80, 15, 14, 80, 35, 47, 50, 14, 80, 40, 80, 47, 80, 14, 13, 15, 13, 15, 17, 29, 80, 71, 80, 80, 14, 80, 80, 14, 80, 33, 44, 38, 30, 80, 13, 14, 13, 80, 13, 14, 13, 80, 13, 14, 38, 16, 54, 58, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09294757281460793, "mean_inference_ms": 0.2573528881201205, "mean_action_processing_ms": 0.033240253044374925, "mean_env_wait_ms": 0.047322813180601886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001676321029663086, "StateBufferConnector_ms": 0.0013124942779541016, "ViewRequirementAgentConnector_ms": 0.029512405395507812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1090.0750905682398, "num_env_steps_trained_throughput_per_sec": 1090.0750905682398, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3669.238, "sample_time_ms": 1749.663, "load_time_ms": 0.235, "load_throughput": 17020610.733, "learn_time_ms": 1918.325, "learn_throughput": 2085.152, "synch_weights_time_ms": 0.659}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 4937, "training_iteration": 54, "trial_id": "default", "date": "2024-05-23_11-35-39", "timestamp": 1716456939, "time_this_iter_s": 3.672106981277466, "time_total_s": 197.4842712879181, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 197.4842712879181, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 20.116666666666667, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.357155268871656, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2284526524304222, "policy_loss": -0.0026868105605645206, "vf_loss": 0.23049424283847372, "vf_explained_var": 0.1639653629513197, "kl": 0.0064522010855644985, "entropy": 0.7501023621969326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 50685.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 0.9609231583225507, "episode_reward_min": -1.0, "episode_reward_mean": 0.15693565021437214, "episode_len_mean": 38.161904761904765, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9264815423062246, 0.5, -1.0, 0.5, 0.9282271370274688, 0.7201469840450136, 0.5, -1.0, 0.537381194746632, 0.5, 0.5, 0.5, 0.6736171748789438, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7338544655686552, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5930725032846282, 0.5854683410604067, 0.7631960931989483, 0.6428593895423986, 0.8361803352058936, 0.8605149849908481, -1.0, 0.6266843383648577, 0.8217533920064038, 0.5, 0.8386899536619158, -1.0, 0.8935141968030549, -1.0, -1.0, -1.0, 0.8120548547943105, 0.7977325245357408, 0.728130106303568, 0.5, 0.7616290574342934, -1.0, 0.5, -1.0, -1.0, 0.9074531305035305, -1.0, 0.7754757533283834, 0.5836602931573647, -1.0, -1.0, 0.9475259724705131, 0.9609231583225507, 0.8049644798314037, 0.5793499390951534, 0.5940325540340816, -1.0, 0.8134063099396158, 0.7877483680030335, 0.6351102310950147, 0.7039377775596394, 0.8522084702351003, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.8809716395179995, -1.0, 0.5, 0.5, 0.7425864106541327, 0.7734824462269939, 0.8758020630874488, 0.8496884518442375, 0.9377788084026941, 0.9267111227042237, -1.0, 0.5, 0.7034308349869429, -1.0, 0.8638424241254505, 0.9554691781492125, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8919250558259102, 0.5, 0.7874759218422016, 0.5, 0.5, 0.9568543293955905, 0.5, 0.8052395784104451], "episode_lengths": [53, 16, 80, 33, 51, 67, 49, 80, 16, 13, 13, 45, 13, 80, 80, 13, 15, 80, 80, 80, 24, 80, 13, 15, 80, 80, 80, 14, 14, 19, 13, 26, 13, 13, 80, 22, 13, 14, 43, 15, 52, 12, 80, 16, 48, 15, 15, 14, 23, 80, 42, 80, 80, 13, 80, 58, 14, 28, 80, 13, 13, 20, 14, 14, 23, 14, 14, 13, 41, 15, 13, 80, 80, 13, 17, 80, 13, 80, 40, 20, 61, 50, 17, 14, 14, 48, 80, 14, 17, 80, 16, 13, 80, 15, 16, 65, 80, 36, 43, 48, 13, 18, 54, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09296456042026649, "mean_inference_ms": 0.25735576323129145, "mean_action_processing_ms": 0.033239884356823915, "mean_env_wait_ms": 0.047326859015514554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015824181692940848, "StateBufferConnector_ms": 0.0013256072998046875, "ViewRequirementAgentConnector_ms": 0.029085250127883183}}, "episode_reward_max": 0.9609231583225507, "episode_reward_min": -1.0, "episode_reward_mean": 0.15693565021437214, "episode_len_mean": 38.161904761904765, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9264815423062246, 0.5, -1.0, 0.5, 0.9282271370274688, 0.7201469840450136, 0.5, -1.0, 0.537381194746632, 0.5, 0.5, 0.5, 0.6736171748789438, -1.0, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.7338544655686552, 0.5, -1.0, -1.0, -1.0, 0.5, 0.5930725032846282, 0.5854683410604067, 0.7631960931989483, 0.6428593895423986, 0.8361803352058936, 0.8605149849908481, -1.0, 0.6266843383648577, 0.8217533920064038, 0.5, 0.8386899536619158, -1.0, 0.8935141968030549, -1.0, -1.0, -1.0, 0.8120548547943105, 0.7977325245357408, 0.728130106303568, 0.5, 0.7616290574342934, -1.0, 0.5, -1.0, -1.0, 0.9074531305035305, -1.0, 0.7754757533283834, 0.5836602931573647, -1.0, -1.0, 0.9475259724705131, 0.9609231583225507, 0.8049644798314037, 0.5793499390951534, 0.5940325540340816, -1.0, 0.8134063099396158, 0.7877483680030335, 0.6351102310950147, 0.7039377775596394, 0.8522084702351003, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.8809716395179995, -1.0, 0.5, 0.5, 0.7425864106541327, 0.7734824462269939, 0.8758020630874488, 0.8496884518442375, 0.9377788084026941, 0.9267111227042237, -1.0, 0.5, 0.7034308349869429, -1.0, 0.8638424241254505, 0.9554691781492125, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8919250558259102, 0.5, 0.7874759218422016, 0.5, 0.5, 0.9568543293955905, 0.5, 0.8052395784104451], "episode_lengths": [53, 16, 80, 33, 51, 67, 49, 80, 16, 13, 13, 45, 13, 80, 80, 13, 15, 80, 80, 80, 24, 80, 13, 15, 80, 80, 80, 14, 14, 19, 13, 26, 13, 13, 80, 22, 13, 14, 43, 15, 52, 12, 80, 16, 48, 15, 15, 14, 23, 80, 42, 80, 80, 13, 80, 58, 14, 28, 80, 13, 13, 20, 14, 14, 23, 14, 14, 13, 41, 15, 13, 80, 80, 13, 17, 80, 13, 80, 40, 20, 61, 50, 17, 14, 14, 48, 80, 14, 17, 80, 16, 13, 80, 15, 16, 65, 80, 36, 43, 48, 13, 18, 54, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09296456042026649, "mean_inference_ms": 0.25735576323129145, "mean_action_processing_ms": 0.033239884356823915, "mean_env_wait_ms": 0.047326859015514554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015824181692940848, "StateBufferConnector_ms": 0.0013256072998046875, "ViewRequirementAgentConnector_ms": 0.029085250127883183}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1094.3768332467623, "num_env_steps_trained_throughput_per_sec": 1094.3768332467623, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 3670.676, "sample_time_ms": 1749.065, "load_time_ms": 0.234, "load_throughput": 17093444.727, "learn_time_ms": 1920.375, "learn_throughput": 2082.926, "synch_weights_time_ms": 0.647}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 5042, "training_iteration": 55, "trial_id": "default", "date": "2024-05-23_11-35-42", "timestamp": 1716456942, "time_this_iter_s": 3.657804012298584, "time_total_s": 201.14207530021667, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 201.14207530021667, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.48, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3908624785561714, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24336449586315662, "policy_loss": -0.004436640392598366, "vf_loss": 0.24693823037769205, "vf_explained_var": 0.14713993809556447, "kl": 0.008629049372269649, "entropy": 0.7127793653036958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 51615.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 0.9887765135227761, "episode_reward_min": -1.0, "episode_reward_mean": 0.30379198945778957, "episode_len_mean": 33.12396694214876, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7903453579397864, 0.8159976000395409, 0.8467437568056186, 0.5, -1.0, 0.9176017496857908, 0.7827413855706057, -1.0, 0.838904111913842, -1.0, 0.6562107238025235, 0.5717723404759381, -1.0, 0.530921467964262, 0.5, 0.5, 0.5407409073582911, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.558673462011288, 0.5, 0.5046571222572237, -1.0, 0.5, 0.9651900578217558, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8041189430686795, 0.8894419252841826, 0.8591103520712724, 0.9363417234274048, 0.5586441789908737, 0.8238014146445986, -1.0, 0.6938743161060316, 0.789361469660564, 0.7376607602136118, 0.5, 0.5, 0.5, -1.0, 0.5118701403253216, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.8466767364887304, 0.5, 0.8131497896745616, 0.5928046392859254, -1.0, 0.9145525188444821, 0.6377203089576688, -1.0, -1.0, 0.8613117102690309, -1.0, -1.0, 0.7541211595913326, 0.9190801571404013, 0.8161852027974046, 0.7104180419628847, 0.9120032289623068, 0.5, -1.0, 0.9629745161277115, -1.0, 0.9412359854596782, 0.5, 0.5, 0.5833643758275007, -1.0, 0.9786983621132712, 0.9615519718370162, 0.5, 0.9773668556893385, 0.5, 0.7818908601949793, 0.9093633583021095, 0.7696927558156806, 0.5, 0.8717367023418033, 0.7565170508771383, 0.8858796173433577, 0.9073428073705826, -1.0, 0.5, 0.7801553163191607, 0.7669747015049402, 0.9489152081753176, 0.8586786844809368, 0.7826589256518866, 0.9156425643241524, 0.9887765135227761, -1.0, 0.7225503708559178, 0.8842169115704531, 0.6769107109508672, 0.5, 0.8752433072534028, 0.5, 0.5, 0.8657579534446432, 0.9288136471925617, -1.0, 0.6452285498450272, 0.6279433785865902, -1.0, 0.5, 0.5], "episode_lengths": [13, 43, 13, 15, 80, 16, 13, 25, 13, 52, 48, 18, 20, 16, 48, 15, 44, 19, 17, 14, 57, 27, 14, 48, 14, 13, 80, 14, 37, 15, 80, 35, 20, 80, 31, 58, 16, 13, 13, 14, 18, 80, 13, 13, 13, 78, 15, 14, 16, 43, 20, 78, 80, 16, 31, 13, 24, 13, 13, 13, 13, 80, 51, 22, 80, 19, 13, 80, 80, 16, 13, 15, 56, 14, 45, 80, 13, 16, 13, 32, 32, 57, 16, 55, 50, 52, 13, 14, 13, 16, 13, 37, 40, 45, 52, 13, 80, 13, 32, 13, 15, 51, 45, 39, 13, 80, 45, 13, 37, 32, 13, 24, 17, 55, 55, 80, 55, 15, 21, 16, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930080178551362, "mean_inference_ms": 0.25737696405262833, "mean_action_processing_ms": 0.033242577495877494, "mean_env_wait_ms": 0.0473400029131732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001623216739370803, "StateBufferConnector_ms": 0.0013225334734956096, "ViewRequirementAgentConnector_ms": 0.0292703139880472}}, "episode_reward_max": 0.9887765135227761, "episode_reward_min": -1.0, "episode_reward_mean": 0.30379198945778957, "episode_len_mean": 33.12396694214876, "episodes_this_iter": 121, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7903453579397864, 0.8159976000395409, 0.8467437568056186, 0.5, -1.0, 0.9176017496857908, 0.7827413855706057, -1.0, 0.838904111913842, -1.0, 0.6562107238025235, 0.5717723404759381, -1.0, 0.530921467964262, 0.5, 0.5, 0.5407409073582911, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.558673462011288, 0.5, 0.5046571222572237, -1.0, 0.5, 0.9651900578217558, 0.5, -1.0, -1.0, -1.0, -1.0, -1.0, 0.8041189430686795, 0.8894419252841826, 0.8591103520712724, 0.9363417234274048, 0.5586441789908737, 0.8238014146445986, -1.0, 0.6938743161060316, 0.789361469660564, 0.7376607602136118, 0.5, 0.5, 0.5, -1.0, 0.5118701403253216, 0.5, -1.0, -1.0, 0.5, 0.5, 0.5, 0.5, 0.8466767364887304, 0.5, 0.8131497896745616, 0.5928046392859254, -1.0, 0.9145525188444821, 0.6377203089576688, -1.0, -1.0, 0.8613117102690309, -1.0, -1.0, 0.7541211595913326, 0.9190801571404013, 0.8161852027974046, 0.7104180419628847, 0.9120032289623068, 0.5, -1.0, 0.9629745161277115, -1.0, 0.9412359854596782, 0.5, 0.5, 0.5833643758275007, -1.0, 0.9786983621132712, 0.9615519718370162, 0.5, 0.9773668556893385, 0.5, 0.7818908601949793, 0.9093633583021095, 0.7696927558156806, 0.5, 0.8717367023418033, 0.7565170508771383, 0.8858796173433577, 0.9073428073705826, -1.0, 0.5, 0.7801553163191607, 0.7669747015049402, 0.9489152081753176, 0.8586786844809368, 0.7826589256518866, 0.9156425643241524, 0.9887765135227761, -1.0, 0.7225503708559178, 0.8842169115704531, 0.6769107109508672, 0.5, 0.8752433072534028, 0.5, 0.5, 0.8657579534446432, 0.9288136471925617, -1.0, 0.6452285498450272, 0.6279433785865902, -1.0, 0.5, 0.5], "episode_lengths": [13, 43, 13, 15, 80, 16, 13, 25, 13, 52, 48, 18, 20, 16, 48, 15, 44, 19, 17, 14, 57, 27, 14, 48, 14, 13, 80, 14, 37, 15, 80, 35, 20, 80, 31, 58, 16, 13, 13, 14, 18, 80, 13, 13, 13, 78, 15, 14, 16, 43, 20, 78, 80, 16, 31, 13, 24, 13, 13, 13, 13, 80, 51, 22, 80, 19, 13, 80, 80, 16, 13, 15, 56, 14, 45, 80, 13, 16, 13, 32, 32, 57, 16, 55, 50, 52, 13, 14, 13, 16, 13, 37, 40, 45, 52, 13, 80, 13, 32, 13, 15, 51, 45, 39, 13, 80, 45, 13, 37, 32, 13, 24, 17, 55, 55, 80, 55, 15, 21, 16, 55]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930080178551362, "mean_inference_ms": 0.25737696405262833, "mean_action_processing_ms": 0.033242577495877494, "mean_env_wait_ms": 0.0473400029131732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001623216739370803, "StateBufferConnector_ms": 0.0013225334734956096, "ViewRequirementAgentConnector_ms": 0.0292703139880472}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1080.8666896920456, "num_env_steps_trained_throughput_per_sec": 1080.8666896920456, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 3675.485, "sample_time_ms": 1749.618, "load_time_ms": 0.214, "load_throughput": 18697443.441, "learn_time_ms": 1924.65, "learn_throughput": 2078.3, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 5163, "training_iteration": 56, "trial_id": "default", "date": "2024-05-23_11-35-46", "timestamp": 1716456946, "time_this_iter_s": 3.704270124435425, "time_total_s": 204.8463454246521, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 204.8463454246521, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 23.060000000000002, "ram_util_percent": 56.879999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0054151386983934, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19811536563029614, "policy_loss": -0.018780272748441466, "vf_loss": 0.2161233977204369, "vf_explained_var": 0.20047079510586235, "kl": 0.007722396897670681, "entropy": 0.7215191109206087, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 52545.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 0.9944342035853194, "episode_reward_min": -1.0, "episode_reward_mean": 0.34997765392844565, "episode_len_mean": 30.674418604651162, "episode_media": {}, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.7787968416618516, -1.0, 0.9756670662883483, 0.9262344456916214, 0.5, 0.8568460653177458, 0.635713973238909, 0.7708385673370133, 0.6678691906610175, 0.8359737909294472, 0.9309729645491187, -1.0, 0.8853872643617143, -1.0, 0.8111225944636309, 0.5, -1.0, -1.0, 0.9329311271707269, 0.6089843051264099, 0.9796080346538056, -1.0, 0.6283051950630574, 0.9344854762181634, 0.5, -1.0, 0.8957405940782349, 0.8188184187813863, 0.5972690710308948, -1.0, 0.9738562289776449, 0.8546103196079508, 0.9601254014368351, -1.0, 0.6491353889157185, -1.0, 0.9944342035853194, 0.8526224307522459, 0.5, 0.7559227481266815, 0.5860093299991738, 0.9000177754263631, 0.5, 0.5, -1.0, 0.5369044492482178, 0.7188398514367502, 0.675963023702475, 0.7153201369150615, 0.5, -1.0, 0.5, 0.8778836435966961, 0.5, 0.9568412060927646, 0.6029977474085554, 0.512658047660367, 0.9698452084399959, 0.5, 0.5236748221796776, 0.5, -1.0, 0.861466813970663, 0.6275155113894786, 0.5, 0.9134405728198562, 0.5, 0.730597472727782, 0.9142442959112962, 0.5, 0.5, 0.6188906785896987, 0.7675081205802217, 0.9311506441217038, 0.7632731266817254, -1.0, 0.5697971055458378, 0.5, 0.7445034801945563, -1.0, 0.8935874674619806, 0.5, -1.0, 0.9358044142351949, 0.9361200986585037, 0.5911093625583237, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8434547930197831, 0.9048795931705753, -1.0, -1.0, 0.5, 0.7805002491142297, 0.5555614284137336, 0.5, 0.5, 0.5, 0.6988672140465719, 0.5, 0.9473224714319308, 0.5, 0.5, 0.7850337379800211, 0.5, -1.0, 0.9424607409060017, -1.0, 0.5, 0.8576268844841177, 0.8446862297548968, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.6762527028744307, 0.7286664986208098, 0.5, 0.6777258056158132, 0.9207853726708187, -1.0, 0.5, 0.5950575190873404], "episode_lengths": [13, 58, 80, 15, 42, 39, 15, 13, 13, 23, 48, 52, 80, 13, 80, 50, 19, 80, 80, 13, 14, 15, 15, 13, 44, 25, 16, 14, 14, 13, 12, 13, 54, 54, 80, 14, 80, 13, 56, 19, 13, 72, 54, 25, 14, 69, 13, 13, 13, 13, 34, 24, 21, 50, 53, 14, 14, 18, 49, 17, 13, 15, 80, 49, 13, 14, 13, 16, 13, 56, 13, 56, 45, 13, 13, 18, 25, 15, 15, 13, 80, 43, 14, 14, 13, 13, 40, 19, 80, 13, 15, 13, 65, 13, 80, 16, 14, 45, 14, 19, 15, 14, 33, 17, 13, 14, 14, 13, 13, 72, 39, 80, 13, 13, 57, 16, 16, 13, 80, 58, 80, 14, 15, 21, 13, 22, 16, 30, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09302963583660365, "mean_inference_ms": 0.257321480821605, "mean_action_processing_ms": 0.03323440029414276, "mean_env_wait_ms": 0.047328989221162125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015386315279228742, "StateBufferConnector_ms": 0.0012941138688908067, "ViewRequirementAgentConnector_ms": 0.02859525902326717}}, "episode_reward_max": 0.9944342035853194, "episode_reward_min": -1.0, "episode_reward_mean": 0.34997765392844565, "episode_len_mean": 30.674418604651162, "episodes_this_iter": 129, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.7787968416618516, -1.0, 0.9756670662883483, 0.9262344456916214, 0.5, 0.8568460653177458, 0.635713973238909, 0.7708385673370133, 0.6678691906610175, 0.8359737909294472, 0.9309729645491187, -1.0, 0.8853872643617143, -1.0, 0.8111225944636309, 0.5, -1.0, -1.0, 0.9329311271707269, 0.6089843051264099, 0.9796080346538056, -1.0, 0.6283051950630574, 0.9344854762181634, 0.5, -1.0, 0.8957405940782349, 0.8188184187813863, 0.5972690710308948, -1.0, 0.9738562289776449, 0.8546103196079508, 0.9601254014368351, -1.0, 0.6491353889157185, -1.0, 0.9944342035853194, 0.8526224307522459, 0.5, 0.7559227481266815, 0.5860093299991738, 0.9000177754263631, 0.5, 0.5, -1.0, 0.5369044492482178, 0.7188398514367502, 0.675963023702475, 0.7153201369150615, 0.5, -1.0, 0.5, 0.8778836435966961, 0.5, 0.9568412060927646, 0.6029977474085554, 0.512658047660367, 0.9698452084399959, 0.5, 0.5236748221796776, 0.5, -1.0, 0.861466813970663, 0.6275155113894786, 0.5, 0.9134405728198562, 0.5, 0.730597472727782, 0.9142442959112962, 0.5, 0.5, 0.6188906785896987, 0.7675081205802217, 0.9311506441217038, 0.7632731266817254, -1.0, 0.5697971055458378, 0.5, 0.7445034801945563, -1.0, 0.8935874674619806, 0.5, -1.0, 0.9358044142351949, 0.9361200986585037, 0.5911093625583237, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8434547930197831, 0.9048795931705753, -1.0, -1.0, 0.5, 0.7805002491142297, 0.5555614284137336, 0.5, 0.5, 0.5, 0.6988672140465719, 0.5, 0.9473224714319308, 0.5, 0.5, 0.7850337379800211, 0.5, -1.0, 0.9424607409060017, -1.0, 0.5, 0.8576268844841177, 0.8446862297548968, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.6762527028744307, 0.7286664986208098, 0.5, 0.6777258056158132, 0.9207853726708187, -1.0, 0.5, 0.5950575190873404], "episode_lengths": [13, 58, 80, 15, 42, 39, 15, 13, 13, 23, 48, 52, 80, 13, 80, 50, 19, 80, 80, 13, 14, 15, 15, 13, 44, 25, 16, 14, 14, 13, 12, 13, 54, 54, 80, 14, 80, 13, 56, 19, 13, 72, 54, 25, 14, 69, 13, 13, 13, 13, 34, 24, 21, 50, 53, 14, 14, 18, 49, 17, 13, 15, 80, 49, 13, 14, 13, 16, 13, 56, 13, 56, 45, 13, 13, 18, 25, 15, 15, 13, 80, 43, 14, 14, 13, 13, 40, 19, 80, 13, 15, 13, 65, 13, 80, 16, 14, 45, 14, 19, 15, 14, 33, 17, 13, 14, 14, 13, 13, 72, 39, 80, 13, 13, 57, 16, 16, 13, 80, 58, 80, 14, 15, 21, 13, 22, 16, 30, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09302963583660365, "mean_inference_ms": 0.257321480821605, "mean_action_processing_ms": 0.03323440029414276, "mean_env_wait_ms": 0.047328989221162125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015386315279228742, "StateBufferConnector_ms": 0.0012941138688908067, "ViewRequirementAgentConnector_ms": 0.02859525902326717}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1077.2718974991267, "num_env_steps_trained_throughput_per_sec": 1077.2718974991267, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 3682.534, "sample_time_ms": 1747.918, "load_time_ms": 0.212, "load_throughput": 18848686.664, "learn_time_ms": 1933.381, "learn_throughput": 2068.915, "synch_weights_time_ms": 0.665}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 5292, "training_iteration": 57, "trial_id": "default", "date": "2024-05-23_11-35-50", "timestamp": 1716456950, "time_this_iter_s": 3.7161941528320312, "time_total_s": 208.56253957748413, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 208.56253957748413, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 18.98, "ram_util_percent": 56.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.177680211169745, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.27954976895964273, "policy_loss": -0.006411278620362282, "vf_loss": 0.2851117607246163, "vf_explained_var": 0.024069285264579198, "kl": 0.008492877820219066, "entropy": 0.6965892534743073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 53475.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 0.9978451225527382, "episode_reward_min": -1.0, "episode_reward_mean": 0.25408089042074844, "episode_len_mean": 32.288, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5740535665397455, -1.0, 0.9626023757241824, 0.5, 0.7664120819442551, 0.5, 0.8857612734202542, 0.8839539870310085, 0.5262225997863113, -1.0, -1.0, 0.9189556277105793, -1.0, 0.5, 0.504817656507853, 0.6410158333202338, 0.7470996894638107, 0.6578348706786193, 0.9687896108941304, 0.9787832227529917, 0.7922093408440607, 0.5182611091381318, 0.8184675649839684, 0.5, 0.5, 0.9513118278123809, 0.5568243874330956, 0.5, -1.0, 0.5, 0.5816856105878646, 0.9819652149996477, -1.0, 0.5, -1.0, 0.5, 0.9422137897031018, 0.9074856828868738, 0.9566377256885871, 0.5, -1.0, 0.5783425565025053, 0.8210244305717298, 0.5, -1.0, 0.5294550485159553, 0.8155108930085999, 0.5575211347920808, 0.5616297101868373, 0.6283216211838889, -1.0, 0.5, 0.8787214208988872, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.7156050012181544, -1.0, 0.7324643947590741, 0.8405786750648182, -1.0, 0.9815020157170449, -1.0, 0.834080801461385, 0.9716489023135875, 0.9117909306704379, 0.668639119642594, 0.5, 0.5, 0.5, 0.7282896114803623, -1.0, -1.0, 0.7790283260667737, 0.5235854986290347, 0.6616931517896716, 0.5, 0.5, -1.0, 0.9978451225527382, 0.5850144894449187, 0.6485928862417489, -1.0, 0.5, 0.5, 0.5, 0.5375989412448521, -1.0, 0.5285494963950086, -1.0, 0.8846605332221342, 0.7995167923098225, 0.5820334430755245, -1.0, 0.833255983317317, -1.0, -1.0, 0.7501044671396476, -1.0, 0.6799397752392264, 0.5, 0.600486212605527, -1.0, 0.5, 0.9457858892746258, 0.5, 0.7886331098326924, 0.5, 0.5, -1.0, 0.5, 0.7812786759693906, 0.7472327662703921, 0.7088233745771708, 0.5410447989547633, 0.5458187664959764, 0.6866266806929522, -1.0, 0.8444712034120143, 0.5], "episode_lengths": [80, 53, 14, 80, 13, 28, 14, 25, 13, 43, 13, 56, 28, 14, 80, 15, 14, 53, 14, 14, 16, 42, 73, 17, 13, 58, 14, 45, 14, 33, 80, 71, 13, 45, 80, 14, 19, 51, 48, 14, 47, 54, 29, 14, 14, 16, 80, 50, 45, 43, 13, 16, 80, 13, 13, 80, 26, 17, 44, 15, 24, 14, 62, 37, 15, 16, 13, 16, 66, 53, 51, 13, 43, 14, 40, 13, 61, 80, 14, 50, 40, 13, 14, 17, 13, 17, 14, 42, 28, 58, 24, 26, 16, 13, 80, 14, 18, 40, 16, 42, 16, 80, 13, 80, 14, 14, 13, 80, 13, 41, 45, 19, 13, 14, 28, 14, 13, 15, 13, 16, 15, 16, 28, 13, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930323331459976, "mean_inference_ms": 0.25725856935089364, "mean_action_processing_ms": 0.03321992597244074, "mean_env_wait_ms": 0.047311963253230144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014934539794921875, "StateBufferConnector_ms": 0.0012937545776367187, "ViewRequirementAgentConnector_ms": 0.028297805786132814}}, "episode_reward_max": 0.9978451225527382, "episode_reward_min": -1.0, "episode_reward_mean": 0.25408089042074844, "episode_len_mean": 32.288, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5740535665397455, -1.0, 0.9626023757241824, 0.5, 0.7664120819442551, 0.5, 0.8857612734202542, 0.8839539870310085, 0.5262225997863113, -1.0, -1.0, 0.9189556277105793, -1.0, 0.5, 0.504817656507853, 0.6410158333202338, 0.7470996894638107, 0.6578348706786193, 0.9687896108941304, 0.9787832227529917, 0.7922093408440607, 0.5182611091381318, 0.8184675649839684, 0.5, 0.5, 0.9513118278123809, 0.5568243874330956, 0.5, -1.0, 0.5, 0.5816856105878646, 0.9819652149996477, -1.0, 0.5, -1.0, 0.5, 0.9422137897031018, 0.9074856828868738, 0.9566377256885871, 0.5, -1.0, 0.5783425565025053, 0.8210244305717298, 0.5, -1.0, 0.5294550485159553, 0.8155108930085999, 0.5575211347920808, 0.5616297101868373, 0.6283216211838889, -1.0, 0.5, 0.8787214208988872, -1.0, -1.0, -1.0, 0.5, 0.5, 0.5, 0.7156050012181544, -1.0, 0.7324643947590741, 0.8405786750648182, -1.0, 0.9815020157170449, -1.0, 0.834080801461385, 0.9716489023135875, 0.9117909306704379, 0.668639119642594, 0.5, 0.5, 0.5, 0.7282896114803623, -1.0, -1.0, 0.7790283260667737, 0.5235854986290347, 0.6616931517896716, 0.5, 0.5, -1.0, 0.9978451225527382, 0.5850144894449187, 0.6485928862417489, -1.0, 0.5, 0.5, 0.5, 0.5375989412448521, -1.0, 0.5285494963950086, -1.0, 0.8846605332221342, 0.7995167923098225, 0.5820334430755245, -1.0, 0.833255983317317, -1.0, -1.0, 0.7501044671396476, -1.0, 0.6799397752392264, 0.5, 0.600486212605527, -1.0, 0.5, 0.9457858892746258, 0.5, 0.7886331098326924, 0.5, 0.5, -1.0, 0.5, 0.7812786759693906, 0.7472327662703921, 0.7088233745771708, 0.5410447989547633, 0.5458187664959764, 0.6866266806929522, -1.0, 0.8444712034120143, 0.5], "episode_lengths": [80, 53, 14, 80, 13, 28, 14, 25, 13, 43, 13, 56, 28, 14, 80, 15, 14, 53, 14, 14, 16, 42, 73, 17, 13, 58, 14, 45, 14, 33, 80, 71, 13, 45, 80, 14, 19, 51, 48, 14, 47, 54, 29, 14, 14, 16, 80, 50, 45, 43, 13, 16, 80, 13, 13, 80, 26, 17, 44, 15, 24, 14, 62, 37, 15, 16, 13, 16, 66, 53, 51, 13, 43, 14, 40, 13, 61, 80, 14, 50, 40, 13, 14, 17, 13, 17, 14, 42, 28, 58, 24, 26, 16, 13, 80, 14, 18, 40, 16, 42, 16, 80, 13, 80, 14, 14, 13, 80, 13, 41, 45, 19, 13, 14, 28, 14, 13, 15, 13, 16, 15, 16, 28, 13, 37]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930323331459976, "mean_inference_ms": 0.25725856935089364, "mean_action_processing_ms": 0.03321992597244074, "mean_env_wait_ms": 0.047311963253230144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014934539794921875, "StateBufferConnector_ms": 0.0012937545776367187, "ViewRequirementAgentConnector_ms": 0.028297805786132814}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1111.9113753690115, "num_env_steps_trained_throughput_per_sec": 1111.9113753690115, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 3675.91, "sample_time_ms": 1745.187, "load_time_ms": 0.21, "load_throughput": 19036895.495, "learn_time_ms": 1929.493, "learn_throughput": 2073.084, "synch_weights_time_ms": 0.662}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 5417, "training_iteration": 58, "trial_id": "default", "date": "2024-05-23_11-35-53", "timestamp": 1716456953, "time_this_iter_s": 3.6003167629241943, "time_total_s": 212.16285634040833, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.16285634040833, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 18.150000000000002, "ram_util_percent": 56.81666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7594540482567202, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17667718501486165, "policy_loss": -0.008189849613574884, "vf_loss": 0.18399836642126882, "vf_explained_var": 0.23028350023813146, "kl": 0.008686690702461908, "entropy": 0.6755944798069615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 54405.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 0.9993157045487113, "episode_reward_min": -1.0, "episode_reward_mean": 0.2936770846854134, "episode_len_mean": 32.30327868852459, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8997343369710218, 0.8668963081146394, 0.996792860920527, 0.6309687693255548, 0.8896951402428693, 0.97680728925824, -1.0, 0.5, -1.0, -1.0, 0.5876074112537761, 0.5, -1.0, 0.5587944947301375, -1.0, 0.5259957198956567, 0.5, 0.5286312077887468, 0.5, 0.5, 0.5, 0.5, -1.0, 0.8635317513863745, 0.5, 0.5, 0.5106057099353232, -1.0, 0.8712625497530082, 0.9782484292579299, 0.9833461330795479, -1.0, -1.0, 0.9830723332216402, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.6175654199536881, -1.0, 0.5, -1.0, 0.5, 0.8882725283070669, 0.5, 0.6541110331632228, 0.7111991972494536, 0.646854346342856, 0.5, 0.6462613519661644, 0.5, -1.0, 0.5693814781064077, 0.9195392745113512, 0.889794636534423, 0.6282341445315667, 0.732609970659374, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9815848553813072, 0.8238191471591194, 0.6486661865961754, -1.0, 0.7783055703894413, 0.9725951089942816, -1.0, 0.8467393050402046, 0.8647947311759308, 0.6913125024172669, 0.5809455356816087, 0.9993157045487113, -1.0, 0.7316378864627158, 0.8754473929082247, -1.0, 0.5, 0.7677140043147402, 0.5, 0.8914490602404667, 0.5, 0.5, 0.6774588583554437, 0.973756102202735, 0.8892647232152868, 0.5, 0.5205297137371121, 0.5, 0.5, -1.0, -1.0, 0.5, 0.8215829755966039, 0.5, 0.5, 0.8828855228482243, 0.5518735131277488, -1.0, 0.5, 0.5193551856728931, 0.5, 0.521830140254937, 0.5521040732530398, -1.0, 0.5, 0.9549514829714164, 0.5829598735707633, 0.7229749277761846, 0.6663780347143733, 0.7975787037451003, 0.5, -1.0, 0.8711897228600619, 0.7402942982893485, -1.0, 0.5714956616584059], "episode_lengths": [13, 15, 48, 15, 52, 13, 80, 17, 80, 80, 13, 26, 26, 40, 80, 22, 14, 18, 14, 15, 13, 15, 80, 14, 43, 13, 15, 80, 63, 13, 13, 52, 80, 13, 17, 13, 18, 14, 14, 19, 80, 13, 80, 18, 19, 38, 42, 16, 18, 39, 13, 14, 13, 19, 36, 42, 13, 41, 57, 47, 11, 16, 19, 31, 13, 80, 48, 44, 14, 20, 13, 14, 80, 13, 49, 37, 20, 13, 80, 41, 14, 80, 15, 25, 15, 13, 60, 55, 26, 15, 14, 79, 13, 13, 19, 41, 80, 29, 13, 30, 14, 13, 14, 31, 15, 47, 27, 23, 48, 80, 13, 14, 15, 13, 16, 13, 62, 80, 44, 14, 80, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09304043070759745, "mean_inference_ms": 0.25750920219757123, "mean_action_processing_ms": 0.03320655653194565, "mean_env_wait_ms": 0.0472992230397964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014994965224969581, "StateBufferConnector_ms": 0.0012726080222207991, "ViewRequirementAgentConnector_ms": 0.02858814645986088}}, "episode_reward_max": 0.9993157045487113, "episode_reward_min": -1.0, "episode_reward_mean": 0.2936770846854134, "episode_len_mean": 32.30327868852459, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8997343369710218, 0.8668963081146394, 0.996792860920527, 0.6309687693255548, 0.8896951402428693, 0.97680728925824, -1.0, 0.5, -1.0, -1.0, 0.5876074112537761, 0.5, -1.0, 0.5587944947301375, -1.0, 0.5259957198956567, 0.5, 0.5286312077887468, 0.5, 0.5, 0.5, 0.5, -1.0, 0.8635317513863745, 0.5, 0.5, 0.5106057099353232, -1.0, 0.8712625497530082, 0.9782484292579299, 0.9833461330795479, -1.0, -1.0, 0.9830723332216402, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.6175654199536881, -1.0, 0.5, -1.0, 0.5, 0.8882725283070669, 0.5, 0.6541110331632228, 0.7111991972494536, 0.646854346342856, 0.5, 0.6462613519661644, 0.5, -1.0, 0.5693814781064077, 0.9195392745113512, 0.889794636534423, 0.6282341445315667, 0.732609970659374, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9815848553813072, 0.8238191471591194, 0.6486661865961754, -1.0, 0.7783055703894413, 0.9725951089942816, -1.0, 0.8467393050402046, 0.8647947311759308, 0.6913125024172669, 0.5809455356816087, 0.9993157045487113, -1.0, 0.7316378864627158, 0.8754473929082247, -1.0, 0.5, 0.7677140043147402, 0.5, 0.8914490602404667, 0.5, 0.5, 0.6774588583554437, 0.973756102202735, 0.8892647232152868, 0.5, 0.5205297137371121, 0.5, 0.5, -1.0, -1.0, 0.5, 0.8215829755966039, 0.5, 0.5, 0.8828855228482243, 0.5518735131277488, -1.0, 0.5, 0.5193551856728931, 0.5, 0.521830140254937, 0.5521040732530398, -1.0, 0.5, 0.9549514829714164, 0.5829598735707633, 0.7229749277761846, 0.6663780347143733, 0.7975787037451003, 0.5, -1.0, 0.8711897228600619, 0.7402942982893485, -1.0, 0.5714956616584059], "episode_lengths": [13, 15, 48, 15, 52, 13, 80, 17, 80, 80, 13, 26, 26, 40, 80, 22, 14, 18, 14, 15, 13, 15, 80, 14, 43, 13, 15, 80, 63, 13, 13, 52, 80, 13, 17, 13, 18, 14, 14, 19, 80, 13, 80, 18, 19, 38, 42, 16, 18, 39, 13, 14, 13, 19, 36, 42, 13, 41, 57, 47, 11, 16, 19, 31, 13, 80, 48, 44, 14, 20, 13, 14, 80, 13, 49, 37, 20, 13, 80, 41, 14, 80, 15, 25, 15, 13, 60, 55, 26, 15, 14, 79, 13, 13, 19, 41, 80, 29, 13, 30, 14, 13, 14, 31, 15, 47, 27, 23, 48, 80, 13, 14, 15, 13, 16, 13, 62, 80, 44, 14, 80, 19]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09304043070759745, "mean_inference_ms": 0.25750920219757123, "mean_action_processing_ms": 0.03320655653194565, "mean_env_wait_ms": 0.0472992230397964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014994965224969581, "StateBufferConnector_ms": 0.0012726080222207991, "ViewRequirementAgentConnector_ms": 0.02858814645986088}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1081.9064962886318, "num_env_steps_trained_throughput_per_sec": 1081.9064962886318, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 3678.576, "sample_time_ms": 1749.148, "load_time_ms": 0.21, "load_throughput": 19028259.045, "learn_time_ms": 1928.198, "learn_throughput": 2074.476, "synch_weights_time_ms": 0.664}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 5539, "training_iteration": 59, "trial_id": "default", "date": "2024-05-23_11-35-57", "timestamp": 1716456957, "time_this_iter_s": 3.7000997066497803, "time_total_s": 215.8629560470581, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 215.8629560470581, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.3, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7338398226486738, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22443548210105427, "policy_loss": 0.0031346759508534146, "vf_loss": 0.22063466670211926, "vf_explained_var": -0.06299515699827543, "kl": 0.006661387105027845, "entropy": 0.666321994860967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 55335.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 0.9816942771969065, "episode_reward_min": -1.0, "episode_reward_mean": 0.29578275594525766, "episode_len_mean": 36.99082568807339, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.8293523829979899, 0.6499008813116753, 0.665082691518174, -1.0, 0.8474535979843281, 0.9481337490060986, 0.5, 0.5045303305467423, 0.611283110272387, -1.0, 0.9125476228133718, 0.9028018731365607, 0.5600664996878775, 0.5286409279920977, 0.7170180919174591, 0.684578008421849, 0.6337839175303153, 0.8026226552241669, 0.5, 0.5, 0.8292888796110774, 0.7486994977450719, 0.5792468229925083, 0.7809637974912711, 0.5222846678364544, -1.0, 0.5, 0.5758690481502972, -1.0, 0.5, 0.5, 0.7909558160922652, 0.8205605628614082, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5521676798200383, 0.5, 0.5, 0.9364220868649143, 0.7019482840222824, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7874167250840146, 0.7260409873609687, 0.7947038661641259, 0.5, -1.0, 0.5, -1.0, -1.0, 0.8446074811144859, -1.0, 0.5, 0.7296405930835177, 0.6264858117841181, 0.6569767185450955, 0.9732348098587056, 0.5, 0.5622793020065849, 0.6117838468305163, 0.8480121887207913, 0.653673886378167, 0.5, 0.9816942771969065, 0.6123985352236518, 0.9525065549977392, 0.9606496374707638, 0.747406866708791, 0.9269689587124316, 0.6943808802006817, 0.5283742493335641, 0.6568444997166678, 0.5, 0.5, -1.0, 0.8517978489561131, -1.0, 0.5011698426599607, 0.55069760109034, -1.0, 0.618155985518196, 0.9270867332548811, 0.6962719269425922, 0.633637313716588, 0.7178279774601306, 0.8735944955411251, 0.5791333872002884, 0.9154280776777256, 0.5764549917509958, 0.5, -1.0, 0.57364179943649, 0.5550929619835789, -1.0, -1.0, 0.5, -1.0, 0.5646343141600313, -1.0, 0.5793594119870342, 0.5, 0.5140515683560442], "episode_lengths": [80, 32, 13, 16, 80, 13, 47, 62, 13, 13, 80, 49, 54, 13, 15, 14, 48, 47, 37, 15, 13, 52, 53, 47, 42, 47, 26, 26, 13, 80, 13, 15, 46, 14, 80, 80, 14, 80, 14, 13, 13, 14, 17, 41, 80, 34, 15, 69, 80, 15, 15, 13, 13, 80, 13, 80, 80, 14, 22, 15, 13, 45, 56, 14, 13, 14, 16, 14, 67, 39, 13, 13, 13, 24, 13, 14, 53, 13, 75, 23, 50, 80, 46, 80, 20, 15, 15, 39, 44, 14, 13, 39, 53, 19, 59, 31, 22, 80, 55, 13, 80, 80, 13, 80, 42, 80, 13, 30, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303464073383233, "mean_inference_ms": 0.25744505941585455, "mean_action_processing_ms": 0.03319855606075478, "mean_env_wait_ms": 0.04728813634234725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015002871872088232, "StateBufferConnector_ms": 0.0013253010741067588, "ViewRequirementAgentConnector_ms": 0.02869137930213858}}, "episode_reward_max": 0.9816942771969065, "episode_reward_min": -1.0, "episode_reward_mean": 0.29578275594525766, "episode_len_mean": 36.99082568807339, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.8293523829979899, 0.6499008813116753, 0.665082691518174, -1.0, 0.8474535979843281, 0.9481337490060986, 0.5, 0.5045303305467423, 0.611283110272387, -1.0, 0.9125476228133718, 0.9028018731365607, 0.5600664996878775, 0.5286409279920977, 0.7170180919174591, 0.684578008421849, 0.6337839175303153, 0.8026226552241669, 0.5, 0.5, 0.8292888796110774, 0.7486994977450719, 0.5792468229925083, 0.7809637974912711, 0.5222846678364544, -1.0, 0.5, 0.5758690481502972, -1.0, 0.5, 0.5, 0.7909558160922652, 0.8205605628614082, -1.0, -1.0, 0.5, -1.0, 0.5, 0.5521676798200383, 0.5, 0.5, 0.9364220868649143, 0.7019482840222824, -1.0, -1.0, 0.5, -1.0, -1.0, 0.7874167250840146, 0.7260409873609687, 0.7947038661641259, 0.5, -1.0, 0.5, -1.0, -1.0, 0.8446074811144859, -1.0, 0.5, 0.7296405930835177, 0.6264858117841181, 0.6569767185450955, 0.9732348098587056, 0.5, 0.5622793020065849, 0.6117838468305163, 0.8480121887207913, 0.653673886378167, 0.5, 0.9816942771969065, 0.6123985352236518, 0.9525065549977392, 0.9606496374707638, 0.747406866708791, 0.9269689587124316, 0.6943808802006817, 0.5283742493335641, 0.6568444997166678, 0.5, 0.5, -1.0, 0.8517978489561131, -1.0, 0.5011698426599607, 0.55069760109034, -1.0, 0.618155985518196, 0.9270867332548811, 0.6962719269425922, 0.633637313716588, 0.7178279774601306, 0.8735944955411251, 0.5791333872002884, 0.9154280776777256, 0.5764549917509958, 0.5, -1.0, 0.57364179943649, 0.5550929619835789, -1.0, -1.0, 0.5, -1.0, 0.5646343141600313, -1.0, 0.5793594119870342, 0.5, 0.5140515683560442], "episode_lengths": [80, 32, 13, 16, 80, 13, 47, 62, 13, 13, 80, 49, 54, 13, 15, 14, 48, 47, 37, 15, 13, 52, 53, 47, 42, 47, 26, 26, 13, 80, 13, 15, 46, 14, 80, 80, 14, 80, 14, 13, 13, 14, 17, 41, 80, 34, 15, 69, 80, 15, 15, 13, 13, 80, 13, 80, 80, 14, 22, 15, 13, 45, 56, 14, 13, 14, 16, 14, 67, 39, 13, 13, 13, 24, 13, 14, 53, 13, 75, 23, 50, 80, 46, 80, 20, 15, 15, 39, 44, 14, 13, 39, 53, 19, 59, 31, 22, 80, 55, 13, 80, 80, 13, 80, 42, 80, 13, 30, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303464073383233, "mean_inference_ms": 0.25744505941585455, "mean_action_processing_ms": 0.03319855606075478, "mean_env_wait_ms": 0.04728813634234725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015002871872088232, "StateBufferConnector_ms": 0.0013253010741067588, "ViewRequirementAgentConnector_ms": 0.02869137930213858}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1105.840936152795, "num_env_steps_trained_throughput_per_sec": 1105.840936152795, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 3666.144, "sample_time_ms": 1746.661, "load_time_ms": 0.21, "load_throughput": 19013164.098, "learn_time_ms": 1918.27, "learn_throughput": 2085.212, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 5648, "training_iteration": 60, "trial_id": "default", "date": "2024-05-23_11-36-01", "timestamp": 1716456961, "time_this_iter_s": 3.620014190673828, "time_total_s": 219.48297023773193, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 219.48297023773193, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 56.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.537090257611326, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19584864310679898, "policy_loss": -0.009319566373503016, "vf_loss": 0.20443000074836515, "vf_explained_var": 0.30864945791100945, "kl": 0.0073820770735227624, "entropy": 0.6466056572173231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 56265.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 0.9718427498226493, "episode_reward_min": -1.0, "episode_reward_mean": 0.33255058894107675, "episode_len_mean": 33.475, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5796117233658877, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8624360362174466, 0.8615563764476899, 0.5, 0.8924605886677746, 0.6193550139850456, 0.815163816955018, 0.5, 0.5, -1.0, 0.912977220901379, 0.7997611997710334, -1.0, 0.8732609182063029, 0.5, 0.5, -1.0, 0.5, 0.9390728467090187, -1.0, 0.6534565996597113, 0.9477590470363176, -1.0, 0.5, 0.5, 0.7675488929872365, 0.7039397335242759, -1.0, 0.8368224879832185, 0.6805783908662603, 0.8613367418227935, 0.5, 0.5, -1.0, 0.6381081287736032, 0.5, 0.7152859618705064, 0.9553481397461774, 0.5, 0.9031700552449369, 0.5, -1.0, 0.7591673398481439, 0.5, -1.0, 0.6478046972038958, 0.5, 0.5, 0.7414225005966293, 0.5, 0.5, -1.0, 0.5, 0.686716348479504, 0.9387399697203225, 0.6499056089424421, 0.5366500100474276, 0.5, -1.0, 0.5, 0.7673835123167794, 0.7041660261932957, -1.0, 0.6863021423248272, 0.6579850058130066, 0.775159918906507, 0.5479150517517279, 0.5397145041551112, -1.0, 0.5, -1.0, 0.9469829760120536, 0.7448232253706719, 0.5059843320355509, 0.9527744749682163, -1.0, 0.9006368091565812, 0.9551696087345504, 0.7031616418470814, -1.0, 0.5, 0.8144364546070231, 0.5448895578045129, 0.5, -1.0, -1.0, 0.5, -1.0, 0.7560735945806036, 0.5959252488425695, 0.6138562337723288, 0.566524685955494, 0.5, 0.9515262893717984, 0.845376832528385, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.8091865375275195, 0.5, 0.8403658929443308, 0.5, 0.6970464775223822, 0.9718427498226493, 0.5, 0.5, -1.0, 0.7264639336691794, -1.0, 0.5049805588144748], "episode_lengths": [40, 16, 73, 15, 80, 16, 13, 32, 15, 14, 14, 48, 77, 14, 13, 14, 80, 46, 13, 80, 33, 14, 19, 80, 39, 13, 14, 60, 13, 80, 60, 13, 48, 13, 80, 15, 38, 44, 27, 16, 80, 14, 14, 16, 48, 14, 13, 26, 80, 15, 56, 80, 45, 14, 35, 15, 13, 14, 75, 15, 14, 13, 30, 13, 13, 15, 15, 14, 15, 22, 13, 15, 79, 59, 15, 80, 13, 80, 14, 48, 17, 42, 80, 45, 48, 14, 80, 15, 14, 73, 14, 80, 80, 15, 19, 48, 45, 13, 58, 14, 13, 14, 15, 13, 62, 35, 15, 16, 14, 15, 15, 15, 13, 14, 15, 15, 80, 37, 80, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303882451026774, "mean_inference_ms": 0.257383262970751, "mean_action_processing_ms": 0.033190304910326936, "mean_env_wait_ms": 0.047277050629675806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014452139536539714, "StateBufferConnector_ms": 0.0012993812561035156, "ViewRequirementAgentConnector_ms": 0.028576056162516277}}, "episode_reward_max": 0.9718427498226493, "episode_reward_min": -1.0, "episode_reward_mean": 0.33255058894107675, "episode_len_mean": 33.475, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5796117233658877, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8624360362174466, 0.8615563764476899, 0.5, 0.8924605886677746, 0.6193550139850456, 0.815163816955018, 0.5, 0.5, -1.0, 0.912977220901379, 0.7997611997710334, -1.0, 0.8732609182063029, 0.5, 0.5, -1.0, 0.5, 0.9390728467090187, -1.0, 0.6534565996597113, 0.9477590470363176, -1.0, 0.5, 0.5, 0.7675488929872365, 0.7039397335242759, -1.0, 0.8368224879832185, 0.6805783908662603, 0.8613367418227935, 0.5, 0.5, -1.0, 0.6381081287736032, 0.5, 0.7152859618705064, 0.9553481397461774, 0.5, 0.9031700552449369, 0.5, -1.0, 0.7591673398481439, 0.5, -1.0, 0.6478046972038958, 0.5, 0.5, 0.7414225005966293, 0.5, 0.5, -1.0, 0.5, 0.686716348479504, 0.9387399697203225, 0.6499056089424421, 0.5366500100474276, 0.5, -1.0, 0.5, 0.7673835123167794, 0.7041660261932957, -1.0, 0.6863021423248272, 0.6579850058130066, 0.775159918906507, 0.5479150517517279, 0.5397145041551112, -1.0, 0.5, -1.0, 0.9469829760120536, 0.7448232253706719, 0.5059843320355509, 0.9527744749682163, -1.0, 0.9006368091565812, 0.9551696087345504, 0.7031616418470814, -1.0, 0.5, 0.8144364546070231, 0.5448895578045129, 0.5, -1.0, -1.0, 0.5, -1.0, 0.7560735945806036, 0.5959252488425695, 0.6138562337723288, 0.566524685955494, 0.5, 0.9515262893717984, 0.845376832528385, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.8091865375275195, 0.5, 0.8403658929443308, 0.5, 0.6970464775223822, 0.9718427498226493, 0.5, 0.5, -1.0, 0.7264639336691794, -1.0, 0.5049805588144748], "episode_lengths": [40, 16, 73, 15, 80, 16, 13, 32, 15, 14, 14, 48, 77, 14, 13, 14, 80, 46, 13, 80, 33, 14, 19, 80, 39, 13, 14, 60, 13, 80, 60, 13, 48, 13, 80, 15, 38, 44, 27, 16, 80, 14, 14, 16, 48, 14, 13, 26, 80, 15, 56, 80, 45, 14, 35, 15, 13, 14, 75, 15, 14, 13, 30, 13, 13, 15, 15, 14, 15, 22, 13, 15, 79, 59, 15, 80, 13, 80, 14, 48, 17, 42, 80, 45, 48, 14, 80, 15, 14, 73, 14, 80, 80, 15, 19, 48, 45, 13, 58, 14, 13, 14, 15, 13, 62, 35, 15, 16, 14, 15, 15, 15, 13, 14, 15, 15, 80, 37, 80, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303882451026774, "mean_inference_ms": 0.257383262970751, "mean_action_processing_ms": 0.033190304910326936, "mean_env_wait_ms": 0.047277050629675806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014452139536539714, "StateBufferConnector_ms": 0.0012993812561035156, "ViewRequirementAgentConnector_ms": 0.028576056162516277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1104.684587211345, "num_env_steps_trained_throughput_per_sec": 1104.684587211345, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 3662.842, "sample_time_ms": 1743.641, "load_time_ms": 0.211, "load_throughput": 18963734.599, "learn_time_ms": 1917.992, "learn_throughput": 2085.514, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 5768, "training_iteration": 61, "trial_id": "default", "date": "2024-05-23_11-36-04", "timestamp": 1716456964, "time_this_iter_s": 3.623798131942749, "time_total_s": 223.10676836967468, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 223.10676836967468, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 18.140000000000004, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5363506442116153, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26824131966618603, "policy_loss": -0.007402538420051657, "vf_loss": 0.27489188278234133, "vf_explained_var": 0.07228289105558908, "kl": 0.007519737940660976, "entropy": 0.6496048422269923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 57195.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 0.9976309638249019, "episode_reward_min": -1.0, "episode_reward_mean": 0.306012622386467, "episode_len_mean": 35.078947368421055, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.8648702056069666, 0.5, 0.8577140822164921, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.8465799410240102, 0.8705092779109924, 0.7903791401387279, 0.5, 0.59192963216356, 0.534867144617718, 0.6677611437884083, 0.9284572396927531, -1.0, 0.856252420890293, 0.8771559526524847, 0.6783512356881167, 0.8922445756229925, 0.5, 0.9296424665756811, 0.5, -1.0, 0.5955480865663343, 0.909196159219326, 0.7060358987217231, 0.5, 0.8794145167974119, 0.757405962919726, -1.0, -1.0, 0.9829073952750982, 0.5, 0.5, 0.6089841974587207, 0.8898183575448547, -1.0, -1.0, 0.8859952778911709, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8504839748394015, 0.8161508704136304, 0.5, -1.0, 0.9903961757060903, 0.9601739247374108, 0.5441986784625633, -1.0, 0.5, 0.5, 0.9452703576314075, 0.9976309638249019, -1.0, 0.5269466656437011, -1.0, 0.5, -1.0, -1.0, 0.5, 0.9344594545943268, 0.8938453024937361, 0.5, 0.5, 0.8404660974320046, 0.5, 0.7433520000654862, 0.6531898321674704, 0.7754685504256094, 0.5, 0.6646616123420406, -1.0, 0.6325911217675004, 0.5624763708818447, 0.8336883338185267, 0.764142697834946, 0.9340844564027678, -1.0, 0.5, 0.8735134716243211, 0.8751793604752974, 0.5, 0.7644481972287283, 0.6439953364243747, 0.5102963335049056, 0.5, 0.9424552080732675, -1.0, 0.5, -1.0, 0.5, 0.5, 0.8124757095785325, 0.5, -1.0, 0.8480852781363377, -1.0, 0.6797728880469824, 0.7293511733400412, 0.9335707967395964, 0.9186702423219333, 0.9740575135209942, -1.0, -1.0, -1.0, 0.6138696905729927], "episode_lengths": [80, 15, 24, 13, 20, 19, 36, 32, 14, 17, 13, 56, 46, 48, 14, 15, 13, 13, 80, 53, 13, 42, 13, 34, 13, 44, 80, 43, 13, 45, 13, 13, 53, 29, 73, 53, 73, 32, 14, 56, 70, 80, 13, 20, 14, 51, 35, 36, 28, 13, 50, 24, 80, 47, 45, 13, 20, 33, 21, 13, 16, 80, 67, 80, 43, 37, 80, 18, 13, 31, 16, 14, 50, 14, 16, 13, 35, 13, 20, 80, 44, 14, 13, 73, 13, 16, 17, 13, 78, 13, 14, 14, 13, 39, 13, 32, 21, 24, 14, 14, 56, 52, 80, 28, 80, 19, 20, 41, 16, 13, 80, 80, 80, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303706862681424, "mean_inference_ms": 0.2573208460097796, "mean_action_processing_ms": 0.03318332262486911, "mean_env_wait_ms": 0.04726675609317119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001507056386847245, "StateBufferConnector_ms": 0.0012711474769993832, "ViewRequirementAgentConnector_ms": 0.028615876248008328}}, "episode_reward_max": 0.9976309638249019, "episode_reward_min": -1.0, "episode_reward_mean": 0.306012622386467, "episode_len_mean": 35.078947368421055, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.8648702056069666, 0.5, 0.8577140822164921, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.8465799410240102, 0.8705092779109924, 0.7903791401387279, 0.5, 0.59192963216356, 0.534867144617718, 0.6677611437884083, 0.9284572396927531, -1.0, 0.856252420890293, 0.8771559526524847, 0.6783512356881167, 0.8922445756229925, 0.5, 0.9296424665756811, 0.5, -1.0, 0.5955480865663343, 0.909196159219326, 0.7060358987217231, 0.5, 0.8794145167974119, 0.757405962919726, -1.0, -1.0, 0.9829073952750982, 0.5, 0.5, 0.6089841974587207, 0.8898183575448547, -1.0, -1.0, 0.8859952778911709, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5, 0.8504839748394015, 0.8161508704136304, 0.5, -1.0, 0.9903961757060903, 0.9601739247374108, 0.5441986784625633, -1.0, 0.5, 0.5, 0.9452703576314075, 0.9976309638249019, -1.0, 0.5269466656437011, -1.0, 0.5, -1.0, -1.0, 0.5, 0.9344594545943268, 0.8938453024937361, 0.5, 0.5, 0.8404660974320046, 0.5, 0.7433520000654862, 0.6531898321674704, 0.7754685504256094, 0.5, 0.6646616123420406, -1.0, 0.6325911217675004, 0.5624763708818447, 0.8336883338185267, 0.764142697834946, 0.9340844564027678, -1.0, 0.5, 0.8735134716243211, 0.8751793604752974, 0.5, 0.7644481972287283, 0.6439953364243747, 0.5102963335049056, 0.5, 0.9424552080732675, -1.0, 0.5, -1.0, 0.5, 0.5, 0.8124757095785325, 0.5, -1.0, 0.8480852781363377, -1.0, 0.6797728880469824, 0.7293511733400412, 0.9335707967395964, 0.9186702423219333, 0.9740575135209942, -1.0, -1.0, -1.0, 0.6138696905729927], "episode_lengths": [80, 15, 24, 13, 20, 19, 36, 32, 14, 17, 13, 56, 46, 48, 14, 15, 13, 13, 80, 53, 13, 42, 13, 34, 13, 44, 80, 43, 13, 45, 13, 13, 53, 29, 73, 53, 73, 32, 14, 56, 70, 80, 13, 20, 14, 51, 35, 36, 28, 13, 50, 24, 80, 47, 45, 13, 20, 33, 21, 13, 16, 80, 67, 80, 43, 37, 80, 18, 13, 31, 16, 14, 50, 14, 16, 13, 35, 13, 20, 80, 44, 14, 13, 73, 13, 16, 17, 13, 78, 13, 14, 14, 13, 39, 13, 32, 21, 24, 14, 14, 56, 52, 80, 28, 80, 19, 20, 41, 16, 13, 80, 80, 80, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303706862681424, "mean_inference_ms": 0.2573208460097796, "mean_action_processing_ms": 0.03318332262486911, "mean_env_wait_ms": 0.04726675609317119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001507056386847245, "StateBufferConnector_ms": 0.0012711474769993832, "ViewRequirementAgentConnector_ms": 0.028615876248008328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1103.3819467544995, "num_env_steps_trained_throughput_per_sec": 1103.3819467544995, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 3659.073, "sample_time_ms": 1741.53, "load_time_ms": 0.21, "load_throughput": 19019630.427, "learn_time_ms": 1916.336, "learn_throughput": 2087.317, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 5882, "training_iteration": 62, "trial_id": "default", "date": "2024-05-23_11-36-08", "timestamp": 1716456968, "time_this_iter_s": 3.6282129287719727, "time_total_s": 226.73498129844666, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 226.73498129844666, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 56.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.89004473923355, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24395753254172622, "policy_loss": -0.0036120192818744207, "vf_loss": 0.24705538912325778, "vf_explained_var": 0.003220261489191363, "kl": 0.0051416260299454375, "entropy": 0.6588753070882571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 58125.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 0.9991806692483299, "episode_reward_min": -1.0, "episode_reward_mean": 0.3740823647926244, "episode_len_mean": 32.10569105691057, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.6956373337691893, 0.9681329333704288, 0.5, 0.6000769098188674, 0.5, 0.6603464652927588, 0.9991806692483299, 0.6864544325766959, 0.6461813826835419, 0.6517765662649863, 0.8447361353870533, -1.0, 0.9351249968238043, 0.8054118865666309, 0.8983156140187848, -1.0, -1.0, 0.5, 0.7852131257419951, 0.5, 0.8991616443332096, 0.7132331956050402, 0.6354055176190296, 0.5732086489372414, 0.9879627579114794, 0.7785652746270586, 0.5, 0.5, 0.5, 0.8508807574025675, 0.8465049961406357, 0.5, -1.0, 0.7487826100812531, 0.5, -1.0, 0.5, -1.0, 0.7489410376211472, 0.7961891597198126, 0.8051751735051365, 0.7632796955370544, 0.5, 0.5, 0.6075425598776405, 0.5, 0.6264787075532119, 0.8868344646334649, 0.8555716021389709, 0.5099166939491522, 0.7084092863869245, 0.8252480698277185, 0.5, 0.9379686008516306, -1.0, 0.6281735714799939, -1.0, -1.0, 0.8672562332571045, 0.5, -1.0, 0.5, 0.5, 0.5158790898670114, -1.0, 0.6975893020031374, -1.0, 0.555959211140669, 0.5496512706177834, 0.8537882558411336, -1.0, 0.6667340379967945, 0.6516649510974881, 0.5, -1.0, 0.8176854435225276, 0.5, 0.5, -1.0, 0.5, 0.6587859188060379, -1.0, 0.896278293706801, 0.8475133453576674, 0.5792872805699281, -1.0, 0.9588675060068179, 0.5, -1.0, 0.5, 0.5386166608301832, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9310129096766097, 0.5, 0.5, 0.90215469312525, 0.955409770921927, 0.8535335251737297, 0.5211271197806249, 0.8150654942125202, 0.9050018672345829, 0.5, 0.5, 0.7360151058407203, -1.0, 0.867516798750606, 0.6869217927296187, 0.5, 0.9355993000325838, 0.6525622610643204, 0.9196528106655832, 0.7744154021307538, 0.9905627402298379], "episode_lengths": [23, 13, 14, 14, 13, 13, 44, 14, 13, 32, 46, 14, 14, 61, 13, 15, 80, 41, 14, 38, 80, 42, 74, 13, 60, 42, 13, 15, 15, 75, 54, 13, 15, 13, 14, 13, 15, 80, 14, 20, 80, 16, 80, 14, 14, 74, 15, 13, 14, 15, 33, 14, 13, 45, 42, 16, 38, 21, 36, 22, 57, 28, 15, 15, 15, 80, 39, 14, 32, 16, 45, 80, 14, 14, 13, 80, 38, 13, 22, 80, 13, 14, 15, 80, 14, 13, 80, 15, 48, 16, 80, 47, 15, 80, 52, 15, 48, 13, 23, 80, 14, 17, 13, 13, 14, 48, 14, 16, 52, 73, 13, 13, 14, 13, 80, 45, 13, 57, 75, 13, 13, 18, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09305086090110781, "mean_inference_ms": 0.25726708149498506, "mean_action_processing_ms": 0.0331739725179846, "mean_env_wait_ms": 0.04725792841862287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001531887829788332, "StateBufferConnector_ms": 0.0012742794626127414, "ViewRequirementAgentConnector_ms": 0.028642600144797224}}, "episode_reward_max": 0.9991806692483299, "episode_reward_min": -1.0, "episode_reward_mean": 0.3740823647926244, "episode_len_mean": 32.10569105691057, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.6956373337691893, 0.9681329333704288, 0.5, 0.6000769098188674, 0.5, 0.6603464652927588, 0.9991806692483299, 0.6864544325766959, 0.6461813826835419, 0.6517765662649863, 0.8447361353870533, -1.0, 0.9351249968238043, 0.8054118865666309, 0.8983156140187848, -1.0, -1.0, 0.5, 0.7852131257419951, 0.5, 0.8991616443332096, 0.7132331956050402, 0.6354055176190296, 0.5732086489372414, 0.9879627579114794, 0.7785652746270586, 0.5, 0.5, 0.5, 0.8508807574025675, 0.8465049961406357, 0.5, -1.0, 0.7487826100812531, 0.5, -1.0, 0.5, -1.0, 0.7489410376211472, 0.7961891597198126, 0.8051751735051365, 0.7632796955370544, 0.5, 0.5, 0.6075425598776405, 0.5, 0.6264787075532119, 0.8868344646334649, 0.8555716021389709, 0.5099166939491522, 0.7084092863869245, 0.8252480698277185, 0.5, 0.9379686008516306, -1.0, 0.6281735714799939, -1.0, -1.0, 0.8672562332571045, 0.5, -1.0, 0.5, 0.5, 0.5158790898670114, -1.0, 0.6975893020031374, -1.0, 0.555959211140669, 0.5496512706177834, 0.8537882558411336, -1.0, 0.6667340379967945, 0.6516649510974881, 0.5, -1.0, 0.8176854435225276, 0.5, 0.5, -1.0, 0.5, 0.6587859188060379, -1.0, 0.896278293706801, 0.8475133453576674, 0.5792872805699281, -1.0, 0.9588675060068179, 0.5, -1.0, 0.5, 0.5386166608301832, 0.5, 0.5, -1.0, -1.0, 0.5, -1.0, 0.9310129096766097, 0.5, 0.5, 0.90215469312525, 0.955409770921927, 0.8535335251737297, 0.5211271197806249, 0.8150654942125202, 0.9050018672345829, 0.5, 0.5, 0.7360151058407203, -1.0, 0.867516798750606, 0.6869217927296187, 0.5, 0.9355993000325838, 0.6525622610643204, 0.9196528106655832, 0.7744154021307538, 0.9905627402298379], "episode_lengths": [23, 13, 14, 14, 13, 13, 44, 14, 13, 32, 46, 14, 14, 61, 13, 15, 80, 41, 14, 38, 80, 42, 74, 13, 60, 42, 13, 15, 15, 75, 54, 13, 15, 13, 14, 13, 15, 80, 14, 20, 80, 16, 80, 14, 14, 74, 15, 13, 14, 15, 33, 14, 13, 45, 42, 16, 38, 21, 36, 22, 57, 28, 15, 15, 15, 80, 39, 14, 32, 16, 45, 80, 14, 14, 13, 80, 38, 13, 22, 80, 13, 14, 15, 80, 14, 13, 80, 15, 48, 16, 80, 47, 15, 80, 52, 15, 48, 13, 23, 80, 14, 17, 13, 13, 14, 48, 14, 16, 52, 73, 13, 13, 14, 13, 80, 45, 13, 57, 75, 13, 13, 18, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09305086090110781, "mean_inference_ms": 0.25726708149498506, "mean_action_processing_ms": 0.0331739725179846, "mean_env_wait_ms": 0.04725792841862287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001531887829788332, "StateBufferConnector_ms": 0.0012742794626127414, "ViewRequirementAgentConnector_ms": 0.028642600144797224}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.3550816292068, "num_env_steps_trained_throughput_per_sec": 1102.3550816292068, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3652.47, "sample_time_ms": 1738.55, "load_time_ms": 0.208, "load_throughput": 19259804.844, "learn_time_ms": 1912.732, "learn_throughput": 2091.25, "synch_weights_time_ms": 0.644}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 6005, "training_iteration": 63, "trial_id": "default", "date": "2024-05-23_11-36-12", "timestamp": 1716456972, "time_this_iter_s": 3.631527900695801, "time_total_s": 230.36650919914246, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 230.36650919914246, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 15.266666666666667, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3664882210313634, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22369077113139071, "policy_loss": -0.008200479711415947, "vf_loss": 0.23126567574518342, "vf_explained_var": 0.2145765414161067, "kl": 0.006255756601766078, "entropy": 0.64551316179255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59055.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 0.9857735309268716, "episode_reward_min": -1.0, "episode_reward_mean": 0.19697491722822488, "episode_len_mean": 31.96062992125984, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.8607913999762516, 0.5, -1.0, 0.6146773320975054, 0.5, 0.7055141099916975, 0.9696104045617313, 0.7225440646255824, 0.5, -1.0, 0.5, 0.7676577378630771, 0.7070850894225974, 0.5, 0.8143400042786965, 0.5, 0.8674593977222482, 0.7160303552102285, 0.8315967390252372, 0.5352155128358898, 0.5, 0.6658157606572153, 0.5, 0.8804977619468629, -1.0, 0.7611508384472384, 0.5, 0.5, 0.6476247432542945, 0.6895125308031336, 0.5809309614236571, 0.8884272560127194, 0.5625158246756751, 0.717410732936169, 0.5, 0.5, 0.9521227329339733, 0.7335978655131251, 0.7229559053980574, 0.9582382472521443, -1.0, 0.6243027429621708, 0.5, -1.0, 0.5275747886344789, -1.0, 0.5, 0.5, 0.8549656127917111, -1.0, 0.5, 0.5, 0.9362776841442566, 0.87966590206379, -1.0, 0.5908313695145038, 0.9857735309268716, -1.0, 0.5740195512181218, 0.6476336623804451, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.681696557746208, -1.0, 0.5, -1.0, 0.7030184183886488, 0.6733170755023341, -1.0, -1.0, 0.5, -1.0, 0.7279310049693379, -1.0, -1.0, 0.881669736278297, -1.0, 0.5092086637146063, 0.9455755703500189, -1.0, -1.0, 0.8154624054612798, 0.8596587409121993, 0.738507696217212, -1.0, 0.7857823598695457, 0.5, -1.0, -1.0, 0.6125544518018409, 0.5, 0.5, 0.5967281119517687, -1.0, 0.6981912431890331, 0.5, 0.7222049973140487, 0.8359049311399354, 0.5, 0.6108265242337356, -1.0, -1.0, 0.9659812811070644, -1.0, 0.5, -1.0, -1.0, 0.8305628704392943, -1.0, -1.0, 0.5, -1.0, 0.5158153602227404, 0.5, 0.7408035375800854, 0.5981635391704279, 0.9718812569235408, -1.0, -1.0], "episode_lengths": [80, 20, 13, 80, 13, 13, 43, 38, 14, 36, 18, 13, 14, 13, 17, 13, 13, 13, 13, 13, 66, 15, 14, 17, 13, 80, 13, 40, 28, 13, 14, 28, 48, 13, 41, 16, 14, 13, 13, 13, 14, 20, 41, 14, 20, 54, 80, 66, 15, 13, 18, 50, 14, 14, 41, 80, 14, 13, 16, 13, 13, 13, 14, 49, 80, 13, 16, 28, 29, 14, 14, 41, 16, 80, 53, 46, 80, 80, 26, 80, 13, 80, 80, 13, 80, 13, 13, 80, 17, 42, 13, 13, 79, 16, 14, 17, 18, 14, 14, 29, 13, 16, 13, 53, 13, 17, 18, 15, 80, 11, 15, 74, 13, 80, 80, 55, 16, 80, 13, 28, 36, 28, 13, 13, 51, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09306515255613099, "mean_inference_ms": 0.25720003640731653, "mean_action_processing_ms": 0.03316484940847332, "mean_env_wait_ms": 0.04724922107756422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015148027675358328, "StateBufferConnector_ms": 0.0012838934350201464, "ViewRequirementAgentConnector_ms": 0.028557664766086368}}, "episode_reward_max": 0.9857735309268716, "episode_reward_min": -1.0, "episode_reward_mean": 0.19697491722822488, "episode_len_mean": 31.96062992125984, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.8607913999762516, 0.5, -1.0, 0.6146773320975054, 0.5, 0.7055141099916975, 0.9696104045617313, 0.7225440646255824, 0.5, -1.0, 0.5, 0.7676577378630771, 0.7070850894225974, 0.5, 0.8143400042786965, 0.5, 0.8674593977222482, 0.7160303552102285, 0.8315967390252372, 0.5352155128358898, 0.5, 0.6658157606572153, 0.5, 0.8804977619468629, -1.0, 0.7611508384472384, 0.5, 0.5, 0.6476247432542945, 0.6895125308031336, 0.5809309614236571, 0.8884272560127194, 0.5625158246756751, 0.717410732936169, 0.5, 0.5, 0.9521227329339733, 0.7335978655131251, 0.7229559053980574, 0.9582382472521443, -1.0, 0.6243027429621708, 0.5, -1.0, 0.5275747886344789, -1.0, 0.5, 0.5, 0.8549656127917111, -1.0, 0.5, 0.5, 0.9362776841442566, 0.87966590206379, -1.0, 0.5908313695145038, 0.9857735309268716, -1.0, 0.5740195512181218, 0.6476336623804451, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.681696557746208, -1.0, 0.5, -1.0, 0.7030184183886488, 0.6733170755023341, -1.0, -1.0, 0.5, -1.0, 0.7279310049693379, -1.0, -1.0, 0.881669736278297, -1.0, 0.5092086637146063, 0.9455755703500189, -1.0, -1.0, 0.8154624054612798, 0.8596587409121993, 0.738507696217212, -1.0, 0.7857823598695457, 0.5, -1.0, -1.0, 0.6125544518018409, 0.5, 0.5, 0.5967281119517687, -1.0, 0.6981912431890331, 0.5, 0.7222049973140487, 0.8359049311399354, 0.5, 0.6108265242337356, -1.0, -1.0, 0.9659812811070644, -1.0, 0.5, -1.0, -1.0, 0.8305628704392943, -1.0, -1.0, 0.5, -1.0, 0.5158153602227404, 0.5, 0.7408035375800854, 0.5981635391704279, 0.9718812569235408, -1.0, -1.0], "episode_lengths": [80, 20, 13, 80, 13, 13, 43, 38, 14, 36, 18, 13, 14, 13, 17, 13, 13, 13, 13, 13, 66, 15, 14, 17, 13, 80, 13, 40, 28, 13, 14, 28, 48, 13, 41, 16, 14, 13, 13, 13, 14, 20, 41, 14, 20, 54, 80, 66, 15, 13, 18, 50, 14, 14, 41, 80, 14, 13, 16, 13, 13, 13, 14, 49, 80, 13, 16, 28, 29, 14, 14, 41, 16, 80, 53, 46, 80, 80, 26, 80, 13, 80, 80, 13, 80, 13, 13, 80, 17, 42, 13, 13, 79, 16, 14, 17, 18, 14, 14, 29, 13, 16, 13, 53, 13, 17, 18, 15, 80, 11, 15, 74, 13, 80, 80, 55, 16, 80, 13, 28, 36, 28, 13, 13, 51, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09306515255613099, "mean_inference_ms": 0.25720003640731653, "mean_action_processing_ms": 0.03316484940847332, "mean_env_wait_ms": 0.04724922107756422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015148027675358328, "StateBufferConnector_ms": 0.0012838934350201464, "ViewRequirementAgentConnector_ms": 0.028557664766086368}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1077.0277062885616, "num_env_steps_trained_throughput_per_sec": 1077.0277062885616, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 3656.915, "sample_time_ms": 1734.565, "load_time_ms": 0.207, "load_throughput": 19277508.905, "learn_time_ms": 1921.153, "learn_throughput": 2082.082, "synch_weights_time_ms": 0.648}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 6132, "training_iteration": 64, "trial_id": "default", "date": "2024-05-23_11-36-15", "timestamp": 1716456975, "time_this_iter_s": 3.716989278793335, "time_total_s": 234.0834984779358, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 234.0834984779358, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.095796973666837, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21473885406089085, "policy_loss": -0.00792228465759626, "vf_loss": 0.22221110313930498, "vf_explained_var": 0.12890911762432386, "kl": 0.004500343220580331, "entropy": 0.6360405978336129, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 59985.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 0.9765071387572833, "episode_reward_min": -1.0, "episode_reward_mean": 0.28946061246485205, "episode_len_mean": 31.448, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, 0.62355652276214, 0.5, 0.908421327974387, -1.0, 0.9229299451820054, 0.7172571953587775, 0.5, 0.5066400273598344, 0.8281103218662607, 0.6158610776647198, 0.5, 0.5, 0.7217106087704068, 0.5, -1.0, 0.7132092972939584, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.706011531758094, 0.9765071387572833, -1.0, 0.508390758147365, -1.0, 0.6878810831922677, 0.5, -1.0, -1.0, 0.5, 0.8073952403190805, 0.6985140268283013, 0.5, -1.0, 0.9129566670860727, -1.0, -1.0, 0.9000279644133368, 0.6927656305256134, -1.0, -1.0, -1.0, 0.7162505927071502, 0.5, 0.744948210737708, -1.0, 0.648318006956506, 0.5, 0.5, 0.5, 0.7059263064930108, 0.5, 0.9475606054546525, 0.5, 0.7628296704880194, 0.7046740791722278, 0.8018062558897239, 0.8179654081640768, 0.7427660163033485, 0.9320673886417415, -1.0, 0.6052207958267206, 0.8123891916510501, 0.7410025546838641, 0.8735107137672617, -1.0, 0.5, 0.8834517394143457, 0.6504657072286695, 0.8988314002874453, 0.8303485658837306, 0.7127252886911896, 0.5, -1.0, 0.5, 0.5862663883899748, -1.0, 0.7857421097214039, 0.6816463048371957, 0.715387139751505, -1.0, 0.8703784884966521, 0.8754761159254738, 0.5, 0.7848989505492386, 0.7060019230905161, 0.5, -1.0, -1.0, 0.5, 0.8852557441072338, 0.7111336740185555, 0.5, 0.5, 0.5158379613642079, 0.8048069503049777, 0.7698751460027453, 0.5, 0.7081010908370371, 0.7186559775903145, 0.5, -1.0, 0.5, 0.5, 0.7234328183144327, 0.8585118111671415, 0.8595545064781371, 0.9268047506175761, 0.5, 0.8929221535180331, 0.8206816893218052, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5], "episode_lengths": [14, 55, 13, 13, 13, 13, 16, 13, 13, 13, 18, 46, 16, 34, 14, 36, 15, 25, 13, 18, 14, 80, 80, 80, 31, 13, 13, 80, 14, 80, 13, 18, 80, 18, 13, 57, 13, 13, 80, 59, 80, 80, 32, 14, 80, 80, 80, 60, 14, 21, 23, 15, 15, 14, 16, 13, 13, 44, 40, 14, 13, 13, 13, 49, 45, 80, 13, 13, 48, 14, 64, 38, 13, 45, 13, 45, 14, 14, 80, 13, 15, 18, 13, 14, 46, 80, 58, 16, 13, 15, 14, 49, 16, 80, 14, 44, 13, 13, 13, 29, 13, 40, 13, 13, 14, 13, 11, 42, 14, 56, 14, 13, 13, 17, 48, 13, 38, 34, 68, 80, 14, 13, 80, 20, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09307420585566858, "mean_inference_ms": 0.2571417959553797, "mean_action_processing_ms": 0.0331563270388061, "mean_env_wait_ms": 0.04724042402716833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015073776245117187, "StateBufferConnector_ms": 0.0012699127197265624, "ViewRequirementAgentConnector_ms": 0.028571510314941408}}, "episode_reward_max": 0.9765071387572833, "episode_reward_min": -1.0, "episode_reward_mean": 0.28946061246485205, "episode_len_mean": 31.448, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.5, 0.62355652276214, 0.5, 0.908421327974387, -1.0, 0.9229299451820054, 0.7172571953587775, 0.5, 0.5066400273598344, 0.8281103218662607, 0.6158610776647198, 0.5, 0.5, 0.7217106087704068, 0.5, -1.0, 0.7132092972939584, 0.5, 0.5, -1.0, -1.0, -1.0, 0.5, 0.706011531758094, 0.9765071387572833, -1.0, 0.508390758147365, -1.0, 0.6878810831922677, 0.5, -1.0, -1.0, 0.5, 0.8073952403190805, 0.6985140268283013, 0.5, -1.0, 0.9129566670860727, -1.0, -1.0, 0.9000279644133368, 0.6927656305256134, -1.0, -1.0, -1.0, 0.7162505927071502, 0.5, 0.744948210737708, -1.0, 0.648318006956506, 0.5, 0.5, 0.5, 0.7059263064930108, 0.5, 0.9475606054546525, 0.5, 0.7628296704880194, 0.7046740791722278, 0.8018062558897239, 0.8179654081640768, 0.7427660163033485, 0.9320673886417415, -1.0, 0.6052207958267206, 0.8123891916510501, 0.7410025546838641, 0.8735107137672617, -1.0, 0.5, 0.8834517394143457, 0.6504657072286695, 0.8988314002874453, 0.8303485658837306, 0.7127252886911896, 0.5, -1.0, 0.5, 0.5862663883899748, -1.0, 0.7857421097214039, 0.6816463048371957, 0.715387139751505, -1.0, 0.8703784884966521, 0.8754761159254738, 0.5, 0.7848989505492386, 0.7060019230905161, 0.5, -1.0, -1.0, 0.5, 0.8852557441072338, 0.7111336740185555, 0.5, 0.5, 0.5158379613642079, 0.8048069503049777, 0.7698751460027453, 0.5, 0.7081010908370371, 0.7186559775903145, 0.5, -1.0, 0.5, 0.5, 0.7234328183144327, 0.8585118111671415, 0.8595545064781371, 0.9268047506175761, 0.5, 0.8929221535180331, 0.8206816893218052, 0.5, 0.5, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5], "episode_lengths": [14, 55, 13, 13, 13, 13, 16, 13, 13, 13, 18, 46, 16, 34, 14, 36, 15, 25, 13, 18, 14, 80, 80, 80, 31, 13, 13, 80, 14, 80, 13, 18, 80, 18, 13, 57, 13, 13, 80, 59, 80, 80, 32, 14, 80, 80, 80, 60, 14, 21, 23, 15, 15, 14, 16, 13, 13, 44, 40, 14, 13, 13, 13, 49, 45, 80, 13, 13, 48, 14, 64, 38, 13, 45, 13, 45, 14, 14, 80, 13, 15, 18, 13, 14, 46, 80, 58, 16, 13, 15, 14, 49, 16, 80, 14, 44, 13, 13, 13, 29, 13, 40, 13, 13, 14, 13, 11, 42, 14, 56, 14, 13, 13, 17, 48, 13, 38, 34, 68, 80, 14, 13, 80, 20, 16]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09307420585566858, "mean_inference_ms": 0.2571417959553797, "mean_action_processing_ms": 0.0331563270388061, "mean_env_wait_ms": 0.04724042402716833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015073776245117187, "StateBufferConnector_ms": 0.0012699127197265624, "ViewRequirementAgentConnector_ms": 0.028571510314941408}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1108.841097852893, "num_env_steps_trained_throughput_per_sec": 1108.841097852893, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 3652.147, "sample_time_ms": 1732.375, "load_time_ms": 0.207, "load_throughput": 19297464.918, "learn_time_ms": 1918.575, "learn_throughput": 2084.88, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 6257, "training_iteration": 65, "trial_id": "default", "date": "2024-05-23_11-36-19", "timestamp": 1716456979, "time_this_iter_s": 3.610318899154663, "time_total_s": 237.69381737709045, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 237.69381737709045, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.32, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2106003597859414, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.25108038364566604, "policy_loss": -0.003894986751018673, "vf_loss": 0.25453454988297597, "vf_explained_var": -0.09106254564818515, "kl": 0.008816405193752617, "entropy": 0.6188697838655082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 60915.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 0.9994596358441954, "episode_reward_min": -1.0, "episode_reward_mean": 0.35451816929726704, "episode_len_mean": 33.09016393442623, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.8645807313923446, 0.5928308851660002, 0.7565987727206085, 0.8161162782760258, 0.5298089660939835, 0.5, 0.8056163000598915, -1.0, 0.7717492530042843, 0.5272448882750109, 0.5, 0.5, 0.5, -1.0, 0.9972885761765782, 0.8921369423254724, 0.5, 0.5, 0.6957770373399348, 0.9183469891613615, 0.686497346133527, 0.9735598338358362, 0.5856777556202297, -1.0, 0.7661933589458698, 0.7441325064250949, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9616021160679662, 0.5, 0.8549558349900814, 0.8906221888164885, 0.5597967529124265, 0.7789786997484325, 0.9993429316909295, 0.5, 0.7469388052422234, -1.0, 0.5, 0.9987931254717737, -1.0, 0.6730412224550832, 0.8659019109653978, 0.5, 0.9188837908749243, 0.5, 0.6647975832512152, 0.9196746854545274, 0.5, 0.8955241715030735, 0.6861526616037679, 0.8610418636861709, -1.0, 0.9587215874666037, 0.5, 0.5636726078660017, 0.990813423414201, 0.7229815158449365, 0.7133730630032158, -1.0, 0.5, 0.5, 0.9711317786354496, 0.5, -1.0, 0.6428041946910634, 0.8455164071695391, -1.0, 0.9994596358441954, 0.6042635697821046, 0.5109308742920698, -1.0, 0.5, 0.871627163747039, 0.5, 0.9434903735939989, 0.6721479463802711, -1.0, 0.7274716361592398, 0.5625034999614545, 0.7955443158527526, 0.5653993550221137, 0.5, 0.7029359831752315, -1.0, 0.8712761646700797, 0.9096032829801447, 0.9102974794523179, 0.9699553499881832, 0.6157107518389706, 0.5, 0.8254099114832305, 0.630294502476815, 0.5930028019603013, -1.0, -1.0, -1.0, -1.0, 0.8564411669613864, 0.9661221378872319, 0.5, 0.6877020821242251, 0.9899036867558071, 0.5277644966154442, -1.0, 0.9139095922272433, 0.6666375744722735, -1.0, -1.0, 0.9730625963868269, 0.5, 0.7791293783980844, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [80, 14, 13, 30, 74, 28, 13, 16, 13, 15, 45, 49, 13, 15, 17, 44, 14, 13, 13, 19, 43, 59, 15, 13, 15, 28, 13, 13, 16, 55, 15, 36, 13, 34, 51, 14, 13, 63, 13, 13, 13, 19, 15, 80, 43, 15, 80, 13, 34, 13, 41, 15, 19, 50, 47, 13, 14, 44, 80, 13, 14, 13, 13, 13, 44, 18, 14, 13, 13, 15, 80, 67, 48, 33, 14, 13, 74, 80, 27, 29, 36, 45, 65, 15, 49, 38, 14, 14, 19, 15, 80, 13, 13, 79, 13, 52, 42, 42, 52, 55, 40, 16, 80, 80, 40, 45, 18, 14, 71, 13, 80, 13, 21, 10, 80, 13, 16, 13, 80, 80, 80, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09308442886634996, "mean_inference_ms": 0.25709343017231095, "mean_action_processing_ms": 0.03314730522318782, "mean_env_wait_ms": 0.047232013664982676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015444442874095478, "StateBufferConnector_ms": 0.001261273368460233, "ViewRequirementAgentConnector_ms": 0.028567431402988123}}, "episode_reward_max": 0.9994596358441954, "episode_reward_min": -1.0, "episode_reward_mean": 0.35451816929726704, "episode_len_mean": 33.09016393442623, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.8645807313923446, 0.5928308851660002, 0.7565987727206085, 0.8161162782760258, 0.5298089660939835, 0.5, 0.8056163000598915, -1.0, 0.7717492530042843, 0.5272448882750109, 0.5, 0.5, 0.5, -1.0, 0.9972885761765782, 0.8921369423254724, 0.5, 0.5, 0.6957770373399348, 0.9183469891613615, 0.686497346133527, 0.9735598338358362, 0.5856777556202297, -1.0, 0.7661933589458698, 0.7441325064250949, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9616021160679662, 0.5, 0.8549558349900814, 0.8906221888164885, 0.5597967529124265, 0.7789786997484325, 0.9993429316909295, 0.5, 0.7469388052422234, -1.0, 0.5, 0.9987931254717737, -1.0, 0.6730412224550832, 0.8659019109653978, 0.5, 0.9188837908749243, 0.5, 0.6647975832512152, 0.9196746854545274, 0.5, 0.8955241715030735, 0.6861526616037679, 0.8610418636861709, -1.0, 0.9587215874666037, 0.5, 0.5636726078660017, 0.990813423414201, 0.7229815158449365, 0.7133730630032158, -1.0, 0.5, 0.5, 0.9711317786354496, 0.5, -1.0, 0.6428041946910634, 0.8455164071695391, -1.0, 0.9994596358441954, 0.6042635697821046, 0.5109308742920698, -1.0, 0.5, 0.871627163747039, 0.5, 0.9434903735939989, 0.6721479463802711, -1.0, 0.7274716361592398, 0.5625034999614545, 0.7955443158527526, 0.5653993550221137, 0.5, 0.7029359831752315, -1.0, 0.8712761646700797, 0.9096032829801447, 0.9102974794523179, 0.9699553499881832, 0.6157107518389706, 0.5, 0.8254099114832305, 0.630294502476815, 0.5930028019603013, -1.0, -1.0, -1.0, -1.0, 0.8564411669613864, 0.9661221378872319, 0.5, 0.6877020821242251, 0.9899036867558071, 0.5277644966154442, -1.0, 0.9139095922272433, 0.6666375744722735, -1.0, -1.0, 0.9730625963868269, 0.5, 0.7791293783980844, -1.0, -1.0, -1.0, 0.5], "episode_lengths": [80, 14, 13, 30, 74, 28, 13, 16, 13, 15, 45, 49, 13, 15, 17, 44, 14, 13, 13, 19, 43, 59, 15, 13, 15, 28, 13, 13, 16, 55, 15, 36, 13, 34, 51, 14, 13, 63, 13, 13, 13, 19, 15, 80, 43, 15, 80, 13, 34, 13, 41, 15, 19, 50, 47, 13, 14, 44, 80, 13, 14, 13, 13, 13, 44, 18, 14, 13, 13, 15, 80, 67, 48, 33, 14, 13, 74, 80, 27, 29, 36, 45, 65, 15, 49, 38, 14, 14, 19, 15, 80, 13, 13, 79, 13, 52, 42, 42, 52, 55, 40, 16, 80, 80, 40, 45, 18, 14, 71, 13, 80, 13, 21, 10, 80, 13, 16, 13, 80, 80, 80, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09308442886634996, "mean_inference_ms": 0.25709343017231095, "mean_action_processing_ms": 0.03314730522318782, "mean_env_wait_ms": 0.047232013664982676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015444442874095478, "StateBufferConnector_ms": 0.001261273368460233, "ViewRequirementAgentConnector_ms": 0.028567431402988123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.8990877747672, "num_env_steps_trained_throughput_per_sec": 1102.8990877747672, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 3644.754, "sample_time_ms": 1728.951, "load_time_ms": 0.21, "load_throughput": 19013164.098, "learn_time_ms": 1914.611, "learn_throughput": 2089.197, "synch_weights_time_ms": 0.644}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 6379, "training_iteration": 66, "trial_id": "default", "date": "2024-05-23_11-36-23", "timestamp": 1716456983, "time_this_iter_s": 3.629749059677124, "time_total_s": 241.32356643676758, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 241.32356643676758, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.400000000000002, "ram_util_percent": 56.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.682462175174426, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2765826909540294, "policy_loss": 0.001931739318114455, "vf_loss": 0.2742689193616952, "vf_explained_var": -0.054383154005132696, "kl": 0.007640654704724337, "entropy": 0.6138128066575655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 61845.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 0.9932126113413013, "episode_reward_min": -1.0, "episode_reward_mean": 0.27212545161317087, "episode_len_mean": 33.957264957264954, "episode_media": {}, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7640953246388874, -1.0, -1.0, -1.0, 0.5, 0.5720383210776046, 0.7455667240408737, 0.5, 0.5, 0.7998264397126511, 0.5423860158784748, 0.5, 0.6191570593686695, 0.96080561635536, 0.7942868264623898, 0.5226191442888288, -1.0, 0.5, 0.5, 0.8852959313758478, 0.7574375293496882, 0.5382895442074629, 0.5, 0.5, 0.6439648405997135, 0.6926404476015384, 0.5, 0.9519685710021749, 0.9217614105819263, 0.5, -1.0, 0.9043955665369264, 0.6274797743163731, -1.0, 0.7614407162247983, -1.0, 0.7633304760667078, 0.5, 0.8049859057058673, 0.9161640452012202, 0.7263644478324482, 0.7731813139239135, 0.9300116699673034, 0.6094359711853596, 0.5, 0.5, -1.0, 0.9047690058337547, 0.7050446582151321, 0.8616589573855632, -1.0, -1.0, 0.5, 0.5, -1.0, 0.507598535297763, 0.5057390954987051, 0.5, -1.0, 0.7191466249720547, -1.0, 0.5, 0.5, 0.9844754394378649, 0.7125536555346246, 0.5910268676634026, 0.5253279928843095, -1.0, 0.5, 0.9494093882806376, 0.5, 0.8726996182252897, 0.7500705114822654, 0.8594179810044883, -1.0, 0.5, 0.5162741069326315, 0.6607888162651396, 0.5, -1.0, 0.9932126113413013, 0.9543560687901129, -1.0, 0.8661440132690266, 0.717486250438435, -1.0, 0.963697693578077, 0.5342602480686908, 0.6768328649114665, -1.0, -1.0, -1.0, -1.0, 0.9416521903279984, -1.0, 0.5, 0.9808881867996873, 0.5, -1.0, -1.0, -1.0, 0.6400384964986952, 0.540046930195105, -1.0, 0.9190055078408039, 0.5, 0.8364461984660517, 0.7709989169006404, 0.5002261276870896, 0.5, 0.6537623064873674, -1.0, 0.5722841103399152, 0.6994473579089073, 0.5292180607598619, 0.5857905860031448, 0.807952223711976], "episode_lengths": [44, 16, 16, 80, 13, 44, 15, 56, 15, 49, 15, 13, 13, 13, 13, 48, 80, 13, 39, 14, 40, 15, 49, 14, 13, 13, 61, 28, 50, 14, 17, 41, 13, 17, 14, 18, 51, 13, 13, 50, 15, 14, 13, 43, 39, 15, 80, 14, 43, 13, 80, 80, 13, 20, 80, 15, 13, 20, 80, 13, 80, 15, 14, 44, 49, 13, 13, 80, 14, 61, 15, 16, 59, 48, 20, 13, 48, 30, 14, 80, 48, 49, 80, 21, 30, 80, 14, 29, 47, 80, 10, 13, 15, 59, 80, 54, 46, 14, 80, 16, 15, 14, 26, 80, 57, 14, 79, 15, 31, 48, 16, 40, 14, 36, 14, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09308551547336053, "mean_inference_ms": 0.2570431551674107, "mean_action_processing_ms": 0.03313834899191559, "mean_env_wait_ms": 0.047223457587710904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015193580562232905, "StateBufferConnector_ms": 0.0013009095803285257, "ViewRequirementAgentConnector_ms": 0.02864955836891109}}, "episode_reward_max": 0.9932126113413013, "episode_reward_min": -1.0, "episode_reward_mean": 0.27212545161317087, "episode_len_mean": 33.957264957264954, "episodes_this_iter": 117, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7640953246388874, -1.0, -1.0, -1.0, 0.5, 0.5720383210776046, 0.7455667240408737, 0.5, 0.5, 0.7998264397126511, 0.5423860158784748, 0.5, 0.6191570593686695, 0.96080561635536, 0.7942868264623898, 0.5226191442888288, -1.0, 0.5, 0.5, 0.8852959313758478, 0.7574375293496882, 0.5382895442074629, 0.5, 0.5, 0.6439648405997135, 0.6926404476015384, 0.5, 0.9519685710021749, 0.9217614105819263, 0.5, -1.0, 0.9043955665369264, 0.6274797743163731, -1.0, 0.7614407162247983, -1.0, 0.7633304760667078, 0.5, 0.8049859057058673, 0.9161640452012202, 0.7263644478324482, 0.7731813139239135, 0.9300116699673034, 0.6094359711853596, 0.5, 0.5, -1.0, 0.9047690058337547, 0.7050446582151321, 0.8616589573855632, -1.0, -1.0, 0.5, 0.5, -1.0, 0.507598535297763, 0.5057390954987051, 0.5, -1.0, 0.7191466249720547, -1.0, 0.5, 0.5, 0.9844754394378649, 0.7125536555346246, 0.5910268676634026, 0.5253279928843095, -1.0, 0.5, 0.9494093882806376, 0.5, 0.8726996182252897, 0.7500705114822654, 0.8594179810044883, -1.0, 0.5, 0.5162741069326315, 0.6607888162651396, 0.5, -1.0, 0.9932126113413013, 0.9543560687901129, -1.0, 0.8661440132690266, 0.717486250438435, -1.0, 0.963697693578077, 0.5342602480686908, 0.6768328649114665, -1.0, -1.0, -1.0, -1.0, 0.9416521903279984, -1.0, 0.5, 0.9808881867996873, 0.5, -1.0, -1.0, -1.0, 0.6400384964986952, 0.540046930195105, -1.0, 0.9190055078408039, 0.5, 0.8364461984660517, 0.7709989169006404, 0.5002261276870896, 0.5, 0.6537623064873674, -1.0, 0.5722841103399152, 0.6994473579089073, 0.5292180607598619, 0.5857905860031448, 0.807952223711976], "episode_lengths": [44, 16, 16, 80, 13, 44, 15, 56, 15, 49, 15, 13, 13, 13, 13, 48, 80, 13, 39, 14, 40, 15, 49, 14, 13, 13, 61, 28, 50, 14, 17, 41, 13, 17, 14, 18, 51, 13, 13, 50, 15, 14, 13, 43, 39, 15, 80, 14, 43, 13, 80, 80, 13, 20, 80, 15, 13, 20, 80, 13, 80, 15, 14, 44, 49, 13, 13, 80, 14, 61, 15, 16, 59, 48, 20, 13, 48, 30, 14, 80, 48, 49, 80, 21, 30, 80, 14, 29, 47, 80, 10, 13, 15, 59, 80, 54, 46, 14, 80, 16, 15, 14, 26, 80, 57, 14, 79, 15, 31, 48, 16, 40, 14, 36, 14, 14, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09308551547336053, "mean_inference_ms": 0.2570431551674107, "mean_action_processing_ms": 0.03313834899191559, "mean_env_wait_ms": 0.047223457587710904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015193580562232905, "StateBufferConnector_ms": 0.0013009095803285257, "ViewRequirementAgentConnector_ms": 0.02864955836891109}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.5984303043801, "num_env_steps_trained_throughput_per_sec": 1102.5984303043801, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 3636.226, "sample_time_ms": 1728.216, "load_time_ms": 0.211, "load_throughput": 18959448.525, "learn_time_ms": 1906.838, "learn_throughput": 2097.714, "synch_weights_time_ms": 0.628}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 6496, "training_iteration": 67, "trial_id": "default", "date": "2024-05-23_11-36-26", "timestamp": 1716456986, "time_this_iter_s": 3.6306490898132324, "time_total_s": 244.9542155265808, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 244.9542155265808, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 17.160000000000004, "ram_util_percent": 56.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3326326247184506, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1807033506933079, "policy_loss": -0.0031768128636383243, "vf_loss": 0.18349289578455752, "vf_explained_var": -0.06128394892138819, "kl": 0.007745397754033074, "entropy": 0.6234954252358406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 62775.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 0.9986245058723434, "episode_reward_min": -1.0, "episode_reward_mean": 0.39810082308628386, "episode_len_mean": 33.59166666666667, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6846712386736622, 0.9303077026761727, 0.9100870085301833, 0.8401091465549403, 0.739899127905497, 0.6735979031982915, 0.7416447495192877, 0.5, 0.5, -1.0, 0.5, 0.8847025695027442, 0.7165697923772182, 0.7105416153369766, -1.0, 0.5, -1.0, 0.751346187179504, 0.8155475023061158, 0.8199185168464442, 0.9746094884153396, 0.6028041279754575, 0.5995190042881713, 0.5911740904165583, -1.0, 0.6222188101951371, 0.9560853999332459, 0.6816385245544614, 0.5399576245547388, -1.0, -1.0, 0.5722169065552636, -1.0, 0.8122670552821611, -1.0, 0.5, 0.5, 0.679558607928595, 0.8944305301649673, -1.0, -1.0, 0.5919136674644443, 0.6405224083054365, 0.5, 0.5, 0.5, 0.7305163855765902, 0.5998084766935319, 0.6583049583694237, -1.0, 0.6867101984761258, 0.7967145393197581, 0.8882206394005576, 0.8137668106726883, 0.5052735967153112, 0.5, 0.5, 0.5565901223793144, 0.8449635135117097, -1.0, 0.845415618970403, 0.543217539717507, 0.7278071128733906, 0.9950961435741261, 0.6979381247116949, 0.5, 0.7958737360599002, 0.9559583781106282, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9282594864791431, 0.6749911374510538, 0.7383440544937325, -1.0, 0.5, 0.5, 0.5, 0.7946260400497417, 0.5123196599070694, 0.7383235511205536, 0.7521178221530038, 0.5, 0.9556340756124875, 0.8360039083584767, 0.5, 0.5, -1.0, 0.5, -1.0, 0.9887218153901849, -1.0, 0.9986245058723434, 0.5, 0.5, 0.6105669748821079, 0.7096339974208195, 0.8815309988266529, 0.775823451076532, 0.5, 0.8461019254505062, 0.5, 0.9186909613726565, 0.6594189670912098, 0.5438118259109426, 0.5, 0.6834056865731939, 0.5646436974985063, -1.0, 0.5, 0.7137958014048256, 0.7829157853855526, 0.5, 0.5359138312647314, 0.542722192910678, 0.9978412428307656, 0.8845992078386279, 0.582680963954283], "episode_lengths": [74, 15, 13, 13, 13, 27, 48, 14, 39, 26, 13, 14, 14, 14, 34, 31, 80, 17, 13, 14, 65, 14, 16, 13, 80, 54, 13, 13, 15, 80, 80, 14, 80, 15, 80, 15, 53, 13, 13, 12, 80, 62, 13, 14, 14, 15, 15, 14, 14, 80, 13, 14, 50, 15, 14, 21, 18, 51, 70, 80, 53, 14, 47, 47, 67, 56, 38, 44, 36, 19, 16, 80, 13, 14, 13, 15, 80, 15, 13, 13, 61, 13, 54, 41, 58, 44, 31, 14, 15, 80, 42, 80, 13, 80, 14, 16, 14, 26, 13, 54, 16, 46, 13, 47, 14, 52, 16, 15, 20, 52, 80, 14, 52, 47, 23, 13, 13, 13, 63, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930892111234362, "mean_inference_ms": 0.25697815519527106, "mean_action_processing_ms": 0.0331294545750374, "mean_env_wait_ms": 0.04721369635655995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015513102213541667, "StateBufferConnector_ms": 0.0012737512588500977, "ViewRequirementAgentConnector_ms": 0.028619567553202312}}, "episode_reward_max": 0.9986245058723434, "episode_reward_min": -1.0, "episode_reward_mean": 0.39810082308628386, "episode_len_mean": 33.59166666666667, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6846712386736622, 0.9303077026761727, 0.9100870085301833, 0.8401091465549403, 0.739899127905497, 0.6735979031982915, 0.7416447495192877, 0.5, 0.5, -1.0, 0.5, 0.8847025695027442, 0.7165697923772182, 0.7105416153369766, -1.0, 0.5, -1.0, 0.751346187179504, 0.8155475023061158, 0.8199185168464442, 0.9746094884153396, 0.6028041279754575, 0.5995190042881713, 0.5911740904165583, -1.0, 0.6222188101951371, 0.9560853999332459, 0.6816385245544614, 0.5399576245547388, -1.0, -1.0, 0.5722169065552636, -1.0, 0.8122670552821611, -1.0, 0.5, 0.5, 0.679558607928595, 0.8944305301649673, -1.0, -1.0, 0.5919136674644443, 0.6405224083054365, 0.5, 0.5, 0.5, 0.7305163855765902, 0.5998084766935319, 0.6583049583694237, -1.0, 0.6867101984761258, 0.7967145393197581, 0.8882206394005576, 0.8137668106726883, 0.5052735967153112, 0.5, 0.5, 0.5565901223793144, 0.8449635135117097, -1.0, 0.845415618970403, 0.543217539717507, 0.7278071128733906, 0.9950961435741261, 0.6979381247116949, 0.5, 0.7958737360599002, 0.9559583781106282, 0.5, -1.0, -1.0, -1.0, 0.5, 0.9282594864791431, 0.6749911374510538, 0.7383440544937325, -1.0, 0.5, 0.5, 0.5, 0.7946260400497417, 0.5123196599070694, 0.7383235511205536, 0.7521178221530038, 0.5, 0.9556340756124875, 0.8360039083584767, 0.5, 0.5, -1.0, 0.5, -1.0, 0.9887218153901849, -1.0, 0.9986245058723434, 0.5, 0.5, 0.6105669748821079, 0.7096339974208195, 0.8815309988266529, 0.775823451076532, 0.5, 0.8461019254505062, 0.5, 0.9186909613726565, 0.6594189670912098, 0.5438118259109426, 0.5, 0.6834056865731939, 0.5646436974985063, -1.0, 0.5, 0.7137958014048256, 0.7829157853855526, 0.5, 0.5359138312647314, 0.542722192910678, 0.9978412428307656, 0.8845992078386279, 0.582680963954283], "episode_lengths": [74, 15, 13, 13, 13, 27, 48, 14, 39, 26, 13, 14, 14, 14, 34, 31, 80, 17, 13, 14, 65, 14, 16, 13, 80, 54, 13, 13, 15, 80, 80, 14, 80, 15, 80, 15, 53, 13, 13, 12, 80, 62, 13, 14, 14, 15, 15, 14, 14, 80, 13, 14, 50, 15, 14, 21, 18, 51, 70, 80, 53, 14, 47, 47, 67, 56, 38, 44, 36, 19, 16, 80, 13, 14, 13, 15, 80, 15, 13, 13, 61, 13, 54, 41, 58, 44, 31, 14, 15, 80, 42, 80, 13, 80, 14, 16, 14, 26, 13, 54, 16, 46, 13, 47, 14, 52, 16, 15, 20, 52, 80, 14, 52, 47, 23, 13, 13, 13, 63, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930892111234362, "mean_inference_ms": 0.25697815519527106, "mean_action_processing_ms": 0.0331294545750374, "mean_env_wait_ms": 0.04721369635655995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015513102213541667, "StateBufferConnector_ms": 0.0012737512588500977, "ViewRequirementAgentConnector_ms": 0.028619567553202312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1105.0267035351046, "num_env_steps_trained_throughput_per_sec": 1105.0267035351046, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 3638.467, "sample_time_ms": 1728.028, "load_time_ms": 0.209, "load_throughput": 19143331.812, "learn_time_ms": 1909.27, "learn_throughput": 2095.042, "synch_weights_time_ms": 0.628}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 6616, "training_iteration": 68, "trial_id": "default", "date": "2024-05-23_11-36-30", "timestamp": 1716456990, "time_this_iter_s": 3.6228280067443848, "time_total_s": 248.5770435333252, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 248.5770435333252, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.639999999999997, "ram_util_percent": 56.879999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.902159360595929, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2498680953797634, "policy_loss": 0.0012349656542703028, "vf_loss": 0.24832682737740136, "vf_explained_var": 0.19731471660316632, "kl": 0.00612599838889137, "entropy": 0.6388706811974125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 63705.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 0.9951257715276786, "episode_reward_min": -1.0, "episode_reward_mean": 0.27462200283618005, "episode_len_mean": 38.20952380952381, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.840762100763192, 0.7106271316464061, 0.5720452186125212, 0.5, -1.0, 0.8398225581152454, -1.0, 0.5, 0.5, 0.5, -1.0, 0.7115869628002864, -1.0, -1.0, 0.8525512258108487, 0.5, 0.9257676207573872, 0.5120609005442638, 0.8033011126520372, 0.8363972968979272, 0.8413507351858858, 0.9201121933754126, -1.0, 0.8129165387143362, 0.5, 0.9139294615830678, 0.6848808090673402, 0.9860771011910799, 0.5, -1.0, 0.5, 0.9428229035589029, 0.5050683315302598, 0.9194733853088227, 0.9031672093910276, 0.7003133657301052, 0.8965092091824034, 0.5, 0.5, -1.0, 0.6135871308206837, 0.9403406169758198, -1.0, 0.7856914545496552, 0.7375424300560076, 0.8763878844867126, 0.5, -1.0, 0.7951632096488893, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.9545382076472039, 0.5944824075387506, 0.5584084790346298, 0.7639399282312149, 0.5, -1.0, 0.5, -1.0, 0.8393950193609314, 0.8328387211668893, -1.0, 0.6635039948259773, -1.0, 0.5, 0.7256114655684871, 0.6928463936637774, 0.5, 0.7385170756203503, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9716534556738136, -1.0, 0.683014734183421, 0.5032268709189207, 0.9951257715276786, 0.5, 0.6956478533417834, -1.0, 0.7775374098405332, 0.883675347503957, 0.6160994068101557, 0.9864553700022212, -1.0, 0.6716748435608073, 0.8205156638343778, -1.0, 0.7375070836864874, 0.5, 0.7737409602116927, 0.8185746859010163, 0.7066295270894927, -1.0, 0.949893522097802], "episode_lengths": [46, 13, 13, 14, 80, 45, 67, 14, 41, 15, 80, 40, 80, 80, 65, 54, 48, 33, 67, 16, 14, 14, 9, 15, 13, 50, 13, 42, 14, 80, 14, 48, 46, 47, 13, 13, 45, 17, 14, 80, 66, 13, 80, 44, 14, 14, 13, 80, 18, 80, 15, 32, 80, 25, 63, 17, 80, 80, 48, 36, 14, 13, 60, 80, 14, 32, 43, 47, 80, 49, 16, 24, 14, 44, 13, 13, 80, 14, 18, 26, 16, 80, 53, 15, 13, 30, 42, 18, 42, 80, 17, 14, 13, 14, 80, 53, 14, 80, 14, 32, 51, 50, 14, 16, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09307121507588532, "mean_inference_ms": 0.2569145598465412, "mean_action_processing_ms": 0.033115873390315034, "mean_env_wait_ms": 0.04720112553898005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015190669468470982, "StateBufferConnector_ms": 0.0012831460861932663, "ViewRequirementAgentConnector_ms": 0.028479894002278645}}, "episode_reward_max": 0.9951257715276786, "episode_reward_min": -1.0, "episode_reward_mean": 0.27462200283618005, "episode_len_mean": 38.20952380952381, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.840762100763192, 0.7106271316464061, 0.5720452186125212, 0.5, -1.0, 0.8398225581152454, -1.0, 0.5, 0.5, 0.5, -1.0, 0.7115869628002864, -1.0, -1.0, 0.8525512258108487, 0.5, 0.9257676207573872, 0.5120609005442638, 0.8033011126520372, 0.8363972968979272, 0.8413507351858858, 0.9201121933754126, -1.0, 0.8129165387143362, 0.5, 0.9139294615830678, 0.6848808090673402, 0.9860771011910799, 0.5, -1.0, 0.5, 0.9428229035589029, 0.5050683315302598, 0.9194733853088227, 0.9031672093910276, 0.7003133657301052, 0.8965092091824034, 0.5, 0.5, -1.0, 0.6135871308206837, 0.9403406169758198, -1.0, 0.7856914545496552, 0.7375424300560076, 0.8763878844867126, 0.5, -1.0, 0.7951632096488893, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, -1.0, 0.9545382076472039, 0.5944824075387506, 0.5584084790346298, 0.7639399282312149, 0.5, -1.0, 0.5, -1.0, 0.8393950193609314, 0.8328387211668893, -1.0, 0.6635039948259773, -1.0, 0.5, 0.7256114655684871, 0.6928463936637774, 0.5, 0.7385170756203503, -1.0, 0.5, 0.5, 0.5, 0.5, -1.0, 0.9716534556738136, -1.0, 0.683014734183421, 0.5032268709189207, 0.9951257715276786, 0.5, 0.6956478533417834, -1.0, 0.7775374098405332, 0.883675347503957, 0.6160994068101557, 0.9864553700022212, -1.0, 0.6716748435608073, 0.8205156638343778, -1.0, 0.7375070836864874, 0.5, 0.7737409602116927, 0.8185746859010163, 0.7066295270894927, -1.0, 0.949893522097802], "episode_lengths": [46, 13, 13, 14, 80, 45, 67, 14, 41, 15, 80, 40, 80, 80, 65, 54, 48, 33, 67, 16, 14, 14, 9, 15, 13, 50, 13, 42, 14, 80, 14, 48, 46, 47, 13, 13, 45, 17, 14, 80, 66, 13, 80, 44, 14, 14, 13, 80, 18, 80, 15, 32, 80, 25, 63, 17, 80, 80, 48, 36, 14, 13, 60, 80, 14, 32, 43, 47, 80, 49, 16, 24, 14, 44, 13, 13, 80, 14, 18, 26, 16, 80, 53, 15, 13, 30, 42, 18, 42, 80, 17, 14, 13, 14, 80, 53, 14, 80, 14, 32, 51, 50, 14, 16, 57]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09307121507588532, "mean_inference_ms": 0.2569145598465412, "mean_action_processing_ms": 0.033115873390315034, "mean_env_wait_ms": 0.04720112553898005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015190669468470982, "StateBufferConnector_ms": 0.0012831460861932663, "ViewRequirementAgentConnector_ms": 0.028479894002278645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1106.1438753107013, "num_env_steps_trained_throughput_per_sec": 1106.1438753107013, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 3630.366, "sample_time_ms": 1719.389, "load_time_ms": 0.209, "load_throughput": 19117155.88, "learn_time_ms": 1909.808, "learn_throughput": 2094.451, "synch_weights_time_ms": 0.628}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 6721, "training_iteration": 69, "trial_id": "default", "date": "2024-05-23_11-36-33", "timestamp": 1716456993, "time_this_iter_s": 3.618997812271118, "time_total_s": 252.1960413455963, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 252.1960413455963, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.650000000000002, "ram_util_percent": 56.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.990596576083091, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1989067220679855, "policy_loss": -0.002551303537542461, "vf_loss": 0.20109197616737376, "vf_explained_var": 0.07411395593356061, "kl": 0.007321007321007142, "entropy": 0.5882649854306252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 64635.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 0.9891117320626786, "episode_reward_min": -1.0, "episode_reward_mean": 0.24730416682202963, "episode_len_mean": 44.07, "episode_media": {}, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6716748435608073, 0.8205156638343778, -1.0, 0.7375070836864874, 0.5, 0.7737409602116927, 0.8185746859010163, 0.7066295270894927, -1.0, 0.949893522097802, 0.5, 0.6063747400033788, 0.7551460444352102, -1.0, 0.7369455873272805, 0.5, -1.0, 0.7790591284648878, 0.6140261056961317, 0.9119126725018974, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.7513956385804594, 0.8118551304233586, -1.0, 0.5, 0.7323310834727523, 0.5510687400332399, 0.5, 0.8361726104305152, 0.8750486037834875, -1.0, -1.0, 0.9744706609294093, 0.5, 0.5941387086949421, 0.5, 0.9357843836083937, -1.0, -1.0, 0.8630238510898783, 0.7915856684235768, 0.5935815978677639, 0.7541627050932974, 0.8281790015910382, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6382911257533233, 0.5, -1.0, 0.5, -1.0, 0.9044432939970132, 0.5, -1.0, 0.8571327968010147, 0.9061456474526983, -1.0, -1.0, 0.650288374649473, 0.683729961892254, -1.0, 0.5428916965589372, 0.9891117320626786, 0.5, 0.7502879632387511, 0.7214798882389548, 0.774755104360805, 0.5, 0.5482544910924712, 0.8713018966734264, 0.7113598124230214, 0.5686100444334239, 0.8619563784426693, -1.0, 0.7467444866588271, -1.0, 0.8833781512805888, 0.5, 0.9255184267981682, 0.6506273832844409, 0.5, -1.0, 0.5, 0.7785780149502243, -1.0, 0.9268829908860247, -1.0, 0.5953858754657599, 0.9684621959754424], "episode_lengths": [53, 14, 80, 14, 32, 51, 50, 14, 16, 57, 46, 35, 13, 80, 53, 50, 80, 44, 50, 46, 16, 14, 14, 47, 13, 46, 80, 80, 26, 15, 76, 80, 14, 45, 57, 15, 38, 42, 80, 80, 13, 19, 53, 16, 52, 80, 80, 15, 14, 47, 34, 71, 80, 14, 80, 28, 80, 48, 69, 80, 14, 80, 50, 14, 80, 49, 58, 80, 80, 13, 56, 80, 15, 13, 18, 45, 50, 37, 13, 35, 53, 14, 74, 57, 80, 32, 80, 13, 13, 48, 13, 15, 80, 13, 14, 80, 13, 80, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930420113813797, "mean_inference_ms": 0.2568643773786712, "mean_action_processing_ms": 0.033106959168773493, "mean_env_wait_ms": 0.047188452929381126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001615285873413086, "StateBufferConnector_ms": 0.0012583732604980469, "ViewRequirementAgentConnector_ms": 0.02854156494140625}}, "episode_reward_max": 0.9891117320626786, "episode_reward_min": -1.0, "episode_reward_mean": 0.24730416682202963, "episode_len_mean": 44.07, "episodes_this_iter": 90, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6716748435608073, 0.8205156638343778, -1.0, 0.7375070836864874, 0.5, 0.7737409602116927, 0.8185746859010163, 0.7066295270894927, -1.0, 0.949893522097802, 0.5, 0.6063747400033788, 0.7551460444352102, -1.0, 0.7369455873272805, 0.5, -1.0, 0.7790591284648878, 0.6140261056961317, 0.9119126725018974, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, -1.0, 0.5, 0.7513956385804594, 0.8118551304233586, -1.0, 0.5, 0.7323310834727523, 0.5510687400332399, 0.5, 0.8361726104305152, 0.8750486037834875, -1.0, -1.0, 0.9744706609294093, 0.5, 0.5941387086949421, 0.5, 0.9357843836083937, -1.0, -1.0, 0.8630238510898783, 0.7915856684235768, 0.5935815978677639, 0.7541627050932974, 0.8281790015910382, -1.0, 0.5, -1.0, -1.0, -1.0, 0.6382911257533233, 0.5, -1.0, 0.5, -1.0, 0.9044432939970132, 0.5, -1.0, 0.8571327968010147, 0.9061456474526983, -1.0, -1.0, 0.650288374649473, 0.683729961892254, -1.0, 0.5428916965589372, 0.9891117320626786, 0.5, 0.7502879632387511, 0.7214798882389548, 0.774755104360805, 0.5, 0.5482544910924712, 0.8713018966734264, 0.7113598124230214, 0.5686100444334239, 0.8619563784426693, -1.0, 0.7467444866588271, -1.0, 0.8833781512805888, 0.5, 0.9255184267981682, 0.6506273832844409, 0.5, -1.0, 0.5, 0.7785780149502243, -1.0, 0.9268829908860247, -1.0, 0.5953858754657599, 0.9684621959754424], "episode_lengths": [53, 14, 80, 14, 32, 51, 50, 14, 16, 57, 46, 35, 13, 80, 53, 50, 80, 44, 50, 46, 16, 14, 14, 47, 13, 46, 80, 80, 26, 15, 76, 80, 14, 45, 57, 15, 38, 42, 80, 80, 13, 19, 53, 16, 52, 80, 80, 15, 14, 47, 34, 71, 80, 14, 80, 28, 80, 48, 69, 80, 14, 80, 50, 14, 80, 49, 58, 80, 80, 13, 56, 80, 15, 13, 18, 45, 50, 37, 13, 35, 53, 14, 74, 57, 80, 32, 80, 13, 13, 48, 13, 15, 80, 13, 14, 80, 13, 80, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930420113813797, "mean_inference_ms": 0.2568643773786712, "mean_action_processing_ms": 0.033106959168773493, "mean_env_wait_ms": 0.047188452929381126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001615285873413086, "StateBufferConnector_ms": 0.0012583732604980469, "ViewRequirementAgentConnector_ms": 0.02854156494140625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1107.3675992649503, "num_env_steps_trained_throughput_per_sec": 1107.3675992649503, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 3629.867, "sample_time_ms": 1718.087, "load_time_ms": 0.214, "load_throughput": 18732934.346, "learn_time_ms": 1910.595, "learn_throughput": 2093.589, "synch_weights_time_ms": 0.641}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 6811, "training_iteration": 70, "trial_id": "default", "date": "2024-05-23_11-36-37", "timestamp": 1716456997, "time_this_iter_s": 3.614859104156494, "time_total_s": 255.8109004497528, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 255.8109004497528, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.060000000000002, "ram_util_percent": 56.779999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.076773609845869, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2526458387815153, "policy_loss": -0.0017756356457148189, "vf_loss": 0.2540989556580141, "vf_explained_var": 0.19369804974525207, "kl": 0.006450344898374596, "entropy": 0.6029345166619106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 65565.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 0.9995618990562426, "episode_reward_min": -1.0, "episode_reward_mean": 0.24056683748180324, "episode_len_mean": 37.82857142857143, "episode_media": {}, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.6122279971061968, 0.8700750882797126, 0.8676998293867003, 0.5, -1.0, 0.5411391189904382, 0.6403624893372365, 0.9435338165420146, 0.9956496955608534, 0.5, 0.5, -1.0, -1.0, -1.0, 0.8774763215756781, 0.6738915401335935, 0.5, 0.5, 0.5, 0.8283040545061111, -1.0, 0.8196661319081435, 0.9496471805109526, 0.973644403940151, 0.5147057794223744, -1.0, 0.6101395286883555, 0.5266829536996009, -1.0, -1.0, 0.5, 0.5558540095344826, 0.5, -1.0, 0.6419070350958185, 0.7180304436589351, 0.8762457052978478, 0.9451571997381791, 0.8428429530254647, 0.7636969209377876, 0.5, 0.939733387307388, 0.7751701432460109, -1.0, 0.7537338053327461, 0.5, -1.0, 0.6064048733663774, 0.5, -1.0, 0.5, 0.8872108713903666, 0.6501895245849906, 0.8295087886325334, -1.0, 0.8404324848097048, 0.5161258107844169, 0.5, -1.0, 0.9089286035786345, -1.0, 0.7333729205421654, -1.0, -1.0, 0.5, 0.5632297104822108, -1.0, 0.5074924270840716, 0.5, 0.9165862819052362, 0.9041442617208851, 0.6490284767736691, -1.0, 0.703240552195423, 0.5, 0.8867402419099528, -1.0, -1.0, 0.9952606741446389, -1.0, 0.8557312277356356, 0.5, 0.6678570642420527, 0.9995618990562426, -1.0, 0.6258820236877902, 0.5, 0.8086877713359342, -1.0, 0.8323448380342728, -1.0, 0.5056476906127606, 0.6435427527110285, 0.5822981954444303, 0.5, 0.5289495247654425, 0.8481020354289692, 0.9467756724575747, 0.857975292046673, 0.530759897366667, 0.8702880139958156, -1.0], "episode_lengths": [31, 16, 20, 29, 13, 13, 28, 80, 47, 33, 46, 32, 18, 54, 80, 17, 80, 47, 44, 30, 16, 50, 13, 80, 79, 50, 15, 24, 80, 49, 13, 80, 50, 15, 48, 47, 80, 47, 20, 14, 48, 47, 13, 15, 15, 14, 42, 13, 39, 80, 48, 15, 80, 14, 15, 32, 56, 80, 13, 22, 23, 80, 15, 80, 13, 80, 80, 34, 53, 80, 43, 16, 16, 60, 13, 18, 15, 17, 15, 80, 80, 54, 16, 15, 17, 13, 47, 80, 13, 22, 14, 80, 30, 18, 13, 60, 35, 14, 15, 14, 15, 13, 13, 41, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09302458026596436, "mean_inference_ms": 0.25680662869981485, "mean_action_processing_ms": 0.03309867766044837, "mean_env_wait_ms": 0.047176319216486115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015424546741303943, "StateBufferConnector_ms": 0.001293136959984189, "ViewRequirementAgentConnector_ms": 0.02846536182221912}}, "episode_reward_max": 0.9995618990562426, "episode_reward_min": -1.0, "episode_reward_mean": 0.24056683748180324, "episode_len_mean": 37.82857142857143, "episodes_this_iter": 105, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.5, 0.6122279971061968, 0.8700750882797126, 0.8676998293867003, 0.5, -1.0, 0.5411391189904382, 0.6403624893372365, 0.9435338165420146, 0.9956496955608534, 0.5, 0.5, -1.0, -1.0, -1.0, 0.8774763215756781, 0.6738915401335935, 0.5, 0.5, 0.5, 0.8283040545061111, -1.0, 0.8196661319081435, 0.9496471805109526, 0.973644403940151, 0.5147057794223744, -1.0, 0.6101395286883555, 0.5266829536996009, -1.0, -1.0, 0.5, 0.5558540095344826, 0.5, -1.0, 0.6419070350958185, 0.7180304436589351, 0.8762457052978478, 0.9451571997381791, 0.8428429530254647, 0.7636969209377876, 0.5, 0.939733387307388, 0.7751701432460109, -1.0, 0.7537338053327461, 0.5, -1.0, 0.6064048733663774, 0.5, -1.0, 0.5, 0.8872108713903666, 0.6501895245849906, 0.8295087886325334, -1.0, 0.8404324848097048, 0.5161258107844169, 0.5, -1.0, 0.9089286035786345, -1.0, 0.7333729205421654, -1.0, -1.0, 0.5, 0.5632297104822108, -1.0, 0.5074924270840716, 0.5, 0.9165862819052362, 0.9041442617208851, 0.6490284767736691, -1.0, 0.703240552195423, 0.5, 0.8867402419099528, -1.0, -1.0, 0.9952606741446389, -1.0, 0.8557312277356356, 0.5, 0.6678570642420527, 0.9995618990562426, -1.0, 0.6258820236877902, 0.5, 0.8086877713359342, -1.0, 0.8323448380342728, -1.0, 0.5056476906127606, 0.6435427527110285, 0.5822981954444303, 0.5, 0.5289495247654425, 0.8481020354289692, 0.9467756724575747, 0.857975292046673, 0.530759897366667, 0.8702880139958156, -1.0], "episode_lengths": [31, 16, 20, 29, 13, 13, 28, 80, 47, 33, 46, 32, 18, 54, 80, 17, 80, 47, 44, 30, 16, 50, 13, 80, 79, 50, 15, 24, 80, 49, 13, 80, 50, 15, 48, 47, 80, 47, 20, 14, 48, 47, 13, 15, 15, 14, 42, 13, 39, 80, 48, 15, 80, 14, 15, 32, 56, 80, 13, 22, 23, 80, 15, 80, 13, 80, 80, 34, 53, 80, 43, 16, 16, 60, 13, 18, 15, 17, 15, 80, 80, 54, 16, 15, 17, 13, 47, 80, 13, 22, 14, 80, 30, 18, 13, 60, 35, 14, 15, 14, 15, 13, 13, 41, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09302458026596436, "mean_inference_ms": 0.25680662869981485, "mean_action_processing_ms": 0.03309867766044837, "mean_env_wait_ms": 0.047176319216486115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015424546741303943, "StateBufferConnector_ms": 0.001293136959984189, "ViewRequirementAgentConnector_ms": 0.02846536182221912}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1080.1589011300027, "num_env_steps_trained_throughput_per_sec": 1080.1589011300027, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 3638.088, "sample_time_ms": 1717.253, "load_time_ms": 0.213, "load_throughput": 18785372.299, "learn_time_ms": 1919.637, "learn_throughput": 2083.727, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 6916, "training_iteration": 71, "trial_id": "default", "date": "2024-05-23_11-36-41", "timestamp": 1716457001, "time_this_iter_s": 3.705894947052002, "time_total_s": 259.5167953968048, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.5167953968048, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 56.78000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.869214565459118, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1890031503092858, "policy_loss": -0.011319732557862035, "vf_loss": 0.19987813196675752, "vf_explained_var": 0.2839578931049634, "kl": 0.008895048421623527, "entropy": 0.6176791145596453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 66495.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 0.9994141111653478, "episode_reward_min": -1.0, "episode_reward_mean": 0.3235227531779711, "episode_len_mean": 36.944954128440365, "episode_media": {}, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5638222646564088, 0.7808360481836092, 0.6842348145330067, -1.0, 0.5236431085751859, 0.5, 0.8538270775546049, -1.0, 0.5, 0.9994141111653478, 0.5, 0.5, 0.6658828242158461, -1.0, 0.5741788129278782, 0.5892300619370365, -1.0, 0.7786179318273085, -1.0, 0.5, 0.7576885636521979, 0.5, -1.0, 0.8206969007805319, 0.9910132624290301, 0.540307960285834, 0.5, -1.0, -1.0, 0.7671501032628045, 0.6115650858694011, 0.7043981196400003, 0.8192940157638441, 0.5519172016862459, -1.0, 0.7785059730297098, 0.8701367640413658, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5539667788418137, 0.7563053622855107, 0.5, 0.5906400133473526, 0.5903786769216429, 0.5, 0.7911815717497857, 0.5, 0.558770773887623, -1.0, 0.5572385359418958, 0.8149611006691346, 0.6563119349013438, 0.5, 0.8657264859235857, 0.763043947500418, 0.5, 0.6469834186620915, 0.7850871609005535, 0.6243532688780787, 0.5, 0.7580427077380281, 0.5, -1.0, 0.9326940527182183, 0.9093240301286372, 0.7840186050661982, -1.0, 0.5914914805010696, 0.8582987963434701, 0.5329364133138542, 0.8572923578195046, 0.5, 0.6568566998347495, 0.5460821743056476, 0.6405542373717474, -1.0, 0.7301718098946468, 0.9464071118062044, 0.5332971428709157, 0.946724373877359, 0.5516954103112741, 0.8590772076523342, 0.5, -1.0, -1.0, 0.8661216291296764, 0.5934856895524326, 0.7399435827486308, 0.9233617390253677, 0.5, 0.5047126241671338, -1.0, 0.80973274045959, -1.0, 0.5185803756385449, 0.7607111471909005, 0.7400682219485897, 0.9560118344497109, -1.0, 0.6578486214969885, -1.0, 0.8631329903860051, 0.9835329286770604, -1.0, 0.9304613235463339, -1.0], "episode_lengths": [42, 13, 50, 80, 50, 14, 18, 80, 14, 13, 15, 13, 13, 80, 15, 22, 80, 13, 80, 19, 61, 15, 80, 51, 53, 17, 13, 80, 80, 13, 54, 63, 59, 15, 80, 13, 15, 80, 14, 80, 31, 16, 13, 17, 52, 14, 51, 13, 14, 13, 62, 80, 39, 13, 13, 53, 13, 13, 55, 14, 14, 14, 14, 14, 16, 80, 13, 13, 14, 26, 15, 14, 47, 14, 53, 34, 13, 13, 80, 48, 14, 13, 13, 36, 32, 14, 29, 80, 13, 15, 13, 53, 61, 33, 80, 50, 80, 45, 50, 52, 28, 80, 16, 80, 78, 14, 22, 55, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09301037083585194, "mean_inference_ms": 0.25674353965416946, "mean_action_processing_ms": 0.03308797480246668, "mean_env_wait_ms": 0.04716386826534957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015392215973740323, "StateBufferConnector_ms": 0.0012973032960104287, "ViewRequirementAgentConnector_ms": 0.028204042977149332}}, "episode_reward_max": 0.9994141111653478, "episode_reward_min": -1.0, "episode_reward_mean": 0.3235227531779711, "episode_len_mean": 36.944954128440365, "episodes_this_iter": 109, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5638222646564088, 0.7808360481836092, 0.6842348145330067, -1.0, 0.5236431085751859, 0.5, 0.8538270775546049, -1.0, 0.5, 0.9994141111653478, 0.5, 0.5, 0.6658828242158461, -1.0, 0.5741788129278782, 0.5892300619370365, -1.0, 0.7786179318273085, -1.0, 0.5, 0.7576885636521979, 0.5, -1.0, 0.8206969007805319, 0.9910132624290301, 0.540307960285834, 0.5, -1.0, -1.0, 0.7671501032628045, 0.6115650858694011, 0.7043981196400003, 0.8192940157638441, 0.5519172016862459, -1.0, 0.7785059730297098, 0.8701367640413658, -1.0, 0.5, -1.0, 0.5, 0.5, 0.5539667788418137, 0.7563053622855107, 0.5, 0.5906400133473526, 0.5903786769216429, 0.5, 0.7911815717497857, 0.5, 0.558770773887623, -1.0, 0.5572385359418958, 0.8149611006691346, 0.6563119349013438, 0.5, 0.8657264859235857, 0.763043947500418, 0.5, 0.6469834186620915, 0.7850871609005535, 0.6243532688780787, 0.5, 0.7580427077380281, 0.5, -1.0, 0.9326940527182183, 0.9093240301286372, 0.7840186050661982, -1.0, 0.5914914805010696, 0.8582987963434701, 0.5329364133138542, 0.8572923578195046, 0.5, 0.6568566998347495, 0.5460821743056476, 0.6405542373717474, -1.0, 0.7301718098946468, 0.9464071118062044, 0.5332971428709157, 0.946724373877359, 0.5516954103112741, 0.8590772076523342, 0.5, -1.0, -1.0, 0.8661216291296764, 0.5934856895524326, 0.7399435827486308, 0.9233617390253677, 0.5, 0.5047126241671338, -1.0, 0.80973274045959, -1.0, 0.5185803756385449, 0.7607111471909005, 0.7400682219485897, 0.9560118344497109, -1.0, 0.6578486214969885, -1.0, 0.8631329903860051, 0.9835329286770604, -1.0, 0.9304613235463339, -1.0], "episode_lengths": [42, 13, 50, 80, 50, 14, 18, 80, 14, 13, 15, 13, 13, 80, 15, 22, 80, 13, 80, 19, 61, 15, 80, 51, 53, 17, 13, 80, 80, 13, 54, 63, 59, 15, 80, 13, 15, 80, 14, 80, 31, 16, 13, 17, 52, 14, 51, 13, 14, 13, 62, 80, 39, 13, 13, 53, 13, 13, 55, 14, 14, 14, 14, 14, 16, 80, 13, 13, 14, 26, 15, 14, 47, 14, 53, 34, 13, 13, 80, 48, 14, 13, 13, 36, 32, 14, 29, 80, 13, 15, 13, 53, 61, 33, 80, 50, 80, 45, 50, 52, 28, 80, 16, 80, 78, 14, 22, 55, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09301037083585194, "mean_inference_ms": 0.25674353965416946, "mean_action_processing_ms": 0.03308797480246668, "mean_env_wait_ms": 0.04716386826534957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015392215973740323, "StateBufferConnector_ms": 0.0012973032960104287, "ViewRequirementAgentConnector_ms": 0.028204042977149332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1105.0819480466016, "num_env_steps_trained_throughput_per_sec": 1105.0819480466016, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3637.531, "sample_time_ms": 1716.048, "load_time_ms": 0.213, "load_throughput": 18810646.934, "learn_time_ms": 1920.286, "learn_throughput": 2083.023, "synch_weights_time_ms": 0.648}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 7025, "training_iteration": 72, "trial_id": "default", "date": "2024-05-23_11-36-44", "timestamp": 1716457004, "time_this_iter_s": 3.6225361824035645, "time_total_s": 263.1393315792084, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 263.1393315792084, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.3, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0219905532175493, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1822522041978695, "policy_loss": -0.008737960345642542, "vf_loss": 0.19058184071734388, "vf_explained_var": -0.1557415783405304, "kl": 0.008166417941877996, "entropy": 0.6238317871926933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 67425.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 0.9776831865016586, "episode_reward_min": -1.0, "episode_reward_mean": 0.3415168593655881, "episode_len_mean": 33.275, "episode_media": {}, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, 0.6104196642087383, 0.5, 0.603499694649908, 0.5, 0.5, -1.0, 0.926672888150128, -1.0, 0.7674778380031354, -1.0, 0.8362059647356995, 0.5137169466736957, 0.6941265352535109, 0.9313511920704042, 0.5512003053484764, 0.5, 0.5, 0.6930931913950432, 0.5, 0.7580864850673619, 0.6870867320047778, 0.9175108119467023, 0.8796888275226094, 0.7728934123654552, 0.5, 0.8941242778295978, 0.6671546379318745, 0.5, -1.0, -1.0, 0.5, 0.9424286038020269, 0.5, 0.6024998379969937, 0.9318083608244039, 0.5169588193428438, 0.5, 0.5, 0.9404615174020962, 0.5, 0.724385928138834, 0.7281367589115206, 0.6166549298193864, 0.9666836712623457, 0.651489835706381, 0.5014513142216175, 0.8498633987061488, 0.867894357801343, 0.5626530278626414, 0.5911232398706043, 0.634087414063486, -1.0, 0.5, 0.8894266852851276, 0.7670039250959625, 0.7009405544268719, 0.5, 0.7422452059586487, 0.6895898747706722, 0.5, 0.5, 0.6591445372222559, 0.7395039753381476, 0.7089251855352832, 0.5834336607370189, 0.6414972220574167, 0.9048131776297171, 0.5, 0.6158870448642235, -1.0, 0.5735222686923781, 0.5, -1.0, -1.0, 0.8302990771214439, 0.6669794759867671, 0.6491080783524941, 0.8287115130262674, 0.5432767362630869, 0.9776831865016586, -1.0, -1.0, 0.5, -1.0, 0.9164074246565466, -1.0, 0.5393492701737108, 0.5, 0.7553150848691963, 0.5669122385824092, 0.9512432460719235, -1.0, 0.7703057924033074, 0.6008830837188892, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.57388160430616, 0.5, -1.0, 0.5, 0.622080970872081, 0.5, 0.7077313380797887, 0.6724241737075602, 0.5, 0.5, 0.8511928211567391, 0.894767966714274, 0.7637463434654803, 0.7508999593372818, -1.0], "episode_lengths": [15, 18, 16, 15, 14, 13, 49, 15, 15, 52, 11, 13, 80, 44, 13, 13, 14, 47, 31, 15, 13, 53, 15, 36, 14, 14, 53, 15, 54, 53, 49, 80, 80, 14, 13, 54, 39, 13, 50, 22, 14, 14, 14, 14, 49, 47, 49, 15, 13, 13, 25, 14, 13, 15, 80, 13, 42, 21, 55, 16, 13, 14, 15, 14, 14, 15, 14, 48, 36, 62, 13, 13, 80, 13, 16, 16, 80, 48, 13, 15, 46, 13, 13, 80, 80, 15, 80, 14, 80, 49, 14, 13, 55, 70, 17, 16, 13, 19, 17, 80, 80, 13, 80, 15, 80, 13, 25, 80, 28, 51, 54, 52, 58, 19, 13, 13, 53, 63, 14, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09304143284767136, "mean_inference_ms": 0.25677550574318125, "mean_action_processing_ms": 0.033094559786544686, "mean_env_wait_ms": 0.04717463102671903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016196568806966145, "StateBufferConnector_ms": 0.0013369321823120117, "ViewRequirementAgentConnector_ms": 0.029071370760599773}}, "episode_reward_max": 0.9776831865016586, "episode_reward_min": -1.0, "episode_reward_mean": 0.3415168593655881, "episode_len_mean": 33.275, "episodes_this_iter": 120, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, -1.0, 0.6104196642087383, 0.5, 0.603499694649908, 0.5, 0.5, -1.0, 0.926672888150128, -1.0, 0.7674778380031354, -1.0, 0.8362059647356995, 0.5137169466736957, 0.6941265352535109, 0.9313511920704042, 0.5512003053484764, 0.5, 0.5, 0.6930931913950432, 0.5, 0.7580864850673619, 0.6870867320047778, 0.9175108119467023, 0.8796888275226094, 0.7728934123654552, 0.5, 0.8941242778295978, 0.6671546379318745, 0.5, -1.0, -1.0, 0.5, 0.9424286038020269, 0.5, 0.6024998379969937, 0.9318083608244039, 0.5169588193428438, 0.5, 0.5, 0.9404615174020962, 0.5, 0.724385928138834, 0.7281367589115206, 0.6166549298193864, 0.9666836712623457, 0.651489835706381, 0.5014513142216175, 0.8498633987061488, 0.867894357801343, 0.5626530278626414, 0.5911232398706043, 0.634087414063486, -1.0, 0.5, 0.8894266852851276, 0.7670039250959625, 0.7009405544268719, 0.5, 0.7422452059586487, 0.6895898747706722, 0.5, 0.5, 0.6591445372222559, 0.7395039753381476, 0.7089251855352832, 0.5834336607370189, 0.6414972220574167, 0.9048131776297171, 0.5, 0.6158870448642235, -1.0, 0.5735222686923781, 0.5, -1.0, -1.0, 0.8302990771214439, 0.6669794759867671, 0.6491080783524941, 0.8287115130262674, 0.5432767362630869, 0.9776831865016586, -1.0, -1.0, 0.5, -1.0, 0.9164074246565466, -1.0, 0.5393492701737108, 0.5, 0.7553150848691963, 0.5669122385824092, 0.9512432460719235, -1.0, 0.7703057924033074, 0.6008830837188892, 0.5, -1.0, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, 0.57388160430616, 0.5, -1.0, 0.5, 0.622080970872081, 0.5, 0.7077313380797887, 0.6724241737075602, 0.5, 0.5, 0.8511928211567391, 0.894767966714274, 0.7637463434654803, 0.7508999593372818, -1.0], "episode_lengths": [15, 18, 16, 15, 14, 13, 49, 15, 15, 52, 11, 13, 80, 44, 13, 13, 14, 47, 31, 15, 13, 53, 15, 36, 14, 14, 53, 15, 54, 53, 49, 80, 80, 14, 13, 54, 39, 13, 50, 22, 14, 14, 14, 14, 49, 47, 49, 15, 13, 13, 25, 14, 13, 15, 80, 13, 42, 21, 55, 16, 13, 14, 15, 14, 14, 15, 14, 48, 36, 62, 13, 13, 80, 13, 16, 16, 80, 48, 13, 15, 46, 13, 13, 80, 80, 15, 80, 14, 80, 49, 14, 13, 55, 70, 17, 16, 13, 19, 17, 80, 80, 13, 80, 15, 80, 13, 25, 80, 28, 51, 54, 52, 58, 19, 13, 13, 53, 63, 14, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09304143284767136, "mean_inference_ms": 0.25677550574318125, "mean_action_processing_ms": 0.033094559786544686, "mean_env_wait_ms": 0.04717463102671903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016196568806966145, "StateBufferConnector_ms": 0.0013369321823120117, "ViewRequirementAgentConnector_ms": 0.029071370760599773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1072.6978229891715, "num_env_steps_trained_throughput_per_sec": 1072.6978229891715, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 3647.563, "sample_time_ms": 1719.557, "load_time_ms": 0.209, "load_throughput": 19160822.293, "learn_time_ms": 1926.81, "learn_throughput": 2075.971, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 7145, "training_iteration": 73, "trial_id": "default", "date": "2024-05-23_11-36-48", "timestamp": 1716457008, "time_this_iter_s": 3.731812000274658, "time_total_s": 266.87114357948303, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 266.87114357948303, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 27.483333333333334, "ram_util_percent": 56.96666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6258249566760115, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1994941645371978, "policy_loss": -0.005173455187249728, "vf_loss": 0.20438121358153, "vf_explained_var": 0.22396735997610195, "kl": 0.005728078838527756, "entropy": 0.6030899259351915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 68355.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 0.9964542686995458, "episode_reward_min": -1.0, "episode_reward_mean": 0.3057579353757304, "episode_len_mean": 35.469026548672566, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.8071788249323755, 0.58540832396146, 0.5, 0.5, -1.0, -1.0, 0.8398754962558267, -1.0, 0.5, 0.8002355811004308, 0.9859964174620223, 0.5226979506704341, -1.0, 0.5655267032127769, 0.5, 0.5, 0.5, -1.0, 0.8565205759418888, 0.5, 0.5, 0.5, 0.7674523857625108, -1.0, 0.5467820798843456, -1.0, 0.908569116505764, 0.5, 0.5, -1.0, -1.0, 0.5074903276166671, -1.0, 0.6221092469247357, -1.0, 0.8180514964596308, 0.9867126881695448, 0.5, 0.8775686712014252, 0.5, 0.5, -1.0, 0.5, 0.9186019496484967, -1.0, 0.8171355358501505, 0.7740952600721187, 0.5, -1.0, 0.8534857616811823, 0.7999417085992351, 0.5468340780932781, 0.5, 0.9158505834162467, 0.5, -1.0, -1.0, 0.6304751173153409, 0.5, 0.9483244742281958, 0.8035809828168006, 0.5, 0.8929727608198385, 0.6508113986737378, 0.5, 0.7691960339742174, 0.9397412805543629, 0.5104559914313718, 0.8410386059162114, 0.7434571687134538, 0.8655675125537134, 0.8771216942144195, 0.5, 0.8120055232112626, 0.5, 0.9964542686995458, -1.0, 0.7395736757004958, 0.985970304331374, 0.7265071670787762, 0.6953482523217434, 0.5871738235926918, 0.9808969654366961, 0.5, 0.5, 0.6602611601586661, 0.5984480271358734, 0.5, 0.6919425930164442, 0.7143697467423862, 0.8909631748925575, 0.881895304279625, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.8213115820786954, 0.7932542506696034, 0.6658948249665995, -1.0, 0.8414721759733359, 0.7579119495810986, -1.0, 0.8767336330752828, -1.0, 0.5, 0.5, 0.73539450988057], "episode_lengths": [38, 16, 14, 58, 15, 13, 62, 22, 52, 28, 14, 14, 47, 42, 80, 23, 14, 17, 59, 80, 13, 13, 32, 40, 49, 80, 14, 80, 50, 15, 13, 16, 80, 64, 80, 13, 16, 14, 13, 32, 71, 15, 26, 80, 61, 14, 80, 13, 58, 13, 80, 52, 52, 13, 13, 13, 14, 80, 80, 32, 13, 14, 13, 32, 13, 38, 15, 51, 13, 14, 13, 15, 45, 13, 15, 17, 15, 13, 80, 43, 49, 13, 30, 52, 50, 13, 28, 27, 15, 16, 74, 18, 13, 72, 80, 18, 80, 24, 20, 80, 80, 14, 44, 13, 80, 15, 48, 80, 14, 16, 26, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09304218739495183, "mean_inference_ms": 0.2567304342135488, "mean_action_processing_ms": 0.03308860048760483, "mean_env_wait_ms": 0.047167796672938446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015452899764069414, "StateBufferConnector_ms": 0.0012853504282183351, "ViewRequirementAgentConnector_ms": 0.028639346097422913}}, "episode_reward_max": 0.9964542686995458, "episode_reward_min": -1.0, "episode_reward_mean": 0.3057579353757304, "episode_len_mean": 35.469026548672566, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, -1.0, 0.8071788249323755, 0.58540832396146, 0.5, 0.5, -1.0, -1.0, 0.8398754962558267, -1.0, 0.5, 0.8002355811004308, 0.9859964174620223, 0.5226979506704341, -1.0, 0.5655267032127769, 0.5, 0.5, 0.5, -1.0, 0.8565205759418888, 0.5, 0.5, 0.5, 0.7674523857625108, -1.0, 0.5467820798843456, -1.0, 0.908569116505764, 0.5, 0.5, -1.0, -1.0, 0.5074903276166671, -1.0, 0.6221092469247357, -1.0, 0.8180514964596308, 0.9867126881695448, 0.5, 0.8775686712014252, 0.5, 0.5, -1.0, 0.5, 0.9186019496484967, -1.0, 0.8171355358501505, 0.7740952600721187, 0.5, -1.0, 0.8534857616811823, 0.7999417085992351, 0.5468340780932781, 0.5, 0.9158505834162467, 0.5, -1.0, -1.0, 0.6304751173153409, 0.5, 0.9483244742281958, 0.8035809828168006, 0.5, 0.8929727608198385, 0.6508113986737378, 0.5, 0.7691960339742174, 0.9397412805543629, 0.5104559914313718, 0.8410386059162114, 0.7434571687134538, 0.8655675125537134, 0.8771216942144195, 0.5, 0.8120055232112626, 0.5, 0.9964542686995458, -1.0, 0.7395736757004958, 0.985970304331374, 0.7265071670787762, 0.6953482523217434, 0.5871738235926918, 0.9808969654366961, 0.5, 0.5, 0.6602611601586661, 0.5984480271358734, 0.5, 0.6919425930164442, 0.7143697467423862, 0.8909631748925575, 0.881895304279625, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, -1.0, 0.8213115820786954, 0.7932542506696034, 0.6658948249665995, -1.0, 0.8414721759733359, 0.7579119495810986, -1.0, 0.8767336330752828, -1.0, 0.5, 0.5, 0.73539450988057], "episode_lengths": [38, 16, 14, 58, 15, 13, 62, 22, 52, 28, 14, 14, 47, 42, 80, 23, 14, 17, 59, 80, 13, 13, 32, 40, 49, 80, 14, 80, 50, 15, 13, 16, 80, 64, 80, 13, 16, 14, 13, 32, 71, 15, 26, 80, 61, 14, 80, 13, 58, 13, 80, 52, 52, 13, 13, 13, 14, 80, 80, 32, 13, 14, 13, 32, 13, 38, 15, 51, 13, 14, 13, 15, 45, 13, 15, 17, 15, 13, 80, 43, 49, 13, 30, 52, 50, 13, 28, 27, 15, 16, 74, 18, 13, 72, 80, 18, 80, 24, 20, 80, 80, 14, 44, 13, 80, 15, 48, 80, 14, 16, 26, 13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09304218739495183, "mean_inference_ms": 0.2567304342135488, "mean_action_processing_ms": 0.03308860048760483, "mean_env_wait_ms": 0.047167796672938446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015452899764069414, "StateBufferConnector_ms": 0.0012853504282183351, "ViewRequirementAgentConnector_ms": 0.028639346097422913}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1104.6352008475103, "num_env_steps_trained_throughput_per_sec": 1104.6352008475103, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 3638.281, "sample_time_ms": 1719.403, "load_time_ms": 0.216, "load_throughput": 18497481.808, "learn_time_ms": 1917.69, "learn_throughput": 2085.843, "synch_weights_time_ms": 0.639}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 7258, "training_iteration": 74, "trial_id": "default", "date": "2024-05-23_11-36-52", "timestamp": 1716457012, "time_this_iter_s": 3.624117136001587, "time_total_s": 270.4952607154846, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 270.4952607154846, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 14.279999999999998, "ram_util_percent": 56.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.817807335174212, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22321839429718512, "policy_loss": -0.0034692280184757964, "vf_loss": 0.22635029770273676, "vf_explained_var": 0.07470738516058974, "kl": 0.006746437909288606, "entropy": 0.5795532964250093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 69285.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 0.989703574278699, "episode_reward_min": -1.0, "episode_reward_mean": 0.3829146667254458, "episode_len_mean": 35.03508771929825, "episode_media": {}, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5478733814300855, 0.5, 0.667737685700995, 0.5, 0.9742619867256661, -1.0, 0.832994841645423, 0.5, 0.6985211002429549, 0.5, 0.5, -1.0, 0.574381727551106, 0.9049022921922628, 0.5461996491093655, 0.7918286905984531, -1.0, 0.5, 0.8990796160469352, 0.6718052577603326, -1.0, 0.9574921827172269, -1.0, 0.9616052166833055, -1.0, 0.7088893055583461, 0.9468805709623883, 0.5, -1.0, 0.7258860254432005, 0.9776611811394966, 0.5, 0.6458508074957976, -1.0, 0.5, 0.9020407504634964, 0.8838971967160164, 0.5046808280866745, -1.0, -1.0, 0.5, -1.0, 0.5, 0.6650515112110427, 0.7702755446455413, 0.8245720228979815, 0.8752055902656652, 0.5, 0.6208341462646371, -1.0, 0.6399257063591297, 0.5, 0.9891855775629483, -1.0, 0.5, 0.8429545535547593, 0.9863188279619077, 0.6108117016325657, 0.5, -1.0, 0.7877624650775803, 0.7957514903501373, 0.8293420626317125, 0.5, 0.5, 0.5, 0.989703574278699, 0.9797796717227073, -1.0, -1.0, 0.8505999418095284, 0.5, 0.847695141497784, 0.5712870248569555, 0.5, 0.8507444723294378, 0.6590663700789823, 0.644735787110805, 0.9004884421257328, 0.5, 0.7749968183733363, 0.6237819752786071, 0.87976164729408, 0.6862416975804773, 0.5, 0.7479954078134983, 0.5, 0.9249617218525921, 0.7010955106888368, -1.0, 0.5, 0.8046835203859016, 0.8573223139228807, 0.9416712742509629, 0.6735763833723536, 0.9870749821268218, 0.6142853971654394, 0.5857349937474001, 0.9536284462233446, 0.5, 0.5, 0.7250482054989142, 0.5950285543898077, 0.8466347509293699, -1.0, -1.0, -1.0, 0.7142558647959474, 0.5, 0.5, 0.7493496288765954, 0.8024867350512532, 0.6060942565866325, -1.0], "episode_lengths": [56, 51, 53, 19, 52, 80, 14, 13, 14, 62, 57, 80, 79, 13, 13, 13, 16, 74, 13, 45, 80, 46, 19, 15, 80, 65, 65, 14, 80, 55, 14, 13, 33, 80, 20, 46, 48, 35, 80, 80, 29, 80, 15, 39, 43, 14, 13, 18, 14, 80, 15, 13, 14, 80, 56, 14, 37, 13, 14, 80, 77, 13, 13, 16, 18, 21, 13, 14, 80, 11, 13, 13, 43, 14, 15, 13, 59, 13, 15, 15, 69, 13, 13, 13, 13, 14, 48, 44, 14, 31, 19, 13, 50, 13, 13, 14, 46, 13, 46, 16, 21, 36, 15, 49, 80, 27, 30, 32, 14, 56, 42, 13, 29, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303883216131062, "mean_inference_ms": 0.2566852620315383, "mean_action_processing_ms": 0.033082401945073774, "mean_env_wait_ms": 0.047160909329103905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015424008955035294, "StateBufferConnector_ms": 0.0012711474769993832, "ViewRequirementAgentConnector_ms": 0.02848537344681589}}, "episode_reward_max": 0.989703574278699, "episode_reward_min": -1.0, "episode_reward_mean": 0.3829146667254458, "episode_len_mean": 35.03508771929825, "episodes_this_iter": 114, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5478733814300855, 0.5, 0.667737685700995, 0.5, 0.9742619867256661, -1.0, 0.832994841645423, 0.5, 0.6985211002429549, 0.5, 0.5, -1.0, 0.574381727551106, 0.9049022921922628, 0.5461996491093655, 0.7918286905984531, -1.0, 0.5, 0.8990796160469352, 0.6718052577603326, -1.0, 0.9574921827172269, -1.0, 0.9616052166833055, -1.0, 0.7088893055583461, 0.9468805709623883, 0.5, -1.0, 0.7258860254432005, 0.9776611811394966, 0.5, 0.6458508074957976, -1.0, 0.5, 0.9020407504634964, 0.8838971967160164, 0.5046808280866745, -1.0, -1.0, 0.5, -1.0, 0.5, 0.6650515112110427, 0.7702755446455413, 0.8245720228979815, 0.8752055902656652, 0.5, 0.6208341462646371, -1.0, 0.6399257063591297, 0.5, 0.9891855775629483, -1.0, 0.5, 0.8429545535547593, 0.9863188279619077, 0.6108117016325657, 0.5, -1.0, 0.7877624650775803, 0.7957514903501373, 0.8293420626317125, 0.5, 0.5, 0.5, 0.989703574278699, 0.9797796717227073, -1.0, -1.0, 0.8505999418095284, 0.5, 0.847695141497784, 0.5712870248569555, 0.5, 0.8507444723294378, 0.6590663700789823, 0.644735787110805, 0.9004884421257328, 0.5, 0.7749968183733363, 0.6237819752786071, 0.87976164729408, 0.6862416975804773, 0.5, 0.7479954078134983, 0.5, 0.9249617218525921, 0.7010955106888368, -1.0, 0.5, 0.8046835203859016, 0.8573223139228807, 0.9416712742509629, 0.6735763833723536, 0.9870749821268218, 0.6142853971654394, 0.5857349937474001, 0.9536284462233446, 0.5, 0.5, 0.7250482054989142, 0.5950285543898077, 0.8466347509293699, -1.0, -1.0, -1.0, 0.7142558647959474, 0.5, 0.5, 0.7493496288765954, 0.8024867350512532, 0.6060942565866325, -1.0], "episode_lengths": [56, 51, 53, 19, 52, 80, 14, 13, 14, 62, 57, 80, 79, 13, 13, 13, 16, 74, 13, 45, 80, 46, 19, 15, 80, 65, 65, 14, 80, 55, 14, 13, 33, 80, 20, 46, 48, 35, 80, 80, 29, 80, 15, 39, 43, 14, 13, 18, 14, 80, 15, 13, 14, 80, 56, 14, 37, 13, 14, 80, 77, 13, 13, 16, 18, 21, 13, 14, 80, 11, 13, 13, 43, 14, 15, 13, 59, 13, 15, 15, 69, 13, 13, 13, 13, 14, 48, 44, 14, 31, 19, 13, 50, 13, 13, 14, 46, 13, 46, 16, 21, 36, 15, 49, 80, 27, 30, 32, 14, 56, 42, 13, 29, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09303883216131062, "mean_inference_ms": 0.2566852620315383, "mean_action_processing_ms": 0.033082401945073774, "mean_env_wait_ms": 0.047160909329103905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015424008955035294, "StateBufferConnector_ms": 0.0012711474769993832, "ViewRequirementAgentConnector_ms": 0.02848537344681589}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1103.6720684306026, "num_env_steps_trained_throughput_per_sec": 1103.6720684306026, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 3639.97, "sample_time_ms": 1719.021, "load_time_ms": 0.215, "load_throughput": 18583535.667, "learn_time_ms": 1919.766, "learn_throughput": 2083.587, "synch_weights_time_ms": 0.637}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 7372, "training_iteration": 75, "trial_id": "default", "date": "2024-05-23_11-36-55", "timestamp": 1716457015, "time_this_iter_s": 3.627166986465454, "time_total_s": 274.1224277019501, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 274.1224277019501, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 15.779999999999998, "ram_util_percent": 56.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5091576205145927, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21974314036096887, "policy_loss": -0.0040200541837401285, "vf_loss": 0.22345691150234592, "vf_explained_var": 0.4221332742962786, "kl": 0.006125670570387279, "entropy": 0.6354116240496277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 70215.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 0.9716695620693475, "episode_reward_min": -1.0, "episode_reward_mean": 0.16188130876091894, "episode_len_mean": 34.8, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5563988051504933, 0.914879107544635, 0.8012134836682256, 0.5, 0.788616460836265, 0.905561581306619, 0.5, -1.0, 0.6799609362461814, 0.5, 0.7201865645573069, 0.5, 0.7265353945958559, 0.855446522820949, 0.5, 0.6103635615204465, 0.7857834423319106, 0.6112052013478904, 0.9296138306205134, -1.0, 0.8346705030218119, 0.6036451127237552, -1.0, -1.0, 0.9556443969317133, 0.6983814368770407, 0.6902481496925914, -1.0, 0.5, -1.0, 0.5050474327503609, 0.5, -1.0, 0.7478161843436149, 0.9716695620693475, 0.5, -1.0, 0.8298006213531905, 0.5, 0.5721709582865865, 0.7107075715272462, -1.0, -1.0, 0.8031925448130001, 0.632024665407876, 0.5, -1.0, 0.5, -1.0, 0.9374083658881555, 0.7384584816702434, 0.6995287947099558, -1.0, 0.7894292275245018, 0.9121047404166243, -1.0, 0.6305054176526275, -1.0, 0.5, 0.570043710644321, 0.5, 0.5, -1.0, -1.0, 0.9397263838521109, -1.0, -1.0, 0.5, 0.6232692786082542, 0.8375820924631071, 0.669018689898361, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.7670157059615844, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8922527040061596, 0.8302824220621516, 0.5, 0.5, 0.5, -1.0, 0.5, 0.6302999670503591, 0.7265546355360767, -1.0, -1.0, 0.587729658819641, -1.0, 0.9668509210939902, 0.5539315863203866, 0.9275590298898643, 0.5, 0.5, 0.8651362987911215, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5600627694249454, 0.5208155928757097, 0.5], "episode_lengths": [80, 13, 32, 31, 41, 14, 14, 14, 80, 13, 16, 13, 20, 23, 14, 44, 32, 16, 14, 14, 80, 52, 16, 10, 80, 13, 15, 15, 26, 17, 80, 56, 16, 80, 50, 34, 21, 80, 14, 14, 43, 13, 24, 80, 67, 59, 15, 22, 14, 80, 13, 16, 55, 52, 14, 53, 65, 16, 80, 13, 21, 79, 13, 80, 80, 15, 80, 65, 13, 62, 13, 60, 28, 80, 14, 20, 80, 23, 13, 22, 80, 17, 9, 42, 80, 18, 80, 14, 36, 39, 14, 22, 20, 46, 13, 17, 35, 17, 14, 34, 15, 16, 13, 16, 14, 44, 15, 17, 13, 80, 16, 13, 35, 51, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930404559248714, "mean_inference_ms": 0.2566405562754431, "mean_action_processing_ms": 0.03307737979717445, "mean_env_wait_ms": 0.047153732669126376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015254642652428668, "StateBufferConnector_ms": 0.001322912133258322, "ViewRequirementAgentConnector_ms": 0.028607948966648266}}, "episode_reward_max": 0.9716695620693475, "episode_reward_min": -1.0, "episode_reward_mean": 0.16188130876091894, "episode_len_mean": 34.8, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5563988051504933, 0.914879107544635, 0.8012134836682256, 0.5, 0.788616460836265, 0.905561581306619, 0.5, -1.0, 0.6799609362461814, 0.5, 0.7201865645573069, 0.5, 0.7265353945958559, 0.855446522820949, 0.5, 0.6103635615204465, 0.7857834423319106, 0.6112052013478904, 0.9296138306205134, -1.0, 0.8346705030218119, 0.6036451127237552, -1.0, -1.0, 0.9556443969317133, 0.6983814368770407, 0.6902481496925914, -1.0, 0.5, -1.0, 0.5050474327503609, 0.5, -1.0, 0.7478161843436149, 0.9716695620693475, 0.5, -1.0, 0.8298006213531905, 0.5, 0.5721709582865865, 0.7107075715272462, -1.0, -1.0, 0.8031925448130001, 0.632024665407876, 0.5, -1.0, 0.5, -1.0, 0.9374083658881555, 0.7384584816702434, 0.6995287947099558, -1.0, 0.7894292275245018, 0.9121047404166243, -1.0, 0.6305054176526275, -1.0, 0.5, 0.570043710644321, 0.5, 0.5, -1.0, -1.0, 0.9397263838521109, -1.0, -1.0, 0.5, 0.6232692786082542, 0.8375820924631071, 0.669018689898361, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.7670157059615844, -1.0, -1.0, 0.5, -1.0, 0.5, -1.0, -1.0, -1.0, 0.8922527040061596, 0.8302824220621516, 0.5, 0.5, 0.5, -1.0, 0.5, 0.6302999670503591, 0.7265546355360767, -1.0, -1.0, 0.587729658819641, -1.0, 0.9668509210939902, 0.5539315863203866, 0.9275590298898643, 0.5, 0.5, 0.8651362987911215, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5, 0.5600627694249454, 0.5208155928757097, 0.5], "episode_lengths": [80, 13, 32, 31, 41, 14, 14, 14, 80, 13, 16, 13, 20, 23, 14, 44, 32, 16, 14, 14, 80, 52, 16, 10, 80, 13, 15, 15, 26, 17, 80, 56, 16, 80, 50, 34, 21, 80, 14, 14, 43, 13, 24, 80, 67, 59, 15, 22, 14, 80, 13, 16, 55, 52, 14, 53, 65, 16, 80, 13, 21, 79, 13, 80, 80, 15, 80, 65, 13, 62, 13, 60, 28, 80, 14, 20, 80, 23, 13, 22, 80, 17, 9, 42, 80, 18, 80, 14, 36, 39, 14, 22, 20, 46, 13, 17, 35, 17, 14, 34, 15, 16, 13, 16, 14, 44, 15, 17, 13, 80, 16, 13, 35, 51, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0930404559248714, "mean_inference_ms": 0.2566405562754431, "mean_action_processing_ms": 0.03307737979717445, "mean_env_wait_ms": 0.047153732669126376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015254642652428668, "StateBufferConnector_ms": 0.001322912133258322, "ViewRequirementAgentConnector_ms": 0.028607948966648266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1106.4364729841923, "num_env_steps_trained_throughput_per_sec": 1106.4364729841923, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 3638.811, "sample_time_ms": 1718.53, "load_time_ms": 0.213, "load_throughput": 18768560.242, "learn_time_ms": 1919.099, "learn_throughput": 2084.312, "synch_weights_time_ms": 0.64}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 7487, "training_iteration": 76, "trial_id": "default", "date": "2024-05-23_11-36-59", "timestamp": 1716457019, "time_this_iter_s": 3.6180622577667236, "time_total_s": 277.7404899597168, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 277.7404899597168, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.4, "ram_util_percent": 56.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3178085890508466, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23705443956636352, "policy_loss": -0.004837866319764045, "vf_loss": 0.24154082885192288, "vf_explained_var": 0.08479905205388223, "kl": 0.007029529278966188, "entropy": 0.6054662162257779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 71145.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 0.9864737559979486, "episode_reward_min": -1.0, "episode_reward_mean": 0.23179911375763568, "episode_len_mean": 32.83471074380165, "episode_media": {}, "episodes_this_iter": 121, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7583439436400006, 0.5, 0.9596059891263732, -1.0, 0.5, 0.5578481652296086, 0.9570172569573727, -1.0, 0.5547201249083695, 0.5, -1.0, 0.5, 0.5, 0.5588619089396627, 0.5, -1.0, 0.6721102191883532, 0.6324087940101392, 0.7144186942880086, 0.7678258104264238, -1.0, 0.5021017573410971, -1.0, 0.5, 0.5, -1.0, -1.0, 0.6434728557390412, 0.9864737559979486, 0.5610856774413796, -1.0, 0.5, 0.5, 0.5, 0.7893922470345531, 0.9261695828980914, 0.538400575516702, 0.5, 0.5831646453161105, 0.5, 0.7048252881384683, 0.9318313235132365, 0.6954942250820308, 0.6572988750585936, 0.6020997162491104, 0.9143913365320406, 0.8423174280868094, 0.80043985961559, 0.8898767081776524, 0.9034183693847352, 0.7355931977601201, -1.0, -1.0, -1.0, -1.0, 0.7693229762202808, 0.7314667671022286, 0.5, 0.8053160879011038, -1.0, 0.7621646391298578, 0.8730256785799906, 0.8340031042769314, 0.5, 0.5, 0.6309665436987177, -1.0, 0.5, -1.0, 0.6256830455722806, 0.5, 0.5, 0.7410686700790584, 0.6719419443325365, 0.8498684358940061, 0.8058871563138859, -1.0, 0.7903252536751217, 0.5, 0.5, 0.5, 0.5125358857166845, -1.0, 0.9225781209756189, -1.0, 0.5705631035315977, -1.0, 0.8240014591308451, 0.5, -1.0, -1.0, 0.542850035618647, 0.6863765730201983, 0.5, 0.5, 0.7732475589075651, 0.6838455703175907, -1.0, -1.0, 0.9801838598971, -1.0, 0.5, 0.5, 0.6134844167566484, -1.0, -1.0, 0.5, 0.6564207751703569, -1.0, 0.5563679098480504, 0.7632425767017537, 0.583567834040004, 0.5, 0.8166183685789113, -1.0, 0.5, 0.5, -1.0, 0.9817279303583748, -1.0, 0.8480321517303494], "episode_lengths": [34, 14, 14, 80, 40, 60, 13, 11, 16, 16, 9, 14, 74, 13, 14, 18, 42, 54, 47, 53, 16, 15, 80, 41, 14, 80, 15, 13, 43, 13, 80, 14, 14, 35, 16, 14, 13, 36, 13, 15, 42, 13, 15, 42, 13, 78, 13, 14, 14, 46, 14, 80, 80, 17, 80, 77, 13, 14, 14, 80, 14, 14, 43, 56, 16, 13, 21, 16, 80, 26, 23, 31, 70, 42, 13, 14, 80, 52, 31, 54, 20, 13, 59, 46, 15, 49, 80, 15, 15, 80, 80, 46, 15, 13, 61, 43, 18, 16, 19, 13, 17, 17, 19, 18, 16, 80, 14, 14, 16, 42, 14, 33, 13, 13, 16, 15, 13, 80, 15, 55, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09317590756224207, "mean_inference_ms": 0.257007292364546, "mean_action_processing_ms": 0.03311058153127343, "mean_env_wait_ms": 0.04722209018251978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016898163094008264, "StateBufferConnector_ms": 0.0014482450879309788, "ViewRequirementAgentConnector_ms": 0.03138790445879471}}, "episode_reward_max": 0.9864737559979486, "episode_reward_min": -1.0, "episode_reward_mean": 0.23179911375763568, "episode_len_mean": 32.83471074380165, "episodes_this_iter": 121, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7583439436400006, 0.5, 0.9596059891263732, -1.0, 0.5, 0.5578481652296086, 0.9570172569573727, -1.0, 0.5547201249083695, 0.5, -1.0, 0.5, 0.5, 0.5588619089396627, 0.5, -1.0, 0.6721102191883532, 0.6324087940101392, 0.7144186942880086, 0.7678258104264238, -1.0, 0.5021017573410971, -1.0, 0.5, 0.5, -1.0, -1.0, 0.6434728557390412, 0.9864737559979486, 0.5610856774413796, -1.0, 0.5, 0.5, 0.5, 0.7893922470345531, 0.9261695828980914, 0.538400575516702, 0.5, 0.5831646453161105, 0.5, 0.7048252881384683, 0.9318313235132365, 0.6954942250820308, 0.6572988750585936, 0.6020997162491104, 0.9143913365320406, 0.8423174280868094, 0.80043985961559, 0.8898767081776524, 0.9034183693847352, 0.7355931977601201, -1.0, -1.0, -1.0, -1.0, 0.7693229762202808, 0.7314667671022286, 0.5, 0.8053160879011038, -1.0, 0.7621646391298578, 0.8730256785799906, 0.8340031042769314, 0.5, 0.5, 0.6309665436987177, -1.0, 0.5, -1.0, 0.6256830455722806, 0.5, 0.5, 0.7410686700790584, 0.6719419443325365, 0.8498684358940061, 0.8058871563138859, -1.0, 0.7903252536751217, 0.5, 0.5, 0.5, 0.5125358857166845, -1.0, 0.9225781209756189, -1.0, 0.5705631035315977, -1.0, 0.8240014591308451, 0.5, -1.0, -1.0, 0.542850035618647, 0.6863765730201983, 0.5, 0.5, 0.7732475589075651, 0.6838455703175907, -1.0, -1.0, 0.9801838598971, -1.0, 0.5, 0.5, 0.6134844167566484, -1.0, -1.0, 0.5, 0.6564207751703569, -1.0, 0.5563679098480504, 0.7632425767017537, 0.583567834040004, 0.5, 0.8166183685789113, -1.0, 0.5, 0.5, -1.0, 0.9817279303583748, -1.0, 0.8480321517303494], "episode_lengths": [34, 14, 14, 80, 40, 60, 13, 11, 16, 16, 9, 14, 74, 13, 14, 18, 42, 54, 47, 53, 16, 15, 80, 41, 14, 80, 15, 13, 43, 13, 80, 14, 14, 35, 16, 14, 13, 36, 13, 15, 42, 13, 15, 42, 13, 78, 13, 14, 14, 46, 14, 80, 80, 17, 80, 77, 13, 14, 14, 80, 14, 14, 43, 56, 16, 13, 21, 16, 80, 26, 23, 31, 70, 42, 13, 14, 80, 52, 31, 54, 20, 13, 59, 46, 15, 49, 80, 15, 15, 80, 80, 46, 15, 13, 61, 43, 18, 16, 19, 13, 17, 17, 19, 18, 16, 80, 14, 14, 16, 42, 14, 33, 13, 13, 16, 15, 13, 80, 15, 55, 53]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09317590756224207, "mean_inference_ms": 0.257007292364546, "mean_action_processing_ms": 0.03311058153127343, "mean_env_wait_ms": 0.04722209018251978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016898163094008264, "StateBufferConnector_ms": 0.0014482450879309788, "ViewRequirementAgentConnector_ms": 0.03138790445879471}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1045.816482483906, "num_env_steps_trained_throughput_per_sec": 1045.816482483906, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 3658.507, "sample_time_ms": 1738.811, "load_time_ms": 0.213, "load_throughput": 18751778.25, "learn_time_ms": 1918.514, "learn_throughput": 2084.947, "synch_weights_time_ms": 0.642}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 7608, "training_iteration": 77, "trial_id": "default", "date": "2024-05-23_11-37-03", "timestamp": 1716457023, "time_this_iter_s": 3.827610731124878, "time_total_s": 281.5681006908417, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 281.5681006908417, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 31.579999999999995, "ram_util_percent": 57.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.864149784849536, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23075247624186768, "policy_loss": -0.006299084929689285, "vf_loss": 0.23664220305940797, "vf_explained_var": 0.16057315904607056, "kl": 0.008187154401001586, "entropy": 0.6042063738069227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 72075.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 0.9952954921172564, "episode_reward_min": -1.0, "episode_reward_mean": 0.32782659819623017, "episode_len_mean": 35.45132743362832, "episode_media": {}, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.8035912041321864, 0.7399416058092125, -1.0, 0.8826476770794363, 0.5, 0.7020819917589505, 0.5, 0.8277895695070645, 0.9296070366464417, 0.6444476020864827, 0.5, 0.9524300544397328, 0.5, 0.6258886984911631, 0.9561762130191024, 0.5, -1.0, 0.9851552637131916, 0.5, 0.5, -1.0, 0.6621123708642521, 0.9342627662340034, -1.0, 0.5, 0.5, 0.9097047569416579, -1.0, 0.8772097394298526, 0.7587894262725011, 0.5, 0.8217453101975052, 0.5786865963028823, 0.5, 0.5, 0.6212827989880927, 0.5, 0.5255354665375014, -1.0, 0.7721814295619261, -1.0, -1.0, 0.8565730114239544, 0.5, 0.7579993879307126, 0.5, 0.5481807099786795, -1.0, 0.7614752539549778, 0.9898860487193255, 0.5, -1.0, 0.8329474032351746, 0.66639472179324, 0.9797633227589561, 0.6784073877578889, 0.6550383490749832, 0.8655578601616237, 0.9255651931680857, 0.7247173896344312, 0.5, 0.8363464143341772, -1.0, 0.7360740715649148, 0.5, 0.8796756480556779, 0.5, 0.7446863272035218, 0.5548445336126351, -1.0, 0.9052569763197366, -1.0, 0.6870507528590957, 0.5, 0.5929469696112238, 0.9386340954499914, 0.5, 0.7640094024156976, 0.8016014731905615, 0.5, 0.9120084110504663, 0.9542369554252693, -1.0, 0.9952954921172564, 0.5, 0.5, 0.5, 0.6955049713541686, 0.5, 0.6810412793604841, -1.0, 0.5, -1.0, 0.6090703169685505, 0.5, -1.0, 0.93790076904902, -1.0, 0.5, 0.9735793539951569, 0.5255911881303716, 0.5, -1.0, 0.9489887530340276, 0.7924608269539775, -1.0, 0.7706587414158622, -1.0, 0.5, 0.5531682550969903, -1.0], "episode_lengths": [80, 22, 25, 44, 76, 13, 18, 79, 16, 14, 14, 13, 41, 13, 52, 13, 13, 13, 80, 47, 14, 14, 80, 15, 13, 80, 13, 14, 30, 15, 14, 14, 14, 73, 14, 13, 13, 33, 36, 49, 9, 16, 80, 29, 47, 14, 16, 36, 14, 80, 45, 49, 37, 12, 35, 42, 52, 34, 36, 13, 18, 55, 14, 37, 80, 15, 29, 14, 48, 35, 17, 80, 45, 80, 39, 77, 14, 13, 14, 13, 14, 14, 38, 15, 80, 14, 47, 14, 26, 43, 22, 13, 80, 15, 80, 46, 30, 80, 43, 80, 47, 46, 13, 21, 80, 40, 36, 80, 13, 36, 27, 13, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09317547174122563, "mean_inference_ms": 0.2569748722355071, "mean_action_processing_ms": 0.03310444580430444, "mean_env_wait_ms": 0.04721627171269037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001577571430037507, "StateBufferConnector_ms": 0.0012811306303581306, "ViewRequirementAgentConnector_ms": 0.02870939474190231}}, "episode_reward_max": 0.9952954921172564, "episode_reward_min": -1.0, "episode_reward_mean": 0.32782659819623017, "episode_len_mean": 35.45132743362832, "episodes_this_iter": 113, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, -1.0, 0.8035912041321864, 0.7399416058092125, -1.0, 0.8826476770794363, 0.5, 0.7020819917589505, 0.5, 0.8277895695070645, 0.9296070366464417, 0.6444476020864827, 0.5, 0.9524300544397328, 0.5, 0.6258886984911631, 0.9561762130191024, 0.5, -1.0, 0.9851552637131916, 0.5, 0.5, -1.0, 0.6621123708642521, 0.9342627662340034, -1.0, 0.5, 0.5, 0.9097047569416579, -1.0, 0.8772097394298526, 0.7587894262725011, 0.5, 0.8217453101975052, 0.5786865963028823, 0.5, 0.5, 0.6212827989880927, 0.5, 0.5255354665375014, -1.0, 0.7721814295619261, -1.0, -1.0, 0.8565730114239544, 0.5, 0.7579993879307126, 0.5, 0.5481807099786795, -1.0, 0.7614752539549778, 0.9898860487193255, 0.5, -1.0, 0.8329474032351746, 0.66639472179324, 0.9797633227589561, 0.6784073877578889, 0.6550383490749832, 0.8655578601616237, 0.9255651931680857, 0.7247173896344312, 0.5, 0.8363464143341772, -1.0, 0.7360740715649148, 0.5, 0.8796756480556779, 0.5, 0.7446863272035218, 0.5548445336126351, -1.0, 0.9052569763197366, -1.0, 0.6870507528590957, 0.5, 0.5929469696112238, 0.9386340954499914, 0.5, 0.7640094024156976, 0.8016014731905615, 0.5, 0.9120084110504663, 0.9542369554252693, -1.0, 0.9952954921172564, 0.5, 0.5, 0.5, 0.6955049713541686, 0.5, 0.6810412793604841, -1.0, 0.5, -1.0, 0.6090703169685505, 0.5, -1.0, 0.93790076904902, -1.0, 0.5, 0.9735793539951569, 0.5255911881303716, 0.5, -1.0, 0.9489887530340276, 0.7924608269539775, -1.0, 0.7706587414158622, -1.0, 0.5, 0.5531682550969903, -1.0], "episode_lengths": [80, 22, 25, 44, 76, 13, 18, 79, 16, 14, 14, 13, 41, 13, 52, 13, 13, 13, 80, 47, 14, 14, 80, 15, 13, 80, 13, 14, 30, 15, 14, 14, 14, 73, 14, 13, 13, 33, 36, 49, 9, 16, 80, 29, 47, 14, 16, 36, 14, 80, 45, 49, 37, 12, 35, 42, 52, 34, 36, 13, 18, 55, 14, 37, 80, 15, 29, 14, 48, 35, 17, 80, 45, 80, 39, 77, 14, 13, 14, 13, 14, 14, 38, 15, 80, 14, 47, 14, 26, 43, 22, 13, 80, 15, 80, 46, 30, 80, 43, 80, 47, 46, 13, 21, 80, 40, 36, 80, 13, 36, 27, 13, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09317547174122563, "mean_inference_ms": 0.2569748722355071, "mean_action_processing_ms": 0.03310444580430444, "mean_env_wait_ms": 0.04721627171269037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001577571430037507, "StateBufferConnector_ms": 0.0012811306303581306, "ViewRequirementAgentConnector_ms": 0.02870939474190231}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1079.5055198716989, "num_env_steps_trained_throughput_per_sec": 1079.5055198716989, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 3667.065, "sample_time_ms": 1739.599, "load_time_ms": 0.215, "load_throughput": 18635139.398, "learn_time_ms": 1926.265, "learn_throughput": 2076.558, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 7721, "training_iteration": 78, "trial_id": "default", "date": "2024-05-23_11-37-07", "timestamp": 1716457027, "time_this_iter_s": 3.708343982696533, "time_total_s": 285.2764446735382, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 285.2764446735382, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 18.75, "ram_util_percent": 56.96666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.982574332273135, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.29233747254456244, "policy_loss": -0.003358088181384148, "vf_loss": 0.29540492113559474, "vf_explained_var": 0.11716641392759097, "kl": 0.0058128320535746495, "entropy": 0.6032426166918969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73005.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 0.9992097496338134, "episode_reward_min": -1.0, "episode_reward_mean": 0.24668371943903822, "episode_len_mean": 36.481818181818184, "episode_media": {}, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7719121107124965, 0.9509459386441859, 0.5, -1.0, 0.8961097782056998, 0.5, 0.6347233074860146, -1.0, 0.5, 0.9992097496338134, 0.810601835933249, 0.5, -1.0, 0.9857351059982319, 0.5, 0.8541509953357705, 0.5267283884516964, 0.9874974278656001, 0.696230179354746, -1.0, 0.5, 0.7851011810182627, 0.8457457581976893, 0.599223595417231, 0.6398764123019742, 0.5771072948078133, 0.9971666919918063, 0.7244531980966924, -1.0, 0.8052205457671363, -1.0, 0.5, 0.6108936136847534, 0.5, 0.9809890044932681, 0.6962288324644474, -1.0, -1.0, 0.8430640804439595, 0.8068517551904757, 0.5, 0.5, 0.6269178715494851, -1.0, 0.5, -1.0, -1.0, 0.8601913069453858, 0.6366021868422235, 0.5, -1.0, 0.5567897377992461, 0.5392504679621256, 0.5, -1.0, 0.5589952980774195, 0.6296894321553519, 0.9735089779517689, -1.0, -1.0, 0.5, 0.8712313363090908, -1.0, -1.0, 0.7102757265946834, 0.5, 0.6739417025857224, 0.6375786763587975, 0.5, -1.0, -1.0, 0.6996584138982933, -1.0, -1.0, 0.6074850252814554, 0.5, -1.0, 0.5, 0.5, 0.6904880403010677, -1.0, 0.5, 0.5, 0.5, 0.5898586748287207, 0.7706151544482578, 0.749867239315253, 0.671224770009824, 0.6714205470930156, 0.5, 0.7778945925579778, 0.564812258225839, 0.5, 0.7138840518139432, 0.8710396453495038, -1.0, 0.9115530527224728, -1.0, 0.5, 0.6699555399492492, 0.5524824433426092, 0.5, 0.5246477342580271, 0.5, -1.0, 0.5, 0.5, -1.0, 0.7975824522703806, 0.5], "episode_lengths": [44, 45, 29, 80, 31, 45, 13, 80, 68, 42, 14, 15, 80, 35, 34, 47, 44, 13, 44, 20, 14, 14, 14, 46, 15, 24, 45, 49, 80, 13, 80, 47, 16, 20, 13, 51, 80, 17, 13, 14, 36, 16, 36, 21, 13, 80, 16, 15, 13, 15, 80, 43, 18, 16, 80, 15, 13, 62, 15, 80, 13, 14, 16, 80, 13, 13, 15, 13, 13, 80, 80, 58, 80, 80, 39, 39, 21, 45, 27, 13, 38, 78, 41, 15, 13, 47, 46, 13, 45, 29, 65, 50, 30, 16, 71, 28, 14, 80, 29, 35, 17, 15, 41, 13, 80, 15, 14, 80, 14, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09317038422527557, "mean_inference_ms": 0.2569280790117196, "mean_action_processing_ms": 0.033098952055681356, "mean_env_wait_ms": 0.04720894671039189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014632398431951349, "StateBufferConnector_ms": 0.0012891942804509943, "ViewRequirementAgentConnector_ms": 0.028465877879749645}}, "episode_reward_max": 0.9992097496338134, "episode_reward_min": -1.0, "episode_reward_mean": 0.24668371943903822, "episode_len_mean": 36.481818181818184, "episodes_this_iter": 110, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7719121107124965, 0.9509459386441859, 0.5, -1.0, 0.8961097782056998, 0.5, 0.6347233074860146, -1.0, 0.5, 0.9992097496338134, 0.810601835933249, 0.5, -1.0, 0.9857351059982319, 0.5, 0.8541509953357705, 0.5267283884516964, 0.9874974278656001, 0.696230179354746, -1.0, 0.5, 0.7851011810182627, 0.8457457581976893, 0.599223595417231, 0.6398764123019742, 0.5771072948078133, 0.9971666919918063, 0.7244531980966924, -1.0, 0.8052205457671363, -1.0, 0.5, 0.6108936136847534, 0.5, 0.9809890044932681, 0.6962288324644474, -1.0, -1.0, 0.8430640804439595, 0.8068517551904757, 0.5, 0.5, 0.6269178715494851, -1.0, 0.5, -1.0, -1.0, 0.8601913069453858, 0.6366021868422235, 0.5, -1.0, 0.5567897377992461, 0.5392504679621256, 0.5, -1.0, 0.5589952980774195, 0.6296894321553519, 0.9735089779517689, -1.0, -1.0, 0.5, 0.8712313363090908, -1.0, -1.0, 0.7102757265946834, 0.5, 0.6739417025857224, 0.6375786763587975, 0.5, -1.0, -1.0, 0.6996584138982933, -1.0, -1.0, 0.6074850252814554, 0.5, -1.0, 0.5, 0.5, 0.6904880403010677, -1.0, 0.5, 0.5, 0.5, 0.5898586748287207, 0.7706151544482578, 0.749867239315253, 0.671224770009824, 0.6714205470930156, 0.5, 0.7778945925579778, 0.564812258225839, 0.5, 0.7138840518139432, 0.8710396453495038, -1.0, 0.9115530527224728, -1.0, 0.5, 0.6699555399492492, 0.5524824433426092, 0.5, 0.5246477342580271, 0.5, -1.0, 0.5, 0.5, -1.0, 0.7975824522703806, 0.5], "episode_lengths": [44, 45, 29, 80, 31, 45, 13, 80, 68, 42, 14, 15, 80, 35, 34, 47, 44, 13, 44, 20, 14, 14, 14, 46, 15, 24, 45, 49, 80, 13, 80, 47, 16, 20, 13, 51, 80, 17, 13, 14, 36, 16, 36, 21, 13, 80, 16, 15, 13, 15, 80, 43, 18, 16, 80, 15, 13, 62, 15, 80, 13, 14, 16, 80, 13, 13, 15, 13, 13, 80, 80, 58, 80, 80, 39, 39, 21, 45, 27, 13, 38, 78, 41, 15, 13, 47, 46, 13, 45, 29, 65, 50, 30, 16, 71, 28, 14, 80, 29, 35, 17, 15, 41, 13, 80, 15, 14, 80, 14, 18]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09317038422527557, "mean_inference_ms": 0.2569280790117196, "mean_action_processing_ms": 0.033098952055681356, "mean_env_wait_ms": 0.04720894671039189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014632398431951349, "StateBufferConnector_ms": 0.0012891942804509943, "ViewRequirementAgentConnector_ms": 0.028465877879749645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1104.511936040912, "num_env_steps_trained_throughput_per_sec": 1104.511936040912, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 3667.599, "sample_time_ms": 1740.556, "load_time_ms": 0.214, "load_throughput": 18730842.916, "learn_time_ms": 1925.842, "learn_throughput": 2077.013, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 7831, "training_iteration": 79, "trial_id": "default", "date": "2024-05-23_11-37-10", "timestamp": 1716457030, "time_this_iter_s": 3.624297857284546, "time_total_s": 288.90074253082275, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 288.90074253082275, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 13.9, "ram_util_percent": 56.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4396285884482887, "cur_kl_coeff": 0.05000000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2157511968994, "policy_loss": -0.00022108367574150844, "vf_loss": 0.21572350113782832, "vf_explained_var": 0.08532566107729429, "kl": 0.004975679124671881, "entropy": 0.61021015676119, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 73935.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 0.9937528952899416, "episode_reward_min": -1.0, "episode_reward_mean": 0.3083234260705851, "episode_len_mean": 37.120370370370374, "episode_media": {}, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5434244669481698, -1.0, 0.5, 0.5, 0.6626675585399491, 0.5176682040336087, 0.5, -1.0, 0.7270440109344578, -1.0, 0.5, 0.5, 0.5378809182428038, 0.5, 0.5, 0.708816918747686, 0.5218161298600827, 0.9655192040185732, 0.716721420984896, 0.944772496224654, 0.694143522887165, -1.0, -1.0, 0.7688044991200911, 0.5, -1.0, 0.9195651509698742, 0.6224266168337552, 0.7854706356255454, 0.5, 0.5718591606106529, 0.5, 0.5, 0.595618201175246, 0.808341391216356, 0.6295589604881355, 0.6085157272481918, 0.8207864633797047, 0.5, -1.0, 0.8609622435455881, 0.9108682217382805, 0.8566319610392628, 0.5, 0.5856489647298486, 0.5410877694094818, 0.5, -1.0, -1.0, 0.9420274025499253, 0.8527178192164451, 0.7683442567866102, -1.0, 0.6800063642240958, 0.7424603452321548, 0.7178956395181189, 0.989096514664808, 0.5, 0.9857705510521841, 0.5839832846715887, 0.5774586833857072, 0.9015118058683195, 0.9824266376605426, -1.0, 0.7430522921209888, 0.5, 0.7014361034107514, 0.5, 0.8857709862130535, -1.0, 0.8822298977246027, 0.6620177711068767, 0.870359825721356, 0.8159847520501549, 0.8418201907613007, 0.7753412533714455, 0.9766797096437755, 0.7264870927733217, 0.6939848879555286, 0.9491693906360361, -1.0, 0.7909948345679086, -1.0, -1.0, 0.6052090215304123, 0.606087601040977, -1.0, -1.0, 0.7948425278116266, 0.8150077874964388, -1.0, -1.0, -1.0, -1.0, 0.540377188674072, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.7349697238132362, 0.9937528952899416, 0.5, 0.7430341585268224, -1.0, 0.5], "episode_lengths": [80, 36, 80, 25, 14, 15, 14, 15, 80, 13, 80, 43, 15, 13, 39, 23, 39, 15, 13, 13, 79, 14, 46, 75, 38, 32, 80, 19, 13, 43, 43, 14, 22, 16, 14, 14, 69, 15, 36, 28, 13, 32, 14, 36, 39, 15, 38, 45, 80, 80, 15, 44, 44, 80, 14, 13, 51, 48, 39, 41, 32, 14, 52, 14, 57, 13, 14, 45, 64, 14, 80, 13, 14, 15, 58, 15, 41, 16, 14, 43, 60, 80, 38, 56, 80, 14, 15, 80, 80, 13, 13, 80, 80, 80, 80, 14, 16, 13, 14, 42, 14, 80, 14, 15, 22, 14, 80, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0931582706167496, "mean_inference_ms": 0.2568876680247682, "mean_action_processing_ms": 0.03309172779562603, "mean_env_wait_ms": 0.04719682264490276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001517931620279948, "StateBufferConnector_ms": 0.0012845904738814742, "ViewRequirementAgentConnector_ms": 0.028582193233348704}}, "episode_reward_max": 0.9937528952899416, "episode_reward_min": -1.0, "episode_reward_mean": 0.3083234260705851, "episode_len_mean": 37.120370370370374, "episodes_this_iter": 108, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5434244669481698, -1.0, 0.5, 0.5, 0.6626675585399491, 0.5176682040336087, 0.5, -1.0, 0.7270440109344578, -1.0, 0.5, 0.5, 0.5378809182428038, 0.5, 0.5, 0.708816918747686, 0.5218161298600827, 0.9655192040185732, 0.716721420984896, 0.944772496224654, 0.694143522887165, -1.0, -1.0, 0.7688044991200911, 0.5, -1.0, 0.9195651509698742, 0.6224266168337552, 0.7854706356255454, 0.5, 0.5718591606106529, 0.5, 0.5, 0.595618201175246, 0.808341391216356, 0.6295589604881355, 0.6085157272481918, 0.8207864633797047, 0.5, -1.0, 0.8609622435455881, 0.9108682217382805, 0.8566319610392628, 0.5, 0.5856489647298486, 0.5410877694094818, 0.5, -1.0, -1.0, 0.9420274025499253, 0.8527178192164451, 0.7683442567866102, -1.0, 0.6800063642240958, 0.7424603452321548, 0.7178956395181189, 0.989096514664808, 0.5, 0.9857705510521841, 0.5839832846715887, 0.5774586833857072, 0.9015118058683195, 0.9824266376605426, -1.0, 0.7430522921209888, 0.5, 0.7014361034107514, 0.5, 0.8857709862130535, -1.0, 0.8822298977246027, 0.6620177711068767, 0.870359825721356, 0.8159847520501549, 0.8418201907613007, 0.7753412533714455, 0.9766797096437755, 0.7264870927733217, 0.6939848879555286, 0.9491693906360361, -1.0, 0.7909948345679086, -1.0, -1.0, 0.6052090215304123, 0.606087601040977, -1.0, -1.0, 0.7948425278116266, 0.8150077874964388, -1.0, -1.0, -1.0, -1.0, 0.540377188674072, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.7349697238132362, 0.9937528952899416, 0.5, 0.7430341585268224, -1.0, 0.5], "episode_lengths": [80, 36, 80, 25, 14, 15, 14, 15, 80, 13, 80, 43, 15, 13, 39, 23, 39, 15, 13, 13, 79, 14, 46, 75, 38, 32, 80, 19, 13, 43, 43, 14, 22, 16, 14, 14, 69, 15, 36, 28, 13, 32, 14, 36, 39, 15, 38, 45, 80, 80, 15, 44, 44, 80, 14, 13, 51, 48, 39, 41, 32, 14, 52, 14, 57, 13, 14, 45, 64, 14, 80, 13, 14, 15, 58, 15, 41, 16, 14, 43, 60, 80, 38, 56, 80, 14, 15, 80, 80, 13, 13, 80, 80, 80, 80, 14, 16, 13, 14, 42, 14, 80, 14, 15, 22, 14, 80, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0931582706167496, "mean_inference_ms": 0.2568876680247682, "mean_action_processing_ms": 0.03309172779562603, "mean_env_wait_ms": 0.04719682264490276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001517931620279948, "StateBufferConnector_ms": 0.0012845904738814742, "ViewRequirementAgentConnector_ms": 0.028582193233348704}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.501494561435, "num_env_steps_trained_throughput_per_sec": 1101.501494561435, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 3669.523, "sample_time_ms": 1741.419, "load_time_ms": 0.216, "load_throughput": 18511768.73, "learn_time_ms": 1926.907, "learn_throughput": 2075.866, "synch_weights_time_ms": 0.646}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 7939, "training_iteration": 80, "trial_id": "default", "date": "2024-05-23_11-37-14", "timestamp": 1716457034, "time_this_iter_s": 3.634305000305176, "time_total_s": 292.53504753112793, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 292.53504753112793, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 10.76, "ram_util_percent": 56.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.061332596181541, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20804604203740676, "policy_loss": -0.004346586227096537, "vf_loss": 0.2121773487277409, "vf_explained_var": 0.12846623236133206, "kl": 0.008611235329712245, "entropy": 0.6239871802189016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 74865.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 0.9976741699235268, "episode_reward_min": -1.0, "episode_reward_mean": 0.4227881578975695, "episode_len_mean": 29.154411764705884, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.898529412986296, 0.9041290843759024, 0.830477946285209, -1.0, 0.5, 0.5, 0.6760131777874059, -1.0, 0.5, 0.8722073411631948, 0.5260421162717448, 0.7837490651842287, 0.679034591515168, 0.7678488376641728, 0.6570921057878543, 0.6588173638180106, 0.5551790086819126, 0.9190800111766455, -1.0, 0.9488975068714661, 0.8220022420100319, 0.6192091868383145, 0.5, 0.6816617207593483, 0.9400465339708397, -1.0, 0.9739883438478175, 0.8792225616266999, 0.5, 0.9911638520462442, -1.0, 0.8567580489605735, 0.9126951202757986, 0.7753924289728972, 0.5, -1.0, 0.5, 0.5, 0.6886140166343326, 0.5, -1.0, 0.6482094790741268, 0.5, -1.0, 0.5540438265803118, -1.0, 0.8075681726788988, -1.0, 0.6265914541973154, 0.5, 0.5, 0.855690331080733, 0.7289646981863233, 0.5, 0.6297373994322082, 0.9918823629515457, 0.5392186619939239, 0.6021528984027483, -1.0, 0.5, 0.9976741699235268, 0.5, 0.6026223919309809, 0.7312842136653496, 0.5, 0.5, 0.5, 0.5, 0.9354108572762445, 0.8333133672351158, 0.5, -1.0, 0.7701207746757629, 0.755130730658069, -1.0, 0.7195052847413782, 0.7070637243816058, -1.0, -1.0, 0.55011268023922, 0.9684257454492697, 0.9833605307294404, 0.9338344332231657, -1.0, 0.9418377155986399, 0.5164172889453851, -1.0, 0.6168702464148259, 0.5, 0.8443579840106666, 0.8363547893439426, 0.5, 0.7371566589334266, 0.6613612189264858, 0.5314843606575136, 0.7716222337113924, 0.5, 0.8353486165038764, 0.5200161608262485, 0.5, 0.5, 0.5, 0.5, 0.5393451974263657, 0.8450446547992212, 0.5, 0.5, 0.6186114464356609, 0.5, 0.9923168533262361, 0.5, -1.0, 0.7904871376844597, 0.8976779219382982, 0.5, 0.5, 0.7221000512048105, 0.6087659180465302, 0.9485989977022319, 0.5, 0.5052449383621296, 0.5895112749041147, 0.5, 0.6474528913016895, -1.0, -1.0, 0.5123900800478922, 0.5, 0.955049580732587, 0.5, 0.9359974695882621, 0.5, 0.6562523195253959, 0.5445774696121856, 0.5, 0.5871681833396001], "episode_lengths": [14, 18, 30, 48, 38, 14, 39, 72, 14, 36, 37, 43, 13, 14, 13, 14, 15, 14, 16, 13, 15, 13, 32, 17, 13, 80, 14, 43, 51, 13, 21, 14, 13, 15, 31, 80, 13, 30, 13, 15, 17, 14, 15, 15, 16, 48, 41, 77, 13, 14, 14, 14, 14, 40, 14, 40, 13, 46, 19, 31, 15, 14, 17, 13, 14, 38, 41, 14, 38, 47, 16, 80, 43, 14, 80, 44, 15, 44, 80, 15, 16, 13, 15, 80, 32, 35, 25, 16, 16, 49, 42, 32, 17, 41, 46, 44, 13, 13, 15, 25, 70, 24, 13, 13, 13, 41, 15, 35, 15, 14, 48, 80, 13, 13, 44, 36, 14, 21, 13, 13, 13, 47, 14, 24, 80, 80, 16, 26, 15, 46, 44, 14, 65, 14, 41, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09319978076130281, "mean_inference_ms": 0.2569497001574694, "mean_action_processing_ms": 0.03309326421831089, "mean_env_wait_ms": 0.04720523769979323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001583555165459128, "StateBufferConnector_ms": 0.0013226971906774184, "ViewRequirementAgentConnector_ms": 0.028824104982263902}}, "episode_reward_max": 0.9976741699235268, "episode_reward_min": -1.0, "episode_reward_mean": 0.4227881578975695, "episode_len_mean": 29.154411764705884, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.898529412986296, 0.9041290843759024, 0.830477946285209, -1.0, 0.5, 0.5, 0.6760131777874059, -1.0, 0.5, 0.8722073411631948, 0.5260421162717448, 0.7837490651842287, 0.679034591515168, 0.7678488376641728, 0.6570921057878543, 0.6588173638180106, 0.5551790086819126, 0.9190800111766455, -1.0, 0.9488975068714661, 0.8220022420100319, 0.6192091868383145, 0.5, 0.6816617207593483, 0.9400465339708397, -1.0, 0.9739883438478175, 0.8792225616266999, 0.5, 0.9911638520462442, -1.0, 0.8567580489605735, 0.9126951202757986, 0.7753924289728972, 0.5, -1.0, 0.5, 0.5, 0.6886140166343326, 0.5, -1.0, 0.6482094790741268, 0.5, -1.0, 0.5540438265803118, -1.0, 0.8075681726788988, -1.0, 0.6265914541973154, 0.5, 0.5, 0.855690331080733, 0.7289646981863233, 0.5, 0.6297373994322082, 0.9918823629515457, 0.5392186619939239, 0.6021528984027483, -1.0, 0.5, 0.9976741699235268, 0.5, 0.6026223919309809, 0.7312842136653496, 0.5, 0.5, 0.5, 0.5, 0.9354108572762445, 0.8333133672351158, 0.5, -1.0, 0.7701207746757629, 0.755130730658069, -1.0, 0.7195052847413782, 0.7070637243816058, -1.0, -1.0, 0.55011268023922, 0.9684257454492697, 0.9833605307294404, 0.9338344332231657, -1.0, 0.9418377155986399, 0.5164172889453851, -1.0, 0.6168702464148259, 0.5, 0.8443579840106666, 0.8363547893439426, 0.5, 0.7371566589334266, 0.6613612189264858, 0.5314843606575136, 0.7716222337113924, 0.5, 0.8353486165038764, 0.5200161608262485, 0.5, 0.5, 0.5, 0.5, 0.5393451974263657, 0.8450446547992212, 0.5, 0.5, 0.6186114464356609, 0.5, 0.9923168533262361, 0.5, -1.0, 0.7904871376844597, 0.8976779219382982, 0.5, 0.5, 0.7221000512048105, 0.6087659180465302, 0.9485989977022319, 0.5, 0.5052449383621296, 0.5895112749041147, 0.5, 0.6474528913016895, -1.0, -1.0, 0.5123900800478922, 0.5, 0.955049580732587, 0.5, 0.9359974695882621, 0.5, 0.6562523195253959, 0.5445774696121856, 0.5, 0.5871681833396001], "episode_lengths": [14, 18, 30, 48, 38, 14, 39, 72, 14, 36, 37, 43, 13, 14, 13, 14, 15, 14, 16, 13, 15, 13, 32, 17, 13, 80, 14, 43, 51, 13, 21, 14, 13, 15, 31, 80, 13, 30, 13, 15, 17, 14, 15, 15, 16, 48, 41, 77, 13, 14, 14, 14, 14, 40, 14, 40, 13, 46, 19, 31, 15, 14, 17, 13, 14, 38, 41, 14, 38, 47, 16, 80, 43, 14, 80, 44, 15, 44, 80, 15, 16, 13, 15, 80, 32, 35, 25, 16, 16, 49, 42, 32, 17, 41, 46, 44, 13, 13, 15, 25, 70, 24, 13, 13, 13, 41, 15, 35, 15, 14, 48, 80, 13, 13, 44, 36, 14, 21, 13, 13, 13, 47, 14, 24, 80, 80, 16, 26, 15, 46, 44, 14, 65, 14, 41, 45]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09319978076130281, "mean_inference_ms": 0.2569497001574694, "mean_action_processing_ms": 0.03309326421831089, "mean_env_wait_ms": 0.04720523769979323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001583555165459128, "StateBufferConnector_ms": 0.0013226971906774184, "ViewRequirementAgentConnector_ms": 0.028824104982263902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1085.5706885581985, "num_env_steps_trained_throughput_per_sec": 1085.5706885581985, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3667.677, "sample_time_ms": 1747.603, "load_time_ms": 0.22, "load_throughput": 18174862.962, "learn_time_ms": 1918.881, "learn_throughput": 2084.549, "synch_weights_time_ms": 0.643}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 8075, "training_iteration": 81, "trial_id": "default", "date": "2024-05-23_11-37-18", "timestamp": 1716457038, "time_this_iter_s": 3.687858819961548, "time_total_s": 296.2229063510895, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 296.2229063510895, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 11.96, "ram_util_percent": 56.879999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.587024534004991, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17982103934908042, "policy_loss": -0.006499560137269317, "vf_loss": 0.18615039247338488, "vf_explained_var": 0.11513146975988983, "kl": 0.00680825130475601, "entropy": 0.6059703449728668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 75795.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 0.9940060790476515, "episode_reward_min": -1.0, "episode_reward_mean": 0.3458013321483978, "episode_len_mean": 30.12686567164179, "episode_media": {}, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7363576468351107, 0.5575051256081793, -1.0, 0.5, 0.5, 0.7410385591826228, 0.5092570694076198, -1.0, 0.5, 0.6896603849254579, 0.7199187393727704, -1.0, 0.7121921212802549, 0.6946180758085119, 0.5951998405402144, 0.6337773089215455, 0.77182168242033, 0.5, 0.7118970715068731, 0.5, 0.8326609165650696, 0.5, -1.0, 0.889733020318336, 0.5, 0.7015752685558786, 0.5, 0.516070045402367, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5768183403717313, 0.7503506887902378, 0.5, 0.5494786648967283, 0.6476689638506354, 0.6924417381859607, 0.9446079657618586, 0.8207787801245161, 0.6492764679818799, 0.7400491319800235, 0.5, 0.781967245644159, 0.5, 0.5114022780590846, -1.0, 0.8073437205124093, 0.5, -1.0, 0.7539317367558058, 0.5, 0.5, 0.895816359613754, 0.8450125789312536, 0.5, 0.7849143431508646, 0.7276943289476945, 0.5, 0.8060079827452292, 0.6889162273840348, 0.5, 0.6604813658786804, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.6035907375128968, -1.0, 0.5, 0.5, 0.5, 0.8251282525819499, 0.5, 0.8546829493167439, 0.6803136698563828, 0.5, 0.5891989457947691, 0.8528366355818381, 0.7147236487786204, 0.6920403710722096, 0.5, 0.8609193628035279, 0.5, -1.0, 0.5, 0.5, 0.8055991453520018, -1.0, 0.8052158834566958, 0.5744724423519841, -1.0, 0.5, 0.5395072689159444, -1.0, 0.9688998437004457, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.7336583437109656, 0.5, 0.6547877629605756, 0.9940060790476515, 0.8237584597398714, 0.5, 0.8407109726758024, 0.5, 0.5, -1.0, 0.5978878897920936, 0.5, 0.5493497849021222, 0.5, -1.0, 0.659891815133178, 0.5, 0.7079552499792757, 0.5516805014215573, 0.558721488730846, -1.0, -1.0, 0.9675580710161193, -1.0, 0.5, 0.6232547839841223, -1.0, 0.5587863614974277], "episode_lengths": [53, 36, 80, 34, 16, 18, 14, 80, 14, 15, 13, 80, 58, 14, 20, 38, 13, 15, 14, 41, 15, 14, 80, 13, 19, 13, 15, 35, 34, 42, 32, 53, 33, 77, 14, 14, 40, 15, 13, 13, 13, 13, 15, 35, 23, 45, 15, 35, 80, 52, 14, 40, 13, 13, 17, 13, 48, 42, 15, 14, 40, 13, 27, 14, 41, 80, 46, 18, 80, 72, 23, 13, 19, 22, 15, 15, 13, 14, 13, 42, 13, 13, 13, 14, 13, 14, 47, 41, 80, 16, 15, 14, 17, 13, 34, 80, 45, 14, 41, 14, 14, 80, 33, 15, 16, 36, 14, 16, 38, 19, 13, 13, 15, 19, 15, 80, 13, 72, 19, 31, 9, 38, 14, 13, 14, 26, 73, 16, 41, 73, 14, 66, 80, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09321989664756279, "mean_inference_ms": 0.25691900195406875, "mean_action_processing_ms": 0.033088455270673944, "mean_env_wait_ms": 0.04720215609873785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015132462800438724, "StateBufferConnector_ms": 0.0013008046506056145, "ViewRequirementAgentConnector_ms": 0.0287354882083722}}, "episode_reward_max": 0.9940060790476515, "episode_reward_min": -1.0, "episode_reward_mean": 0.3458013321483978, "episode_len_mean": 30.12686567164179, "episodes_this_iter": 134, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7363576468351107, 0.5575051256081793, -1.0, 0.5, 0.5, 0.7410385591826228, 0.5092570694076198, -1.0, 0.5, 0.6896603849254579, 0.7199187393727704, -1.0, 0.7121921212802549, 0.6946180758085119, 0.5951998405402144, 0.6337773089215455, 0.77182168242033, 0.5, 0.7118970715068731, 0.5, 0.8326609165650696, 0.5, -1.0, 0.889733020318336, 0.5, 0.7015752685558786, 0.5, 0.516070045402367, 0.5, 0.5, 0.5, 0.5, 0.5, -1.0, 0.5768183403717313, 0.7503506887902378, 0.5, 0.5494786648967283, 0.6476689638506354, 0.6924417381859607, 0.9446079657618586, 0.8207787801245161, 0.6492764679818799, 0.7400491319800235, 0.5, 0.781967245644159, 0.5, 0.5114022780590846, -1.0, 0.8073437205124093, 0.5, -1.0, 0.7539317367558058, 0.5, 0.5, 0.895816359613754, 0.8450125789312536, 0.5, 0.7849143431508646, 0.7276943289476945, 0.5, 0.8060079827452292, 0.6889162273840348, 0.5, 0.6604813658786804, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.6035907375128968, -1.0, 0.5, 0.5, 0.5, 0.8251282525819499, 0.5, 0.8546829493167439, 0.6803136698563828, 0.5, 0.5891989457947691, 0.8528366355818381, 0.7147236487786204, 0.6920403710722096, 0.5, 0.8609193628035279, 0.5, -1.0, 0.5, 0.5, 0.8055991453520018, -1.0, 0.8052158834566958, 0.5744724423519841, -1.0, 0.5, 0.5395072689159444, -1.0, 0.9688998437004457, 0.5, -1.0, 0.5, -1.0, -1.0, 0.5, 0.7336583437109656, 0.5, 0.6547877629605756, 0.9940060790476515, 0.8237584597398714, 0.5, 0.8407109726758024, 0.5, 0.5, -1.0, 0.5978878897920936, 0.5, 0.5493497849021222, 0.5, -1.0, 0.659891815133178, 0.5, 0.7079552499792757, 0.5516805014215573, 0.558721488730846, -1.0, -1.0, 0.9675580710161193, -1.0, 0.5, 0.6232547839841223, -1.0, 0.5587863614974277], "episode_lengths": [53, 36, 80, 34, 16, 18, 14, 80, 14, 15, 13, 80, 58, 14, 20, 38, 13, 15, 14, 41, 15, 14, 80, 13, 19, 13, 15, 35, 34, 42, 32, 53, 33, 77, 14, 14, 40, 15, 13, 13, 13, 13, 15, 35, 23, 45, 15, 35, 80, 52, 14, 40, 13, 13, 17, 13, 48, 42, 15, 14, 40, 13, 27, 14, 41, 80, 46, 18, 80, 72, 23, 13, 19, 22, 15, 15, 13, 14, 13, 42, 13, 13, 13, 14, 13, 14, 47, 41, 80, 16, 15, 14, 17, 13, 34, 80, 45, 14, 41, 14, 14, 80, 33, 15, 16, 36, 14, 16, 38, 19, 13, 13, 15, 19, 15, 80, 13, 72, 19, 31, 9, 38, 14, 13, 14, 26, 73, 16, 41, 73, 14, 66, 80, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09321989664756279, "mean_inference_ms": 0.25691900195406875, "mean_action_processing_ms": 0.033088455270673944, "mean_env_wait_ms": 0.04720215609873785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015132462800438724, "StateBufferConnector_ms": 0.0013008046506056145, "ViewRequirementAgentConnector_ms": 0.0287354882083722}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1096.6962915316813, "num_env_steps_trained_throughput_per_sec": 1096.6962915316813, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 3670.445, "sample_time_ms": 1750.065, "load_time_ms": 0.22, "load_throughput": 18166990.796, "learn_time_ms": 1919.177, "learn_throughput": 2084.227, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 8209, "training_iteration": 82, "trial_id": "default", "date": "2024-05-23_11-37-21", "timestamp": 1716457041, "time_this_iter_s": 3.6503312587738037, "time_total_s": 299.8732376098633, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 299.8732376098633, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.183333333333334, "ram_util_percent": 56.81666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.236694436432213, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19210555718070077, "policy_loss": -0.01757194873255988, "vf_loss": 0.20945726718393065, "vf_explained_var": 0.05214476713570215, "kl": 0.008809500781237217, "entropy": 0.6253194732050742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 76725.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 0.9942411441464454, "episode_reward_min": -1.0, "episode_reward_mean": 0.386481293284415, "episode_len_mean": 31.181102362204726, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.9126963913922003, 0.918778188705891, 0.7216779041175272, 0.8810312421015487, 0.8215246751242069, 0.6707490638380258, 0.8163460934021081, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.9581479009547903, 0.5, 0.5, 0.5392779560211574, -1.0, 0.77896841330721, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7880436146934187, 0.5138143198907674, -1.0, 0.5, 0.7914839199515417, 0.8415803313526663, 0.5, 0.5, 0.8744669469751285, 0.6934819791835415, 0.5560479599220198, 0.8868315993665676, 0.5420667408989923, -1.0, 0.5, 0.5, -1.0, 0.9497982771685717, 0.519863267248394, 0.5, 0.5083921600937775, 0.6183257849868327, 0.5, 0.9406177434422949, 0.5, 0.7553137782089571, 0.5, 0.9672193316735223, 0.7284619809637727, 0.9317229062181049, 0.7735604474112455, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5539855133668926, 0.9927232674434789, 0.6725458683310914, 0.5, 0.6413688165281533, 0.5, 0.9942411441464454, 0.6011350081996791, 0.5, 0.9099750814204646, 0.7054935580694897, 0.5191184214621754, 0.5, 0.5, 0.5, -1.0, -1.0, 0.7287878656717984, 0.5, 0.5, -1.0, 0.5, 0.5, 0.7803522759074744, 0.5, 0.7696950262743238, 0.5, 0.5, 0.8629679697827686, 0.6868972838354569, -1.0, 0.7999014748372464, 0.5, -1.0, 0.7636224242230816, 0.5, -1.0, -1.0, 0.5, 0.5, 0.9087128084806766, 0.758042078360802, -1.0, 0.5, 0.5, 0.5141736799672147, 0.5, 0.5, 0.5, 0.5, 0.8569954761880543, 0.8804480732510668, 0.5, -1.0, 0.5, 0.5, 0.5931443260735083, 0.5, 0.9677064865442292, 0.6083535619052695, -1.0, 0.8124458382350831, 0.5], "episode_lengths": [13, 13, 13, 13, 55, 71, 45, 38, 66, 18, 80, 13, 13, 18, 48, 15, 17, 39, 26, 39, 25, 13, 13, 14, 49, 22, 18, 53, 15, 80, 13, 14, 46, 14, 24, 13, 13, 13, 52, 14, 42, 13, 46, 18, 13, 13, 17, 13, 77, 16, 14, 16, 29, 24, 13, 67, 16, 41, 80, 46, 31, 36, 80, 26, 53, 46, 13, 16, 13, 14, 13, 13, 16, 13, 51, 13, 79, 15, 16, 80, 17, 13, 17, 27, 16, 15, 18, 77, 16, 53, 14, 14, 13, 14, 80, 13, 74, 80, 53, 14, 43, 80, 14, 14, 43, 43, 80, 18, 31, 14, 29, 14, 14, 15, 14, 18, 65, 80, 14, 13, 47, 17, 13, 38, 80, 35, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09322885287084452, "mean_inference_ms": 0.256884642787522, "mean_action_processing_ms": 0.03308236257320019, "mean_env_wait_ms": 0.047197176060544216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015668043001430241, "StateBufferConnector_ms": 0.0012788246935746801, "ViewRequirementAgentConnector_ms": 0.028454975819024515}}, "episode_reward_max": 0.9942411441464454, "episode_reward_min": -1.0, "episode_reward_mean": 0.386481293284415, "episode_len_mean": 31.181102362204726, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.9126963913922003, 0.918778188705891, 0.7216779041175272, 0.8810312421015487, 0.8215246751242069, 0.6707490638380258, 0.8163460934021081, -1.0, 0.5, -1.0, 0.5, 0.5, -1.0, 0.9581479009547903, 0.5, 0.5, 0.5392779560211574, -1.0, 0.77896841330721, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7880436146934187, 0.5138143198907674, -1.0, 0.5, 0.7914839199515417, 0.8415803313526663, 0.5, 0.5, 0.8744669469751285, 0.6934819791835415, 0.5560479599220198, 0.8868315993665676, 0.5420667408989923, -1.0, 0.5, 0.5, -1.0, 0.9497982771685717, 0.519863267248394, 0.5, 0.5083921600937775, 0.6183257849868327, 0.5, 0.9406177434422949, 0.5, 0.7553137782089571, 0.5, 0.9672193316735223, 0.7284619809637727, 0.9317229062181049, 0.7735604474112455, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.5539855133668926, 0.9927232674434789, 0.6725458683310914, 0.5, 0.6413688165281533, 0.5, 0.9942411441464454, 0.6011350081996791, 0.5, 0.9099750814204646, 0.7054935580694897, 0.5191184214621754, 0.5, 0.5, 0.5, -1.0, -1.0, 0.7287878656717984, 0.5, 0.5, -1.0, 0.5, 0.5, 0.7803522759074744, 0.5, 0.7696950262743238, 0.5, 0.5, 0.8629679697827686, 0.6868972838354569, -1.0, 0.7999014748372464, 0.5, -1.0, 0.7636224242230816, 0.5, -1.0, -1.0, 0.5, 0.5, 0.9087128084806766, 0.758042078360802, -1.0, 0.5, 0.5, 0.5141736799672147, 0.5, 0.5, 0.5, 0.5, 0.8569954761880543, 0.8804480732510668, 0.5, -1.0, 0.5, 0.5, 0.5931443260735083, 0.5, 0.9677064865442292, 0.6083535619052695, -1.0, 0.8124458382350831, 0.5], "episode_lengths": [13, 13, 13, 13, 55, 71, 45, 38, 66, 18, 80, 13, 13, 18, 48, 15, 17, 39, 26, 39, 25, 13, 13, 14, 49, 22, 18, 53, 15, 80, 13, 14, 46, 14, 24, 13, 13, 13, 52, 14, 42, 13, 46, 18, 13, 13, 17, 13, 77, 16, 14, 16, 29, 24, 13, 67, 16, 41, 80, 46, 31, 36, 80, 26, 53, 46, 13, 16, 13, 14, 13, 13, 16, 13, 51, 13, 79, 15, 16, 80, 17, 13, 17, 27, 16, 15, 18, 77, 16, 53, 14, 14, 13, 14, 80, 13, 74, 80, 53, 14, 43, 80, 14, 14, 43, 43, 80, 18, 31, 14, 29, 14, 14, 15, 14, 18, 65, 80, 14, 13, 47, 17, 13, 38, 80, 35, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09322885287084452, "mean_inference_ms": 0.256884642787522, "mean_action_processing_ms": 0.03308236257320019, "mean_env_wait_ms": 0.047197176060544216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015668043001430241, "StateBufferConnector_ms": 0.0012788246935746801, "ViewRequirementAgentConnector_ms": 0.028454975819024515}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.7737536279303, "num_env_steps_trained_throughput_per_sec": 1098.7737536279303, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 3661.596, "sample_time_ms": 1746.615, "load_time_ms": 0.213, "load_throughput": 18747587.44, "learn_time_ms": 1913.792, "learn_throughput": 2090.092, "synch_weights_time_ms": 0.649}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 8336, "training_iteration": 83, "trial_id": "default", "date": "2024-05-23_11-37-25", "timestamp": 1716457045, "time_this_iter_s": 3.6434342861175537, "time_total_s": 303.51667189598083, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 303.51667189598083, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.080000000000002, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8580433655650386, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19501362825460328, "policy_loss": -0.00399339055662514, "vf_loss": 0.19884902570516833, "vf_explained_var": 0.22476835904582854, "kl": 0.006319702634141093, "entropy": 0.6173689711157994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 77655.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 0.9941154226227464, "episode_reward_min": -1.0, "episode_reward_mean": 0.3402806273648979, "episode_len_mean": 33.09836065573771, "episode_media": {}, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.6398316711375288, 0.5, -1.0, 0.6385066440197353, 0.6185548705025129, 0.7815311131665846, 0.8631573948625966, 0.8475485412655014, 0.719483443217512, -1.0, -1.0, 0.5414704340053547, 0.5, 0.5945893039572665, 0.8791813673170599, 0.8445815852507831, 0.861508997855844, 0.8164317379571985, 0.5, 0.5, 0.6630668632706285, -1.0, -1.0, 0.7979953749469941, 0.7814451637544392, -1.0, 0.9372759202627947, 0.8250087401474618, 0.5, 0.9305927973652987, -1.0, -1.0, 0.5, 0.6923476514027025, -1.0, -1.0, 0.8278379049008259, 0.5, 0.8662512571730665, 0.8995365562456071, 0.6928732734016758, -1.0, 0.7387155484733545, 0.7352330826597491, 0.9941154226227464, -1.0, 0.9831728003081727, 0.5751788545564969, 0.7638776910574686, -1.0, 0.6633070846331317, 0.5220451885256832, 0.6341493233079984, 0.8774884536679358, 0.7164749991761085, 0.6370271798503442, 0.539649036182473, 0.5, -1.0, 0.5, -1.0, 0.7390781611800661, 0.9744066543965615, 0.819095066746264, 0.5, 0.5, 0.9443182843834451, 0.9641742709381584, 0.5, 0.6982754265194717, 0.943259997598941, 0.6423022214137782, 0.673996328480682, 0.9195062634932399, 0.5, -1.0, 0.5730488731458798, 0.5, 0.5, -1.0, 0.9188089584781042, 0.6323662700876802, 0.6881441520223208, 0.5, 0.816853947750749, 0.8350353631777746, 0.5, 0.7469880016372474, -1.0, 0.5, 0.689687054064386, 0.9317127120034537, 0.6325507086783964, 0.7492148706442701, 0.5726762941011068, -1.0, 0.7355799288449252, 0.7962351056915169, -1.0, 0.5, 0.5, -1.0, -1.0, 0.7796531924693162, -1.0, 0.5514285169638977, 0.7043505047036143, -1.0, 0.8005831288962146, 0.8494121546617, 0.5, -1.0, 0.5, 0.9857856621825085, 0.6211666308715005, 0.9829802014268748, 0.6933787573203236, 0.9185252127872788, 0.5289063120963761, 0.8046329254481107, 0.7150751508027768], "episode_lengths": [80, 13, 19, 16, 66, 14, 36, 13, 13, 14, 11, 80, 15, 29, 13, 73, 44, 47, 13, 13, 15, 18, 80, 80, 50, 13, 80, 13, 15, 39, 14, 18, 16, 15, 14, 16, 80, 48, 14, 31, 13, 13, 77, 13, 14, 50, 79, 35, 15, 13, 80, 14, 14, 47, 64, 18, 54, 14, 35, 13, 15, 80, 40, 13, 14, 13, 14, 13, 15, 13, 14, 14, 48, 41, 13, 13, 25, 51, 14, 14, 43, 78, 45, 13, 14, 47, 13, 13, 14, 73, 23, 14, 48, 13, 54, 15, 80, 13, 13, 80, 20, 14, 80, 80, 41, 80, 14, 70, 80, 13, 45, 30, 80, 33, 55, 13, 13, 13, 42, 14, 46, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09323212217442836, "mean_inference_ms": 0.2568405332542061, "mean_action_processing_ms": 0.0330774885295101, "mean_env_wait_ms": 0.047189937511410276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015561697912997888, "StateBufferConnector_ms": 0.0013054394331134733, "ViewRequirementAgentConnector_ms": 0.02854476209546699}}, "episode_reward_max": 0.9941154226227464, "episode_reward_min": -1.0, "episode_reward_mean": 0.3402806273648979, "episode_len_mean": 33.09836065573771, "episodes_this_iter": 122, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.6398316711375288, 0.5, -1.0, 0.6385066440197353, 0.6185548705025129, 0.7815311131665846, 0.8631573948625966, 0.8475485412655014, 0.719483443217512, -1.0, -1.0, 0.5414704340053547, 0.5, 0.5945893039572665, 0.8791813673170599, 0.8445815852507831, 0.861508997855844, 0.8164317379571985, 0.5, 0.5, 0.6630668632706285, -1.0, -1.0, 0.7979953749469941, 0.7814451637544392, -1.0, 0.9372759202627947, 0.8250087401474618, 0.5, 0.9305927973652987, -1.0, -1.0, 0.5, 0.6923476514027025, -1.0, -1.0, 0.8278379049008259, 0.5, 0.8662512571730665, 0.8995365562456071, 0.6928732734016758, -1.0, 0.7387155484733545, 0.7352330826597491, 0.9941154226227464, -1.0, 0.9831728003081727, 0.5751788545564969, 0.7638776910574686, -1.0, 0.6633070846331317, 0.5220451885256832, 0.6341493233079984, 0.8774884536679358, 0.7164749991761085, 0.6370271798503442, 0.539649036182473, 0.5, -1.0, 0.5, -1.0, 0.7390781611800661, 0.9744066543965615, 0.819095066746264, 0.5, 0.5, 0.9443182843834451, 0.9641742709381584, 0.5, 0.6982754265194717, 0.943259997598941, 0.6423022214137782, 0.673996328480682, 0.9195062634932399, 0.5, -1.0, 0.5730488731458798, 0.5, 0.5, -1.0, 0.9188089584781042, 0.6323662700876802, 0.6881441520223208, 0.5, 0.816853947750749, 0.8350353631777746, 0.5, 0.7469880016372474, -1.0, 0.5, 0.689687054064386, 0.9317127120034537, 0.6325507086783964, 0.7492148706442701, 0.5726762941011068, -1.0, 0.7355799288449252, 0.7962351056915169, -1.0, 0.5, 0.5, -1.0, -1.0, 0.7796531924693162, -1.0, 0.5514285169638977, 0.7043505047036143, -1.0, 0.8005831288962146, 0.8494121546617, 0.5, -1.0, 0.5, 0.9857856621825085, 0.6211666308715005, 0.9829802014268748, 0.6933787573203236, 0.9185252127872788, 0.5289063120963761, 0.8046329254481107, 0.7150751508027768], "episode_lengths": [80, 13, 19, 16, 66, 14, 36, 13, 13, 14, 11, 80, 15, 29, 13, 73, 44, 47, 13, 13, 15, 18, 80, 80, 50, 13, 80, 13, 15, 39, 14, 18, 16, 15, 14, 16, 80, 48, 14, 31, 13, 13, 77, 13, 14, 50, 79, 35, 15, 13, 80, 14, 14, 47, 64, 18, 54, 14, 35, 13, 15, 80, 40, 13, 14, 13, 14, 13, 15, 13, 14, 14, 48, 41, 13, 13, 25, 51, 14, 14, 43, 78, 45, 13, 14, 47, 13, 13, 14, 73, 23, 14, 48, 13, 54, 15, 80, 13, 13, 80, 20, 14, 80, 80, 41, 80, 14, 70, 80, 13, 45, 30, 80, 33, 55, 13, 13, 13, 42, 14, 46, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09323212217442836, "mean_inference_ms": 0.2568405332542061, "mean_action_processing_ms": 0.0330774885295101, "mean_env_wait_ms": 0.047189937511410276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015561697912997888, "StateBufferConnector_ms": 0.0013054394331134733, "ViewRequirementAgentConnector_ms": 0.02854476209546699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1100.0903430267942, "num_env_steps_trained_throughput_per_sec": 1100.0903430267942, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 3663.092, "sample_time_ms": 1746.657, "load_time_ms": 0.206, "load_throughput": 19402354.574, "learn_time_ms": 1915.25, "learn_throughput": 2088.501, "synch_weights_time_ms": 0.653}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 8458, "training_iteration": 84, "trial_id": "default", "date": "2024-05-23_11-37-29", "timestamp": 1716457049, "time_this_iter_s": 3.6390531063079834, "time_total_s": 307.1557250022888, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 307.1557250022888, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 17.62, "ram_util_percent": 56.78000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.26299082199412, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21398054793707386, "policy_loss": -0.002726073585130194, "vf_loss": 0.2165236287499948, "vf_explained_var": 0.19806712929920484, "kl": 0.007319649381505704, "entropy": 0.6124790940874366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 78585.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 0.9920464852460373, "episode_reward_min": -1.0, "episode_reward_mean": 0.322889686984337, "episode_len_mean": 30.607692307692307, "episode_media": {}, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.6887743611650831, -1.0, -1.0, -1.0, 0.6049030214611428, -1.0, 0.5, 0.755630374921361, 0.5342348055167432, -1.0, 0.7886592269353565, 0.951113026147074, -1.0, 0.6523723956092685, 0.6733949229349356, 0.5, -1.0, 0.5, 0.7858391032495529, -1.0, 0.5, -1.0, 0.7936842519343265, 0.5222159888062472, 0.5, 0.6889319397120244, 0.5, 0.9364422798247372, 0.5, 0.6345207994274957, 0.5, 0.5, 0.9341556394417526, 0.8357193454572613, -1.0, 0.9206358628815184, 0.7228922728483538, 0.9766859343475863, 0.6164460243356141, 0.8680622011566063, 0.5273510747650096, -1.0, 0.5855711742956597, 0.5, 0.940190006594764, 0.8977676377633348, 0.9004865193079689, 0.5959594294687698, -1.0, 0.9161972756841072, 0.5, 0.8463280979234522, 0.9146915515581493, 0.5, 0.9625819176042799, 0.5, 0.9897994045039246, 0.6004223610084034, 0.8936594685181084, -1.0, 0.5, 0.9834375358939962, 0.5, 0.9254734980446271, 0.5, -1.0, 0.5, 0.6685409094853325, 0.5, 0.8079886121957944, 0.5, 0.5, 0.5, 0.5, 0.9611138549229136, 0.6033016945509623, 0.6967704586559572, 0.5, 0.7604331946311611, 0.9920464852460373, 0.9252434952512882, -1.0, 0.5, 0.5, 0.7611982664624715, 0.7463211890831905, 0.7725590241509582, -1.0, 0.5, -1.0, 0.5, 0.8227730977464287, 0.7855415288047183, 0.5, 0.8199341279405139, 0.8520817704168638, 0.5, 0.5, 0.9865491312624284, 0.5316885405392626, 0.6338094252104566, 0.5, -1.0, 0.5389995842434863, 0.5, 0.8003018047292173, -1.0, -1.0, 0.8984145423447879, -1.0, -1.0, -1.0, 0.6637329957027974, -1.0, 0.5, 0.5, 0.8603037175268216, -1.0, -1.0, -1.0, 0.968603537310041, 0.5761374042588285, 0.8665624488406161, 0.632130287718994, 0.910756388374478, 0.5646347762144495, 0.8580665482005119, 0.6659983823343758, 0.6778913525590646], "episode_lengths": [18, 13, 21, 47, 29, 14, 77, 13, 16, 15, 80, 55, 15, 27, 17, 13, 31, 23, 13, 17, 17, 39, 80, 13, 13, 22, 41, 15, 13, 56, 13, 13, 15, 43, 13, 80, 13, 14, 50, 13, 43, 32, 80, 39, 47, 13, 13, 53, 49, 15, 40, 27, 55, 49, 13, 54, 33, 13, 47, 50, 17, 13, 31, 19, 13, 15, 80, 15, 13, 13, 13, 13, 35, 15, 38, 41, 14, 13, 17, 14, 39, 13, 68, 13, 15, 42, 77, 13, 80, 20, 80, 29, 13, 17, 16, 38, 45, 14, 42, 13, 13, 13, 15, 80, 13, 14, 13, 80, 80, 13, 80, 80, 15, 15, 43, 14, 14, 46, 15, 66, 80, 13, 34, 13, 13, 14, 14, 13, 13, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09324444525694166, "mean_inference_ms": 0.2568046267476691, "mean_action_processing_ms": 0.03307218992372227, "mean_env_wait_ms": 0.0471846588171207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016361016493577224, "StateBufferConnector_ms": 0.0013021322397085337, "ViewRequirementAgentConnector_ms": 0.028682488661545973}}, "episode_reward_max": 0.9920464852460373, "episode_reward_min": -1.0, "episode_reward_mean": 0.322889686984337, "episode_len_mean": 30.607692307692307, "episodes_this_iter": 130, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.6887743611650831, -1.0, -1.0, -1.0, 0.6049030214611428, -1.0, 0.5, 0.755630374921361, 0.5342348055167432, -1.0, 0.7886592269353565, 0.951113026147074, -1.0, 0.6523723956092685, 0.6733949229349356, 0.5, -1.0, 0.5, 0.7858391032495529, -1.0, 0.5, -1.0, 0.7936842519343265, 0.5222159888062472, 0.5, 0.6889319397120244, 0.5, 0.9364422798247372, 0.5, 0.6345207994274957, 0.5, 0.5, 0.9341556394417526, 0.8357193454572613, -1.0, 0.9206358628815184, 0.7228922728483538, 0.9766859343475863, 0.6164460243356141, 0.8680622011566063, 0.5273510747650096, -1.0, 0.5855711742956597, 0.5, 0.940190006594764, 0.8977676377633348, 0.9004865193079689, 0.5959594294687698, -1.0, 0.9161972756841072, 0.5, 0.8463280979234522, 0.9146915515581493, 0.5, 0.9625819176042799, 0.5, 0.9897994045039246, 0.6004223610084034, 0.8936594685181084, -1.0, 0.5, 0.9834375358939962, 0.5, 0.9254734980446271, 0.5, -1.0, 0.5, 0.6685409094853325, 0.5, 0.8079886121957944, 0.5, 0.5, 0.5, 0.5, 0.9611138549229136, 0.6033016945509623, 0.6967704586559572, 0.5, 0.7604331946311611, 0.9920464852460373, 0.9252434952512882, -1.0, 0.5, 0.5, 0.7611982664624715, 0.7463211890831905, 0.7725590241509582, -1.0, 0.5, -1.0, 0.5, 0.8227730977464287, 0.7855415288047183, 0.5, 0.8199341279405139, 0.8520817704168638, 0.5, 0.5, 0.9865491312624284, 0.5316885405392626, 0.6338094252104566, 0.5, -1.0, 0.5389995842434863, 0.5, 0.8003018047292173, -1.0, -1.0, 0.8984145423447879, -1.0, -1.0, -1.0, 0.6637329957027974, -1.0, 0.5, 0.5, 0.8603037175268216, -1.0, -1.0, -1.0, 0.968603537310041, 0.5761374042588285, 0.8665624488406161, 0.632130287718994, 0.910756388374478, 0.5646347762144495, 0.8580665482005119, 0.6659983823343758, 0.6778913525590646], "episode_lengths": [18, 13, 21, 47, 29, 14, 77, 13, 16, 15, 80, 55, 15, 27, 17, 13, 31, 23, 13, 17, 17, 39, 80, 13, 13, 22, 41, 15, 13, 56, 13, 13, 15, 43, 13, 80, 13, 14, 50, 13, 43, 32, 80, 39, 47, 13, 13, 53, 49, 15, 40, 27, 55, 49, 13, 54, 33, 13, 47, 50, 17, 13, 31, 19, 13, 15, 80, 15, 13, 13, 13, 13, 35, 15, 38, 41, 14, 13, 17, 14, 39, 13, 68, 13, 15, 42, 77, 13, 80, 20, 80, 29, 13, 17, 16, 38, 45, 14, 42, 13, 13, 13, 15, 80, 13, 14, 13, 80, 80, 13, 80, 80, 15, 15, 43, 14, 14, 46, 15, 66, 80, 13, 34, 13, 13, 14, 14, 13, 13, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09324444525694166, "mean_inference_ms": 0.2568046267476691, "mean_action_processing_ms": 0.03307218992372227, "mean_env_wait_ms": 0.0471846588171207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0016361016493577224, "StateBufferConnector_ms": 0.0013021322397085337, "ViewRequirementAgentConnector_ms": 0.028682488661545973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1076.6681563689392, "num_env_steps_trained_throughput_per_sec": 1076.6681563689392, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 3672.182, "sample_time_ms": 1747.491, "load_time_ms": 0.206, "load_throughput": 19370991.802, "learn_time_ms": 1923.492, "learn_throughput": 2079.551, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 8588, "training_iteration": 85, "trial_id": "default", "date": "2024-05-23_11-37-32", "timestamp": 1716457052, "time_this_iter_s": 3.7182679176330566, "time_total_s": 310.8739929199219, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 310.8739929199219, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 56.720000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.64808246554226, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22633117906829361, "policy_loss": -0.0054233737510218415, "vf_loss": 0.23158500464132395, "vf_explained_var": 0.08920159013040604, "kl": 0.006781957861136884, "entropy": 0.6172234619176517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 79515.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 0.9975089979968927, "episode_reward_min": -1.0, "episode_reward_mean": 0.40992592895130703, "episode_len_mean": 32.048, "episode_media": {}, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7385036853746836, 0.7500164700586036, 0.5, 0.6359658409501057, 0.5983098291199582, 0.5514589792744613, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8592204151383265, 0.9776450807310548, 0.6345105626633458, 0.7030371704815588, 0.8566240728450247, 0.7093847280509705, 0.9488030365526539, 0.6512887161167547, 0.54774189584832, 0.5, -1.0, 0.5, -1.0, -1.0, 0.8549500076695196, 0.7207799653757598, -1.0, 0.7124555087797148, 0.5, 0.5, 0.8311871630734897, -1.0, 0.8434554650358901, -1.0, 0.5, 0.7603017106840269, 0.528543192450224, 0.5, 0.618559164238927, 0.6999862623078394, 0.7318668463557454, 0.5703202536586158, 0.8210087800712806, 0.909941315466576, 0.5, -1.0, 0.5, 0.7264737034757496, 0.8526142617752726, 0.5, 0.5367565798352631, 0.781001264791404, 0.5, 0.5, 0.6212485155399596, 0.5495653154064469, 0.9662560750392065, 0.6672315450176682, 0.6885320113375273, 0.5, -1.0, 0.5, 0.7753231091550746, 0.6437624340088794, -1.0, 0.7496679556228346, 0.9891357830161093, -1.0, 0.58014152118772, 0.5141045886956397, -1.0, 0.5, 0.5, 0.9206711582897538, 0.8618960982258576, 0.5, -1.0, 0.5, 0.5198750041147984, 0.7544153723654331, -1.0, 0.5171835848981288, 0.5, 0.8156809102671789, 0.5018032690331514, 0.9975089979968927, -1.0, 0.8215945102876013, -1.0, 0.6458981885657018, 0.8409999752486721, 0.7048214120218648, 0.5, 0.9100644637480549, 0.977743994727889, 0.6414645728411437, 0.5, 0.99136296843802, 0.9074110502060597, 0.5, 0.5, 0.9921563243005779, 0.6352799593904175, 0.5, -1.0, 0.9284714180203917, 0.9166500981115646, 0.6201772357714813, -1.0, 0.9788428006324077, 0.7214494069559507, -1.0, 0.7385926472492668, 0.5, 0.632253207328296, 0.7750861607047289, 0.7374086999810028, 0.947247048040691, -1.0, 0.8631128509146186, 0.673371986488847, 0.5, 0.8425649614687518], "episode_lengths": [52, 42, 19, 13, 13, 14, 80, 15, 22, 37, 20, 24, 42, 13, 35, 58, 13, 14, 40, 14, 14, 38, 80, 14, 80, 49, 14, 40, 80, 34, 14, 40, 13, 80, 15, 80, 16, 14, 14, 13, 48, 13, 48, 33, 39, 13, 41, 80, 15, 14, 41, 13, 14, 15, 20, 18, 23, 36, 13, 13, 43, 13, 17, 56, 13, 43, 9, 48, 15, 80, 15, 14, 80, 13, 13, 45, 36, 17, 80, 41, 28, 14, 80, 13, 15, 15, 13, 13, 80, 15, 80, 18, 13, 55, 14, 14, 13, 42, 45, 67, 13, 46, 17, 53, 41, 17, 67, 15, 13, 16, 80, 14, 15, 80, 37, 14, 28, 13, 46, 14, 22, 44, 15, 41, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09324994397813982, "mean_inference_ms": 0.25676452978510195, "mean_action_processing_ms": 0.03306524997137993, "mean_env_wait_ms": 0.04717731900269359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015270233154296875, "StateBufferConnector_ms": 0.00128936767578125, "ViewRequirementAgentConnector_ms": 0.028636741638183593}}, "episode_reward_max": 0.9975089979968927, "episode_reward_min": -1.0, "episode_reward_mean": 0.40992592895130703, "episode_len_mean": 32.048, "episodes_this_iter": 125, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7385036853746836, 0.7500164700586036, 0.5, 0.6359658409501057, 0.5983098291199582, 0.5514589792744613, -1.0, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8592204151383265, 0.9776450807310548, 0.6345105626633458, 0.7030371704815588, 0.8566240728450247, 0.7093847280509705, 0.9488030365526539, 0.6512887161167547, 0.54774189584832, 0.5, -1.0, 0.5, -1.0, -1.0, 0.8549500076695196, 0.7207799653757598, -1.0, 0.7124555087797148, 0.5, 0.5, 0.8311871630734897, -1.0, 0.8434554650358901, -1.0, 0.5, 0.7603017106840269, 0.528543192450224, 0.5, 0.618559164238927, 0.6999862623078394, 0.7318668463557454, 0.5703202536586158, 0.8210087800712806, 0.909941315466576, 0.5, -1.0, 0.5, 0.7264737034757496, 0.8526142617752726, 0.5, 0.5367565798352631, 0.781001264791404, 0.5, 0.5, 0.6212485155399596, 0.5495653154064469, 0.9662560750392065, 0.6672315450176682, 0.6885320113375273, 0.5, -1.0, 0.5, 0.7753231091550746, 0.6437624340088794, -1.0, 0.7496679556228346, 0.9891357830161093, -1.0, 0.58014152118772, 0.5141045886956397, -1.0, 0.5, 0.5, 0.9206711582897538, 0.8618960982258576, 0.5, -1.0, 0.5, 0.5198750041147984, 0.7544153723654331, -1.0, 0.5171835848981288, 0.5, 0.8156809102671789, 0.5018032690331514, 0.9975089979968927, -1.0, 0.8215945102876013, -1.0, 0.6458981885657018, 0.8409999752486721, 0.7048214120218648, 0.5, 0.9100644637480549, 0.977743994727889, 0.6414645728411437, 0.5, 0.99136296843802, 0.9074110502060597, 0.5, 0.5, 0.9921563243005779, 0.6352799593904175, 0.5, -1.0, 0.9284714180203917, 0.9166500981115646, 0.6201772357714813, -1.0, 0.9788428006324077, 0.7214494069559507, -1.0, 0.7385926472492668, 0.5, 0.632253207328296, 0.7750861607047289, 0.7374086999810028, 0.947247048040691, -1.0, 0.8631128509146186, 0.673371986488847, 0.5, 0.8425649614687518], "episode_lengths": [52, 42, 19, 13, 13, 14, 80, 15, 22, 37, 20, 24, 42, 13, 35, 58, 13, 14, 40, 14, 14, 38, 80, 14, 80, 49, 14, 40, 80, 34, 14, 40, 13, 80, 15, 80, 16, 14, 14, 13, 48, 13, 48, 33, 39, 13, 41, 80, 15, 14, 41, 13, 14, 15, 20, 18, 23, 36, 13, 13, 43, 13, 17, 56, 13, 43, 9, 48, 15, 80, 15, 14, 80, 13, 13, 45, 36, 17, 80, 41, 28, 14, 80, 13, 15, 15, 13, 13, 80, 15, 80, 18, 13, 55, 14, 14, 13, 42, 45, 67, 13, 46, 17, 53, 41, 17, 67, 15, 13, 16, 80, 14, 15, 80, 37, 14, 28, 13, 46, 14, 22, 44, 15, 41, 35]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09324994397813982, "mean_inference_ms": 0.25676452978510195, "mean_action_processing_ms": 0.03306524997137993, "mean_env_wait_ms": 0.04717731900269359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015270233154296875, "StateBufferConnector_ms": 0.00128936767578125, "ViewRequirementAgentConnector_ms": 0.028636741638183593}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.518799487684, "num_env_steps_trained_throughput_per_sec": 1102.518799487684, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 3673.466, "sample_time_ms": 1747.661, "load_time_ms": 0.21, "load_throughput": 19065018.182, "learn_time_ms": 1924.595, "learn_throughput": 2078.359, "synch_weights_time_ms": 0.666}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 8713, "training_iteration": 86, "trial_id": "default", "date": "2024-05-23_11-37-36", "timestamp": 1716457056, "time_this_iter_s": 3.6309850215911865, "time_total_s": 314.50497794151306, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 314.50497794151306, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.860000000000003, "ram_util_percent": 56.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.771114910001396, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1666254880219718, "policy_loss": -0.009294277384516693, "vf_loss": 0.17577172507762268, "vf_explained_var": -0.06726195254633503, "kl": 0.005921665345656921, "entropy": 0.5674001392818266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 80445.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 0.9953024804069941, "episode_reward_min": -1.0, "episode_reward_mean": 0.5202720416539366, "episode_len_mean": 30.480916030534353, "episode_media": {}, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.983571913243104, 0.6610774737633061, 0.5, 0.9860861810104405, 0.5, -1.0, 0.9536863872568434, 0.5, 0.6261950617537604, 0.8710071688605419, 0.5, 0.9425864343112506, 0.7471878516226467, 0.8853796615875587, 0.9248101270449445, 0.9677922300537037, 0.5, 0.5, 0.5, -1.0, -1.0, 0.6192277193593225, 0.9217524846359285, 0.8930164560262368, 0.5, -1.0, 0.5730742951438398, 0.9641960753008436, 0.6847627677372796, 0.9654660710385022, 0.8993000770597867, 0.8946701013039331, 0.5, 0.627701074798444, 0.5, 0.8157842792517006, 0.5, 0.5, 0.6236057611029221, 0.5, 0.9953024804069941, 0.9899042664392353, -1.0, 0.5, 0.8675112232793015, 0.5, 0.848100773310255, 0.5, 0.5, 0.8083419922225044, 0.5, 0.9585306303064044, 0.6762743792526422, -1.0, 0.9182198249702505, 0.736219695321698, 0.8381601977648883, 0.5, 0.6701083057664754, 0.5, 0.8035950270414094, 0.5, 0.5, 0.7927064028001192, 0.7011535777348984, -1.0, 0.9253225753305436, 0.621204847432944, -1.0, 0.8403694907466192, 0.5589229022770277, 0.5039680148622749, 0.5108563369142325, 0.6008670340336154, 0.5, 0.5, 0.9314958810210026, 0.8498497135426248, 0.9506458694834267, 0.832195026911279, 0.6638816271937922, -1.0, 0.7175955081514206, -1.0, 0.9723843888292618, 0.5, 0.5755587420760877, 0.5, 0.5, 0.5738318069158473, 0.9003516171902691, -1.0, 0.8679877553590634, 0.8385532430423098, 0.798106375787303, 0.8083455785613255, 0.5, 0.6776304214361393, 0.5, 0.8101616230609707, 0.8758444874750538, 0.97571841659985, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8788251934233381, 0.5193379360896586, 0.9901936107845198, 0.8627041823327448, -1.0, 0.5, 0.9540303433494146, 0.5, 0.5, 0.5, 0.5815226651252489, 0.773984159244932, 0.8937925311326792, 0.5827148821432282, 0.5, 0.5, 0.7062878739581837, 0.5, 0.5, 0.5, 0.5, 0.8293031079524915, -1.0, 0.7652252570110416], "episode_lengths": [48, 14, 14, 13, 46, 36, 52, 14, 31, 48, 16, 13, 49, 13, 13, 47, 15, 71, 19, 80, 80, 14, 14, 13, 14, 24, 14, 43, 14, 45, 13, 51, 13, 13, 19, 13, 16, 16, 78, 15, 70, 46, 80, 14, 43, 26, 23, 15, 24, 45, 47, 44, 13, 80, 13, 47, 40, 68, 56, 21, 58, 15, 14, 46, 13, 80, 13, 39, 80, 38, 13, 42, 13, 37, 14, 14, 48, 13, 13, 13, 13, 80, 13, 19, 15, 14, 55, 14, 14, 13, 13, 80, 13, 13, 42, 15, 41, 15, 17, 42, 13, 15, 17, 61, 14, 13, 33, 66, 14, 13, 42, 80, 16, 13, 34, 14, 13, 14, 16, 46, 13, 32, 53, 42, 14, 15, 20, 13, 38, 16, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0932631450316123, "mean_inference_ms": 0.2567314376709818, "mean_action_processing_ms": 0.033060807834357664, "mean_env_wait_ms": 0.04717270748596376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015593667066734255, "StateBufferConnector_ms": 0.0013058422175982526, "ViewRequirementAgentConnector_ms": 0.028502122136472744}}, "episode_reward_max": 0.9953024804069941, "episode_reward_min": -1.0, "episode_reward_mean": 0.5202720416539366, "episode_len_mean": 30.480916030534353, "episodes_this_iter": 131, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.983571913243104, 0.6610774737633061, 0.5, 0.9860861810104405, 0.5, -1.0, 0.9536863872568434, 0.5, 0.6261950617537604, 0.8710071688605419, 0.5, 0.9425864343112506, 0.7471878516226467, 0.8853796615875587, 0.9248101270449445, 0.9677922300537037, 0.5, 0.5, 0.5, -1.0, -1.0, 0.6192277193593225, 0.9217524846359285, 0.8930164560262368, 0.5, -1.0, 0.5730742951438398, 0.9641960753008436, 0.6847627677372796, 0.9654660710385022, 0.8993000770597867, 0.8946701013039331, 0.5, 0.627701074798444, 0.5, 0.8157842792517006, 0.5, 0.5, 0.6236057611029221, 0.5, 0.9953024804069941, 0.9899042664392353, -1.0, 0.5, 0.8675112232793015, 0.5, 0.848100773310255, 0.5, 0.5, 0.8083419922225044, 0.5, 0.9585306303064044, 0.6762743792526422, -1.0, 0.9182198249702505, 0.736219695321698, 0.8381601977648883, 0.5, 0.6701083057664754, 0.5, 0.8035950270414094, 0.5, 0.5, 0.7927064028001192, 0.7011535777348984, -1.0, 0.9253225753305436, 0.621204847432944, -1.0, 0.8403694907466192, 0.5589229022770277, 0.5039680148622749, 0.5108563369142325, 0.6008670340336154, 0.5, 0.5, 0.9314958810210026, 0.8498497135426248, 0.9506458694834267, 0.832195026911279, 0.6638816271937922, -1.0, 0.7175955081514206, -1.0, 0.9723843888292618, 0.5, 0.5755587420760877, 0.5, 0.5, 0.5738318069158473, 0.9003516171902691, -1.0, 0.8679877553590634, 0.8385532430423098, 0.798106375787303, 0.8083455785613255, 0.5, 0.6776304214361393, 0.5, 0.8101616230609707, 0.8758444874750538, 0.97571841659985, 0.5, 0.5, 0.5, 0.5, 0.5, 0.8788251934233381, 0.5193379360896586, 0.9901936107845198, 0.8627041823327448, -1.0, 0.5, 0.9540303433494146, 0.5, 0.5, 0.5, 0.5815226651252489, 0.773984159244932, 0.8937925311326792, 0.5827148821432282, 0.5, 0.5, 0.7062878739581837, 0.5, 0.5, 0.5, 0.5, 0.8293031079524915, -1.0, 0.7652252570110416], "episode_lengths": [48, 14, 14, 13, 46, 36, 52, 14, 31, 48, 16, 13, 49, 13, 13, 47, 15, 71, 19, 80, 80, 14, 14, 13, 14, 24, 14, 43, 14, 45, 13, 51, 13, 13, 19, 13, 16, 16, 78, 15, 70, 46, 80, 14, 43, 26, 23, 15, 24, 45, 47, 44, 13, 80, 13, 47, 40, 68, 56, 21, 58, 15, 14, 46, 13, 80, 13, 39, 80, 38, 13, 42, 13, 37, 14, 14, 48, 13, 13, 13, 13, 80, 13, 19, 15, 14, 55, 14, 14, 13, 13, 80, 13, 13, 42, 15, 41, 15, 17, 42, 13, 15, 17, 61, 14, 13, 33, 66, 14, 13, 42, 80, 16, 13, 34, 14, 13, 14, 16, 46, 13, 32, 53, 42, 14, 15, 20, 13, 38, 16, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0932631450316123, "mean_inference_ms": 0.2567314376709818, "mean_action_processing_ms": 0.033060807834357664, "mean_env_wait_ms": 0.04717270748596376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015593667066734255, "StateBufferConnector_ms": 0.0013058422175982526, "ViewRequirementAgentConnector_ms": 0.028502122136472744}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.729779509784, "num_env_steps_trained_throughput_per_sec": 1101.729779509784, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 3654.055, "sample_time_ms": 1728.055, "load_time_ms": 0.209, "load_throughput": 19106270.356, "learn_time_ms": 1924.775, "learn_throughput": 2078.165, "synch_weights_time_ms": 0.681}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 8844, "training_iteration": 87, "trial_id": "default", "date": "2024-05-23_11-37-40", "timestamp": 1716457060, "time_this_iter_s": 3.633646011352539, "time_total_s": 318.1386239528656, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 318.1386239528656, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.200000000000003, "ram_util_percent": 56.650000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3217055445076316, "cur_kl_coeff": 0.025000000000000005, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21467052381786128, "policy_loss": -0.01132852659831124, "vf_loss": 0.2258790455237832, "vf_explained_var": 0.15772141852686483, "kl": 0.0048002035441743396, "entropy": 0.5683358720233364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 81375.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 0.9964614649942917, "episode_reward_min": -1.0, "episode_reward_mean": 0.29466846194320406, "episode_len_mean": 32.41463414634146, "episode_media": {}, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.9372904713736592, 0.7843123481732077, -1.0, -1.0, 0.5, 0.9940037196118486, 0.5387139765987445, 0.6350513621731309, 0.5, 0.5, 0.7258951947265009, 0.5, 0.8807982535864712, 0.5404787582483963, 0.5, 0.5, -1.0, 0.7379649937020929, 0.9304160581635723, 0.7931369175412123, -1.0, 0.9853024382110185, 0.5820282017488081, 0.5, 0.7446727273643151, 0.6865157248920575, -1.0, 0.5, 0.7027047451545079, 0.5, 0.7138741190044987, -1.0, -1.0, 0.9509319191402736, -1.0, 0.5152619343944721, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6094494406693318, 0.8562700733061361, 0.9925439787794372, 0.868428797590906, 0.8495357538244653, -1.0, 0.5, 0.5, -1.0, 0.7565165618222062, -1.0, 0.5, -1.0, 0.7802737521063183, -1.0, -1.0, 0.6920529381249927, 0.9337165090354861, 0.5, -1.0, 0.7336738238251523, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6697889168713524, 0.581815847822111, 0.602007904892632, 0.9753573620713748, -1.0, 0.8695850847884691, 0.8978312259812884, 0.9379056378308256, 0.5, 0.5, 0.9870080405112239, 0.6096364047362628, 0.6371083521616578, -1.0, 0.685712488788363, 0.5, 0.5, 0.6205863292308083, 0.9128033169324711, 0.5, 0.5115679763991119, 0.8594147331394177, 0.9570299782305781, 0.9964614649942917, 0.5, 0.6158530846457377, 0.9893024740589618, 0.5, 0.6233993532407722, 0.707307315636785, 0.5, -1.0, 0.7804810925526642, 0.7177295779227828, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7472002561245444, -1.0, 0.6423834039066165, 0.7987872336310178, 0.5, 0.8152744801364388, 0.5, 0.9529237454732, -1.0, 0.5, 0.5945881275377636, 0.6753901417464684, 0.6750459103526689, 0.726109840264533, 0.8488912566473793, 0.5701169668603114], "episode_lengths": [27, 14, 13, 18, 80, 31, 13, 13, 51, 14, 24, 13, 17, 14, 13, 17, 35, 80, 64, 35, 13, 18, 39, 15, 14, 13, 15, 80, 51, 13, 32, 14, 61, 80, 13, 80, 14, 28, 71, 44, 63, 10, 40, 55, 14, 54, 15, 80, 15, 45, 80, 45, 80, 14, 16, 14, 16, 68, 13, 42, 17, 80, 52, 19, 80, 13, 80, 80, 44, 14, 14, 13, 18, 45, 55, 48, 16, 53, 13, 13, 13, 18, 13, 14, 13, 38, 47, 15, 40, 13, 45, 13, 16, 43, 13, 15, 20, 14, 15, 13, 16, 13, 58, 13, 21, 16, 14, 14, 80, 41, 38, 14, 15, 13, 33, 71, 21, 35, 71, 44, 14, 44, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09326828799765666, "mean_inference_ms": 0.25670055863519975, "mean_action_processing_ms": 0.03305538835556156, "mean_env_wait_ms": 0.04716747129863396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015826729254993965, "StateBufferConnector_ms": 0.0012791253686920414, "ViewRequirementAgentConnector_ms": 0.0285520786192359}}, "episode_reward_max": 0.9964614649942917, "episode_reward_min": -1.0, "episode_reward_mean": 0.29466846194320406, "episode_len_mean": 32.41463414634146, "episodes_this_iter": 123, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.9372904713736592, 0.7843123481732077, -1.0, -1.0, 0.5, 0.9940037196118486, 0.5387139765987445, 0.6350513621731309, 0.5, 0.5, 0.7258951947265009, 0.5, 0.8807982535864712, 0.5404787582483963, 0.5, 0.5, -1.0, 0.7379649937020929, 0.9304160581635723, 0.7931369175412123, -1.0, 0.9853024382110185, 0.5820282017488081, 0.5, 0.7446727273643151, 0.6865157248920575, -1.0, 0.5, 0.7027047451545079, 0.5, 0.7138741190044987, -1.0, -1.0, 0.9509319191402736, -1.0, 0.5152619343944721, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6094494406693318, 0.8562700733061361, 0.9925439787794372, 0.868428797590906, 0.8495357538244653, -1.0, 0.5, 0.5, -1.0, 0.7565165618222062, -1.0, 0.5, -1.0, 0.7802737521063183, -1.0, -1.0, 0.6920529381249927, 0.9337165090354861, 0.5, -1.0, 0.7336738238251523, -1.0, -1.0, 0.5, -1.0, -1.0, 0.6697889168713524, 0.581815847822111, 0.602007904892632, 0.9753573620713748, -1.0, 0.8695850847884691, 0.8978312259812884, 0.9379056378308256, 0.5, 0.5, 0.9870080405112239, 0.6096364047362628, 0.6371083521616578, -1.0, 0.685712488788363, 0.5, 0.5, 0.6205863292308083, 0.9128033169324711, 0.5, 0.5115679763991119, 0.8594147331394177, 0.9570299782305781, 0.9964614649942917, 0.5, 0.6158530846457377, 0.9893024740589618, 0.5, 0.6233993532407722, 0.707307315636785, 0.5, -1.0, 0.7804810925526642, 0.7177295779227828, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7472002561245444, -1.0, 0.6423834039066165, 0.7987872336310178, 0.5, 0.8152744801364388, 0.5, 0.9529237454732, -1.0, 0.5, 0.5945881275377636, 0.6753901417464684, 0.6750459103526689, 0.726109840264533, 0.8488912566473793, 0.5701169668603114], "episode_lengths": [27, 14, 13, 18, 80, 31, 13, 13, 51, 14, 24, 13, 17, 14, 13, 17, 35, 80, 64, 35, 13, 18, 39, 15, 14, 13, 15, 80, 51, 13, 32, 14, 61, 80, 13, 80, 14, 28, 71, 44, 63, 10, 40, 55, 14, 54, 15, 80, 15, 45, 80, 45, 80, 14, 16, 14, 16, 68, 13, 42, 17, 80, 52, 19, 80, 13, 80, 80, 44, 14, 14, 13, 18, 45, 55, 48, 16, 53, 13, 13, 13, 18, 13, 14, 13, 38, 47, 15, 40, 13, 45, 13, 16, 43, 13, 15, 20, 14, 15, 13, 16, 13, 58, 13, 21, 16, 14, 14, 80, 41, 38, 14, 15, 13, 33, 71, 21, 35, 71, 44, 14, 44, 17]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09326828799765666, "mean_inference_ms": 0.25670055863519975, "mean_action_processing_ms": 0.03305538835556156, "mean_env_wait_ms": 0.04716747129863396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015826729254993965, "StateBufferConnector_ms": 0.0012791253686920414, "ViewRequirementAgentConnector_ms": 0.0285520786192359}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.451640306932, "num_env_steps_trained_throughput_per_sec": 1102.451640306932, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 3646.343, "sample_time_ms": 1728.061, "load_time_ms": 0.209, "load_throughput": 19154259.619, "learn_time_ms": 1917.074, "learn_throughput": 2086.513, "synch_weights_time_ms": 0.669}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 8967, "training_iteration": 88, "trial_id": "default", "date": "2024-05-23_11-37-43", "timestamp": 1716457063, "time_this_iter_s": 3.6313159465789795, "time_total_s": 321.7699398994446, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 321.7699398994446, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.68, "ram_util_percent": 56.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2750488309450048, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20051709802795303, "policy_loss": -0.009153126437537452, "vf_loss": 0.20954057832238496, "vf_explained_var": 0.062339552564005696, "kl": 0.010371722789746494, "entropy": 0.5742690577622382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 82305.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 0.9958929917267305, "episode_reward_min": -1.0, "episode_reward_mean": 0.44173875298363935, "episode_len_mean": 28.274647887323944, "episode_media": {}, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.785608833595155, 0.9919958042260386, 0.9732385273217253, 0.5, 0.6660910277376672, 0.9350468131921715, -1.0, -1.0, 0.6353420659774442, 0.5, 0.6960345849565188, 0.8056330286600251, 0.5, 0.9786311552248926, 0.5812577173881934, -1.0, 0.5, 0.6105994537562653, 0.5, 0.6631790379135469, 0.5, 0.5, 0.5, 0.963519153202607, 0.8102360412881773, 0.7451950852902189, 0.7834365720074414, 0.5314921063847866, 0.8313328725866477, -1.0, 0.7225275501979622, 0.9726665191345344, 0.5307289915735054, 0.5068509774933294, 0.5, -1.0, 0.6184232090446417, 0.6583474991548155, 0.9926107881858781, 0.5, 0.5, 0.5, 0.5, 0.8754802362486458, 0.6294288911042818, 0.8716371383884456, 0.7887620749999407, 0.7351552960673937, 0.5731615704041411, 0.898150215839995, -1.0, 0.5, 0.5, 0.9427087601302812, -1.0, 0.8188539551785723, -1.0, 0.5, 0.6588427266241261, 0.9403655029978707, 0.5, 0.9713458095422274, 0.652413602170892, 0.8593714112631394, 0.7207147471295113, 0.8946268779384882, 0.7975561072181793, 0.5, 0.7212530442904723, 0.5, 0.8099833195664408, 0.9586985444468628, 0.8522576611470745, 0.9881887196543985, 0.5, 0.778921984416693, 0.8695691973876596, 0.6961767999645538, 0.5, 0.6928910750309696, -1.0, 0.5, 0.5, 0.5, 0.5, 0.7314007614638518, 0.9958929917267305, 0.7046453245155705, 0.9696620656214717, 0.5, -1.0, -1.0, 0.902201224165629, 0.7211175444083083, -1.0, 0.7481942583169203, 0.724551962558912, 0.5, 0.5, -1.0, -1.0, 0.8819031649141905, 0.5, 0.5100995369909185, 0.765098578921481, 0.7665963482627995, 0.7930030537101602, 0.6369856026562292, -1.0, 0.5836865011912848, 0.7527154362106959, 0.5, 0.5, 0.6701343754861061, 0.9089738412392574, 0.5985826883407107, -1.0, 0.9814051706476484, 0.5, -1.0, 0.7123395369829697, -1.0, 0.856988438568051, 0.6010331099576675, 0.5, 0.9595046091565094, 0.5, 0.9866014952213864, 0.8816286584776658, -1.0, 0.5, -1.0, 0.9706037035345263, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6449884526593226, 0.8893830153140465, 0.8904407878103207], "episode_lengths": [80, 14, 13, 13, 47, 17, 13, 80, 22, 13, 14, 13, 15, 14, 50, 19, 16, 13, 48, 14, 13, 19, 33, 17, 13, 47, 48, 47, 13, 13, 16, 13, 51, 13, 50, 13, 80, 32, 38, 38, 15, 17, 26, 42, 13, 15, 35, 14, 43, 13, 13, 18, 14, 44, 14, 27, 14, 17, 14, 14, 40, 14, 13, 14, 14, 13, 43, 13, 44, 45, 14, 47, 13, 13, 13, 13, 37, 37, 42, 17, 35, 80, 31, 14, 17, 14, 13, 39, 13, 13, 14, 50, 22, 49, 16, 80, 33, 26, 72, 26, 80, 10, 31, 35, 13, 13, 14, 13, 13, 79, 13, 15, 48, 14, 13, 13, 13, 80, 13, 25, 80, 15, 36, 43, 13, 13, 13, 22, 46, 54, 80, 14, 80, 42, 29, 13, 32, 14, 42, 13, 45, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09329107819571757, "mean_inference_ms": 0.25667486326586947, "mean_action_processing_ms": 0.03305171404732986, "mean_env_wait_ms": 0.04716605294369277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001533098623786174, "StateBufferConnector_ms": 0.0012923294389751597, "ViewRequirementAgentConnector_ms": 0.02854793844088702}}, "episode_reward_max": 0.9958929917267305, "episode_reward_min": -1.0, "episode_reward_mean": 0.44173875298363935, "episode_len_mean": 28.274647887323944, "episodes_this_iter": 142, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.785608833595155, 0.9919958042260386, 0.9732385273217253, 0.5, 0.6660910277376672, 0.9350468131921715, -1.0, -1.0, 0.6353420659774442, 0.5, 0.6960345849565188, 0.8056330286600251, 0.5, 0.9786311552248926, 0.5812577173881934, -1.0, 0.5, 0.6105994537562653, 0.5, 0.6631790379135469, 0.5, 0.5, 0.5, 0.963519153202607, 0.8102360412881773, 0.7451950852902189, 0.7834365720074414, 0.5314921063847866, 0.8313328725866477, -1.0, 0.7225275501979622, 0.9726665191345344, 0.5307289915735054, 0.5068509774933294, 0.5, -1.0, 0.6184232090446417, 0.6583474991548155, 0.9926107881858781, 0.5, 0.5, 0.5, 0.5, 0.8754802362486458, 0.6294288911042818, 0.8716371383884456, 0.7887620749999407, 0.7351552960673937, 0.5731615704041411, 0.898150215839995, -1.0, 0.5, 0.5, 0.9427087601302812, -1.0, 0.8188539551785723, -1.0, 0.5, 0.6588427266241261, 0.9403655029978707, 0.5, 0.9713458095422274, 0.652413602170892, 0.8593714112631394, 0.7207147471295113, 0.8946268779384882, 0.7975561072181793, 0.5, 0.7212530442904723, 0.5, 0.8099833195664408, 0.9586985444468628, 0.8522576611470745, 0.9881887196543985, 0.5, 0.778921984416693, 0.8695691973876596, 0.6961767999645538, 0.5, 0.6928910750309696, -1.0, 0.5, 0.5, 0.5, 0.5, 0.7314007614638518, 0.9958929917267305, 0.7046453245155705, 0.9696620656214717, 0.5, -1.0, -1.0, 0.902201224165629, 0.7211175444083083, -1.0, 0.7481942583169203, 0.724551962558912, 0.5, 0.5, -1.0, -1.0, 0.8819031649141905, 0.5, 0.5100995369909185, 0.765098578921481, 0.7665963482627995, 0.7930030537101602, 0.6369856026562292, -1.0, 0.5836865011912848, 0.7527154362106959, 0.5, 0.5, 0.6701343754861061, 0.9089738412392574, 0.5985826883407107, -1.0, 0.9814051706476484, 0.5, -1.0, 0.7123395369829697, -1.0, 0.856988438568051, 0.6010331099576675, 0.5, 0.9595046091565094, 0.5, 0.9866014952213864, 0.8816286584776658, -1.0, 0.5, -1.0, 0.9706037035345263, 0.5, 0.5, 0.5, 0.5, 0.5, 0.6449884526593226, 0.8893830153140465, 0.8904407878103207], "episode_lengths": [80, 14, 13, 13, 47, 17, 13, 80, 22, 13, 14, 13, 15, 14, 50, 19, 16, 13, 48, 14, 13, 19, 33, 17, 13, 47, 48, 47, 13, 13, 16, 13, 51, 13, 50, 13, 80, 32, 38, 38, 15, 17, 26, 42, 13, 15, 35, 14, 43, 13, 13, 18, 14, 44, 14, 27, 14, 17, 14, 14, 40, 14, 13, 14, 14, 13, 43, 13, 44, 45, 14, 47, 13, 13, 13, 13, 37, 37, 42, 17, 35, 80, 31, 14, 17, 14, 13, 39, 13, 13, 14, 50, 22, 49, 16, 80, 33, 26, 72, 26, 80, 10, 31, 35, 13, 13, 14, 13, 13, 79, 13, 15, 48, 14, 13, 13, 13, 80, 13, 25, 80, 15, 36, 43, 13, 13, 13, 22, 46, 54, 80, 14, 80, 42, 29, 13, 32, 14, 42, 13, 45, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09329107819571757, "mean_inference_ms": 0.25667486326586947, "mean_action_processing_ms": 0.03305171404732986, "mean_env_wait_ms": 0.04716605294369277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001533098623786174, "StateBufferConnector_ms": 0.0012923294389751597, "ViewRequirementAgentConnector_ms": 0.02854793844088702}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.1317811405863, "num_env_steps_trained_throughput_per_sec": 1101.1317811405863, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 3647.455, "sample_time_ms": 1729.724, "load_time_ms": 0.21, "load_throughput": 19045539.789, "learn_time_ms": 1916.525, "learn_throughput": 2087.111, "synch_weights_time_ms": 0.665}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 9109, "training_iteration": 89, "trial_id": "default", "date": "2024-05-23_11-37-47", "timestamp": 1716457067, "time_this_iter_s": 3.6357319355010986, "time_total_s": 325.4056718349457, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 325.4056718349457, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.160000000000004, "ram_util_percent": 56.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8692267742849165, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20323577006572796, "policy_loss": -0.005063651137614763, "vf_loss": 0.20819928744227015, "vf_explained_var": -0.04002765378644389, "kl": 0.008010557894368447, "entropy": 0.5759014623139495, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 83235.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 0.9979413091677932, "episode_reward_min": -1.0, "episode_reward_mean": 0.44070186428511865, "episode_len_mean": 28.397163120567377, "episode_media": {}, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8354311511711061, 0.5, 0.7607059675382792, -1.0, 0.7175499219476061, 0.8057417019344465, 0.5, 0.7212173251443792, 0.5, 0.747344071769773, 0.710263514555145, 0.9979413091677932, 0.7152216224550629, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.6139583623185008, 0.8629889509995211, 0.7916968823700846, -1.0, 0.5, -1.0, 0.5788166812070925, 0.5, 0.8256385781223043, 0.6880462871442571, 0.5, 0.5, 0.5, 0.9887224511367941, 0.5, 0.5, 0.7490704954246874, 0.5, 0.5, 0.5, 0.6966037948035666, 0.8962917058046603, 0.5, 0.5, 0.5210800086861491, 0.5, 0.7457180782373654, 0.596963490287594, 0.5, -1.0, 0.8329795692498843, 0.8913813697738684, 0.6624719827548419, 0.8385950298022483, 0.5, -1.0, 0.5, 0.5, 0.8878997085634608, 0.5, 0.5017300033695795, 0.8326231600514229, -1.0, 0.5, 0.8541750632408216, 0.5, 0.5196792340348125, 0.5, 0.5289214535466703, 0.9697808108071383, 0.5, 0.7097623016173351, 0.932185672397321, 0.7535668594942739, 0.6717022755572974, 0.5, 0.5, 0.5, 0.7198171009837251, 0.8541984474975653, -1.0, 0.5073293969068247, 0.5488850557655023, 0.5, 0.7692690968332654, 0.5, 0.9945666720070743, 0.5, 0.895515943849264, 0.9954597155188334, -1.0, 0.5, 0.5, 0.5, 0.7615460729854096, -1.0, 0.9086820539635478, 0.5, 0.5011739912666267, -1.0, 0.5, 0.7130548404977792, 0.9793947425964137, 0.6572066487701855, 0.5, 0.5423642809282194, 0.7461882612553594, 0.7921913980107331, 0.9292247952675443, -1.0, 0.569574158157349, 0.6804852565364743, 0.5, 0.5, 0.7417953257639005, 0.5, 0.5, 0.5, -1.0, 0.6477004329733422, -1.0, 0.6198358784041904, 0.8199502680096591, -1.0, 0.6143008691384817, 0.9791010686728713, 0.774208464846813, 0.5871500014429536, 0.9152725774763253, 0.5, -1.0, 0.5321321167827981, 0.5581963662382883, 0.9870159755589559, -1.0, 0.8912781650309997, 0.7481024132323524, 0.6044554554585517, 0.9368256055211219, 0.6194466987063805, 0.5416004048588958, 0.5], "episode_lengths": [67, 31, 13, 80, 14, 13, 18, 33, 31, 41, 25, 44, 13, 80, 14, 15, 80, 14, 15, 27, 71, 13, 16, 33, 80, 13, 16, 44, 13, 14, 13, 13, 13, 45, 17, 13, 15, 14, 15, 14, 56, 14, 15, 57, 13, 13, 13, 27, 80, 51, 13, 14, 45, 17, 20, 14, 13, 14, 23, 13, 16, 80, 13, 42, 13, 13, 15, 14, 45, 13, 14, 48, 14, 15, 13, 16, 15, 13, 14, 80, 13, 13, 15, 13, 15, 13, 16, 47, 47, 80, 15, 42, 14, 41, 18, 45, 16, 16, 80, 14, 55, 14, 48, 14, 13, 17, 14, 44, 80, 32, 13, 16, 14, 35, 40, 15, 15, 12, 23, 18, 13, 14, 47, 13, 56, 13, 14, 43, 20, 80, 16, 47, 54, 80, 41, 32, 13, 39, 53, 13, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09331104796800234, "mean_inference_ms": 0.2566372590497585, "mean_action_processing_ms": 0.03304775382921028, "mean_env_wait_ms": 0.04716257001681058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015476916698699303, "StateBufferConnector_ms": 0.001291856698110594, "ViewRequirementAgentConnector_ms": 0.02849490930002632}}, "episode_reward_max": 0.9979413091677932, "episode_reward_min": -1.0, "episode_reward_mean": 0.44070186428511865, "episode_len_mean": 28.397163120567377, "episodes_this_iter": 141, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8354311511711061, 0.5, 0.7607059675382792, -1.0, 0.7175499219476061, 0.8057417019344465, 0.5, 0.7212173251443792, 0.5, 0.747344071769773, 0.710263514555145, 0.9979413091677932, 0.7152216224550629, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.6139583623185008, 0.8629889509995211, 0.7916968823700846, -1.0, 0.5, -1.0, 0.5788166812070925, 0.5, 0.8256385781223043, 0.6880462871442571, 0.5, 0.5, 0.5, 0.9887224511367941, 0.5, 0.5, 0.7490704954246874, 0.5, 0.5, 0.5, 0.6966037948035666, 0.8962917058046603, 0.5, 0.5, 0.5210800086861491, 0.5, 0.7457180782373654, 0.596963490287594, 0.5, -1.0, 0.8329795692498843, 0.8913813697738684, 0.6624719827548419, 0.8385950298022483, 0.5, -1.0, 0.5, 0.5, 0.8878997085634608, 0.5, 0.5017300033695795, 0.8326231600514229, -1.0, 0.5, 0.8541750632408216, 0.5, 0.5196792340348125, 0.5, 0.5289214535466703, 0.9697808108071383, 0.5, 0.7097623016173351, 0.932185672397321, 0.7535668594942739, 0.6717022755572974, 0.5, 0.5, 0.5, 0.7198171009837251, 0.8541984474975653, -1.0, 0.5073293969068247, 0.5488850557655023, 0.5, 0.7692690968332654, 0.5, 0.9945666720070743, 0.5, 0.895515943849264, 0.9954597155188334, -1.0, 0.5, 0.5, 0.5, 0.7615460729854096, -1.0, 0.9086820539635478, 0.5, 0.5011739912666267, -1.0, 0.5, 0.7130548404977792, 0.9793947425964137, 0.6572066487701855, 0.5, 0.5423642809282194, 0.7461882612553594, 0.7921913980107331, 0.9292247952675443, -1.0, 0.569574158157349, 0.6804852565364743, 0.5, 0.5, 0.7417953257639005, 0.5, 0.5, 0.5, -1.0, 0.6477004329733422, -1.0, 0.6198358784041904, 0.8199502680096591, -1.0, 0.6143008691384817, 0.9791010686728713, 0.774208464846813, 0.5871500014429536, 0.9152725774763253, 0.5, -1.0, 0.5321321167827981, 0.5581963662382883, 0.9870159755589559, -1.0, 0.8912781650309997, 0.7481024132323524, 0.6044554554585517, 0.9368256055211219, 0.6194466987063805, 0.5416004048588958, 0.5], "episode_lengths": [67, 31, 13, 80, 14, 13, 18, 33, 31, 41, 25, 44, 13, 80, 14, 15, 80, 14, 15, 27, 71, 13, 16, 33, 80, 13, 16, 44, 13, 14, 13, 13, 13, 45, 17, 13, 15, 14, 15, 14, 56, 14, 15, 57, 13, 13, 13, 27, 80, 51, 13, 14, 45, 17, 20, 14, 13, 14, 23, 13, 16, 80, 13, 42, 13, 13, 15, 14, 45, 13, 14, 48, 14, 15, 13, 16, 15, 13, 14, 80, 13, 13, 15, 13, 15, 13, 16, 47, 47, 80, 15, 42, 14, 41, 18, 45, 16, 16, 80, 14, 55, 14, 48, 14, 13, 17, 14, 44, 80, 32, 13, 16, 14, 35, 40, 15, 15, 12, 23, 18, 13, 14, 47, 13, 56, 13, 14, 43, 20, 80, 16, 47, 54, 80, 41, 32, 13, 39, 53, 13, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09331104796800234, "mean_inference_ms": 0.2566372590497585, "mean_action_processing_ms": 0.03304775382921028, "mean_env_wait_ms": 0.04716257001681058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015476916698699303, "StateBufferConnector_ms": 0.001291856698110594, "ViewRequirementAgentConnector_ms": 0.02849490930002632}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1096.9654782994292, "num_env_steps_trained_throughput_per_sec": 1096.9654782994292, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3648.956, "sample_time_ms": 1731.069, "load_time_ms": 0.203, "load_throughput": 19723978.368, "learn_time_ms": 1916.691, "learn_throughput": 2086.93, "synch_weights_time_ms": 0.663}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 9250, "training_iteration": 90, "trial_id": "default", "date": "2024-05-23_11-37-50", "timestamp": 1716457070, "time_this_iter_s": 3.6496241092681885, "time_total_s": 329.05529594421387, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 329.05529594421387, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.42, "ram_util_percent": 56.720000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6554858374339276, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.16952939011076446, "policy_loss": -0.001980388493988142, "vf_loss": 0.17138902906989378, "vf_explained_var": -0.06041558602804779, "kl": 0.009659955211395437, "entropy": 0.5934296974251347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 84165.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 0.9902723232585018, "episode_reward_min": -1.0, "episode_reward_mean": 0.5307755946361833, "episode_len_mean": 34.63793103448276, "episode_media": {}, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5566205591009807, 0.5, 0.6757439809930496, 0.7069871009774178, 0.7931854357895584, -1.0, 0.5, 0.926481848588845, 0.572782363695645, 0.6054317090877865, 0.7303371981095934, 0.6899098768280483, 0.5, 0.7807524595425448, -1.0, 0.9321265561752754, 0.5, 0.5740488081715784, 0.6594462809694255, -1.0, 0.8995956150122462, 0.5, 0.6595794772700494, 0.7843823859803376, -1.0, 0.931565743058559, 0.6047297739500929, 0.8597149669633899, 0.5, 0.6673977771492794, 0.8645747527916712, 0.51867301264077, -1.0, 0.6696844953634005, 0.7329724823786756, 0.5, 0.6753180507918521, 0.7090668425101665, -1.0, 0.56193769617418, -1.0, 0.949794065990505, 0.6953648337872376, 0.6120959252613567, 0.5, 0.5527854512434536, 0.5, 0.8287001325257664, 0.5, -1.0, 0.5, 0.9600090078801854, 0.5, 0.5, 0.6274168790196262, -1.0, 0.9902723232585018, 0.7281274742235901, 0.9324301715514002, 0.8507488699531246, 0.8864833240456113, 0.9431731958413447, 0.5, 0.5, 0.9002779646192521, 0.8362260325199008, 0.7675946937144187, 0.9394679627956527, 0.5436735909869312, 0.710160944359439, 0.9738950484611638, -1.0, 0.5, 0.5, 0.755039820848371, 0.5063288829815478, 0.6375896025540502, 0.7833247456208218, -1.0, 0.5, 0.5, 0.7456136971493365, 0.5931197799604355, 0.7258684042513097, 0.8211493777537041, 0.5, 0.9275485526359472, 0.909970295454147, 0.9901023699807698, 0.7508137899961176, 0.8310263110406586, 0.8567239515016671, 0.8741683349374906, 0.9342627329519786, 0.5, 0.8169288180676535, 0.6488328357175615, 0.6981793051385092, 0.633190817571174, 0.9883384510462763, 0.5, 0.5564156272074801, 0.6814483467121657, 0.5087156378653959, 0.876535171990179, 0.5, 0.6581827096494364, 0.6586011603262747, 0.5, 0.5, 0.9756606061169458, 0.5529921967751528, 0.917082205451041, 0.6844692964407914, 0.5], "episode_lengths": [44, 14, 70, 13, 13, 46, 80, 40, 39, 13, 42, 13, 14, 15, 14, 80, 53, 70, 42, 13, 80, 55, 45, 14, 13, 80, 47, 51, 45, 19, 32, 61, 15, 11, 44, 45, 13, 63, 48, 80, 20, 80, 45, 50, 13, 13, 15, 14, 53, 30, 17, 16, 54, 57, 51, 38, 80, 13, 13, 37, 44, 14, 13, 13, 13, 55, 37, 15, 53, 14, 13, 13, 21, 18, 13, 13, 40, 46, 78, 80, 14, 15, 14, 13, 49, 13, 32, 51, 71, 44, 13, 13, 40, 14, 13, 53, 29, 14, 43, 14, 55, 17, 40, 50, 15, 13, 49, 55, 13, 17, 15, 42, 72, 63, 13, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0933047707601083, "mean_inference_ms": 0.25659026207664326, "mean_action_processing_ms": 0.03304018124082302, "mean_env_wait_ms": 0.04715517406729863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014792228567189183, "StateBufferConnector_ms": 0.0012730729990992054, "ViewRequirementAgentConnector_ms": 0.028344474989792395}}, "episode_reward_max": 0.9902723232585018, "episode_reward_min": -1.0, "episode_reward_mean": 0.5307755946361833, "episode_len_mean": 34.63793103448276, "episodes_this_iter": 116, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5566205591009807, 0.5, 0.6757439809930496, 0.7069871009774178, 0.7931854357895584, -1.0, 0.5, 0.926481848588845, 0.572782363695645, 0.6054317090877865, 0.7303371981095934, 0.6899098768280483, 0.5, 0.7807524595425448, -1.0, 0.9321265561752754, 0.5, 0.5740488081715784, 0.6594462809694255, -1.0, 0.8995956150122462, 0.5, 0.6595794772700494, 0.7843823859803376, -1.0, 0.931565743058559, 0.6047297739500929, 0.8597149669633899, 0.5, 0.6673977771492794, 0.8645747527916712, 0.51867301264077, -1.0, 0.6696844953634005, 0.7329724823786756, 0.5, 0.6753180507918521, 0.7090668425101665, -1.0, 0.56193769617418, -1.0, 0.949794065990505, 0.6953648337872376, 0.6120959252613567, 0.5, 0.5527854512434536, 0.5, 0.8287001325257664, 0.5, -1.0, 0.5, 0.9600090078801854, 0.5, 0.5, 0.6274168790196262, -1.0, 0.9902723232585018, 0.7281274742235901, 0.9324301715514002, 0.8507488699531246, 0.8864833240456113, 0.9431731958413447, 0.5, 0.5, 0.9002779646192521, 0.8362260325199008, 0.7675946937144187, 0.9394679627956527, 0.5436735909869312, 0.710160944359439, 0.9738950484611638, -1.0, 0.5, 0.5, 0.755039820848371, 0.5063288829815478, 0.6375896025540502, 0.7833247456208218, -1.0, 0.5, 0.5, 0.7456136971493365, 0.5931197799604355, 0.7258684042513097, 0.8211493777537041, 0.5, 0.9275485526359472, 0.909970295454147, 0.9901023699807698, 0.7508137899961176, 0.8310263110406586, 0.8567239515016671, 0.8741683349374906, 0.9342627329519786, 0.5, 0.8169288180676535, 0.6488328357175615, 0.6981793051385092, 0.633190817571174, 0.9883384510462763, 0.5, 0.5564156272074801, 0.6814483467121657, 0.5087156378653959, 0.876535171990179, 0.5, 0.6581827096494364, 0.6586011603262747, 0.5, 0.5, 0.9756606061169458, 0.5529921967751528, 0.917082205451041, 0.6844692964407914, 0.5], "episode_lengths": [44, 14, 70, 13, 13, 46, 80, 40, 39, 13, 42, 13, 14, 15, 14, 80, 53, 70, 42, 13, 80, 55, 45, 14, 13, 80, 47, 51, 45, 19, 32, 61, 15, 11, 44, 45, 13, 63, 48, 80, 20, 80, 45, 50, 13, 13, 15, 14, 53, 30, 17, 16, 54, 57, 51, 38, 80, 13, 13, 37, 44, 14, 13, 13, 13, 55, 37, 15, 53, 14, 13, 13, 21, 18, 13, 13, 40, 46, 78, 80, 14, 15, 14, 13, 49, 13, 32, 51, 71, 44, 13, 13, 40, 14, 13, 53, 29, 14, 43, 14, 55, 17, 40, 50, 15, 13, 49, 55, 13, 17, 15, 42, 72, 63, 13, 23]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0933047707601083, "mean_inference_ms": 0.25659026207664326, "mean_action_processing_ms": 0.03304018124082302, "mean_env_wait_ms": 0.04715517406729863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014792228567189183, "StateBufferConnector_ms": 0.0012730729990992054, "ViewRequirementAgentConnector_ms": 0.028344474989792395}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1105.6881078339468, "num_env_steps_trained_throughput_per_sec": 1105.6881078339468, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 3642.252, "sample_time_ms": 1724.778, "load_time_ms": 0.199, "load_throughput": 20051650.532, "learn_time_ms": 1916.286, "learn_throughput": 2087.371, "synch_weights_time_ms": 0.66}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 9366, "training_iteration": 91, "trial_id": "default", "date": "2024-05-23_11-37-54", "timestamp": 1716457074, "time_this_iter_s": 3.6205761432647705, "time_total_s": 332.67587208747864, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 332.67587208747864, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 19.72, "ram_util_percent": 56.75999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.39183567786409, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12492329874783203, "policy_loss": -0.005746909949968579, "vf_loss": 0.1305805700410518, "vf_explained_var": 0.05219176693629193, "kl": 0.007170988552473444, "entropy": 0.5940507037665255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 85095.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 0.999621762910316, "episode_reward_min": -1.0, "episode_reward_mean": 0.4737493071362456, "episode_len_mean": 34.63478260869565, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7276196475470148, 0.5, 0.5, 0.7471833623042403, 0.941599934078104, 0.9511867026660538, 0.5, 0.6993347295761191, 0.9955335722813132, 0.5, 0.6872665281724275, 0.7822451293307603, 0.8512793571870466, 0.5, 0.7444041288560417, -1.0, 0.8993288944353581, 0.7508370656725378, 0.9872331933631392, 0.5, 0.8584417533983653, 0.883199290342058, 0.5232878104203136, 0.8240675105145376, 0.5, 0.7714957569074603, 0.9142456152265377, 0.6331668751615414, 0.5, 0.6249841513578127, 0.6588799166770629, 0.9679351720218481, 0.5, 0.581997864678433, 0.5, 0.5, 0.5893274714780001, 0.5219646771555833, 0.9326670850253675, 0.8808193886237214, -1.0, 0.56278171999085, 0.5, -1.0, 0.8286513058145559, 0.6504240266496211, 0.9066328233122131, 0.5, 0.5, 0.9856266964330832, 0.7436496430809433, 0.7612786071528964, -1.0, -1.0, 0.5, 0.8815424018523884, 0.6718424509046736, 0.5, 0.965356423047273, 0.5, 0.5, 0.5, 0.5, 0.6088681491936958, 0.8751320925896884, 0.8631946760735766, 0.754506705999438, 0.6200891772588506, 0.7737261210088585, 0.5, 0.6546165736846324, 0.8847541584541516, 0.7236519651115312, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.9451556293698385, 0.5, 0.8734968197554338, 0.5, 0.5, 0.9508241188014279, -1.0, 0.5, 0.8085497599964345, 0.8477697356024323, 0.6610821462533407, -1.0, 0.674242212282197, 0.859141548128368, -1.0, 0.5, 0.6383210644828174, 0.5374532072415977, 0.5, -1.0, 0.999621762910316, 0.759483236474844, 0.5393453015095562, 0.5445444496887255, 0.9459585969162232, 0.8197567406453174, 0.5, 0.5588064514692029, 0.5, -1.0, 0.5, 0.522539152474178, -1.0, 0.8472200845942703, 0.5], "episode_lengths": [16, 22, 14, 14, 70, 66, 13, 13, 14, 16, 14, 15, 38, 15, 47, 80, 14, 15, 48, 13, 39, 46, 26, 13, 71, 35, 59, 48, 42, 13, 14, 47, 13, 15, 15, 38, 51, 51, 13, 51, 24, 60, 14, 80, 13, 13, 15, 16, 17, 36, 18, 15, 31, 80, 44, 55, 52, 14, 13, 52, 16, 32, 17, 15, 44, 65, 14, 13, 13, 15, 13, 51, 56, 80, 80, 15, 13, 80, 42, 20, 13, 28, 15, 15, 13, 48, 80, 57, 44, 13, 40, 80, 62, 17, 80, 14, 14, 48, 46, 80, 52, 40, 15, 27, 51, 43, 16, 65, 14, 80, 14, 13, 80, 39, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09329832032872404, "mean_inference_ms": 0.25654809627798164, "mean_action_processing_ms": 0.033033123125874184, "mean_env_wait_ms": 0.0471486684059005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015739772630774457, "StateBufferConnector_ms": 0.0012835212375806725, "ViewRequirementAgentConnector_ms": 0.028416799462359886}}, "episode_reward_max": 0.999621762910316, "episode_reward_min": -1.0, "episode_reward_mean": 0.4737493071362456, "episode_len_mean": 34.63478260869565, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7276196475470148, 0.5, 0.5, 0.7471833623042403, 0.941599934078104, 0.9511867026660538, 0.5, 0.6993347295761191, 0.9955335722813132, 0.5, 0.6872665281724275, 0.7822451293307603, 0.8512793571870466, 0.5, 0.7444041288560417, -1.0, 0.8993288944353581, 0.7508370656725378, 0.9872331933631392, 0.5, 0.8584417533983653, 0.883199290342058, 0.5232878104203136, 0.8240675105145376, 0.5, 0.7714957569074603, 0.9142456152265377, 0.6331668751615414, 0.5, 0.6249841513578127, 0.6588799166770629, 0.9679351720218481, 0.5, 0.581997864678433, 0.5, 0.5, 0.5893274714780001, 0.5219646771555833, 0.9326670850253675, 0.8808193886237214, -1.0, 0.56278171999085, 0.5, -1.0, 0.8286513058145559, 0.6504240266496211, 0.9066328233122131, 0.5, 0.5, 0.9856266964330832, 0.7436496430809433, 0.7612786071528964, -1.0, -1.0, 0.5, 0.8815424018523884, 0.6718424509046736, 0.5, 0.965356423047273, 0.5, 0.5, 0.5, 0.5, 0.6088681491936958, 0.8751320925896884, 0.8631946760735766, 0.754506705999438, 0.6200891772588506, 0.7737261210088585, 0.5, 0.6546165736846324, 0.8847541584541516, 0.7236519651115312, -1.0, -1.0, 0.5, 0.5, -1.0, 0.5, 0.5, 0.9451556293698385, 0.5, 0.8734968197554338, 0.5, 0.5, 0.9508241188014279, -1.0, 0.5, 0.8085497599964345, 0.8477697356024323, 0.6610821462533407, -1.0, 0.674242212282197, 0.859141548128368, -1.0, 0.5, 0.6383210644828174, 0.5374532072415977, 0.5, -1.0, 0.999621762910316, 0.759483236474844, 0.5393453015095562, 0.5445444496887255, 0.9459585969162232, 0.8197567406453174, 0.5, 0.5588064514692029, 0.5, -1.0, 0.5, 0.522539152474178, -1.0, 0.8472200845942703, 0.5], "episode_lengths": [16, 22, 14, 14, 70, 66, 13, 13, 14, 16, 14, 15, 38, 15, 47, 80, 14, 15, 48, 13, 39, 46, 26, 13, 71, 35, 59, 48, 42, 13, 14, 47, 13, 15, 15, 38, 51, 51, 13, 51, 24, 60, 14, 80, 13, 13, 15, 16, 17, 36, 18, 15, 31, 80, 44, 55, 52, 14, 13, 52, 16, 32, 17, 15, 44, 65, 14, 13, 13, 15, 13, 51, 56, 80, 80, 15, 13, 80, 42, 20, 13, 28, 15, 15, 13, 48, 80, 57, 44, 13, 40, 80, 62, 17, 80, 14, 14, 48, 46, 80, 52, 40, 15, 27, 51, 43, 16, 65, 14, 80, 14, 13, 80, 39, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09329832032872404, "mean_inference_ms": 0.25654809627798164, "mean_action_processing_ms": 0.033033123125874184, "mean_env_wait_ms": 0.0471486684059005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015739772630774457, "StateBufferConnector_ms": 0.0012835212375806725, "ViewRequirementAgentConnector_ms": 0.028416799462359886}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1079.358147550097, "num_env_steps_trained_throughput_per_sec": 1079.358147550097, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 3648.111, "sample_time_ms": 1722.919, "load_time_ms": 0.2, "load_throughput": 20049254.302, "learn_time_ms": 1924.002, "learn_throughput": 2079.0, "synch_weights_time_ms": 0.655}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 9481, "training_iteration": 92, "trial_id": "default", "date": "2024-05-23_11-37-58", "timestamp": 1716457078, "time_this_iter_s": 3.7088770866394043, "time_total_s": 336.38474917411804, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 336.38474917411804, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 20.2, "ram_util_percent": 56.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3182213098451654, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12624110127098218, "policy_loss": 0.0001250793636646322, "vf_loss": 0.1260106944929688, "vf_explained_var": 0.37983022960283425, "kl": 0.008426150217809866, "entropy": 0.6177378595516246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86025.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 0.9886095367121362, "episode_reward_min": -1.0, "episode_reward_mean": 0.38799373873138004, "episode_len_mean": 34.417391304347824, "episode_media": {}, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7276864811804268, 0.5, 0.7305705920925667, 0.8475259131813373, 0.5654922631062009, -1.0, 0.6669636577205476, 0.5, -1.0, 0.6669420071647719, 0.6401926205129919, 0.8337361690798623, -1.0, 0.5, 0.6502846714777745, 0.843187581798264, 0.9085954378814227, 0.7660288059487902, 0.6512037915708904, 0.5, 0.5, -1.0, 0.6094192036665969, 0.9198784085576165, -1.0, 0.6187697659081642, 0.5204503056174596, 0.5, 0.8273512445774025, -1.0, -1.0, 0.5, 0.6327850504195756, 0.6173371605350516, 0.8028976128803542, 0.9111109882674655, 0.770650286075862, 0.6387990794036158, 0.8386498503839557, -1.0, 0.5093378761929861, 0.5, 0.5, 0.5, 0.5, 0.8446385419741025, 0.6561442064750389, 0.802972899869091, 0.5420108287630248, 0.8274284377283145, 0.5, 0.5531956672120621, 0.5, -1.0, 0.5, -1.0, 0.7982413568296708, 0.5, 0.7795893447264013, 0.5654657791732525, 0.5062040625496316, -1.0, 0.6123768601188819, 0.5, 0.7322306881734408, 0.5, -1.0, 0.7452864607227156, 0.5, 0.5, 0.7724635068964727, 0.5, 0.5, 0.5, 0.8378855482641965, 0.6477443080898102, 0.5204000189791331, -1.0, 0.5, 0.8911664080613539, 0.5, -1.0, -1.0, 0.5, 0.8825703026270816, 0.9000275463835883, 0.5353153607553007, -1.0, -1.0, 0.5660148163860623, 0.8561555426357388, 0.8505379053240744, 0.5, 0.9886095367121362, 0.5917774376964939, 0.6513586541294253, 0.5, 0.5367600586893702, 0.894630350327441, 0.8103314018568926, -1.0, 0.8062406970456594, 0.9812244707431962, 0.5, 0.8248003132828978, 0.89037090997553, -1.0, 0.5, 0.919744203392888, 0.8734417087417821, 0.5, 0.9073479014027058, 0.5789987954970014, 0.5, 0.9217302906948941], "episode_lengths": [45, 13, 59, 35, 50, 80, 13, 53, 80, 14, 13, 14, 80, 15, 13, 18, 13, 53, 44, 14, 46, 80, 15, 69, 80, 14, 15, 74, 13, 9, 65, 27, 14, 38, 17, 13, 14, 28, 56, 80, 13, 14, 14, 14, 20, 50, 14, 48, 14, 48, 42, 55, 14, 80, 71, 80, 16, 15, 13, 14, 13, 80, 52, 14, 52, 14, 19, 14, 14, 14, 17, 24, 26, 17, 58, 42, 14, 80, 18, 45, 14, 80, 80, 13, 14, 55, 15, 80, 80, 59, 13, 13, 31, 14, 36, 29, 14, 39, 14, 14, 80, 52, 13, 14, 13, 13, 80, 49, 13, 47, 15, 13, 31, 14, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09329608735720804, "mean_inference_ms": 0.2565224145477885, "mean_action_processing_ms": 0.03302936301744791, "mean_env_wait_ms": 0.047143001881926695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015437084695567255, "StateBufferConnector_ms": 0.0012406058933423913, "ViewRequirementAgentConnector_ms": 0.028451836627462635}}, "episode_reward_max": 0.9886095367121362, "episode_reward_min": -1.0, "episode_reward_mean": 0.38799373873138004, "episode_len_mean": 34.417391304347824, "episodes_this_iter": 115, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.7276864811804268, 0.5, 0.7305705920925667, 0.8475259131813373, 0.5654922631062009, -1.0, 0.6669636577205476, 0.5, -1.0, 0.6669420071647719, 0.6401926205129919, 0.8337361690798623, -1.0, 0.5, 0.6502846714777745, 0.843187581798264, 0.9085954378814227, 0.7660288059487902, 0.6512037915708904, 0.5, 0.5, -1.0, 0.6094192036665969, 0.9198784085576165, -1.0, 0.6187697659081642, 0.5204503056174596, 0.5, 0.8273512445774025, -1.0, -1.0, 0.5, 0.6327850504195756, 0.6173371605350516, 0.8028976128803542, 0.9111109882674655, 0.770650286075862, 0.6387990794036158, 0.8386498503839557, -1.0, 0.5093378761929861, 0.5, 0.5, 0.5, 0.5, 0.8446385419741025, 0.6561442064750389, 0.802972899869091, 0.5420108287630248, 0.8274284377283145, 0.5, 0.5531956672120621, 0.5, -1.0, 0.5, -1.0, 0.7982413568296708, 0.5, 0.7795893447264013, 0.5654657791732525, 0.5062040625496316, -1.0, 0.6123768601188819, 0.5, 0.7322306881734408, 0.5, -1.0, 0.7452864607227156, 0.5, 0.5, 0.7724635068964727, 0.5, 0.5, 0.5, 0.8378855482641965, 0.6477443080898102, 0.5204000189791331, -1.0, 0.5, 0.8911664080613539, 0.5, -1.0, -1.0, 0.5, 0.8825703026270816, 0.9000275463835883, 0.5353153607553007, -1.0, -1.0, 0.5660148163860623, 0.8561555426357388, 0.8505379053240744, 0.5, 0.9886095367121362, 0.5917774376964939, 0.6513586541294253, 0.5, 0.5367600586893702, 0.894630350327441, 0.8103314018568926, -1.0, 0.8062406970456594, 0.9812244707431962, 0.5, 0.8248003132828978, 0.89037090997553, -1.0, 0.5, 0.919744203392888, 0.8734417087417821, 0.5, 0.9073479014027058, 0.5789987954970014, 0.5, 0.9217302906948941], "episode_lengths": [45, 13, 59, 35, 50, 80, 13, 53, 80, 14, 13, 14, 80, 15, 13, 18, 13, 53, 44, 14, 46, 80, 15, 69, 80, 14, 15, 74, 13, 9, 65, 27, 14, 38, 17, 13, 14, 28, 56, 80, 13, 14, 14, 14, 20, 50, 14, 48, 14, 48, 42, 55, 14, 80, 71, 80, 16, 15, 13, 14, 13, 80, 52, 14, 52, 14, 19, 14, 14, 14, 17, 24, 26, 17, 58, 42, 14, 80, 18, 45, 14, 80, 80, 13, 14, 55, 15, 80, 80, 59, 13, 13, 31, 14, 36, 29, 14, 39, 14, 14, 80, 52, 13, 14, 13, 13, 80, 49, 13, 47, 15, 13, 31, 14, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09329608735720804, "mean_inference_ms": 0.2565224145477885, "mean_action_processing_ms": 0.03302936301744791, "mean_env_wait_ms": 0.047143001881926695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015437084695567255, "StateBufferConnector_ms": 0.0012406058933423913, "ViewRequirementAgentConnector_ms": 0.028451836627462635}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1101.5557362167453, "num_env_steps_trained_throughput_per_sec": 1101.5557362167453, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 3647.192, "sample_time_ms": 1722.624, "load_time_ms": 0.2, "load_throughput": 20015767.12, "learn_time_ms": 1923.376, "learn_throughput": 2079.676, "synch_weights_time_ms": 0.654}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 9596, "training_iteration": 93, "trial_id": "default", "date": "2024-05-23_11-38-01", "timestamp": 1716457081, "time_this_iter_s": 3.6341888904571533, "time_total_s": 340.0189380645752, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 340.0189380645752, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.759999999999998, "ram_util_percent": 56.739999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.892325871541936, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1024157429654752, "policy_loss": -0.001900748959091562, "vf_loss": 0.1042437215966563, "vf_explained_var": -0.12906749517686905, "kl": 0.005821788565249179, "entropy": 0.6101718100168372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 86955.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 0.9989814389811066, "episode_reward_min": -1.0, "episode_reward_mean": 0.5623377171950827, "episode_len_mean": 29.735294117647058, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6394002019462697, 0.7807167602707711, 0.5, 0.5453539470934131, 0.7146613142015845, 0.8156683394803423, 0.9008487195210529, 0.6906532728863763, 0.632728427473978, 0.5, 0.5, 0.9645738552560985, 0.9526555911092758, 0.6329499875174203, 0.5, 0.578934940982019, 0.5, 0.7909438445193013, 0.994918566852421, -1.0, 0.5165159513694377, 0.9989814389811066, 0.9362227892962931, -1.0, 0.6235155138001272, 0.579026312594795, 0.9826016347713843, 0.8074203775035229, 0.7262095820426097, 0.5, 0.7036754766916629, 0.861338867502396, 0.5, 0.982443571713465, 0.9055935638076306, 0.5326617384082071, 0.7976086383145224, 0.6696838270210037, 0.5, 0.7747788283441367, 0.7292080961205545, 0.6292006714071178, 0.61951528966998, -1.0, 0.9500645728379569, 0.9479157566350429, 0.8680393946283208, -1.0, 0.9352994036451315, 0.5, 0.7554505526269744, 0.6705918770067003, 0.5727240728603693, 0.529783105719713, 0.5, 0.8155434824193393, 0.5, 0.7503966206045283, 0.907057400072132, 0.5285209528013382, 0.6870265351840834, 0.8332094881516993, 0.5, 0.6507978221175322, 0.5, 0.8896495948920229, -1.0, 0.6264980175989472, 0.6530599004961611, 0.8979344075671865, 0.8169351927869442, 0.5, 0.5, 0.582083919184573, 0.5, 0.7994982941132519, 0.7096248817253136, 0.7595436716337688, 0.7383492040029894, -1.0, 0.9476921718493676, 0.6146643775316938, 0.9012130954817656, 0.5578072353325432, 0.8511215412397983, 0.5, 0.6888170715471573, 0.6767954577803785, 0.5, -1.0, 0.7092294712966816, 0.5, 0.5, 0.638646328361802, 0.5, 0.5734016982321951, 0.7133058443721869, 0.5, 0.7024612965925772, 0.7809791535353743, 0.9339997334033255, 0.6578246811668882, 0.5, 0.5, 0.7940962333081864, 0.8598804302051771, 0.5, 0.5, 0.5, -1.0, 0.5, 0.9140079464612596, 0.5, 0.5, 0.664246811093311, 0.5, 0.6371399003415592, 0.5419446522964266, -1.0, 0.7183002561387359, 0.6518666400878805, 0.5, -1.0, 0.6386112443951931, 0.898938566245753, 0.68449240768318, 0.77571665883152, 0.9407277443208224, 0.7331744927702506, 0.6608559599459141, 0.7189999982446243, 0.8270410929770564, 0.7669178530497487, 0.7368700757674274, 0.9793333568611986, 0.5], "episode_lengths": [61, 15, 17, 13, 49, 44, 13, 38, 14, 14, 21, 49, 13, 14, 25, 13, 46, 13, 14, 10, 14, 50, 14, 74, 71, 42, 14, 52, 20, 13, 32, 13, 13, 57, 49, 13, 15, 14, 15, 13, 15, 15, 32, 80, 13, 13, 51, 80, 14, 45, 45, 14, 13, 30, 15, 74, 20, 13, 13, 60, 39, 19, 26, 61, 13, 39, 19, 71, 58, 53, 14, 40, 36, 15, 16, 27, 14, 37, 30, 80, 13, 39, 13, 33, 52, 19, 30, 37, 14, 23, 18, 18, 14, 42, 19, 13, 13, 27, 16, 13, 42, 31, 28, 15, 36, 16, 22, 15, 47, 80, 14, 44, 13, 14, 54, 14, 46, 45, 80, 28, 41, 14, 80, 14, 13, 13, 14, 48, 51, 13, 15, 13, 53, 14, 14, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09331025508390073, "mean_inference_ms": 0.2564915096484823, "mean_action_processing_ms": 0.033024804061988704, "mean_env_wait_ms": 0.047138648011697155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014971284305348115, "StateBufferConnector_ms": 0.0012955244849709904, "ViewRequirementAgentConnector_ms": 0.028391094768748563}}, "episode_reward_max": 0.9989814389811066, "episode_reward_min": -1.0, "episode_reward_mean": 0.5623377171950827, "episode_len_mean": 29.735294117647058, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.6394002019462697, 0.7807167602707711, 0.5, 0.5453539470934131, 0.7146613142015845, 0.8156683394803423, 0.9008487195210529, 0.6906532728863763, 0.632728427473978, 0.5, 0.5, 0.9645738552560985, 0.9526555911092758, 0.6329499875174203, 0.5, 0.578934940982019, 0.5, 0.7909438445193013, 0.994918566852421, -1.0, 0.5165159513694377, 0.9989814389811066, 0.9362227892962931, -1.0, 0.6235155138001272, 0.579026312594795, 0.9826016347713843, 0.8074203775035229, 0.7262095820426097, 0.5, 0.7036754766916629, 0.861338867502396, 0.5, 0.982443571713465, 0.9055935638076306, 0.5326617384082071, 0.7976086383145224, 0.6696838270210037, 0.5, 0.7747788283441367, 0.7292080961205545, 0.6292006714071178, 0.61951528966998, -1.0, 0.9500645728379569, 0.9479157566350429, 0.8680393946283208, -1.0, 0.9352994036451315, 0.5, 0.7554505526269744, 0.6705918770067003, 0.5727240728603693, 0.529783105719713, 0.5, 0.8155434824193393, 0.5, 0.7503966206045283, 0.907057400072132, 0.5285209528013382, 0.6870265351840834, 0.8332094881516993, 0.5, 0.6507978221175322, 0.5, 0.8896495948920229, -1.0, 0.6264980175989472, 0.6530599004961611, 0.8979344075671865, 0.8169351927869442, 0.5, 0.5, 0.582083919184573, 0.5, 0.7994982941132519, 0.7096248817253136, 0.7595436716337688, 0.7383492040029894, -1.0, 0.9476921718493676, 0.6146643775316938, 0.9012130954817656, 0.5578072353325432, 0.8511215412397983, 0.5, 0.6888170715471573, 0.6767954577803785, 0.5, -1.0, 0.7092294712966816, 0.5, 0.5, 0.638646328361802, 0.5, 0.5734016982321951, 0.7133058443721869, 0.5, 0.7024612965925772, 0.7809791535353743, 0.9339997334033255, 0.6578246811668882, 0.5, 0.5, 0.7940962333081864, 0.8598804302051771, 0.5, 0.5, 0.5, -1.0, 0.5, 0.9140079464612596, 0.5, 0.5, 0.664246811093311, 0.5, 0.6371399003415592, 0.5419446522964266, -1.0, 0.7183002561387359, 0.6518666400878805, 0.5, -1.0, 0.6386112443951931, 0.898938566245753, 0.68449240768318, 0.77571665883152, 0.9407277443208224, 0.7331744927702506, 0.6608559599459141, 0.7189999982446243, 0.8270410929770564, 0.7669178530497487, 0.7368700757674274, 0.9793333568611986, 0.5], "episode_lengths": [61, 15, 17, 13, 49, 44, 13, 38, 14, 14, 21, 49, 13, 14, 25, 13, 46, 13, 14, 10, 14, 50, 14, 74, 71, 42, 14, 52, 20, 13, 32, 13, 13, 57, 49, 13, 15, 14, 15, 13, 15, 15, 32, 80, 13, 13, 51, 80, 14, 45, 45, 14, 13, 30, 15, 74, 20, 13, 13, 60, 39, 19, 26, 61, 13, 39, 19, 71, 58, 53, 14, 40, 36, 15, 16, 27, 14, 37, 30, 80, 13, 39, 13, 33, 52, 19, 30, 37, 14, 23, 18, 18, 14, 42, 19, 13, 13, 27, 16, 13, 42, 31, 28, 15, 36, 16, 22, 15, 47, 80, 14, 44, 13, 14, 54, 14, 46, 45, 80, 28, 41, 14, 80, 14, 13, 13, 14, 48, 51, 13, 15, 13, 53, 14, 14, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09331025508390073, "mean_inference_ms": 0.2564915096484823, "mean_action_processing_ms": 0.033024804061988704, "mean_env_wait_ms": 0.047138648011697155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014971284305348115, "StateBufferConnector_ms": 0.0012955244849709904, "ViewRequirementAgentConnector_ms": 0.028391094768748563}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1100.576448767537, "num_env_steps_trained_throughput_per_sec": 1100.576448767537, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 3647.031, "sample_time_ms": 1723.271, "load_time_ms": 0.2, "load_throughput": 20034888.942, "learn_time_ms": 1922.565, "learn_throughput": 2080.554, "synch_weights_time_ms": 0.659}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 9732, "training_iteration": 94, "trial_id": "default", "date": "2024-05-23_11-38-05", "timestamp": 1716457085, "time_this_iter_s": 3.637629985809326, "time_total_s": 343.6565680503845, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 343.6565680503845, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 17.22, "ram_util_percent": 56.660000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0813785271458727, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19065598171224357, "policy_loss": -0.007272654426814888, "vf_loss": 0.19786518194302116, "vf_explained_var": 0.18745158321113997, "kl": 0.005076225945361632, "entropy": 0.6158258041707418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 0.9867991946143132, "episode_reward_min": -1.0, "episode_reward_mean": 0.43902456581332777, "episode_len_mean": 29.36764705882353, "episode_media": {}, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.9552566326141435, 0.5, -1.0, 0.7511943831955729, 0.9379883167418461, 0.6641502389891873, 0.5, 0.6081980975820052, 0.5, 0.7969374732367871, 0.5, 0.7895470596296138, 0.8587421874641529, 0.7310640187826325, 0.5003552642745697, 0.7653353408679932, 0.7965091944771363, -1.0, 0.9595314764604043, -1.0, 0.5, 0.8456545451867812, 0.8407218408248635, 0.6733709545068008, 0.5, 0.6917523106214681, 0.8213868244114733, 0.5, 0.8484276295892621, -1.0, 0.5, 0.9660571586527147, 0.7171711740133151, 0.7763474947093029, -1.0, 0.8880244023251415, 0.8304095762409622, 0.954113619299113, -1.0, 0.9867991946143132, 0.582106832369653, 0.5, 0.9384229326627674, 0.9800245177814386, 0.6161157937408346, 0.5, 0.9441238697294878, -1.0, 0.5, 0.5, 0.742128161010154, -1.0, 0.5, -1.0, 0.6780248683386643, 0.5, 0.7502824996177511, 0.5, 0.884606720533342, 0.7019253935590053, 0.7233813788289079, -1.0, 0.6238861328102947, 0.5, 0.7595152146924574, 0.7932461673938346, 0.8958803664082216, 0.7691000401926212, 0.7452094163778719, 0.7095772229873225, 0.5, 0.731678913957205, 0.9015880159723558, 0.6549732981846257, -1.0, 0.8889481565060968, 0.9683001707981213, 0.921127408329925, 0.5, 0.5, 0.5802551677812936, 0.5, 0.5153008855673242, 0.9226066121027261, 0.6896919434237639, 0.708365190326342, 0.8576912197600423, -1.0, 0.5, 0.5, 0.8558433061164687, 0.5, 0.5, 0.9486633512215644, 0.5, 0.7921473600693696, -1.0, 0.5, 0.9834210195966933, 0.9451161696134943, 0.5605808413866963, 0.5, 0.6717559160104467, -1.0, 0.5, 0.5, 0.6851636189760864, 0.5747582436621627, -1.0, 0.5, 0.9245546082978603, 0.754379122255712, 0.7491476400715646, 0.9484681103881496, 0.6477744808715331, 0.5, 0.6104474746079542, 0.5, 0.5, 0.6250980320871746, 0.5, 0.8990766253261755, 0.6756975676876169, 0.5, 0.6449087543107297, -1.0, -1.0, -1.0, 0.7039855419989575, 0.5, 0.8732222450001594, 0.5, 0.5, -1.0], "episode_lengths": [80, 48, 13, 36, 9, 36, 42, 14, 62, 19, 13, 13, 16, 13, 14, 15, 14, 53, 42, 80, 34, 80, 15, 16, 36, 14, 16, 17, 14, 47, 13, 80, 52, 35, 13, 13, 80, 15, 46, 66, 21, 38, 14, 14, 14, 45, 13, 19, 13, 25, 14, 14, 13, 80, 15, 80, 14, 14, 13, 13, 13, 49, 55, 60, 13, 15, 16, 13, 51, 13, 13, 14, 15, 13, 14, 66, 80, 13, 51, 42, 14, 23, 47, 13, 67, 48, 58, 14, 13, 80, 14, 16, 13, 15, 24, 13, 13, 13, 80, 15, 13, 14, 15, 18, 14, 9, 13, 14, 13, 13, 80, 15, 59, 13, 15, 55, 41, 15, 13, 17, 13, 13, 30, 49, 32, 13, 29, 80, 11, 80, 13, 14, 17, 15, 14, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09332593338280247, "mean_inference_ms": 0.25646270847159686, "mean_action_processing_ms": 0.03302030155709989, "mean_env_wait_ms": 0.04713482562003158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015027382794548484, "StateBufferConnector_ms": 0.00132445026846493, "ViewRequirementAgentConnector_ms": 0.028621624497806326}}, "episode_reward_max": 0.9867991946143132, "episode_reward_min": -1.0, "episode_reward_mean": 0.43902456581332777, "episode_len_mean": 29.36764705882353, "episodes_this_iter": 136, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1.0, 0.5, 0.9552566326141435, 0.5, -1.0, 0.7511943831955729, 0.9379883167418461, 0.6641502389891873, 0.5, 0.6081980975820052, 0.5, 0.7969374732367871, 0.5, 0.7895470596296138, 0.8587421874641529, 0.7310640187826325, 0.5003552642745697, 0.7653353408679932, 0.7965091944771363, -1.0, 0.9595314764604043, -1.0, 0.5, 0.8456545451867812, 0.8407218408248635, 0.6733709545068008, 0.5, 0.6917523106214681, 0.8213868244114733, 0.5, 0.8484276295892621, -1.0, 0.5, 0.9660571586527147, 0.7171711740133151, 0.7763474947093029, -1.0, 0.8880244023251415, 0.8304095762409622, 0.954113619299113, -1.0, 0.9867991946143132, 0.582106832369653, 0.5, 0.9384229326627674, 0.9800245177814386, 0.6161157937408346, 0.5, 0.9441238697294878, -1.0, 0.5, 0.5, 0.742128161010154, -1.0, 0.5, -1.0, 0.6780248683386643, 0.5, 0.7502824996177511, 0.5, 0.884606720533342, 0.7019253935590053, 0.7233813788289079, -1.0, 0.6238861328102947, 0.5, 0.7595152146924574, 0.7932461673938346, 0.8958803664082216, 0.7691000401926212, 0.7452094163778719, 0.7095772229873225, 0.5, 0.731678913957205, 0.9015880159723558, 0.6549732981846257, -1.0, 0.8889481565060968, 0.9683001707981213, 0.921127408329925, 0.5, 0.5, 0.5802551677812936, 0.5, 0.5153008855673242, 0.9226066121027261, 0.6896919434237639, 0.708365190326342, 0.8576912197600423, -1.0, 0.5, 0.5, 0.8558433061164687, 0.5, 0.5, 0.9486633512215644, 0.5, 0.7921473600693696, -1.0, 0.5, 0.9834210195966933, 0.9451161696134943, 0.5605808413866963, 0.5, 0.6717559160104467, -1.0, 0.5, 0.5, 0.6851636189760864, 0.5747582436621627, -1.0, 0.5, 0.9245546082978603, 0.754379122255712, 0.7491476400715646, 0.9484681103881496, 0.6477744808715331, 0.5, 0.6104474746079542, 0.5, 0.5, 0.6250980320871746, 0.5, 0.8990766253261755, 0.6756975676876169, 0.5, 0.6449087543107297, -1.0, -1.0, -1.0, 0.7039855419989575, 0.5, 0.8732222450001594, 0.5, 0.5, -1.0], "episode_lengths": [80, 48, 13, 36, 9, 36, 42, 14, 62, 19, 13, 13, 16, 13, 14, 15, 14, 53, 42, 80, 34, 80, 15, 16, 36, 14, 16, 17, 14, 47, 13, 80, 52, 35, 13, 13, 80, 15, 46, 66, 21, 38, 14, 14, 14, 45, 13, 19, 13, 25, 14, 14, 13, 80, 15, 80, 14, 14, 13, 13, 13, 49, 55, 60, 13, 15, 16, 13, 51, 13, 13, 14, 15, 13, 14, 66, 80, 13, 51, 42, 14, 23, 47, 13, 67, 48, 58, 14, 13, 80, 14, 16, 13, 15, 24, 13, 13, 13, 80, 15, 13, 14, 15, 18, 14, 9, 13, 14, 13, 13, 80, 15, 59, 13, 15, 55, 41, 15, 13, 17, 13, 13, 30, 49, 32, 13, 29, 80, 11, 80, 13, 14, 17, 15, 14, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09332593338280247, "mean_inference_ms": 0.25646270847159686, "mean_action_processing_ms": 0.03302030155709989, "mean_env_wait_ms": 0.04713482562003158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015027382794548484, "StateBufferConnector_ms": 0.00132445026846493, "ViewRequirementAgentConnector_ms": 0.028621624497806326}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1102.6756810135785, "num_env_steps_trained_throughput_per_sec": 1102.6756810135785, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 3638.269, "sample_time_ms": 1723.475, "load_time_ms": 0.2, "load_throughput": 20037281.739, "learn_time_ms": 1913.612, "learn_throughput": 2090.288, "synch_weights_time_ms": 0.651}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 9868, "training_iteration": 95, "trial_id": "default", "date": "2024-05-23_11-38-09", "timestamp": 1716457089, "time_this_iter_s": 3.6305301189422607, "time_total_s": 347.2870981693268, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 347.2870981693268, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 10.620000000000001, "ram_util_percent": 56.71999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.126852597664761, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21389317181642337, "policy_loss": -0.0029952835171453414, "vf_loss": 0.21678399661335573, "vf_explained_var": 0.02219037913507031, "kl": 0.008356565500114007, "entropy": 0.6390574052769651, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 88815.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 0.9993796200167757, "episode_reward_min": -1.0, "episode_reward_mean": 0.42722561837234224, "episode_len_mean": 27.71527777777778, "episode_media": {}, "episodes_this_iter": 144, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.729549280810933, 0.7486638511684371, -1.0, 0.6311552467055147, -1.0, 0.8287377114536988, 0.8896791347001434, 0.5, 0.5, -1.0, 0.5199045631647126, 0.6478582838080338, -1.0, 0.9417961063460265, 0.5, 0.6597385523734585, 0.5, 0.5, 0.9564843913942463, 0.952634589966623, 0.9692283423473194, 0.640041530896148, 0.7728571208778169, 0.5823457078416459, 0.5, 0.5, 0.9650417723405695, 0.5, 0.5, 0.8239737280532584, 0.6419961740539293, 0.9333889898757095, 0.8115426444364958, 0.9658768386750625, 0.9736273104880354, 0.5, 0.9073345802841204, -1.0, 0.5873630450427749, 0.6936449624082366, 0.5727051646160535, 0.5972671087324561, 0.5, 0.7456828985247088, 0.7301648338156829, 0.5246226123544392, -1.0, -1.0, 0.9055028712870307, 0.8356706030302928, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.9993796200167757, 0.5812614435644521, 0.961270085740738, 0.688652664713497, 0.5951085009008472, 0.5, 0.9275705168619456, 0.659864759515178, 0.6413729289716571, -1.0, 0.6834855623567062, 0.5, -1.0, 0.8213507443863259, 0.5051959073505414, 0.5969012273232768, 0.779117159425371, 0.5, 0.830086823412147, 0.9128337968851526, 0.9094447818792607, 0.7114291651150275, -1.0, 0.5, 0.9277728334278876, 0.5, 0.5, -1.0, 0.5799350372141876, 0.8171693413048252, -1.0, 0.5, 0.5, 0.5, 0.7797900628737937, 0.5, 0.5493940092250063, 0.5, -1.0, 0.5368842999505594, 0.6452838151623106, 0.9988080401338522, 0.5, 0.9031344925702863, 0.9034344850690902, 0.8025017938595209, 0.5, 0.8096193067942314, 0.5, 0.5, 0.8964659444194338, 0.7735242827518128, 0.5819339802922356, 0.5443336174638512, 0.5527609382043879, 0.5, 0.5, 0.7035639125054742, 0.7352294316142919, 0.5, 0.733715456798604, 0.7285483703966764, 0.5115449695860406, 0.5, 0.8319976360153987, 0.8823528098818912, 0.6281884050339831, 0.5, 0.6636181057557193, -1.0, 0.8889538397062284, 0.7813952110197352, 0.9792996087815762, 0.5234314526951671, 0.7573352444889954, 0.6544877160167712, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.9236743543109416, -1.0, 0.5], "episode_lengths": [29, 13, 41, 80, 14, 80, 58, 14, 14, 15, 80, 23, 55, 16, 18, 14, 25, 21, 26, 13, 13, 42, 13, 70, 14, 61, 13, 63, 38, 15, 13, 42, 57, 13, 13, 58, 19, 13, 80, 40, 14, 13, 47, 20, 13, 13, 16, 80, 80, 14, 15, 28, 20, 13, 13, 13, 15, 49, 56, 39, 16, 31, 13, 15, 13, 18, 35, 16, 14, 14, 80, 64, 44, 13, 68, 14, 13, 52, 14, 13, 80, 24, 54, 17, 47, 17, 49, 15, 17, 14, 15, 17, 39, 24, 14, 14, 55, 14, 14, 13, 14, 60, 14, 13, 14, 41, 42, 22, 40, 22, 41, 15, 13, 15, 28, 13, 14, 17, 14, 13, 15, 20, 14, 13, 25, 14, 30, 15, 14, 13, 13, 13, 28, 15, 14, 16, 80, 13, 15, 17, 17, 58, 18, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09334612170730304, "mean_inference_ms": 0.25643721125050084, "mean_action_processing_ms": 0.03301709736154506, "mean_env_wait_ms": 0.04713470631757922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015467405319213867, "StateBufferConnector_ms": 0.0012763672404819066, "ViewRequirementAgentConnector_ms": 0.02860741482840644}}, "episode_reward_max": 0.9993796200167757, "episode_reward_min": -1.0, "episode_reward_mean": 0.42722561837234224, "episode_len_mean": 27.71527777777778, "episodes_this_iter": 144, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.729549280810933, 0.7486638511684371, -1.0, 0.6311552467055147, -1.0, 0.8287377114536988, 0.8896791347001434, 0.5, 0.5, -1.0, 0.5199045631647126, 0.6478582838080338, -1.0, 0.9417961063460265, 0.5, 0.6597385523734585, 0.5, 0.5, 0.9564843913942463, 0.952634589966623, 0.9692283423473194, 0.640041530896148, 0.7728571208778169, 0.5823457078416459, 0.5, 0.5, 0.9650417723405695, 0.5, 0.5, 0.8239737280532584, 0.6419961740539293, 0.9333889898757095, 0.8115426444364958, 0.9658768386750625, 0.9736273104880354, 0.5, 0.9073345802841204, -1.0, 0.5873630450427749, 0.6936449624082366, 0.5727051646160535, 0.5972671087324561, 0.5, 0.7456828985247088, 0.7301648338156829, 0.5246226123544392, -1.0, -1.0, 0.9055028712870307, 0.8356706030302928, 0.5, -1.0, 0.5, 0.5, 0.5, -1.0, 0.5, 0.9993796200167757, 0.5812614435644521, 0.961270085740738, 0.688652664713497, 0.5951085009008472, 0.5, 0.9275705168619456, 0.659864759515178, 0.6413729289716571, -1.0, 0.6834855623567062, 0.5, -1.0, 0.8213507443863259, 0.5051959073505414, 0.5969012273232768, 0.779117159425371, 0.5, 0.830086823412147, 0.9128337968851526, 0.9094447818792607, 0.7114291651150275, -1.0, 0.5, 0.9277728334278876, 0.5, 0.5, -1.0, 0.5799350372141876, 0.8171693413048252, -1.0, 0.5, 0.5, 0.5, 0.7797900628737937, 0.5, 0.5493940092250063, 0.5, -1.0, 0.5368842999505594, 0.6452838151623106, 0.9988080401338522, 0.5, 0.9031344925702863, 0.9034344850690902, 0.8025017938595209, 0.5, 0.8096193067942314, 0.5, 0.5, 0.8964659444194338, 0.7735242827518128, 0.5819339802922356, 0.5443336174638512, 0.5527609382043879, 0.5, 0.5, 0.7035639125054742, 0.7352294316142919, 0.5, 0.733715456798604, 0.7285483703966764, 0.5115449695860406, 0.5, 0.8319976360153987, 0.8823528098818912, 0.6281884050339831, 0.5, 0.6636181057557193, -1.0, 0.8889538397062284, 0.7813952110197352, 0.9792996087815762, 0.5234314526951671, 0.7573352444889954, 0.6544877160167712, 0.5, -1.0, -1.0, 0.5, -1.0, -1.0, 0.5, 0.9236743543109416, -1.0, 0.5], "episode_lengths": [29, 13, 41, 80, 14, 80, 58, 14, 14, 15, 80, 23, 55, 16, 18, 14, 25, 21, 26, 13, 13, 42, 13, 70, 14, 61, 13, 63, 38, 15, 13, 42, 57, 13, 13, 58, 19, 13, 80, 40, 14, 13, 47, 20, 13, 13, 16, 80, 80, 14, 15, 28, 20, 13, 13, 13, 15, 49, 56, 39, 16, 31, 13, 15, 13, 18, 35, 16, 14, 14, 80, 64, 44, 13, 68, 14, 13, 52, 14, 13, 80, 24, 54, 17, 47, 17, 49, 15, 17, 14, 15, 17, 39, 24, 14, 14, 55, 14, 14, 13, 14, 60, 14, 13, 14, 41, 42, 22, 40, 22, 41, 15, 13, 15, 28, 13, 14, 17, 14, 13, 15, 20, 14, 13, 25, 14, 30, 15, 14, 13, 13, 13, 28, 15, 14, 16, 80, 13, 15, 17, 17, 58, 18, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09334612170730304, "mean_inference_ms": 0.25643721125050084, "mean_action_processing_ms": 0.03301709736154506, "mean_env_wait_ms": 0.04713470631757922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015467405319213867, "StateBufferConnector_ms": 0.0012763672404819066, "ViewRequirementAgentConnector_ms": 0.02860741482840644}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1099.2885872223517, "num_env_steps_trained_throughput_per_sec": 1099.2885872223517, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 3639.335, "sample_time_ms": 1724.678, "load_time_ms": 0.2, "load_throughput": 19968121.876, "learn_time_ms": 1913.488, "learn_throughput": 2090.423, "synch_weights_time_ms": 0.637}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 10012, "training_iteration": 96, "trial_id": "default", "date": "2024-05-23_11-38-12", "timestamp": 1716457092, "time_this_iter_s": 3.641875982284546, "time_total_s": 350.9289741516113, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 350.9289741516113, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 17.84, "ram_util_percent": 56.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6741385786603855, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14730746570213507, "policy_loss": -0.006107977261486393, "vf_loss": 0.15331990975055404, "vf_explained_var": 0.024174712357982513, "kl": 0.007642535075427746, "entropy": 0.6263491360731023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 89745.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 0.9940678562487859, "episode_reward_min": -1.0, "episode_reward_mean": 0.4504028621986185, "episode_len_mean": 31.606299212598426, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9940678562487859, 0.5, 0.5, 0.9263704142752677, 0.7947002856475383, 0.6881571518438616, -1.0, -1.0, -1.0, 0.8227452721588921, 0.5, 0.7913946686203662, 0.5, 0.7094637622086726, 0.7275892368263719, -1.0, 0.5673543023940506, 0.6557733838995554, 0.7146165252615191, 0.9469723850951347, -1.0, -1.0, 0.5533222511033848, 0.5, 0.5, 0.6465353030996113, 0.7275845730092577, -1.0, 0.5, 0.5, -1.0, 0.7731137829652894, 0.5, 0.9597880265028519, 0.5, 0.6808377267477217, 0.5, 0.5, 0.9459107442115299, 0.5545800787277718, 0.5, 0.5289938514052024, 0.5, 0.9893166862731367, 0.8872976475355149, 0.5315378389586749, 0.9306889353783688, 0.9396971415175913, -1.0, 0.5, 0.8312189683038731, 0.5, 0.9620372416244011, 0.5161534136190576, -1.0, 0.9867124276320138, 0.5, 0.5052173951355416, 0.7106357591240093, 0.8755675600337116, 0.7117880470570994, 0.5, 0.7236202022823708, 0.5, -1.0, 0.6498917656056337, 0.7742419423948197, 0.8787452252165037, 0.9293471278107917, 0.8296998644449706, 0.5, 0.9420626490052436, 0.5, 0.5, 0.659962747278087, 0.8067464657396403, 0.7496675490013787, 0.5094190053227823, 0.7287944485654037, 0.5, 0.8151613865406779, 0.8865060467610266, -1.0, 0.5, 0.5, 0.6349230099833743, 0.7300777241744487, 0.5676545509852169, 0.5, 0.5, 0.5, 0.5, 0.6821575434689195, 0.7566533182692762, 0.7114935238793567, 0.8031379349645189, 0.5, 0.8037395078698839, 0.9433736075243908, 0.836453079331114, 0.6324850200970557, 0.725802438392902, 0.8382717368699021, 0.782527504522686, -1.0, 0.5545132434928945, 0.5, 0.5, -1.0, 0.5, 0.81541859653703, 0.5, 0.5, 0.5, 0.9819344705142319, -1.0, 0.9846400672418628, 0.8967541833502141, -1.0, 0.7052850543664173, -1.0, 0.5, 0.5, 0.7664476866209071, 0.9002894780526952, 0.5, 0.6755231483002957], "episode_lengths": [53, 13, 36, 14, 14, 14, 16, 27, 80, 49, 14, 66, 13, 13, 66, 17, 53, 55, 55, 36, 19, 63, 13, 53, 50, 13, 13, 23, 14, 67, 15, 61, 13, 51, 17, 13, 46, 47, 50, 33, 13, 14, 18, 13, 70, 28, 13, 13, 80, 14, 54, 21, 13, 15, 80, 45, 14, 13, 55, 55, 14, 68, 29, 13, 80, 42, 47, 57, 13, 14, 13, 15, 15, 21, 13, 30, 13, 36, 52, 13, 59, 14, 42, 16, 14, 52, 55, 64, 46, 41, 55, 14, 18, 73, 57, 14, 13, 37, 13, 14, 16, 14, 13, 15, 19, 13, 16, 14, 80, 14, 13, 15, 15, 28, 13, 80, 13, 13, 32, 38, 80, 13, 14, 52, 13, 15, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.093352101791093, "mean_inference_ms": 0.2564045919347021, "mean_action_processing_ms": 0.0330113077535702, "mean_env_wait_ms": 0.047131894983277085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015373305072934609, "StateBufferConnector_ms": 0.0012934677244171382, "ViewRequirementAgentConnector_ms": 0.028505287771149884}}, "episode_reward_max": 0.9940678562487859, "episode_reward_min": -1.0, "episode_reward_mean": 0.4504028621986185, "episode_len_mean": 31.606299212598426, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.9940678562487859, 0.5, 0.5, 0.9263704142752677, 0.7947002856475383, 0.6881571518438616, -1.0, -1.0, -1.0, 0.8227452721588921, 0.5, 0.7913946686203662, 0.5, 0.7094637622086726, 0.7275892368263719, -1.0, 0.5673543023940506, 0.6557733838995554, 0.7146165252615191, 0.9469723850951347, -1.0, -1.0, 0.5533222511033848, 0.5, 0.5, 0.6465353030996113, 0.7275845730092577, -1.0, 0.5, 0.5, -1.0, 0.7731137829652894, 0.5, 0.9597880265028519, 0.5, 0.6808377267477217, 0.5, 0.5, 0.9459107442115299, 0.5545800787277718, 0.5, 0.5289938514052024, 0.5, 0.9893166862731367, 0.8872976475355149, 0.5315378389586749, 0.9306889353783688, 0.9396971415175913, -1.0, 0.5, 0.8312189683038731, 0.5, 0.9620372416244011, 0.5161534136190576, -1.0, 0.9867124276320138, 0.5, 0.5052173951355416, 0.7106357591240093, 0.8755675600337116, 0.7117880470570994, 0.5, 0.7236202022823708, 0.5, -1.0, 0.6498917656056337, 0.7742419423948197, 0.8787452252165037, 0.9293471278107917, 0.8296998644449706, 0.5, 0.9420626490052436, 0.5, 0.5, 0.659962747278087, 0.8067464657396403, 0.7496675490013787, 0.5094190053227823, 0.7287944485654037, 0.5, 0.8151613865406779, 0.8865060467610266, -1.0, 0.5, 0.5, 0.6349230099833743, 0.7300777241744487, 0.5676545509852169, 0.5, 0.5, 0.5, 0.5, 0.6821575434689195, 0.7566533182692762, 0.7114935238793567, 0.8031379349645189, 0.5, 0.8037395078698839, 0.9433736075243908, 0.836453079331114, 0.6324850200970557, 0.725802438392902, 0.8382717368699021, 0.782527504522686, -1.0, 0.5545132434928945, 0.5, 0.5, -1.0, 0.5, 0.81541859653703, 0.5, 0.5, 0.5, 0.9819344705142319, -1.0, 0.9846400672418628, 0.8967541833502141, -1.0, 0.7052850543664173, -1.0, 0.5, 0.5, 0.7664476866209071, 0.9002894780526952, 0.5, 0.6755231483002957], "episode_lengths": [53, 13, 36, 14, 14, 14, 16, 27, 80, 49, 14, 66, 13, 13, 66, 17, 53, 55, 55, 36, 19, 63, 13, 53, 50, 13, 13, 23, 14, 67, 15, 61, 13, 51, 17, 13, 46, 47, 50, 33, 13, 14, 18, 13, 70, 28, 13, 13, 80, 14, 54, 21, 13, 15, 80, 45, 14, 13, 55, 55, 14, 68, 29, 13, 80, 42, 47, 57, 13, 14, 13, 15, 15, 21, 13, 30, 13, 36, 52, 13, 59, 14, 42, 16, 14, 52, 55, 64, 46, 41, 55, 14, 18, 73, 57, 14, 13, 37, 13, 14, 16, 14, 13, 15, 19, 13, 16, 14, 80, 14, 13, 15, 15, 28, 13, 80, 13, 13, 32, 38, 80, 13, 14, 52, 13, 15, 25]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.093352101791093, "mean_inference_ms": 0.2564045919347021, "mean_action_processing_ms": 0.0330113077535702, "mean_env_wait_ms": 0.047131894983277085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015373305072934609, "StateBufferConnector_ms": 0.0012934677244171382, "ViewRequirementAgentConnector_ms": 0.028505287771149884}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1100.200213269659, "num_env_steps_trained_throughput_per_sec": 1100.200213269659, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 3639.84, "sample_time_ms": 1724.18, "load_time_ms": 0.201, "load_throughput": 19890001.186, "learn_time_ms": 1914.504, "learn_throughput": 2089.314, "synch_weights_time_ms": 0.625}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 10139, "training_iteration": 97, "trial_id": "default", "date": "2024-05-23_11-38-16", "timestamp": 1716457096, "time_this_iter_s": 3.638641834259033, "time_total_s": 354.56761598587036, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 354.56761598587036, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 14.059999999999999, "ram_util_percent": 56.67999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0660838424518544, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18377894134290756, "policy_loss": -0.004834049355278733, "vf_loss": 0.18853395920326954, "vf_explained_var": -0.16272270359018798, "kl": 0.006322456305628097, "entropy": 0.5761071441635008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 90675.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 0.9998810193166682, "episode_reward_min": -1.0, "episode_reward_mean": 0.4998656783978592, "episode_len_mean": 31.559055118110237, "episode_media": {}, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5823652565735467, 0.6789184244318855, 0.7768894916898851, 0.5, 0.5, 0.794791556378017, -1.0, 0.8308869336993272, -1.0, -1.0, 0.7923793738322653, 0.551456795896319, 0.9411964852986997, 0.5, 0.7065499120666225, 0.5317571983834872, 0.5, 0.8830261590530664, 0.5, 0.8090171546164296, 0.8644035372949146, 0.7834788977265086, 0.7604726385252606, 0.5337349773011664, -1.0, 0.6988888860411053, 0.6899824705380149, 0.8860825990400674, 0.9191346332881785, 0.8100789867167757, 0.5, 0.5, -1.0, 0.7943742970473631, 0.7349458525804642, 0.6842374570803885, 0.5, 0.9517124363255856, 0.5, 0.749651325341238, 0.5, 0.70475167140543, 0.671122801953967, -1.0, 0.9998810193166682, 0.9648987657095229, 0.9947590038178478, 0.8949913251750692, 0.9404266170744882, 0.9885171766156909, 0.5647786783562179, 0.5, 0.5773421397423733, -1.0, 0.9350715119344098, -1.0, 0.6371693206358024, -1.0, 0.9279671839287321, 0.5655728730351554, 0.7953868426636317, 0.9616729790587584, 0.7667999424842458, 0.7343033034364218, 0.5, 0.7896353800422726, 0.5, 0.9406915451277023, -1.0, 0.5, 0.5, -1.0, 0.6335409484038741, 0.5956550570907269, 0.5, 0.5, 0.5, 0.5161071832153862, 0.900082499790164, 0.5, -1.0, 0.7924388294497803, 0.8723593445027752, 0.5, 0.6382358869369058, -1.0, 0.7606993197189511, 0.5, 0.8298420414539569, 0.6199705985696349, 0.8916058253601495, 0.9323338989593264, 0.8060545403747781, 0.8697437538079589, 0.9281703923823575, 0.5, 0.5, 0.6380394005098592, 0.625633963118428, 0.7873112143269633, 0.6983591514485976, 0.907149376278298, 0.7556606515809878, 0.7212310879973345, 0.5, 0.5, 0.9397593594131747, 0.7131463212443598, 0.5, 0.9960722686107059, -1.0, 0.7338694459354491, 0.5, 0.9016603593110215, 0.5594950699367063, -1.0, 0.933029250931602, 0.5, 0.7726799141194435, 0.7912318943229468, 0.8593052611275123, 0.5, 0.5, 0.647696297235433, 0.5, 0.8186169307815798, 0.5], "episode_lengths": [42, 53, 43, 15, 14, 52, 80, 13, 80, 80, 15, 15, 58, 21, 50, 13, 14, 54, 22, 38, 13, 14, 47, 13, 80, 14, 13, 60, 14, 56, 49, 20, 80, 13, 14, 55, 24, 18, 14, 43, 14, 13, 54, 80, 48, 13, 21, 14, 61, 17, 13, 17, 18, 34, 13, 21, 13, 21, 13, 13, 56, 71, 13, 45, 33, 13, 18, 13, 9, 15, 13, 80, 56, 41, 13, 49, 16, 13, 62, 13, 80, 14, 15, 17, 13, 80, 54, 38, 14, 40, 13, 59, 68, 14, 56, 13, 14, 43, 72, 16, 38, 48, 14, 15, 13, 14, 45, 14, 14, 13, 80, 48, 16, 49, 20, 14, 13, 16, 53, 42, 13, 36, 14, 13, 14, 13, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09335857351565952, "mean_inference_ms": 0.256375175157723, "mean_action_processing_ms": 0.03300772671526781, "mean_env_wait_ms": 0.04712896099310165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001540521937092458, "StateBufferConnector_ms": 0.0013188114316444698, "ViewRequirementAgentConnector_ms": 0.02876323039137472}}, "episode_reward_max": 0.9998810193166682, "episode_reward_min": -1.0, "episode_reward_mean": 0.4998656783978592, "episode_len_mean": 31.559055118110237, "episodes_this_iter": 127, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5823652565735467, 0.6789184244318855, 0.7768894916898851, 0.5, 0.5, 0.794791556378017, -1.0, 0.8308869336993272, -1.0, -1.0, 0.7923793738322653, 0.551456795896319, 0.9411964852986997, 0.5, 0.7065499120666225, 0.5317571983834872, 0.5, 0.8830261590530664, 0.5, 0.8090171546164296, 0.8644035372949146, 0.7834788977265086, 0.7604726385252606, 0.5337349773011664, -1.0, 0.6988888860411053, 0.6899824705380149, 0.8860825990400674, 0.9191346332881785, 0.8100789867167757, 0.5, 0.5, -1.0, 0.7943742970473631, 0.7349458525804642, 0.6842374570803885, 0.5, 0.9517124363255856, 0.5, 0.749651325341238, 0.5, 0.70475167140543, 0.671122801953967, -1.0, 0.9998810193166682, 0.9648987657095229, 0.9947590038178478, 0.8949913251750692, 0.9404266170744882, 0.9885171766156909, 0.5647786783562179, 0.5, 0.5773421397423733, -1.0, 0.9350715119344098, -1.0, 0.6371693206358024, -1.0, 0.9279671839287321, 0.5655728730351554, 0.7953868426636317, 0.9616729790587584, 0.7667999424842458, 0.7343033034364218, 0.5, 0.7896353800422726, 0.5, 0.9406915451277023, -1.0, 0.5, 0.5, -1.0, 0.6335409484038741, 0.5956550570907269, 0.5, 0.5, 0.5, 0.5161071832153862, 0.900082499790164, 0.5, -1.0, 0.7924388294497803, 0.8723593445027752, 0.5, 0.6382358869369058, -1.0, 0.7606993197189511, 0.5, 0.8298420414539569, 0.6199705985696349, 0.8916058253601495, 0.9323338989593264, 0.8060545403747781, 0.8697437538079589, 0.9281703923823575, 0.5, 0.5, 0.6380394005098592, 0.625633963118428, 0.7873112143269633, 0.6983591514485976, 0.907149376278298, 0.7556606515809878, 0.7212310879973345, 0.5, 0.5, 0.9397593594131747, 0.7131463212443598, 0.5, 0.9960722686107059, -1.0, 0.7338694459354491, 0.5, 0.9016603593110215, 0.5594950699367063, -1.0, 0.933029250931602, 0.5, 0.7726799141194435, 0.7912318943229468, 0.8593052611275123, 0.5, 0.5, 0.647696297235433, 0.5, 0.8186169307815798, 0.5], "episode_lengths": [42, 53, 43, 15, 14, 52, 80, 13, 80, 80, 15, 15, 58, 21, 50, 13, 14, 54, 22, 38, 13, 14, 47, 13, 80, 14, 13, 60, 14, 56, 49, 20, 80, 13, 14, 55, 24, 18, 14, 43, 14, 13, 54, 80, 48, 13, 21, 14, 61, 17, 13, 17, 18, 34, 13, 21, 13, 21, 13, 13, 56, 71, 13, 45, 33, 13, 18, 13, 9, 15, 13, 80, 56, 41, 13, 49, 16, 13, 62, 13, 80, 14, 15, 17, 13, 80, 54, 38, 14, 40, 13, 59, 68, 14, 56, 13, 14, 43, 72, 16, 38, 48, 14, 15, 13, 14, 45, 14, 14, 13, 80, 48, 16, 49, 20, 14, 13, 16, 53, 42, 13, 36, 14, 13, 14, 13, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09335857351565952, "mean_inference_ms": 0.256375175157723, "mean_action_processing_ms": 0.03300772671526781, "mean_env_wait_ms": 0.04712896099310165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001540521937092458, "StateBufferConnector_ms": 0.0013188114316444698, "ViewRequirementAgentConnector_ms": 0.02876323039137472}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1099.6203779441682, "num_env_steps_trained_throughput_per_sec": 1099.6203779441682, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 3640.774, "sample_time_ms": 1724.157, "load_time_ms": 0.201, "load_throughput": 19890001.186, "learn_time_ms": 1915.465, "learn_throughput": 2088.265, "synch_weights_time_ms": 0.62}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 10266, "training_iteration": 98, "trial_id": "default", "date": "2024-05-23_11-38-20", "timestamp": 1716457100, "time_this_iter_s": 3.6405999660491943, "time_total_s": 358.20821595191956, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 358.20821595191956, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 14.4, "ram_util_percent": 56.78333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.938245021015085, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18032967756672572, "policy_loss": -0.005181300764282544, "vf_loss": 0.18540035447366135, "vf_explained_var": 0.28058318649568864, "kl": 0.008849693995512125, "entropy": 0.6013109052373516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 91605.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 0.9902533944888485, "episode_reward_min": -1.0, "episode_reward_mean": 0.40714374456029756, "episode_len_mean": 28.607142857142858, "episode_media": {}, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.5, 0.5, -1.0, 0.5, 0.5, 0.8747526775020388, 0.9788186147607404, 0.5147971336582857, -1.0, 0.5, 0.8873083574041678, 0.7201197530157428, 0.8809205551156617, 0.5511743605793537, 0.8926470350200165, -1.0, 0.5, 0.5051249832429441, 0.5, 0.930815391339864, 0.5850310071926513, -1.0, 0.6034467631046964, 0.5968985897276385, 0.5, 0.5, 0.6978263039117492, 0.5036964161908248, 0.9643857353898324, 0.5898103978690701, 0.9293176030179544, 0.9715895749184501, 0.7432285197621968, 0.7788569359659889, 0.9251502891472818, -1.0, 0.5, -1.0, 0.8758695399381028, 0.5, 0.7581491384115876, 0.7755107341763834, -1.0, 0.5, 0.9003756584663059, -1.0, 0.6534979467150046, 0.5, -1.0, -1.0, 0.7342654811371718, 0.5250980506565313, 0.6579161881656169, -1.0, 0.5, 0.5911093813009236, 0.5, 0.7191551680809041, 0.5420200323014206, 0.9330302000067705, -1.0, 0.5, 0.5853406382814863, 0.5985983971578285, 0.9902533944888485, 0.5, 0.986968756246013, 0.5, 0.8005734423684214, 0.5, 0.7754066550122546, -1.0, 0.6458607049703822, 0.5, -1.0, 0.8577109945134864, 0.7285526843239396, 0.5, 0.5684740972014943, 0.5, -1.0, 0.5, 0.5, 0.8973082726885242, 0.5, 0.8917881131540151, -1.0, 0.5, 0.6962635483495945, 0.5, -1.0, 0.7874087831422828, 0.8823695739704547, 0.5, 0.5106235949326785, 0.9011566701087687, 0.5, 0.8964597102221117, 0.7007765293507124, 0.8459208461437724, 0.8229613050616073, 0.5127975705038728, 0.7903937532434742, 0.5, 0.5, 0.5, -1.0, 0.5, 0.7107192600526553, 0.9301083963778372, 0.5011221292643988, 0.8528651706664128, 0.5919928267580331, 0.9686889893586311, 0.5, 0.6709117137393588, -1.0, 0.5420253453214814, 0.9495820784766356, 0.6639732121224091, 0.8311485935118051, -1.0, 0.5, 0.5546071134831905, 0.6666432212994513, 0.9231572238376438, 0.7641576799244809, 0.710374826634135, -1.0, 0.5, 0.8094034642334651, 0.9714144611127213, 0.7781924066634692, 0.8216748690589317, -1.0, 0.5553090870872996, 0.754976050936842, 0.5113935658904719, 0.5, 0.5], "episode_lengths": [14, 14, 17, 15, 16, 13, 13, 13, 80, 13, 13, 15, 14, 13, 39, 32, 26, 13, 20, 13, 44, 17, 13, 14, 13, 39, 14, 14, 53, 13, 15, 45, 14, 13, 14, 80, 15, 80, 13, 30, 13, 13, 80, 22, 14, 80, 13, 13, 80, 80, 14, 42, 13, 80, 15, 18, 14, 53, 15, 13, 80, 13, 53, 14, 54, 19, 70, 14, 13, 14, 13, 80, 45, 20, 35, 48, 16, 28, 13, 14, 80, 16, 21, 13, 16, 13, 16, 16, 17, 34, 80, 13, 13, 14, 19, 16, 14, 13, 13, 14, 14, 13, 13, 23, 15, 48, 80, 13, 13, 55, 14, 13, 67, 60, 14, 61, 80, 13, 52, 13, 34, 80, 44, 61, 14, 40, 33, 15, 23, 13, 14, 13, 13, 14, 16, 65, 13, 14, 46, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09337593470736195, "mean_inference_ms": 0.2563501227923442, "mean_action_processing_ms": 0.033003384762202416, "mean_env_wait_ms": 0.047126386706039004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015435900006975447, "StateBufferConnector_ms": 0.0012893336159842356, "ViewRequirementAgentConnector_ms": 0.028589793613978794}}, "episode_reward_max": 0.9902533944888485, "episode_reward_min": -1.0, "episode_reward_mean": 0.40714374456029756, "episode_len_mean": 28.607142857142858, "episodes_this_iter": 140, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.5, 0.5, -1.0, 0.5, 0.5, 0.8747526775020388, 0.9788186147607404, 0.5147971336582857, -1.0, 0.5, 0.8873083574041678, 0.7201197530157428, 0.8809205551156617, 0.5511743605793537, 0.8926470350200165, -1.0, 0.5, 0.5051249832429441, 0.5, 0.930815391339864, 0.5850310071926513, -1.0, 0.6034467631046964, 0.5968985897276385, 0.5, 0.5, 0.6978263039117492, 0.5036964161908248, 0.9643857353898324, 0.5898103978690701, 0.9293176030179544, 0.9715895749184501, 0.7432285197621968, 0.7788569359659889, 0.9251502891472818, -1.0, 0.5, -1.0, 0.8758695399381028, 0.5, 0.7581491384115876, 0.7755107341763834, -1.0, 0.5, 0.9003756584663059, -1.0, 0.6534979467150046, 0.5, -1.0, -1.0, 0.7342654811371718, 0.5250980506565313, 0.6579161881656169, -1.0, 0.5, 0.5911093813009236, 0.5, 0.7191551680809041, 0.5420200323014206, 0.9330302000067705, -1.0, 0.5, 0.5853406382814863, 0.5985983971578285, 0.9902533944888485, 0.5, 0.986968756246013, 0.5, 0.8005734423684214, 0.5, 0.7754066550122546, -1.0, 0.6458607049703822, 0.5, -1.0, 0.8577109945134864, 0.7285526843239396, 0.5, 0.5684740972014943, 0.5, -1.0, 0.5, 0.5, 0.8973082726885242, 0.5, 0.8917881131540151, -1.0, 0.5, 0.6962635483495945, 0.5, -1.0, 0.7874087831422828, 0.8823695739704547, 0.5, 0.5106235949326785, 0.9011566701087687, 0.5, 0.8964597102221117, 0.7007765293507124, 0.8459208461437724, 0.8229613050616073, 0.5127975705038728, 0.7903937532434742, 0.5, 0.5, 0.5, -1.0, 0.5, 0.7107192600526553, 0.9301083963778372, 0.5011221292643988, 0.8528651706664128, 0.5919928267580331, 0.9686889893586311, 0.5, 0.6709117137393588, -1.0, 0.5420253453214814, 0.9495820784766356, 0.6639732121224091, 0.8311485935118051, -1.0, 0.5, 0.5546071134831905, 0.6666432212994513, 0.9231572238376438, 0.7641576799244809, 0.710374826634135, -1.0, 0.5, 0.8094034642334651, 0.9714144611127213, 0.7781924066634692, 0.8216748690589317, -1.0, 0.5553090870872996, 0.754976050936842, 0.5113935658904719, 0.5, 0.5], "episode_lengths": [14, 14, 17, 15, 16, 13, 13, 13, 80, 13, 13, 15, 14, 13, 39, 32, 26, 13, 20, 13, 44, 17, 13, 14, 13, 39, 14, 14, 53, 13, 15, 45, 14, 13, 14, 80, 15, 80, 13, 30, 13, 13, 80, 22, 14, 80, 13, 13, 80, 80, 14, 42, 13, 80, 15, 18, 14, 53, 15, 13, 80, 13, 53, 14, 54, 19, 70, 14, 13, 14, 13, 80, 45, 20, 35, 48, 16, 28, 13, 14, 80, 16, 21, 13, 16, 13, 16, 16, 17, 34, 80, 13, 13, 14, 19, 16, 14, 13, 13, 14, 14, 13, 13, 23, 15, 48, 80, 13, 13, 55, 14, 13, 67, 60, 14, 61, 80, 13, 52, 13, 34, 80, 44, 61, 14, 40, 33, 15, 23, 13, 14, 13, 13, 14, 16, 65, 13, 14, 46, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09337593470736195, "mean_inference_ms": 0.2563501227923442, "mean_action_processing_ms": 0.033003384762202416, "mean_env_wait_ms": 0.047126386706039004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0015435900006975447, "StateBufferConnector_ms": 0.0012893336159842356, "ViewRequirementAgentConnector_ms": 0.028589793613978794}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1075.1746102870654, "num_env_steps_trained_throughput_per_sec": 1075.1746102870654, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3649.544, "sample_time_ms": 1723.745, "load_time_ms": 0.204, "load_throughput": 19624770.149, "learn_time_ms": 1924.624, "learn_throughput": 2078.328, "synch_weights_time_ms": 0.637}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 10406, "training_iteration": 99, "trial_id": "default", "date": "2024-05-23_11-38-23", "timestamp": 1716457103, "time_this_iter_s": 3.7235960960388184, "time_total_s": 361.9318120479584, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 361.9318120479584, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 17.080000000000002, "ram_util_percent": 56.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6967809537085152, "cur_kl_coeff": 0.012500000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19944697797235217, "policy_loss": -0.003197225895009294, "vf_loss": 0.20254465511409186, "vf_explained_var": -0.011682007389683877, "kl": 0.007963707024618705, "entropy": 0.6080265047088746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 128.0, "num_grad_updates_lifetime": 92535.5, "diff_num_grad_updates_vs_sampler_policy": 464.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 0.997648354568292, "episode_reward_min": -1.0, "episode_reward_mean": 0.47972033925170127, "episode_len_mean": 28.74820143884892, "episode_media": {}, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8514626271422849, 0.5555046743107874, 0.997648354568292, 0.8881501043860697, -1.0, 0.6936316492778909, 0.803997670681064, -1.0, 0.6539302421640485, 0.5, 0.9126138991181996, 0.5, 0.5, 0.5, 0.5, 0.7192121826260851, 0.6364205546488367, 0.5, 0.9285991057109677, 0.5, 0.6480110038104377, 0.7907851371205323, 0.6381679937963898, 0.7975544314267974, -1.0, 0.5, 0.8777263784747636, 0.9511455374740221, 0.8910314584009349, 0.5, -1.0, -1.0, 0.7803331550228471, -1.0, 0.9364000913905921, -1.0, 0.8959222686156658, 0.5542303403553139, 0.8856642691568944, -1.0, 0.7300690565885701, 0.8461828893812245, 0.5, 0.5, 0.5, 0.709492135116206, 0.8855287994874452, 0.9644867189531481, 0.5, 0.5, 0.9296814075908728, 0.8009130383622247, 0.5725610556767604, 0.9258539065474936, 0.8163390534797071, 0.5, 0.6650702656222193, -1.0, 0.6043209572404782, 0.8354014741226575, 0.9467759760329095, -1.0, 0.5979612326688575, 0.7161181485616184, 0.8732322980059545, 0.5, 0.736380150430956, 0.6632537482413018, -1.0, 0.6933954756676246, 0.8431829461102986, 0.8784338133800739, -1.0, 0.7527745992675575, 0.5, 0.934665124158018, 0.7412839829121103, 0.7000942839729565, 0.96291152756873, 0.6956127004714403, 0.9966468265905377, 0.9912762506028423, 0.5, 0.8398286032065696, 0.5784068646359509, 0.5, -1.0, 0.8329158555737045, 0.9613505742255781, 0.8182275481897764, 0.5, 0.5, 0.9485630969318707, 0.645568485065699, 0.9418538536203197, 0.778234126186927, 0.9537244802021642, 0.6433897039453389, 0.6817621310166753, 0.5, 0.5, 0.8172203680836078, 0.6949521864194145, 0.908547630322838, 0.7534837023169705, -1.0, 0.9460114960509339, 0.5, 0.8245491772791955, 0.7218971177480868, 0.5, 0.8587137531968385, 0.5, 0.6419535820023223, 0.663845427380725, 0.5, 0.6744314048494596, 0.5, -1.0, 0.5, 0.7772425233181076, 0.5, 0.982829051413161, 0.7253910477235342, 0.6738786986979737, 0.5, 0.9234104313287629, 0.6384635820619522, -1.0, 0.8300046874325414, 0.562025371008136, -1.0, -1.0, 0.5387032609322804, 0.9454097838037084, 0.5, 0.8383136320715081, -1.0, 0.8179809452513183], "episode_lengths": [55, 13, 40, 57, 80, 33, 41, 16, 54, 13, 15, 14, 13, 14, 17, 13, 55, 14, 54, 15, 13, 14, 14, 70, 54, 14, 67, 49, 14, 16, 32, 80, 13, 26, 55, 15, 13, 16, 18, 17, 55, 13, 13, 15, 13, 15, 13, 14, 14, 26, 13, 13, 55, 13, 15, 15, 35, 80, 30, 61, 13, 35, 54, 13, 52, 14, 13, 17, 80, 66, 16, 14, 15, 16, 33, 13, 14, 15, 43, 53, 16, 13, 20, 14, 36, 15, 30, 14, 56, 13, 14, 15, 16, 26, 42, 73, 16, 35, 34, 26, 16, 15, 78, 13, 13, 35, 13, 14, 60, 36, 13, 32, 37, 13, 62, 18, 13, 32, 9, 14, 14, 13, 13, 44, 13, 13, 14, 64, 35, 14, 15, 26, 80, 13, 47, 14, 42, 80, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09339201467364985, "mean_inference_ms": 0.2563218271185966, "mean_action_processing_ms": 0.032999826424536714, "mean_env_wait_ms": 0.047124884333556376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014845415842618874, "StateBufferConnector_ms": 0.0012733953462230217, "ViewRequirementAgentConnector_ms": 0.028491363250951973}}, "episode_reward_max": 0.997648354568292, "episode_reward_min": -1.0, "episode_reward_mean": 0.47972033925170127, "episode_len_mean": 28.74820143884892, "episodes_this_iter": 139, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8514626271422849, 0.5555046743107874, 0.997648354568292, 0.8881501043860697, -1.0, 0.6936316492778909, 0.803997670681064, -1.0, 0.6539302421640485, 0.5, 0.9126138991181996, 0.5, 0.5, 0.5, 0.5, 0.7192121826260851, 0.6364205546488367, 0.5, 0.9285991057109677, 0.5, 0.6480110038104377, 0.7907851371205323, 0.6381679937963898, 0.7975544314267974, -1.0, 0.5, 0.8777263784747636, 0.9511455374740221, 0.8910314584009349, 0.5, -1.0, -1.0, 0.7803331550228471, -1.0, 0.9364000913905921, -1.0, 0.8959222686156658, 0.5542303403553139, 0.8856642691568944, -1.0, 0.7300690565885701, 0.8461828893812245, 0.5, 0.5, 0.5, 0.709492135116206, 0.8855287994874452, 0.9644867189531481, 0.5, 0.5, 0.9296814075908728, 0.8009130383622247, 0.5725610556767604, 0.9258539065474936, 0.8163390534797071, 0.5, 0.6650702656222193, -1.0, 0.6043209572404782, 0.8354014741226575, 0.9467759760329095, -1.0, 0.5979612326688575, 0.7161181485616184, 0.8732322980059545, 0.5, 0.736380150430956, 0.6632537482413018, -1.0, 0.6933954756676246, 0.8431829461102986, 0.8784338133800739, -1.0, 0.7527745992675575, 0.5, 0.934665124158018, 0.7412839829121103, 0.7000942839729565, 0.96291152756873, 0.6956127004714403, 0.9966468265905377, 0.9912762506028423, 0.5, 0.8398286032065696, 0.5784068646359509, 0.5, -1.0, 0.8329158555737045, 0.9613505742255781, 0.8182275481897764, 0.5, 0.5, 0.9485630969318707, 0.645568485065699, 0.9418538536203197, 0.778234126186927, 0.9537244802021642, 0.6433897039453389, 0.6817621310166753, 0.5, 0.5, 0.8172203680836078, 0.6949521864194145, 0.908547630322838, 0.7534837023169705, -1.0, 0.9460114960509339, 0.5, 0.8245491772791955, 0.7218971177480868, 0.5, 0.8587137531968385, 0.5, 0.6419535820023223, 0.663845427380725, 0.5, 0.6744314048494596, 0.5, -1.0, 0.5, 0.7772425233181076, 0.5, 0.982829051413161, 0.7253910477235342, 0.6738786986979737, 0.5, 0.9234104313287629, 0.6384635820619522, -1.0, 0.8300046874325414, 0.562025371008136, -1.0, -1.0, 0.5387032609322804, 0.9454097838037084, 0.5, 0.8383136320715081, -1.0, 0.8179809452513183], "episode_lengths": [55, 13, 40, 57, 80, 33, 41, 16, 54, 13, 15, 14, 13, 14, 17, 13, 55, 14, 54, 15, 13, 14, 14, 70, 54, 14, 67, 49, 14, 16, 32, 80, 13, 26, 55, 15, 13, 16, 18, 17, 55, 13, 13, 15, 13, 15, 13, 14, 14, 26, 13, 13, 55, 13, 15, 15, 35, 80, 30, 61, 13, 35, 54, 13, 52, 14, 13, 17, 80, 66, 16, 14, 15, 16, 33, 13, 14, 15, 43, 53, 16, 13, 20, 14, 36, 15, 30, 14, 56, 13, 14, 15, 16, 26, 42, 73, 16, 35, 34, 26, 16, 15, 78, 13, 13, 35, 13, 14, 60, 36, 13, 32, 37, 13, 62, 18, 13, 32, 9, 14, 14, 13, 13, 44, 13, 13, 14, 64, 35, 14, 15, 26, 80, 13, 47, 14, 42, 80, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09339201467364985, "mean_inference_ms": 0.2563218271185966, "mean_action_processing_ms": 0.032999826424536714, "mean_env_wait_ms": 0.047124884333556376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0014845415842618874, "StateBufferConnector_ms": 0.0012733953462230217, "ViewRequirementAgentConnector_ms": 0.028491363250951973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1098.940368399999, "num_env_steps_trained_throughput_per_sec": 1098.940368399999, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 3648.888, "sample_time_ms": 1723.802, "load_time_ms": 0.204, "load_throughput": 19594973.137, "learn_time_ms": 1923.911, "learn_throughput": 2079.098, "synch_weights_time_ms": 0.636}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 10545, "training_iteration": 100, "trial_id": "default", "date": "2024-05-23_11-38-27", "timestamp": 1716457107, "time_this_iter_s": 3.642972946166992, "time_total_s": 365.57478499412537, "pid": 1535, "hostname": "TakayaMacAir.chello.hu", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "env": "<class 'sim_env.parking_env.Parking'>", "env_config": {"render_mode": "no_render", "action_type": "discrete", "parking_type": "perpendicular", "training_mode": "on"}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "_is_atari": null, "env_runner_cls": null, "num_envs_per_worker": 1, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "validate_workers_after_construction": true, "compress_observations": false, "sampler_perf_stats_ema_coef": null, "sample_async": -1, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x306fb64d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 1, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": "<function custom_log_creator.<locals>.logger_creator at 0x30760f7f0>", "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_enable_new_api_stack": false, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 365.57478499412537, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.78, "ram_util_percent": 56.71999999999999}}
